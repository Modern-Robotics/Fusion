var _0x1ed6=['local-signup','username','password','findOne','Error','Username\x20Already\x20Exists','body','filepath','generateFileSystem','local-login','toLowerCase','local-recovery','trim','securityanswer','Strategy','exports','serializeUser','deserializeUser','findById','use'];(function(_0x2d8f05,_0x4b81bb){var _0x4d74cb=function(_0x32719f){while(--_0x32719f){_0x2d8f05['push'](_0x2d8f05['shift']());}};_0x4d74cb(++_0x4b81bb);}(_0x1ed6,0x1ee));var _0x3361=function(_0x571b5c,_0x4dbbea){_0x571b5c=_0x571b5c-0x0;var _0x20e515=_0x1ed6[_0x571b5c];return _0x20e515;};var LocalStrategy=require('passport-local')[_0x3361('0x0')];var User=require('../app/models/user');module[_0x3361('0x1')]=function(_0x366012){_0x366012[_0x3361('0x2')](function(_0x4b7f97,_0x18620d){_0x18620d(null,_0x4b7f97['id']);});_0x366012[_0x3361('0x3')](function(_0x271466,_0xf7301a){User[_0x3361('0x4')](_0x271466,function(_0x3344e0,_0x471db4){_0xf7301a(_0x3344e0,_0x471db4);});});_0x366012[_0x3361('0x5')](_0x3361('0x6'),new LocalStrategy({'usernameField':_0x3361('0x7'),'passwordField':_0x3361('0x8'),'passReqToCallback':!![]},function(_0x1c79c5,_0x5a9766,_0x24f2b2,_0x528ee6){User[_0x3361('0x9')]({'username':_0x5a9766['toLowerCase']()['trim']()},async function(_0x860b7a,_0x16c6b5){if(_0x860b7a)return _0x528ee6(_0x860b7a);if(_0x16c6b5){_0x16c6b5[_0x3361('0xa')]=_0x3361('0xb');return _0x528ee6(null,_0x16c6b5);}else{var _0x5a1257=new User(_0x1c79c5[_0x3361('0xc')]);_0x5a1257[_0x3361('0x7')]=_0x5a9766;_0x5a1257[_0x3361('0x8')]=_0x5a1257['generateHash'](_0x24f2b2);_0x5a1257[_0x3361('0xd')]=await _0x5a1257[_0x3361('0xe')](_0x5a1257[_0x3361('0x7')]);_0x5a1257['save'](function(_0x860b7a){if(_0x860b7a)throw _0x860b7a;return _0x528ee6(null,_0x5a1257);});}});}));_0x366012['use'](_0x3361('0xf'),new LocalStrategy({'usernameField':_0x3361('0x7'),'passwordField':_0x3361('0x8'),'passReqToCallback':!![]},function(_0xf8a88e,_0x41cd63,_0x1cef8e,_0x2ca680){User[_0x3361('0x9')]({'username':_0x41cd63[_0x3361('0x10')]()['trim']()},function(_0x1e2c7b,_0x2e5c95){if(_0x1e2c7b)return _0x2ca680(_0x1e2c7b);if(!_0x2e5c95)return _0x2ca680(null,![]);if(!_0x2e5c95['validPassword'](_0x1cef8e))return _0x2ca680(null,![]);return _0x2ca680(null,_0x2e5c95);});}));_0x366012[_0x3361('0x5')](_0x3361('0x11'),new LocalStrategy({'usernameField':_0x3361('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x9f115b,_0x4caaf5,_0x58b9a3,_0x44c446){User[_0x3361('0x9')]({'username':_0x4caaf5[_0x3361('0x10')]()[_0x3361('0x12')]()},function(_0x2826f2,_0x5c40b9){if(_0x2826f2)return _0x44c446(_0x2826f2);if(!_0x5c40b9)return _0x44c446(null,![]);if(!_0x5c40b9['validSecurityAnswer'](_0x9f115b[_0x3361('0xc')][_0x3361('0x13')]))return _0x44c446(null,![]);return _0x44c446(null,_0x5c40b9);});}));};