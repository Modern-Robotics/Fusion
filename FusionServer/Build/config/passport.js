var _0x476b=['passport-local','serializeUser','deserializeUser','use','local-signup','password','findOne','trim','REGISTER.ALREADY_EXISTS','body','username','filepath','generateFileSystem','local-login','toLowerCase','LOGIN.INVALID','validPassword','securityanswer'];(function(_0xadd265,_0x2997af){var _0x331aab=function(_0x393a37){while(--_0x393a37){_0xadd265['push'](_0xadd265['shift']());}};_0x331aab(++_0x2997af);}(_0x476b,0x17a));var _0x2b8e=function(_0x1fcc6d,_0x11c788){_0x1fcc6d=_0x1fcc6d-0x0;var _0xee2a15=_0x476b[_0x1fcc6d];return _0xee2a15;};var LocalStrategy=require(_0x2b8e('0x0'))['Strategy'];var User=require('../app/models/user');module['exports']=function(_0x5904a2){_0x5904a2[_0x2b8e('0x1')](function(_0x49196b,_0x2d1fe0){_0x2d1fe0(null,_0x49196b['id']);});_0x5904a2[_0x2b8e('0x2')](function(_0x52500d,_0x3f873a){User['findById'](_0x52500d,function(_0x54c908,_0x46dfa5){_0x3f873a(_0x54c908,_0x46dfa5);});});_0x5904a2[_0x2b8e('0x3')](_0x2b8e('0x4'),new LocalStrategy({'usernameField':'username','passwordField':_0x2b8e('0x5'),'passReqToCallback':!![]},function(_0x323ec2,_0x2518d5,_0x28eb65,_0x4d218f){User[_0x2b8e('0x6')]({'username':_0x2518d5['toLowerCase']()[_0x2b8e('0x7')]()},async function(_0x316a7d,_0x2fc391){if(_0x316a7d)return _0x4d218f(_0x316a7d);if(_0x2fc391){return _0x4d218f(null,_0x2fc391,{'message':_0x2b8e('0x8')});}else{var _0x24340c=new User(_0x323ec2[_0x2b8e('0x9')]);_0x24340c[_0x2b8e('0xa')]=_0x2518d5;_0x24340c['password']=_0x24340c['generateHash'](_0x28eb65);_0x24340c[_0x2b8e('0xb')]=await _0x24340c[_0x2b8e('0xc')](_0x24340c['username']);_0x24340c['save'](function(_0x316a7d){if(_0x316a7d)throw _0x316a7d;return _0x4d218f(null,_0x24340c);});}});}));_0x5904a2[_0x2b8e('0x3')](_0x2b8e('0xd'),new LocalStrategy({'usernameField':_0x2b8e('0xa'),'passwordField':'password','passReqToCallback':!![]},function(_0x38e393,_0x2b66a9,_0x4f63c2,_0x3bcf2e){User['findOne']({'username':_0x2b66a9[_0x2b8e('0xe')]()[_0x2b8e('0x7')]()},function(_0x97c9b3,_0x1910f6){if(_0x97c9b3)return _0x3bcf2e(_0x97c9b3);if(!_0x1910f6)return _0x3bcf2e(null,![],{'message':_0x2b8e('0xf')});if(!_0x1910f6[_0x2b8e('0x10')](_0x4f63c2))return _0x3bcf2e(null,![],{'message':_0x2b8e('0xf')});return _0x3bcf2e(null,_0x1910f6);});}));_0x5904a2[_0x2b8e('0x3')]('local-recovery',new LocalStrategy({'usernameField':'username','passwordField':_0x2b8e('0x5'),'passReqToCallback':!![]},function(_0x146d70,_0x54df42,_0x50b65,_0xeb7d5){User[_0x2b8e('0x6')]({'username':_0x54df42[_0x2b8e('0xe')]()[_0x2b8e('0x7')]()},function(_0x2e2a8f,_0x35664d){if(_0x2e2a8f)return _0xeb7d5(_0x2e2a8f);if(!_0x35664d)return _0xeb7d5(null,![]);if(!_0x35664d['validSecurityAnswer'](_0x146d70['body'][_0x2b8e('0x11')]))return _0xeb7d5(null,![]);return _0xeb7d5(null,_0x35664d);});}));};