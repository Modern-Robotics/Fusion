var _0x1267=['password','findOne','toLowerCase','REGISTER.ALREADY_EXISTS','body','generateHash','generateFileSystem','save','use','trim','LOGIN.INVALID','validPassword','local-recovery','securityanswer','passport-local','Strategy','../app/models/user','serializeUser','deserializeUser','findById','local-signup','username'];(function(_0x51d779,_0x2364ed){var _0x2e0f85=function(_0x5edabf){while(--_0x5edabf){_0x51d779['push'](_0x51d779['shift']());}};_0x2e0f85(++_0x2364ed);}(_0x1267,0xd4));var _0x8705=function(_0x5a236b,_0x848061){_0x5a236b=_0x5a236b-0x0;var _0xa9f333=_0x1267[_0x5a236b];return _0xa9f333;};var LocalStrategy=require(_0x8705('0x0'))[_0x8705('0x1')];var User=require(_0x8705('0x2'));module['exports']=function(_0x716d7e){_0x716d7e[_0x8705('0x3')](function(_0x50c51c,_0x4d3864){_0x4d3864(null,_0x50c51c['id']);});_0x716d7e[_0x8705('0x4')](function(_0x5e8ad5,_0x290e44){User[_0x8705('0x5')](_0x5e8ad5,function(_0x112f27,_0x7dc632){_0x290e44(_0x112f27,_0x7dc632);});});_0x716d7e['use'](_0x8705('0x6'),new LocalStrategy({'usernameField':_0x8705('0x7'),'passwordField':_0x8705('0x8'),'passReqToCallback':!![]},function(_0x3859a1,_0x244027,_0x4ee982,_0x1f8933){User[_0x8705('0x9')]({'username':_0x244027[_0x8705('0xa')]()['trim']()},async function(_0x3ed67a,_0x28a427){if(_0x3ed67a)return _0x1f8933(_0x3ed67a);if(_0x28a427){return _0x1f8933(null,_0x28a427,{'message':_0x8705('0xb')});}else{var _0x406e65=new User(_0x3859a1[_0x8705('0xc')]);_0x406e65[_0x8705('0x7')]=_0x244027;_0x406e65[_0x8705('0x8')]=_0x406e65[_0x8705('0xd')](_0x4ee982);_0x406e65['filepath']=await _0x406e65[_0x8705('0xe')](_0x406e65['username']);_0x406e65[_0x8705('0xf')](function(_0x3ed67a){if(_0x3ed67a)throw _0x3ed67a;return _0x1f8933(null,_0x406e65);});}});}));_0x716d7e[_0x8705('0x10')]('local-login',new LocalStrategy({'usernameField':_0x8705('0x7'),'passwordField':_0x8705('0x8'),'passReqToCallback':!![]},function(_0x16226b,_0x57ffc4,_0x6bee21,_0x1c888f){User['findOne']({'username':_0x57ffc4[_0x8705('0xa')]()[_0x8705('0x11')]()},function(_0x35393a,_0x6888a4){if(_0x35393a)return _0x1c888f(_0x35393a);if(!_0x6888a4)return _0x1c888f(null,![],{'message':_0x8705('0x12')});if(!_0x6888a4[_0x8705('0x13')](_0x6bee21))return _0x1c888f(null,![],{'message':_0x8705('0x12')});return _0x1c888f(null,_0x6888a4);});}));_0x716d7e[_0x8705('0x10')](_0x8705('0x14'),new LocalStrategy({'usernameField':_0x8705('0x7'),'passwordField':_0x8705('0x8'),'passReqToCallback':!![]},function(_0x325daf,_0x11fb8e,_0x506639,_0x4ab821){User[_0x8705('0x9')]({'username':_0x11fb8e[_0x8705('0xa')]()[_0x8705('0x11')]()},function(_0x1771e7,_0x5cd7ae){if(_0x1771e7)return _0x4ab821(_0x1771e7);if(!_0x5cd7ae)return _0x4ab821(null,![]);if(!_0x5cd7ae['validSecurityAnswer'](_0x325daf[_0x8705('0xc')][_0x8705('0x15')]))return _0x4ab821(null,![]);return _0x4ab821(null,_0x5cd7ae);});}));};