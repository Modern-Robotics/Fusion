var _0x3fcb=['generateFileSystem','save','local-login','validPassword','local-recovery','findOne','validSecurityAnswer','securityanswer','passport-local','../app/models/user','deserializeUser','use','local-signup','username','password','toLowerCase','trim','Error','body','generateHash','filepath'];(function(_0x5bd518,_0x18a61a){var _0x304a00=function(_0x594d48){while(--_0x594d48){_0x5bd518['push'](_0x5bd518['shift']());}};_0x304a00(++_0x18a61a);}(_0x3fcb,0xda));var _0x1a3a=function(_0x4601eb,_0x2b7480){_0x4601eb=_0x4601eb-0x0;var _0x66cb9f=_0x3fcb[_0x4601eb];return _0x66cb9f;};var LocalStrategy=require(_0x1a3a('0x0'))['Strategy'];var User=require(_0x1a3a('0x1'));module['exports']=function(_0x217c45){_0x217c45['serializeUser'](function(_0x4ffcd7,_0x6b9254){_0x6b9254(null,_0x4ffcd7['id']);});_0x217c45[_0x1a3a('0x2')](function(_0x2553e3,_0x3710df){User['findById'](_0x2553e3,function(_0x1a6c33,_0x59f14b){_0x3710df(_0x1a6c33,_0x59f14b);});});_0x217c45[_0x1a3a('0x3')](_0x1a3a('0x4'),new LocalStrategy({'usernameField':_0x1a3a('0x5'),'passwordField':_0x1a3a('0x6'),'passReqToCallback':!![]},function(_0x5f2bc1,_0x589e9d,_0xc9b213,_0xb70cd1){User['findOne']({'username':_0x589e9d[_0x1a3a('0x7')]()[_0x1a3a('0x8')]()},function(_0x12fa86,_0x3d7611){if(_0x12fa86)return _0xb70cd1(_0x12fa86);if(_0x3d7611){_0x3d7611[_0x1a3a('0x9')]='Username\x20Already\x20Exists';return _0xb70cd1(null,_0x3d7611);}else{var _0x52a4ac=new User(_0x5f2bc1[_0x1a3a('0xa')]);_0x52a4ac[_0x1a3a('0x5')]=_0x589e9d;_0x52a4ac[_0x1a3a('0x6')]=_0x52a4ac[_0x1a3a('0xb')](_0xc9b213);_0x52a4ac[_0x1a3a('0xc')]=_0x52a4ac[_0x1a3a('0xd')](_0x52a4ac[_0x1a3a('0x5')]);_0x52a4ac[_0x1a3a('0xe')](function(_0x12fa86){if(_0x12fa86)throw _0x12fa86;return _0xb70cd1(null,_0x52a4ac);});}});}));_0x217c45[_0x1a3a('0x3')](_0x1a3a('0xf'),new LocalStrategy({'usernameField':_0x1a3a('0x5'),'passwordField':_0x1a3a('0x6'),'passReqToCallback':!![]},function(_0x23661f,_0x4b97dd,_0x25d11e,_0x4ca9ac){User['findOne']({'username':_0x4b97dd['toLowerCase']()[_0x1a3a('0x8')]()},function(_0x34cc92,_0x2afc56){if(_0x34cc92)return _0x4ca9ac(_0x34cc92);if(!_0x2afc56)return _0x4ca9ac(null,![]);if(!_0x2afc56[_0x1a3a('0x10')](_0x25d11e))return _0x4ca9ac(null,![]);return _0x4ca9ac(null,_0x2afc56);});}));_0x217c45['use'](_0x1a3a('0x11'),new LocalStrategy({'usernameField':_0x1a3a('0x5'),'passwordField':_0x1a3a('0x6'),'passReqToCallback':!![]},function(_0x238da0,_0x1787ec,_0x21a182,_0x25bdcf){User[_0x1a3a('0x12')]({'username':_0x1787ec[_0x1a3a('0x7')]()['trim']()},function(_0x170586,_0x548e47){if(_0x170586)return _0x25bdcf(_0x170586);if(!_0x548e47)return _0x25bdcf(null,![]);if(!_0x548e47[_0x1a3a('0x13')](_0x238da0[_0x1a3a('0xa')][_0x1a3a('0x14')]))return _0x25bdcf(null,![]);return _0x25bdcf(null,_0x548e47);});}));};