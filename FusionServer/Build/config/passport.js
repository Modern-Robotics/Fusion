var _0x2f3d=['securityanswer','passport-local','Strategy','../app/models/user','exports','serializeUser','deserializeUser','findById','use','local-signup','username','password','findOne','toLowerCase','Error','Username\x20Already\x20Exists','body','filepath','generateFileSystem','save','local-login','trim','validPassword','local-recovery','validSecurityAnswer'];(function(_0x1501a3,_0x23a0a4){var _0x3ce815=function(_0x2bd3db){while(--_0x2bd3db){_0x1501a3['push'](_0x1501a3['shift']());}};_0x3ce815(++_0x23a0a4);}(_0x2f3d,0x97));var _0x4c1e=function(_0x1f4970,_0x2bda50){_0x1f4970=_0x1f4970-0x0;var _0x488918=_0x2f3d[_0x1f4970];return _0x488918;};var LocalStrategy=require(_0x4c1e('0x0'))[_0x4c1e('0x1')];var User=require(_0x4c1e('0x2'));module[_0x4c1e('0x3')]=function(_0x3183b8){_0x3183b8[_0x4c1e('0x4')](function(_0x21d07d,_0x40427b){_0x40427b(null,_0x21d07d['id']);});_0x3183b8[_0x4c1e('0x5')](function(_0x119588,_0xde05c7){User[_0x4c1e('0x6')](_0x119588,function(_0x236da7,_0x410a3c){_0xde05c7(_0x236da7,_0x410a3c);});});_0x3183b8[_0x4c1e('0x7')](_0x4c1e('0x8'),new LocalStrategy({'usernameField':_0x4c1e('0x9'),'passwordField':_0x4c1e('0xa'),'passReqToCallback':!![]},function(_0x27beed,_0x1c354f,_0xac184f,_0x34bae2){User[_0x4c1e('0xb')]({'username':_0x1c354f[_0x4c1e('0xc')]()['trim']()},function(_0x115a7b,_0x1c6c37){if(_0x115a7b)return _0x34bae2(_0x115a7b);if(_0x1c6c37){_0x1c6c37[_0x4c1e('0xd')]=_0x4c1e('0xe');return _0x34bae2(null,_0x1c6c37);}else{var _0x1b834a=new User(_0x27beed[_0x4c1e('0xf')]);_0x1b834a[_0x4c1e('0x9')]=_0x1c354f;_0x1b834a[_0x4c1e('0xa')]=_0x1b834a['generateHash'](_0xac184f);_0x1b834a[_0x4c1e('0x10')]=_0x1b834a[_0x4c1e('0x11')](_0x1b834a[_0x4c1e('0x9')]);_0x1b834a[_0x4c1e('0x12')](function(_0x115a7b){if(_0x115a7b)throw _0x115a7b;return _0x34bae2(null,_0x1b834a);});}});}));_0x3183b8[_0x4c1e('0x7')](_0x4c1e('0x13'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x40345e,_0xba49b4,_0x29204d,_0x48bb0b){User[_0x4c1e('0xb')]({'username':_0xba49b4[_0x4c1e('0xc')]()[_0x4c1e('0x14')]()},function(_0xab9785,_0x113884){if(_0xab9785)return _0x48bb0b(_0xab9785);if(!_0x113884)return _0x48bb0b(null,![]);if(!_0x113884[_0x4c1e('0x15')](_0x29204d))return _0x48bb0b(null,![]);return _0x48bb0b(null,_0x113884);});}));_0x3183b8[_0x4c1e('0x7')](_0x4c1e('0x16'),new LocalStrategy({'usernameField':'username','passwordField':_0x4c1e('0xa'),'passReqToCallback':!![]},function(_0x6f0d63,_0x3644f3,_0x34da42,_0x21916d){User['findOne']({'username':_0x3644f3['toLowerCase']()[_0x4c1e('0x14')]()},function(_0x13557f,_0x55a0b9){if(_0x13557f)return _0x21916d(_0x13557f);if(!_0x55a0b9)return _0x21916d(null,![]);if(!_0x55a0b9[_0x4c1e('0x17')](_0x6f0d63['body'][_0x4c1e('0x18')]))return _0x21916d(null,![]);return _0x21916d(null,_0x55a0b9);});}));};