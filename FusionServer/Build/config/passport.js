var _0x1e24=['Error','Username\x20Already\x20Exists','username','generateHash','filepath','generateFileSystem','validPassword','local-recovery','body','securityanswer','Strategy','../app/models/user','exports','serializeUser','deserializeUser','findById','use','local-signup','password','findOne','toLowerCase','trim'];(function(_0x17cc83,_0x5e2acc){var _0x2a8925=function(_0x618b30){while(--_0x618b30){_0x17cc83['push'](_0x17cc83['shift']());}};_0x2a8925(++_0x5e2acc);}(_0x1e24,0xe6));var _0x1e70=function(_0x14643a,_0x2d0254){_0x14643a=_0x14643a-0x0;var _0x56404e=_0x1e24[_0x14643a];return _0x56404e;};var LocalStrategy=require('passport-local')[_0x1e70('0x0')];var User=require(_0x1e70('0x1'));module[_0x1e70('0x2')]=function(_0x3d4235){_0x3d4235[_0x1e70('0x3')](function(_0x3cd279,_0x1802b8){_0x1802b8(null,_0x3cd279['id']);});_0x3d4235[_0x1e70('0x4')](function(_0x4a1642,_0x4a3172){User[_0x1e70('0x5')](_0x4a1642,function(_0x56215e,_0x42d472){_0x4a3172(_0x56215e,_0x42d472);});});_0x3d4235[_0x1e70('0x6')](_0x1e70('0x7'),new LocalStrategy({'usernameField':'username','passwordField':_0x1e70('0x8'),'passReqToCallback':!![]},function(_0x2b759f,_0x42ff0e,_0x5ab4d9,_0x39600b){User[_0x1e70('0x9')]({'username':_0x42ff0e[_0x1e70('0xa')]()[_0x1e70('0xb')]()},async function(_0x99554d,_0x249631){if(_0x99554d)return _0x39600b(_0x99554d);if(_0x249631){_0x249631[_0x1e70('0xc')]=_0x1e70('0xd');return _0x39600b(null,_0x249631);}else{var _0x5deb22=new User(_0x2b759f['body']);_0x5deb22[_0x1e70('0xe')]=_0x42ff0e;_0x5deb22['password']=_0x5deb22[_0x1e70('0xf')](_0x5ab4d9);_0x5deb22[_0x1e70('0x10')]=await _0x5deb22[_0x1e70('0x11')](_0x5deb22[_0x1e70('0xe')]);_0x5deb22['save'](function(_0x99554d){if(_0x99554d)throw _0x99554d;return _0x39600b(null,_0x5deb22);});}});}));_0x3d4235['use']('local-login',new LocalStrategy({'usernameField':_0x1e70('0xe'),'passwordField':_0x1e70('0x8'),'passReqToCallback':!![]},function(_0x38fd46,_0x213867,_0x1c571f,_0x51e5c7){User[_0x1e70('0x9')]({'username':_0x213867['toLowerCase']()[_0x1e70('0xb')]()},function(_0xe113ad,_0x32d98f){if(_0xe113ad)return _0x51e5c7(_0xe113ad);if(!_0x32d98f)return _0x51e5c7(null,![]);if(!_0x32d98f[_0x1e70('0x12')](_0x1c571f))return _0x51e5c7(null,![]);return _0x51e5c7(null,_0x32d98f);});}));_0x3d4235[_0x1e70('0x6')](_0x1e70('0x13'),new LocalStrategy({'usernameField':_0x1e70('0xe'),'passwordField':'password','passReqToCallback':!![]},function(_0x4a7cac,_0x4d32e4,_0xedb176,_0x3d5134){User[_0x1e70('0x9')]({'username':_0x4d32e4[_0x1e70('0xa')]()[_0x1e70('0xb')]()},function(_0x3eda40,_0x413d84){if(_0x3eda40)return _0x3d5134(_0x3eda40);if(!_0x413d84)return _0x3d5134(null,![]);if(!_0x413d84['validSecurityAnswer'](_0x4a7cac[_0x1e70('0x14')][_0x1e70('0x15')]))return _0x3d5134(null,![]);return _0x3d5134(null,_0x413d84);});}));};