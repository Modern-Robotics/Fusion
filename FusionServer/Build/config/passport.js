var _0x559c=['local-login','password','trim','validPassword','local-recovery','passport-local','Strategy','../app/models/user','exports','serializeUser','use','local-signup','username','findOne','toLowerCase','Error','Username\x20Already\x20Exists','body','filepath','generateFileSystem','save'];(function(_0x2e9fcd,_0x2dbf6b){var _0x1f4ad6=function(_0x4aa021){while(--_0x4aa021){_0x2e9fcd['push'](_0x2e9fcd['shift']());}};_0x1f4ad6(++_0x2dbf6b);}(_0x559c,0x194));var _0x1080=function(_0x1fedf7,_0x34b2ee){_0x1fedf7=_0x1fedf7-0x0;var _0x1091ff=_0x559c[_0x1fedf7];return _0x1091ff;};var LocalStrategy=require(_0x1080('0x0'))[_0x1080('0x1')];var User=require(_0x1080('0x2'));module[_0x1080('0x3')]=function(_0xa8e0b8){_0xa8e0b8[_0x1080('0x4')](function(_0x54214f,_0x352b9d){_0x352b9d(null,_0x54214f['id']);});_0xa8e0b8['deserializeUser'](function(_0x21391e,_0x166876){User['findById'](_0x21391e,function(_0x1305e2,_0x475796){_0x166876(_0x1305e2,_0x475796);});});_0xa8e0b8[_0x1080('0x5')](_0x1080('0x6'),new LocalStrategy({'usernameField':_0x1080('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x437827,_0x461ce9,_0x6458dd,_0x3a8619){User[_0x1080('0x8')]({'username':_0x461ce9[_0x1080('0x9')]()['trim']()},async function(_0x1940f6,_0x16c38c){if(_0x1940f6)return _0x3a8619(_0x1940f6);if(_0x16c38c){_0x16c38c[_0x1080('0xa')]=_0x1080('0xb');return _0x3a8619(null,_0x16c38c);}else{var _0x208af2=new User(_0x437827[_0x1080('0xc')]);_0x208af2[_0x1080('0x7')]=_0x461ce9;_0x208af2['password']=_0x208af2['generateHash'](_0x6458dd);_0x208af2[_0x1080('0xd')]=await _0x208af2[_0x1080('0xe')](_0x208af2[_0x1080('0x7')]);_0x208af2[_0x1080('0xf')](function(_0x1940f6){if(_0x1940f6)throw _0x1940f6;return _0x3a8619(null,_0x208af2);});}});}));_0xa8e0b8['use'](_0x1080('0x10'),new LocalStrategy({'usernameField':_0x1080('0x7'),'passwordField':_0x1080('0x11'),'passReqToCallback':!![]},function(_0x59e516,_0x4fb04a,_0x2d8bca,_0x95587d){User[_0x1080('0x8')]({'username':_0x4fb04a[_0x1080('0x9')]()[_0x1080('0x12')]()},function(_0xa6c2eb,_0x2c7fec){if(_0xa6c2eb)return _0x95587d(_0xa6c2eb);if(!_0x2c7fec)return _0x95587d(null,![]);if(!_0x2c7fec[_0x1080('0x13')](_0x2d8bca))return _0x95587d(null,![]);return _0x95587d(null,_0x2c7fec);});}));_0xa8e0b8['use'](_0x1080('0x14'),new LocalStrategy({'usernameField':_0x1080('0x7'),'passwordField':_0x1080('0x11'),'passReqToCallback':!![]},function(_0x351fad,_0x13c84b,_0x1efb03,_0x10dba0){User[_0x1080('0x8')]({'username':_0x13c84b[_0x1080('0x9')]()[_0x1080('0x12')]()},function(_0x1c92b3,_0x354480){if(_0x1c92b3)return _0x10dba0(_0x1c92b3);if(!_0x354480)return _0x10dba0(null,![]);if(!_0x354480['validSecurityAnswer'](_0x351fad[_0x1080('0xc')]['securityanswer']))return _0x10dba0(null,![]);return _0x10dba0(null,_0x354480);});}));};