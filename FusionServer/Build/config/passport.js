var _0x4479=['body','password','generateHash','filepath','generateFileSystem','save','local-login','LOGIN.INVALID','validPassword','findOne','validSecurityAnswer','securityanswer','Strategy','../app/models/user','exports','serializeUser','deserializeUser','findById','use','username','trim','REGISTER.ALREADY_EXISTS'];(function(_0x20d7d8,_0x2a3491){var _0x4f5cc2=function(_0x103a9d){while(--_0x103a9d){_0x20d7d8['push'](_0x20d7d8['shift']());}};_0x4f5cc2(++_0x2a3491);}(_0x4479,0x114));var _0x3b70=function(_0x20d7d8,_0x2a3491){_0x20d7d8=_0x20d7d8-0x0;var _0x4f5cc2=_0x4479[_0x20d7d8];return _0x4f5cc2;};var LocalStrategy=require('passport-local')[_0x3b70('0x0')];var User=require(_0x3b70('0x1'));module[_0x3b70('0x2')]=function(_0x732d3a){_0x732d3a[_0x3b70('0x3')](function(_0x1bbd68,_0x4c6886){_0x4c6886(null,_0x1bbd68['id']);});_0x732d3a[_0x3b70('0x4')](function(_0x51f59e,_0x3023a1){User[_0x3b70('0x5')](_0x51f59e,function(_0x1b3d28,_0x3f82a2){_0x3023a1(_0x1b3d28,_0x3f82a2);});});_0x732d3a[_0x3b70('0x6')]('local-signup',new LocalStrategy({'usernameField':_0x3b70('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x31daac,_0x5cd4ce,_0x47aced,_0x1a2164){User['findOne']({'username':_0x5cd4ce['toLowerCase']()[_0x3b70('0x8')]()},async function(_0x45000c,_0x385b63){if(_0x45000c)return _0x1a2164(_0x45000c);if(_0x385b63){return _0x1a2164(null,_0x385b63,{'message':_0x3b70('0x9')});}else{var _0x2c8f43=new User(_0x31daac[_0x3b70('0xa')]);_0x2c8f43[_0x3b70('0x7')]=_0x5cd4ce;_0x2c8f43[_0x3b70('0xb')]=_0x2c8f43[_0x3b70('0xc')](_0x47aced);_0x2c8f43[_0x3b70('0xd')]=await _0x2c8f43[_0x3b70('0xe')](_0x2c8f43[_0x3b70('0x7')]);_0x2c8f43[_0x3b70('0xf')](function(_0x45000c){if(_0x45000c)throw _0x45000c;return _0x1a2164(null,_0x2c8f43);});}});}));_0x732d3a[_0x3b70('0x6')](_0x3b70('0x10'),new LocalStrategy({'usernameField':_0x3b70('0x7'),'passwordField':_0x3b70('0xb'),'passReqToCallback':!![]},function(_0x456af8,_0x1072b3,_0x56fb21,_0x5b9a16){User['findOne']({'username':_0x1072b3['toLowerCase']()['trim']()},function(_0x54ac54,_0x465b82){if(_0x54ac54)return _0x5b9a16(_0x54ac54);if(!_0x465b82)return _0x5b9a16(null,![],{'message':_0x3b70('0x11')});if(!_0x465b82[_0x3b70('0x12')](_0x56fb21))return _0x5b9a16(null,![],{'message':_0x3b70('0x11')});return _0x5b9a16(null,_0x465b82);});}));_0x732d3a['use']('local-recovery',new LocalStrategy({'usernameField':_0x3b70('0x7'),'passwordField':_0x3b70('0xb'),'passReqToCallback':!![]},function(_0x420f63,_0x4c4c4f,_0x4d4294,_0x3ac9e3){User[_0x3b70('0x13')]({'username':_0x4c4c4f['toLowerCase']()[_0x3b70('0x8')]()},function(_0x4488ed,_0x22c725){if(_0x4488ed)return _0x3ac9e3(_0x4488ed);if(!_0x22c725)return _0x3ac9e3(null,![]);if(!_0x22c725[_0x3b70('0x14')](_0x420f63['body'][_0x3b70('0x15')]))return _0x3ac9e3(null,![]);return _0x3ac9e3(null,_0x22c725);});}));};