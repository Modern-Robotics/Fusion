var _0x186a=['securityanswer','local-signup','validSecurityAnswer','username','generateFileSystem','findOne','password','passport-local','trim','toLowerCase','save','filepath','Strategy','../app/models/user','local-recovery','body','serializeUser','local-login','exports','use','LOGIN.INVALID','REGISTER.ALREADY_EXISTS','findById','deserializeUser'];(function(_0x309bd0,_0x186a36){var _0x63d3b3=function(_0x422c00){while(--_0x422c00){_0x309bd0['push'](_0x309bd0['shift']());}};_0x63d3b3(++_0x186a36);}(_0x186a,0x130));var _0x63d3=function(_0x309bd0,_0x186a36){_0x309bd0=_0x309bd0-0x0;var _0x63d3b3=_0x186a[_0x309bd0];return _0x63d3b3;};var LocalStrategy=require(_0x63d3('0xf'))[_0x63d3('0x14')];var User=require(_0x63d3('0x15'));module[_0x63d3('0x2')]=function(_0x1c2420){_0x1c2420[_0x63d3('0x0')](function(_0x1ab19d,_0x1cadb5){_0x1cadb5(null,_0x1ab19d['id']);});_0x1c2420[_0x63d3('0x7')](function(_0x4ec29a,_0x1493cc){User[_0x63d3('0x6')](_0x4ec29a,function(_0xc3e89f,_0x5c038a){_0x1493cc(_0xc3e89f,_0x5c038a);});});_0x1c2420[_0x63d3('0x3')](_0x63d3('0x9'),new LocalStrategy({'usernameField':'username','passwordField':_0x63d3('0xe'),'passReqToCallback':!![]},function(_0x7b39c8,_0xb59759,_0x49a4d7,_0x37716c){User['findOne']({'username':_0xb59759[_0x63d3('0x11')]()[_0x63d3('0x10')]()},async function(_0x159dce,_0x53d85e){if(_0x159dce)return _0x37716c(_0x159dce);if(_0x53d85e){return _0x37716c(null,_0x53d85e,{'message':_0x63d3('0x5')});}else{var _0x497304=new User(_0x7b39c8[_0x63d3('0x17')]);_0x497304[_0x63d3('0xb')]=_0xb59759;_0x497304[_0x63d3('0xe')]=_0x497304['generateHash'](_0x49a4d7);_0x497304[_0x63d3('0x13')]=await _0x497304[_0x63d3('0xc')](_0x497304[_0x63d3('0xb')]);_0x497304[_0x63d3('0x12')](function(_0x3881da){if(_0x3881da)throw _0x3881da;return _0x37716c(null,_0x497304);});}});}));_0x1c2420[_0x63d3('0x3')](_0x63d3('0x1'),new LocalStrategy({'usernameField':_0x63d3('0xb'),'passwordField':_0x63d3('0xe'),'passReqToCallback':!![]},function(_0x2ef995,_0x55d8d5,_0x1232a9,_0x55c8c3){User[_0x63d3('0xd')]({'username':_0x55d8d5[_0x63d3('0x11')]()[_0x63d3('0x10')]()},function(_0x4ee4ce,_0x409e3d){if(_0x4ee4ce)return _0x55c8c3(_0x4ee4ce);if(!_0x409e3d)return _0x55c8c3(null,![],{'message':'LOGIN.INVALID'});if(!_0x409e3d['validPassword'](_0x1232a9))return _0x55c8c3(null,![],{'message':_0x63d3('0x4')});return _0x55c8c3(null,_0x409e3d);});}));_0x1c2420[_0x63d3('0x3')](_0x63d3('0x16'),new LocalStrategy({'usernameField':'username','passwordField':_0x63d3('0xe'),'passReqToCallback':!![]},function(_0x5e8b84,_0x1cb54c,_0x3dd3b3,_0x1ed249){User[_0x63d3('0xd')]({'username':_0x1cb54c[_0x63d3('0x11')]()[_0x63d3('0x10')]()},function(_0x5045de,_0x56f239){if(_0x5045de)return _0x1ed249(_0x5045de);if(!_0x56f239)return _0x1ed249(null,![]);if(!_0x56f239[_0x63d3('0xa')](_0x5e8b84[_0x63d3('0x17')][_0x63d3('0x8')]))return _0x1ed249(null,![]);return _0x1ed249(null,_0x56f239);});}));};