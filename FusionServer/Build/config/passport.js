var _0x1007=['generateHash','local-login','use','securityanswer','local-recovery','filepath','../app/models/user','LOGIN.INVALID','generateFileSystem','username','body','deserializeUser','Strategy','trim','password','exports','validPassword','toLowerCase','passport-local','save','findOne'];(function(_0x4255b8,_0x31b78b){var _0x3b0b7d=function(_0x1fda37){while(--_0x1fda37){_0x4255b8['push'](_0x4255b8['shift']());}};_0x3b0b7d(++_0x31b78b);}(_0x1007,0x178));var _0x363e=function(_0x4255b8,_0x31b78b){_0x4255b8=_0x4255b8-0x0;var _0x3b0b7d=_0x1007[_0x4255b8];return _0x3b0b7d;};var LocalStrategy=require(_0x363e('0x14'))[_0x363e('0xe')];var User=require(_0x363e('0x8'));module[_0x363e('0x11')]=function(_0x5faeb8){_0x5faeb8['serializeUser'](function(_0x7e61c3,_0x747d1b){_0x747d1b(null,_0x7e61c3['id']);});_0x5faeb8[_0x363e('0xd')](function(_0x15c139,_0x2dab0b){User['findById'](_0x15c139,function(_0xa8c25d,_0x37cc4f){_0x2dab0b(_0xa8c25d,_0x37cc4f);});});_0x5faeb8[_0x363e('0x4')]('local-signup',new LocalStrategy({'usernameField':_0x363e('0xb'),'passwordField':_0x363e('0x10'),'passReqToCallback':!![]},function(_0x5a099e,_0x56bfcc,_0x5c6c85,_0x1c7415){User[_0x363e('0x1')]({'username':_0x56bfcc[_0x363e('0x13')]()[_0x363e('0xf')]()},async function(_0x41dbfb,_0x42a353){if(_0x41dbfb)return _0x1c7415(_0x41dbfb);if(_0x42a353){return _0x1c7415(null,_0x42a353,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0xc02524=new User(_0x5a099e['body']);_0xc02524[_0x363e('0xb')]=_0x56bfcc;_0xc02524['password']=_0xc02524[_0x363e('0x2')](_0x5c6c85);_0xc02524[_0x363e('0x7')]=await _0xc02524[_0x363e('0xa')](_0xc02524[_0x363e('0xb')]);_0xc02524[_0x363e('0x0')](function(_0x45e74c){if(_0x45e74c)throw _0x45e74c;return _0x1c7415(null,_0xc02524);});}});}));_0x5faeb8[_0x363e('0x4')](_0x363e('0x3'),new LocalStrategy({'usernameField':_0x363e('0xb'),'passwordField':_0x363e('0x10'),'passReqToCallback':!![]},function(_0x55c134,_0x411064,_0x1d8891,_0x43c683){User['findOne']({'username':_0x411064['toLowerCase']()[_0x363e('0xf')]()},function(_0x2d05f2,_0x50135d){if(_0x2d05f2)return _0x43c683(_0x2d05f2);if(!_0x50135d)return _0x43c683(null,![],{'message':'LOGIN.INVALID'});if(!_0x50135d[_0x363e('0x12')](_0x1d8891))return _0x43c683(null,![],{'message':_0x363e('0x9')});return _0x43c683(null,_0x50135d);});}));_0x5faeb8[_0x363e('0x4')](_0x363e('0x6'),new LocalStrategy({'usernameField':_0x363e('0xb'),'passwordField':_0x363e('0x10'),'passReqToCallback':!![]},function(_0x34f436,_0x4550df,_0x39c0e8,_0x42e9f9){User[_0x363e('0x1')]({'username':_0x4550df[_0x363e('0x13')]()['trim']()},function(_0x3b2729,_0x3d2748){if(_0x3b2729)return _0x42e9f9(_0x3b2729);if(!_0x3d2748)return _0x42e9f9(null,![]);if(!_0x3d2748['validSecurityAnswer'](_0x34f436[_0x363e('0xc')][_0x363e('0x5')]))return _0x42e9f9(null,![]);return _0x42e9f9(null,_0x3d2748);});}));};