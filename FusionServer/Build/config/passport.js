var _0x4414=['use','local-signup','findOne','toLowerCase','trim','REGISTER.ALREADY_EXISTS','body','username','password','filepath','save','local-login','LOGIN.INVALID','local-recovery','validSecurityAnswer','securityanswer','../app/models/user','exports','serializeUser','deserializeUser','findById'];(function(_0x2c91a2,_0x369be0){var _0x2c0dd2=function(_0x51a3e2){while(--_0x51a3e2){_0x2c91a2['push'](_0x2c91a2['shift']());}};_0x2c0dd2(++_0x369be0);}(_0x4414,0x175));var _0x461e=function(_0x373fa4,_0x28f2dd){_0x373fa4=_0x373fa4-0x0;var _0x2a56f5=_0x4414[_0x373fa4];return _0x2a56f5;};var LocalStrategy=require('passport-local')['Strategy'];var User=require(_0x461e('0x0'));module[_0x461e('0x1')]=function(_0x453b70){_0x453b70[_0x461e('0x2')](function(_0x3016ff,_0x2653d8){_0x2653d8(null,_0x3016ff['id']);});_0x453b70[_0x461e('0x3')](function(_0x1609fd,_0x458902){User[_0x461e('0x4')](_0x1609fd,function(_0x266682,_0x26b348){_0x458902(_0x266682,_0x26b348);});});_0x453b70[_0x461e('0x5')](_0x461e('0x6'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x4131a6,_0x196e5b,_0x27a519,_0x4ac34c){User[_0x461e('0x7')]({'username':_0x196e5b[_0x461e('0x8')]()[_0x461e('0x9')]()},async function(_0x18baa8,_0x172ff5){if(_0x18baa8)return _0x4ac34c(_0x18baa8);if(_0x172ff5){return _0x4ac34c(null,_0x172ff5,{'message':_0x461e('0xa')});}else{var _0xb2f7ce=new User(_0x4131a6[_0x461e('0xb')]);_0xb2f7ce[_0x461e('0xc')]=_0x196e5b;_0xb2f7ce[_0x461e('0xd')]=_0xb2f7ce['generateHash'](_0x27a519);_0xb2f7ce[_0x461e('0xe')]=await _0xb2f7ce['generateFileSystem'](_0xb2f7ce[_0x461e('0xc')]);_0xb2f7ce[_0x461e('0xf')](function(_0x18baa8){if(_0x18baa8)throw _0x18baa8;return _0x4ac34c(null,_0xb2f7ce);});}});}));_0x453b70[_0x461e('0x5')](_0x461e('0x10'),new LocalStrategy({'usernameField':_0x461e('0xc'),'passwordField':'password','passReqToCallback':!![]},function(_0x2435b8,_0x3a11cb,_0x2d6309,_0x35a461){User[_0x461e('0x7')]({'username':_0x3a11cb[_0x461e('0x8')]()[_0x461e('0x9')]()},function(_0x20074b,_0x182f05){if(_0x20074b)return _0x35a461(_0x20074b);if(!_0x182f05)return _0x35a461(null,![],{'message':_0x461e('0x11')});if(!_0x182f05['validPassword'](_0x2d6309))return _0x35a461(null,![],{'message':_0x461e('0x11')});return _0x35a461(null,_0x182f05);});}));_0x453b70[_0x461e('0x5')](_0x461e('0x12'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x5a1e59,_0x26d144,_0x104caf,_0xc0a442){User[_0x461e('0x7')]({'username':_0x26d144[_0x461e('0x8')]()[_0x461e('0x9')]()},function(_0x53964e,_0x2ab703){if(_0x53964e)return _0xc0a442(_0x53964e);if(!_0x2ab703)return _0xc0a442(null,![]);if(!_0x2ab703[_0x461e('0x13')](_0x5a1e59['body'][_0x461e('0x14')]))return _0xc0a442(null,![]);return _0xc0a442(null,_0x2ab703);});}));};