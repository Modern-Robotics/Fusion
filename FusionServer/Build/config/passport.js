var _0x1f41=['toLowerCase','trim','body','username','generateHash','generateFileSystem','save','local-login','LOGIN.INVALID','local-recovery','securityanswer','Strategy','exports','serializeUser','findById','use','local-signup','password','findOne'];(function(_0x465dfb,_0x52549b){var _0x11a0d5=function(_0x43d0df){while(--_0x43d0df){_0x465dfb['push'](_0x465dfb['shift']());}};_0x11a0d5(++_0x52549b);}(_0x1f41,0x1e6));var _0x575f=function(_0x4d80fc,_0x5535ec){_0x4d80fc=_0x4d80fc-0x0;var _0x124e74=_0x1f41[_0x4d80fc];return _0x124e74;};var LocalStrategy=require('passport-local')[_0x575f('0x0')];var User=require('../app/models/user');module[_0x575f('0x1')]=function(_0xe13695){_0xe13695[_0x575f('0x2')](function(_0x1681e4,_0x178d85){_0x178d85(null,_0x1681e4['id']);});_0xe13695['deserializeUser'](function(_0x20088a,_0x3773a4){User[_0x575f('0x3')](_0x20088a,function(_0x3024b3,_0x2e1a3e){_0x3773a4(_0x3024b3,_0x2e1a3e);});});_0xe13695[_0x575f('0x4')](_0x575f('0x5'),new LocalStrategy({'usernameField':'username','passwordField':_0x575f('0x6'),'passReqToCallback':!![]},function(_0x4445f1,_0x580dce,_0x3d3aa8,_0x3d8b30){User[_0x575f('0x7')]({'username':_0x580dce[_0x575f('0x8')]()[_0x575f('0x9')]()},async function(_0x2d5020,_0x24358f){if(_0x2d5020)return _0x3d8b30(_0x2d5020);if(_0x24358f){return _0x3d8b30(null,_0x24358f,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x4639f0=new User(_0x4445f1[_0x575f('0xa')]);_0x4639f0[_0x575f('0xb')]=_0x580dce;_0x4639f0[_0x575f('0x6')]=_0x4639f0[_0x575f('0xc')](_0x3d3aa8);_0x4639f0['filepath']=await _0x4639f0[_0x575f('0xd')](_0x4639f0[_0x575f('0xb')]);_0x4639f0[_0x575f('0xe')](function(_0x2d5020){if(_0x2d5020)throw _0x2d5020;return _0x3d8b30(null,_0x4639f0);});}});}));_0xe13695[_0x575f('0x4')](_0x575f('0xf'),new LocalStrategy({'usernameField':_0x575f('0xb'),'passwordField':_0x575f('0x6'),'passReqToCallback':!![]},function(_0x965437,_0x12855b,_0x5adea5,_0x4b6fc7){User['findOne']({'username':_0x12855b['toLowerCase']()['trim']()},function(_0x341415,_0x2127ec){if(_0x341415)return _0x4b6fc7(_0x341415);if(!_0x2127ec)return _0x4b6fc7(null,![],{'message':'LOGIN.INVALID'});if(!_0x2127ec['validPassword'](_0x5adea5))return _0x4b6fc7(null,![],{'message':_0x575f('0x10')});return _0x4b6fc7(null,_0x2127ec);});}));_0xe13695[_0x575f('0x4')](_0x575f('0x11'),new LocalStrategy({'usernameField':_0x575f('0xb'),'passwordField':_0x575f('0x6'),'passReqToCallback':!![]},function(_0x2c82c3,_0x38050e,_0x3de8a1,_0xf8ee5d){User[_0x575f('0x7')]({'username':_0x38050e['toLowerCase']()[_0x575f('0x9')]()},function(_0x4683af,_0x510e6e){if(_0x4683af)return _0xf8ee5d(_0x4683af);if(!_0x510e6e)return _0xf8ee5d(null,![]);if(!_0x510e6e['validSecurityAnswer'](_0x2c82c3[_0x575f('0xa')][_0x575f('0x12')]))return _0xf8ee5d(null,![]);return _0xf8ee5d(null,_0x510e6e);});}));};