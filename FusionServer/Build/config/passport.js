var _0x5e12=['password','validSecurityAnswer','../app/models/user','exports','serializeUser','deserializeUser','findById','use','local-signup','username','trim','REGISTER.ALREADY_EXISTS','body','generateHash','save','local-login','findOne','toLowerCase','validPassword','LOGIN.INVALID','local-recovery'];(function(_0x37e449,_0x384ace){var _0x305f28=function(_0xfbdc1a){while(--_0xfbdc1a){_0x37e449['push'](_0x37e449['shift']());}};_0x305f28(++_0x384ace);}(_0x5e12,0xfe));var _0x1f18=function(_0x3265c5,_0x8ca517){_0x3265c5=_0x3265c5-0x0;var _0x3bace2=_0x5e12[_0x3265c5];return _0x3bace2;};var LocalStrategy=require('passport-local')['Strategy'];var User=require(_0x1f18('0x0'));module[_0x1f18('0x1')]=function(_0x146273){_0x146273[_0x1f18('0x2')](function(_0x4754f0,_0x17d0f0){_0x17d0f0(null,_0x4754f0['id']);});_0x146273[_0x1f18('0x3')](function(_0x152803,_0x10e17c){User[_0x1f18('0x4')](_0x152803,function(_0x284856,_0x142d5f){_0x10e17c(_0x284856,_0x142d5f);});});_0x146273[_0x1f18('0x5')](_0x1f18('0x6'),new LocalStrategy({'usernameField':_0x1f18('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x1027d2,_0x54cd44,_0x2e8594,_0x3164f0){User['findOne']({'username':_0x54cd44['toLowerCase']()[_0x1f18('0x8')]()},async function(_0x56b275,_0x383d0b){if(_0x56b275)return _0x3164f0(_0x56b275);if(_0x383d0b){return _0x3164f0(null,_0x383d0b,{'message':_0x1f18('0x9')});}else{var _0x2a6c50=new User(_0x1027d2[_0x1f18('0xa')]);_0x2a6c50[_0x1f18('0x7')]=_0x54cd44;_0x2a6c50['password']=_0x2a6c50[_0x1f18('0xb')](_0x2e8594);_0x2a6c50['filepath']=await _0x2a6c50['generateFileSystem'](_0x2a6c50['username']);_0x2a6c50[_0x1f18('0xc')](function(_0x56b275){if(_0x56b275)throw _0x56b275;return _0x3164f0(null,_0x2a6c50);});}});}));_0x146273[_0x1f18('0x5')](_0x1f18('0xd'),new LocalStrategy({'usernameField':_0x1f18('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x3fb5fd,_0x395432,_0x204e17,_0x56a2c2){User[_0x1f18('0xe')]({'username':_0x395432[_0x1f18('0xf')]()[_0x1f18('0x8')]()},function(_0x567f8a,_0x5b12e8){if(_0x567f8a)return _0x56a2c2(_0x567f8a);if(!_0x5b12e8)return _0x56a2c2(null,![],{'message':'LOGIN.INVALID'});if(!_0x5b12e8[_0x1f18('0x10')](_0x204e17))return _0x56a2c2(null,![],{'message':_0x1f18('0x11')});return _0x56a2c2(null,_0x5b12e8);});}));_0x146273[_0x1f18('0x5')](_0x1f18('0x12'),new LocalStrategy({'usernameField':_0x1f18('0x7'),'passwordField':_0x1f18('0x13'),'passReqToCallback':!![]},function(_0x440328,_0x3b0a3d,_0x4b76f7,_0x2e602d){User['findOne']({'username':_0x3b0a3d['toLowerCase']()['trim']()},function(_0x5f4e55,_0x4d1e4f){if(_0x5f4e55)return _0x2e602d(_0x5f4e55);if(!_0x4d1e4f)return _0x2e602d(null,![]);if(!_0x4d1e4f[_0x1f18('0x14')](_0x440328[_0x1f18('0xa')]['securityanswer']))return _0x2e602d(null,![]);return _0x2e602d(null,_0x4d1e4f);});}));};