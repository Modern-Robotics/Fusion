var _0x4f1e=['securityanswer','passport-local','Strategy','../app/models/user','exports','serializeUser','deserializeUser','use','username','password','findOne','trim','REGISTER.ALREADY_EXISTS','body','generateHash','generateFileSystem','local-login','toLowerCase','validPassword','LOGIN.INVALID','local-recovery','validSecurityAnswer'];(function(_0x431c15,_0x56478f){var _0x1b20a2=function(_0x1b8cb9){while(--_0x1b8cb9){_0x431c15['push'](_0x431c15['shift']());}};_0x1b20a2(++_0x56478f);}(_0x4f1e,0x11f));var _0x4c63=function(_0x3d2f9b,_0x1813e0){_0x3d2f9b=_0x3d2f9b-0x0;var _0x31b8c2=_0x4f1e[_0x3d2f9b];return _0x31b8c2;};var LocalStrategy=require(_0x4c63('0x0'))[_0x4c63('0x1')];var User=require(_0x4c63('0x2'));module[_0x4c63('0x3')]=function(_0x2230b6){_0x2230b6[_0x4c63('0x4')](function(_0x3d5590,_0x3363f3){_0x3363f3(null,_0x3d5590['id']);});_0x2230b6[_0x4c63('0x5')](function(_0x404a0e,_0x36b267){User['findById'](_0x404a0e,function(_0x1f7149,_0x52b6e3){_0x36b267(_0x1f7149,_0x52b6e3);});});_0x2230b6[_0x4c63('0x6')]('local-signup',new LocalStrategy({'usernameField':_0x4c63('0x7'),'passwordField':_0x4c63('0x8'),'passReqToCallback':!![]},function(_0x30bb4f,_0x11fd6e,_0x52ae35,_0x1d9a38){User[_0x4c63('0x9')]({'username':_0x11fd6e['toLowerCase']()[_0x4c63('0xa')]()},async function(_0x5d04bd,_0x44afda){if(_0x5d04bd)return _0x1d9a38(_0x5d04bd);if(_0x44afda){return _0x1d9a38(null,_0x44afda,{'message':_0x4c63('0xb')});}else{var _0x2db48d=new User(_0x30bb4f[_0x4c63('0xc')]);_0x2db48d[_0x4c63('0x7')]=_0x11fd6e;_0x2db48d['password']=_0x2db48d[_0x4c63('0xd')](_0x52ae35);_0x2db48d['filepath']=await _0x2db48d[_0x4c63('0xe')](_0x2db48d[_0x4c63('0x7')]);_0x2db48d['save'](function(_0x5d04bd){if(_0x5d04bd)throw _0x5d04bd;return _0x1d9a38(null,_0x2db48d);});}});}));_0x2230b6[_0x4c63('0x6')](_0x4c63('0xf'),new LocalStrategy({'usernameField':_0x4c63('0x7'),'passwordField':_0x4c63('0x8'),'passReqToCallback':!![]},function(_0x4f345e,_0x5b25f2,_0x416e51,_0x59d197){User[_0x4c63('0x9')]({'username':_0x5b25f2[_0x4c63('0x10')]()[_0x4c63('0xa')]()},function(_0x21eb04,_0x5a5b3e){if(_0x21eb04)return _0x59d197(_0x21eb04);if(!_0x5a5b3e)return _0x59d197(null,![],{'message':'LOGIN.INVALID'});if(!_0x5a5b3e[_0x4c63('0x11')](_0x416e51))return _0x59d197(null,![],{'message':_0x4c63('0x12')});return _0x59d197(null,_0x5a5b3e);});}));_0x2230b6[_0x4c63('0x6')](_0x4c63('0x13'),new LocalStrategy({'usernameField':_0x4c63('0x7'),'passwordField':_0x4c63('0x8'),'passReqToCallback':!![]},function(_0x26ffae,_0xe935db,_0xa34492,_0x10e5dc){User[_0x4c63('0x9')]({'username':_0xe935db[_0x4c63('0x10')]()[_0x4c63('0xa')]()},function(_0x16ec0a,_0x9d98a7){if(_0x16ec0a)return _0x10e5dc(_0x16ec0a);if(!_0x9d98a7)return _0x10e5dc(null,![]);if(!_0x9d98a7[_0x4c63('0x14')](_0x26ffae[_0x4c63('0xc')][_0x4c63('0x15')]))return _0x10e5dc(null,![]);return _0x10e5dc(null,_0x9d98a7);});}));};