var _0x1152=['findById','use','local-signup','username','password','findOne','toLowerCase','trim','REGISTER.ALREADY_EXISTS','body','generateHash','filepath','generateFileSystem','save','local-login','LOGIN.INVALID','validPassword','local-recovery','validSecurityAnswer','passport-local','Strategy','../app/models/user','exports','serializeUser'];(function(_0x519992,_0x1e5c1b){var _0x189f5e=function(_0x283790){while(--_0x283790){_0x519992['push'](_0x519992['shift']());}};_0x189f5e(++_0x1e5c1b);}(_0x1152,0x73));var _0x4ddc=function(_0x195ea5,_0x2bc901){_0x195ea5=_0x195ea5-0x0;var _0x304738=_0x1152[_0x195ea5];return _0x304738;};var LocalStrategy=require(_0x4ddc('0x0'))[_0x4ddc('0x1')];var User=require(_0x4ddc('0x2'));module[_0x4ddc('0x3')]=function(_0x525c71){_0x525c71[_0x4ddc('0x4')](function(_0x3bdb00,_0x1ac5dc){_0x1ac5dc(null,_0x3bdb00['id']);});_0x525c71['deserializeUser'](function(_0x17d7ce,_0x2797aa){User[_0x4ddc('0x5')](_0x17d7ce,function(_0x1e13a8,_0x2ce1d6){_0x2797aa(_0x1e13a8,_0x2ce1d6);});});_0x525c71[_0x4ddc('0x6')](_0x4ddc('0x7'),new LocalStrategy({'usernameField':_0x4ddc('0x8'),'passwordField':_0x4ddc('0x9'),'passReqToCallback':!![]},function(_0x31dd61,_0x4b5379,_0x500472,_0x7370d9){User[_0x4ddc('0xa')]({'username':_0x4b5379[_0x4ddc('0xb')]()[_0x4ddc('0xc')]()},async function(_0x4f0c6b,_0x210a06){if(_0x4f0c6b)return _0x7370d9(_0x4f0c6b);if(_0x210a06){return _0x7370d9(null,_0x210a06,{'message':_0x4ddc('0xd')});}else{var _0x1e3fc8=new User(_0x31dd61[_0x4ddc('0xe')]);_0x1e3fc8[_0x4ddc('0x8')]=_0x4b5379;_0x1e3fc8[_0x4ddc('0x9')]=_0x1e3fc8[_0x4ddc('0xf')](_0x500472);_0x1e3fc8[_0x4ddc('0x10')]=await _0x1e3fc8[_0x4ddc('0x11')](_0x1e3fc8['username']);_0x1e3fc8[_0x4ddc('0x12')](function(_0x4f0c6b){if(_0x4f0c6b)throw _0x4f0c6b;return _0x7370d9(null,_0x1e3fc8);});}});}));_0x525c71[_0x4ddc('0x6')](_0x4ddc('0x13'),new LocalStrategy({'usernameField':_0x4ddc('0x8'),'passwordField':_0x4ddc('0x9'),'passReqToCallback':!![]},function(_0xe2feee,_0x4aa77f,_0x56d706,_0x72ff99){User['findOne']({'username':_0x4aa77f[_0x4ddc('0xb')]()[_0x4ddc('0xc')]()},function(_0xfac7c9,_0x33131e){if(_0xfac7c9)return _0x72ff99(_0xfac7c9);if(!_0x33131e)return _0x72ff99(null,![],{'message':_0x4ddc('0x14')});if(!_0x33131e[_0x4ddc('0x15')](_0x56d706))return _0x72ff99(null,![],{'message':_0x4ddc('0x14')});return _0x72ff99(null,_0x33131e);});}));_0x525c71[_0x4ddc('0x6')](_0x4ddc('0x16'),new LocalStrategy({'usernameField':_0x4ddc('0x8'),'passwordField':_0x4ddc('0x9'),'passReqToCallback':!![]},function(_0x47b226,_0x2dc1b7,_0x4c66ef,_0x5321f5){User[_0x4ddc('0xa')]({'username':_0x2dc1b7[_0x4ddc('0xb')]()[_0x4ddc('0xc')]()},function(_0x11d958,_0x296784){if(_0x11d958)return _0x5321f5(_0x11d958);if(!_0x296784)return _0x5321f5(null,![]);if(!_0x296784[_0x4ddc('0x17')](_0x47b226['body']['securityanswer']))return _0x5321f5(null,![]);return _0x5321f5(null,_0x296784);});}));};