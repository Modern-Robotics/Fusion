var _0x18ec=['deserializeUser','findById','local-signup','username','password','findOne','toLowerCase','trim','body','generateHash','generateFileSystem','save','use','LOGIN.INVALID','validPassword','local-recovery','securityanswer','passport-local','Strategy','../app/models/user','exports','serializeUser'];(function(_0x10d3f1,_0x3fd8cc){var _0x3fa2a9=function(_0xadf9c8){while(--_0xadf9c8){_0x10d3f1['push'](_0x10d3f1['shift']());}};_0x3fa2a9(++_0x3fd8cc);}(_0x18ec,0x95));var _0x15cb=function(_0x2c3157,_0x261464){_0x2c3157=_0x2c3157-0x0;var _0xa54672=_0x18ec[_0x2c3157];return _0xa54672;};var LocalStrategy=require(_0x15cb('0x0'))[_0x15cb('0x1')];var User=require(_0x15cb('0x2'));module[_0x15cb('0x3')]=function(_0x2e5eed){_0x2e5eed[_0x15cb('0x4')](function(_0x154711,_0x42af7f){_0x42af7f(null,_0x154711['id']);});_0x2e5eed[_0x15cb('0x5')](function(_0x40b7d1,_0x597f50){User[_0x15cb('0x6')](_0x40b7d1,function(_0x54e042,_0x32ae36){_0x597f50(_0x54e042,_0x32ae36);});});_0x2e5eed['use'](_0x15cb('0x7'),new LocalStrategy({'usernameField':_0x15cb('0x8'),'passwordField':_0x15cb('0x9'),'passReqToCallback':!![]},function(_0x257d67,_0x47a78c,_0x3cc8c2,_0x40e5ca){User[_0x15cb('0xa')]({'username':_0x47a78c[_0x15cb('0xb')]()[_0x15cb('0xc')]()},async function(_0x3c8252,_0x1dcaa1){if(_0x3c8252)return _0x40e5ca(_0x3c8252);if(_0x1dcaa1){return _0x40e5ca(null,_0x1dcaa1,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x5b0b37=new User(_0x257d67[_0x15cb('0xd')]);_0x5b0b37[_0x15cb('0x8')]=_0x47a78c;_0x5b0b37[_0x15cb('0x9')]=_0x5b0b37[_0x15cb('0xe')](_0x3cc8c2);_0x5b0b37['filepath']=await _0x5b0b37[_0x15cb('0xf')](_0x5b0b37['username']);_0x5b0b37[_0x15cb('0x10')](function(_0x3c8252){if(_0x3c8252)throw _0x3c8252;return _0x40e5ca(null,_0x5b0b37);});}});}));_0x2e5eed[_0x15cb('0x11')]('local-login',new LocalStrategy({'usernameField':'username','passwordField':_0x15cb('0x9'),'passReqToCallback':!![]},function(_0x1a9c12,_0xa89552,_0x1d7a08,_0x5f1825){User['findOne']({'username':_0xa89552[_0x15cb('0xb')]()[_0x15cb('0xc')]()},function(_0x454e84,_0xd4ff44){if(_0x454e84)return _0x5f1825(_0x454e84);if(!_0xd4ff44)return _0x5f1825(null,![],{'message':_0x15cb('0x12')});if(!_0xd4ff44[_0x15cb('0x13')](_0x1d7a08))return _0x5f1825(null,![],{'message':'LOGIN.INVALID'});return _0x5f1825(null,_0xd4ff44);});}));_0x2e5eed['use'](_0x15cb('0x14'),new LocalStrategy({'usernameField':_0x15cb('0x8'),'passwordField':'password','passReqToCallback':!![]},function(_0x446124,_0x19a69b,_0x554c91,_0x5984a9){User[_0x15cb('0xa')]({'username':_0x19a69b[_0x15cb('0xb')]()['trim']()},function(_0x4538cc,_0x113471){if(_0x4538cc)return _0x5984a9(_0x4538cc);if(!_0x113471)return _0x5984a9(null,![]);if(!_0x113471['validSecurityAnswer'](_0x446124[_0x15cb('0xd')][_0x15cb('0x15')]))return _0x5984a9(null,![]);return _0x5984a9(null,_0x113471);});}));};