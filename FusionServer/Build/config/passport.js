var _0x60b8=['findById','use','local-signup','username','password','toLowerCase','trim','Error','Username\x20Already\x20Exists','body','generateHash','generateFileSystem','save','local-login','findOne','local-recovery','validSecurityAnswer','securityanswer','passport-local','Strategy','../app/models/user','exports'];(function(_0x428104,_0x5e13d0){var _0x30f18a=function(_0x2b945b){while(--_0x2b945b){_0x428104['push'](_0x428104['shift']());}};_0x30f18a(++_0x5e13d0);}(_0x60b8,0x1b4));var _0x3946=function(_0x3ff3a9,_0x579003){_0x3ff3a9=_0x3ff3a9-0x0;var _0x20344d=_0x60b8[_0x3ff3a9];return _0x20344d;};var LocalStrategy=require(_0x3946('0x0'))[_0x3946('0x1')];var User=require(_0x3946('0x2'));module[_0x3946('0x3')]=function(_0x3851d4){_0x3851d4['serializeUser'](function(_0x15b0ad,_0x27825c){_0x27825c(null,_0x15b0ad['id']);});_0x3851d4['deserializeUser'](function(_0x3b4296,_0x21632d){User[_0x3946('0x4')](_0x3b4296,function(_0x467aa1,_0x5e79f0){_0x21632d(_0x467aa1,_0x5e79f0);});});_0x3851d4[_0x3946('0x5')](_0x3946('0x6'),new LocalStrategy({'usernameField':_0x3946('0x7'),'passwordField':_0x3946('0x8'),'passReqToCallback':!![]},function(_0x4c24a8,_0x4fd181,_0xb51c43,_0x5ebdd8){User['findOne']({'username':_0x4fd181[_0x3946('0x9')]()[_0x3946('0xa')]()},async function(_0x813d50,_0x164a22){if(_0x813d50)return _0x5ebdd8(_0x813d50);if(_0x164a22){_0x164a22[_0x3946('0xb')]=_0x3946('0xc');return _0x5ebdd8(null,_0x164a22);}else{var _0x38fdce=new User(_0x4c24a8[_0x3946('0xd')]);_0x38fdce[_0x3946('0x7')]=_0x4fd181;_0x38fdce[_0x3946('0x8')]=_0x38fdce[_0x3946('0xe')](_0xb51c43);_0x38fdce['filepath']=await _0x38fdce[_0x3946('0xf')](_0x38fdce['username']);_0x38fdce[_0x3946('0x10')](function(_0x813d50){if(_0x813d50)throw _0x813d50;return _0x5ebdd8(null,_0x38fdce);});}});}));_0x3851d4['use'](_0x3946('0x11'),new LocalStrategy({'usernameField':_0x3946('0x7'),'passwordField':_0x3946('0x8'),'passReqToCallback':!![]},function(_0x884d8,_0x344034,_0x3dde04,_0x48c3fc){User[_0x3946('0x12')]({'username':_0x344034[_0x3946('0x9')]()[_0x3946('0xa')]()},function(_0x11780d,_0x33867d){if(_0x11780d)return _0x48c3fc(_0x11780d);if(!_0x33867d)return _0x48c3fc(null,![]);if(!_0x33867d['validPassword'](_0x3dde04))return _0x48c3fc(null,![]);return _0x48c3fc(null,_0x33867d);});}));_0x3851d4['use'](_0x3946('0x13'),new LocalStrategy({'usernameField':_0x3946('0x7'),'passwordField':_0x3946('0x8'),'passReqToCallback':!![]},function(_0x29501d,_0x28f416,_0x37914c,_0x2ab734){User[_0x3946('0x12')]({'username':_0x28f416[_0x3946('0x9')]()[_0x3946('0xa')]()},function(_0x3189e1,_0x278843){if(_0x3189e1)return _0x2ab734(_0x3189e1);if(!_0x278843)return _0x2ab734(null,![]);if(!_0x278843[_0x3946('0x14')](_0x29501d[_0x3946('0xd')][_0x3946('0x15')]))return _0x2ab734(null,![]);return _0x2ab734(null,_0x278843);});}));};