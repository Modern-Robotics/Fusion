var _0xdad4=['Username\x20Already\x20Exists','body','username','generateHash','filepath','generateFileSystem','local-login','validPassword','local-recovery','validSecurityAnswer','passport-local','../app/models/user','serializeUser','deserializeUser','use','password','findOne','toLowerCase','trim','Error'];(function(_0x593c64,_0x596c7f){var _0x363f28=function(_0x24cd5c){while(--_0x24cd5c){_0x593c64['push'](_0x593c64['shift']());}};_0x363f28(++_0x596c7f);}(_0xdad4,0x10e));var _0x310e=function(_0xa89660,_0x55c087){_0xa89660=_0xa89660-0x0;var _0x13f574=_0xdad4[_0xa89660];return _0x13f574;};var LocalStrategy=require(_0x310e('0x0'))['Strategy'];var User=require(_0x310e('0x1'));module['exports']=function(_0x59d9d1){_0x59d9d1[_0x310e('0x2')](function(_0x563832,_0x13fd94){_0x13fd94(null,_0x563832['id']);});_0x59d9d1[_0x310e('0x3')](function(_0x570cd2,_0x3c5940){User['findById'](_0x570cd2,function(_0x2305fd,_0x1fb2c6){_0x3c5940(_0x2305fd,_0x1fb2c6);});});_0x59d9d1[_0x310e('0x4')]('local-signup',new LocalStrategy({'usernameField':'username','passwordField':_0x310e('0x5'),'passReqToCallback':!![]},function(_0x262aa4,_0xfe50a0,_0xea3257,_0x5e78bc){User[_0x310e('0x6')]({'username':_0xfe50a0[_0x310e('0x7')]()[_0x310e('0x8')]()},async function(_0x31042a,_0x1c807e){if(_0x31042a)return _0x5e78bc(_0x31042a);if(_0x1c807e){_0x1c807e[_0x310e('0x9')]=_0x310e('0xa');return _0x5e78bc(null,_0x1c807e);}else{var _0x4d8521=new User(_0x262aa4[_0x310e('0xb')]);_0x4d8521[_0x310e('0xc')]=_0xfe50a0;_0x4d8521[_0x310e('0x5')]=_0x4d8521[_0x310e('0xd')](_0xea3257);_0x4d8521[_0x310e('0xe')]=await _0x4d8521[_0x310e('0xf')](_0x4d8521[_0x310e('0xc')]);_0x4d8521['save'](function(_0x31042a){if(_0x31042a)throw _0x31042a;return _0x5e78bc(null,_0x4d8521);});}});}));_0x59d9d1[_0x310e('0x4')](_0x310e('0x10'),new LocalStrategy({'usernameField':_0x310e('0xc'),'passwordField':_0x310e('0x5'),'passReqToCallback':!![]},function(_0x25828e,_0x77d063,_0x19b461,_0x4d0c0a){User[_0x310e('0x6')]({'username':_0x77d063[_0x310e('0x7')]()[_0x310e('0x8')]()},function(_0x16c798,_0x396275){if(_0x16c798)return _0x4d0c0a(_0x16c798);if(!_0x396275)return _0x4d0c0a(null,![]);if(!_0x396275[_0x310e('0x11')](_0x19b461))return _0x4d0c0a(null,![]);return _0x4d0c0a(null,_0x396275);});}));_0x59d9d1[_0x310e('0x4')](_0x310e('0x12'),new LocalStrategy({'usernameField':_0x310e('0xc'),'passwordField':_0x310e('0x5'),'passReqToCallback':!![]},function(_0x4b70a0,_0x5f4f15,_0x43b4df,_0xad880f){User[_0x310e('0x6')]({'username':_0x5f4f15['toLowerCase']()['trim']()},function(_0x51f42c,_0x3310ae){if(_0x51f42c)return _0xad880f(_0x51f42c);if(!_0x3310ae)return _0xad880f(null,![]);if(!_0x3310ae[_0x310e('0x13')](_0x4b70a0[_0x310e('0xb')]['securityanswer']))return _0xad880f(null,![]);return _0xad880f(null,_0x3310ae);});}));};