var _0x4a3e=['local-signup','findOne','REGISTER.ALREADY_EXISTS','body','password','generateHash','filepath','generateFileSystem','username','local-login','toLowerCase','LOGIN.INVALID','validPassword','local-recovery','validSecurityAnswer','securityanswer','passport-local','Strategy','../app/models/user','exports','deserializeUser','use'];(function(_0x1ddd89,_0x37fdab){var _0x4c3f44=function(_0x4909fe){while(--_0x4909fe){_0x1ddd89['push'](_0x1ddd89['shift']());}};_0x4c3f44(++_0x37fdab);}(_0x4a3e,0x68));var _0x1d8a=function(_0x954749,_0x228e76){_0x954749=_0x954749-0x0;var _0x2048c1=_0x4a3e[_0x954749];return _0x2048c1;};var LocalStrategy=require(_0x1d8a('0x0'))[_0x1d8a('0x1')];var User=require(_0x1d8a('0x2'));module[_0x1d8a('0x3')]=function(_0xd0adf2){_0xd0adf2['serializeUser'](function(_0xc0240b,_0x191c51){_0x191c51(null,_0xc0240b['id']);});_0xd0adf2[_0x1d8a('0x4')](function(_0x55f201,_0x4a151f){User['findById'](_0x55f201,function(_0x35ded6,_0x46ce64){_0x4a151f(_0x35ded6,_0x46ce64);});});_0xd0adf2[_0x1d8a('0x5')](_0x1d8a('0x6'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x3ca664,_0x8f20e2,_0x2e6a47,_0x298375){User[_0x1d8a('0x7')]({'username':_0x8f20e2['toLowerCase']()['trim']()},async function(_0x5f4538,_0x28192b){if(_0x5f4538)return _0x298375(_0x5f4538);if(_0x28192b){return _0x298375(null,_0x28192b,{'message':_0x1d8a('0x8')});}else{var _0x43404b=new User(_0x3ca664[_0x1d8a('0x9')]);_0x43404b['username']=_0x8f20e2;_0x43404b[_0x1d8a('0xa')]=_0x43404b[_0x1d8a('0xb')](_0x2e6a47);_0x43404b[_0x1d8a('0xc')]=await _0x43404b[_0x1d8a('0xd')](_0x43404b[_0x1d8a('0xe')]);_0x43404b['save'](function(_0x5f4538){if(_0x5f4538)throw _0x5f4538;return _0x298375(null,_0x43404b);});}});}));_0xd0adf2['use'](_0x1d8a('0xf'),new LocalStrategy({'usernameField':_0x1d8a('0xe'),'passwordField':_0x1d8a('0xa'),'passReqToCallback':!![]},function(_0x179973,_0x90eccb,_0x5b35ea,_0x5a1f3e){User[_0x1d8a('0x7')]({'username':_0x90eccb[_0x1d8a('0x10')]()['trim']()},function(_0x2abad7,_0x431b97){if(_0x2abad7)return _0x5a1f3e(_0x2abad7);if(!_0x431b97)return _0x5a1f3e(null,![],{'message':_0x1d8a('0x11')});if(!_0x431b97[_0x1d8a('0x12')](_0x5b35ea))return _0x5a1f3e(null,![],{'message':_0x1d8a('0x11')});return _0x5a1f3e(null,_0x431b97);});}));_0xd0adf2['use'](_0x1d8a('0x13'),new LocalStrategy({'usernameField':_0x1d8a('0xe'),'passwordField':_0x1d8a('0xa'),'passReqToCallback':!![]},function(_0x4f1197,_0x2d5b07,_0x3a600c,_0x4c8228){User['findOne']({'username':_0x2d5b07[_0x1d8a('0x10')]()['trim']()},function(_0x46c78a,_0x4cf432){if(_0x46c78a)return _0x4c8228(_0x46c78a);if(!_0x4cf432)return _0x4c8228(null,![]);if(!_0x4cf432[_0x1d8a('0x14')](_0x4f1197[_0x1d8a('0x9')][_0x1d8a('0x15')]))return _0x4c8228(null,![]);return _0x4c8228(null,_0x4cf432);});}));};