var _0x4522=['body','username','generateHash','save','local-login','LOGIN.INVALID','validSecurityAnswer','passport-local','../app/models/user','serializeUser','deserializeUser','findById','use','local-signup','password','findOne','toLowerCase','trim'];(function(_0xca490,_0x45aa3f){var _0x2956b6=function(_0x3b9171){while(--_0x3b9171){_0xca490['push'](_0xca490['shift']());}};_0x2956b6(++_0x45aa3f);}(_0x4522,0x73));var _0x42c8=function(_0x2bd639,_0x3f53ae){_0x2bd639=_0x2bd639-0x0;var _0xcfb1db=_0x4522[_0x2bd639];return _0xcfb1db;};var LocalStrategy=require(_0x42c8('0x0'))['Strategy'];var User=require(_0x42c8('0x1'));module['exports']=function(_0x267ffd){_0x267ffd[_0x42c8('0x2')](function(_0x16de85,_0x5b31cd){_0x5b31cd(null,_0x16de85['id']);});_0x267ffd[_0x42c8('0x3')](function(_0x3e73af,_0x517378){User[_0x42c8('0x4')](_0x3e73af,function(_0x29a460,_0x453010){_0x517378(_0x29a460,_0x453010);});});_0x267ffd[_0x42c8('0x5')](_0x42c8('0x6'),new LocalStrategy({'usernameField':'username','passwordField':_0x42c8('0x7'),'passReqToCallback':!![]},function(_0x373228,_0xc77352,_0x69a0b3,_0x450f55){User[_0x42c8('0x8')]({'username':_0xc77352[_0x42c8('0x9')]()[_0x42c8('0xa')]()},async function(_0x36c606,_0x31cc6a){if(_0x36c606)return _0x450f55(_0x36c606);if(_0x31cc6a){return _0x450f55(null,_0x31cc6a,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x292521=new User(_0x373228[_0x42c8('0xb')]);_0x292521[_0x42c8('0xc')]=_0xc77352;_0x292521['password']=_0x292521[_0x42c8('0xd')](_0x69a0b3);_0x292521['filepath']=await _0x292521['generateFileSystem'](_0x292521[_0x42c8('0xc')]);_0x292521[_0x42c8('0xe')](function(_0x36c606){if(_0x36c606)throw _0x36c606;return _0x450f55(null,_0x292521);});}});}));_0x267ffd[_0x42c8('0x5')](_0x42c8('0xf'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x3a6414,_0x412ab6,_0x4cf6bd,_0x3c4dd5){User[_0x42c8('0x8')]({'username':_0x412ab6['toLowerCase']()['trim']()},function(_0x5ba1aa,_0x2e81c8){if(_0x5ba1aa)return _0x3c4dd5(_0x5ba1aa);if(!_0x2e81c8)return _0x3c4dd5(null,![],{'message':_0x42c8('0x10')});if(!_0x2e81c8['validPassword'](_0x4cf6bd))return _0x3c4dd5(null,![],{'message':_0x42c8('0x10')});return _0x3c4dd5(null,_0x2e81c8);});}));_0x267ffd[_0x42c8('0x5')]('local-recovery',new LocalStrategy({'usernameField':_0x42c8('0xc'),'passwordField':'password','passReqToCallback':!![]},function(_0x4e3cd8,_0x3a981a,_0x3ff2f0,_0x27efeb){User['findOne']({'username':_0x3a981a[_0x42c8('0x9')]()[_0x42c8('0xa')]()},function(_0x233394,_0x3158a1){if(_0x233394)return _0x27efeb(_0x233394);if(!_0x3158a1)return _0x27efeb(null,![]);if(!_0x3158a1[_0x42c8('0x11')](_0x4e3cd8[_0x42c8('0xb')]['securityanswer']))return _0x27efeb(null,![]);return _0x27efeb(null,_0x3158a1);});}));};