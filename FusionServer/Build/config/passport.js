var _0x4506=['findOne','validPassword','local-recovery','validSecurityAnswer','Strategy','exports','findById','use','local-signup','username','password','toLowerCase','trim','Username\x20Already\x20Exists','body','filepath','generateFileSystem','save','local-login'];(function(_0x5e8a01,_0x57610d){var _0x2208b5=function(_0xef52d3){while(--_0xef52d3){_0x5e8a01['push'](_0x5e8a01['shift']());}};_0x2208b5(++_0x57610d);}(_0x4506,0xe8));var _0x5b32=function(_0x19f205,_0x2885d1){_0x19f205=_0x19f205-0x0;var _0x17b8cd=_0x4506[_0x19f205];return _0x17b8cd;};var LocalStrategy=require('passport-local')[_0x5b32('0x0')];var User=require('../app/models/user');module[_0x5b32('0x1')]=function(_0x5c559f){_0x5c559f['serializeUser'](function(_0x25688f,_0x3c958f){_0x3c958f(null,_0x25688f['id']);});_0x5c559f['deserializeUser'](function(_0x3f71ed,_0x5e32ef){User[_0x5b32('0x2')](_0x3f71ed,function(_0x2c115b,_0x27f86b){_0x5e32ef(_0x2c115b,_0x27f86b);});});_0x5c559f[_0x5b32('0x3')](_0x5b32('0x4'),new LocalStrategy({'usernameField':_0x5b32('0x5'),'passwordField':_0x5b32('0x6'),'passReqToCallback':!![]},function(_0x32d855,_0x13ec80,_0x3f149e,_0x55dda5){User['findOne']({'username':_0x13ec80[_0x5b32('0x7')]()[_0x5b32('0x8')]()},function(_0x1bc16e,_0x9353cd){if(_0x1bc16e)return _0x55dda5(_0x1bc16e);if(_0x9353cd){_0x9353cd['Error']=_0x5b32('0x9');return _0x55dda5(null,_0x9353cd);}else{var _0x461ac1=new User(_0x32d855[_0x5b32('0xa')]);_0x461ac1[_0x5b32('0x5')]=_0x13ec80;_0x461ac1[_0x5b32('0x6')]=_0x461ac1['generateHash'](_0x3f149e);_0x461ac1[_0x5b32('0xb')]=_0x461ac1[_0x5b32('0xc')](_0x461ac1[_0x5b32('0x5')]);_0x461ac1[_0x5b32('0xd')](function(_0x1bc16e){if(_0x1bc16e)throw _0x1bc16e;return _0x55dda5(null,_0x461ac1);});}});}));_0x5c559f[_0x5b32('0x3')](_0x5b32('0xe'),new LocalStrategy({'usernameField':'username','passwordField':_0x5b32('0x6'),'passReqToCallback':!![]},function(_0x1a6ee5,_0x426109,_0x40d1b0,_0x15dabd){User[_0x5b32('0xf')]({'username':_0x426109[_0x5b32('0x7')]()[_0x5b32('0x8')]()},function(_0x1d900b,_0x652890){if(_0x1d900b)return _0x15dabd(_0x1d900b);if(!_0x652890)return _0x15dabd(null,![]);if(!_0x652890[_0x5b32('0x10')](_0x40d1b0))return _0x15dabd(null,![]);return _0x15dabd(null,_0x652890);});}));_0x5c559f[_0x5b32('0x3')](_0x5b32('0x11'),new LocalStrategy({'usernameField':_0x5b32('0x5'),'passwordField':_0x5b32('0x6'),'passReqToCallback':!![]},function(_0x201109,_0x2859f2,_0x3ca675,_0x2f8d68){User[_0x5b32('0xf')]({'username':_0x2859f2[_0x5b32('0x7')]()[_0x5b32('0x8')]()},function(_0x320fe5,_0x475eee){if(_0x320fe5)return _0x2f8d68(_0x320fe5);if(!_0x475eee)return _0x2f8d68(null,![]);if(!_0x475eee[_0x5b32('0x12')](_0x201109[_0x5b32('0xa')]['securityanswer']))return _0x2f8d68(null,![]);return _0x2f8d68(null,_0x475eee);});}));};