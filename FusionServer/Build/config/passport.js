var _0x5c63=['username','findOne','body','password','generateHash','filepath','generateFileSystem','local-login','toLowerCase','trim','LOGIN.INVALID','validPassword','local-recovery','validSecurityAnswer','securityanswer','passport-local','../app/models/user','exports','findById','use','local-signup'];(function(_0x325c57,_0x4daddb){var _0x1dcb28=function(_0x3d95d5){while(--_0x3d95d5){_0x325c57['push'](_0x325c57['shift']());}};_0x1dcb28(++_0x4daddb);}(_0x5c63,0x10b));var _0x5748=function(_0x3f8020,_0x5ca59c){_0x3f8020=_0x3f8020-0x0;var _0x159f37=_0x5c63[_0x3f8020];return _0x159f37;};var LocalStrategy=require(_0x5748('0x0'))['Strategy'];var User=require(_0x5748('0x1'));module[_0x5748('0x2')]=function(_0x25a175){_0x25a175['serializeUser'](function(_0x4cab73,_0x504662){_0x504662(null,_0x4cab73['id']);});_0x25a175['deserializeUser'](function(_0x10d8f4,_0x25d038){User[_0x5748('0x3')](_0x10d8f4,function(_0x3860ac,_0x4df47d){_0x25d038(_0x3860ac,_0x4df47d);});});_0x25a175[_0x5748('0x4')](_0x5748('0x5'),new LocalStrategy({'usernameField':_0x5748('0x6'),'passwordField':'password','passReqToCallback':!![]},function(_0x358d0a,_0x3a9d1e,_0x38d1b9,_0x279d93){User[_0x5748('0x7')]({'username':_0x3a9d1e['toLowerCase']()['trim']()},async function(_0x2fd4b9,_0x50854e){if(_0x2fd4b9)return _0x279d93(_0x2fd4b9);if(_0x50854e){return _0x279d93(null,_0x50854e,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x7e96f7=new User(_0x358d0a[_0x5748('0x8')]);_0x7e96f7[_0x5748('0x6')]=_0x3a9d1e;_0x7e96f7[_0x5748('0x9')]=_0x7e96f7[_0x5748('0xa')](_0x38d1b9);_0x7e96f7[_0x5748('0xb')]=await _0x7e96f7[_0x5748('0xc')](_0x7e96f7['username']);_0x7e96f7['save'](function(_0x2fd4b9){if(_0x2fd4b9)throw _0x2fd4b9;return _0x279d93(null,_0x7e96f7);});}});}));_0x25a175[_0x5748('0x4')](_0x5748('0xd'),new LocalStrategy({'usernameField':'username','passwordField':_0x5748('0x9'),'passReqToCallback':!![]},function(_0x4908dc,_0x19fc88,_0x52cd18,_0xc0168a){User[_0x5748('0x7')]({'username':_0x19fc88[_0x5748('0xe')]()[_0x5748('0xf')]()},function(_0xa1c26d,_0x18469c){if(_0xa1c26d)return _0xc0168a(_0xa1c26d);if(!_0x18469c)return _0xc0168a(null,![],{'message':_0x5748('0x10')});if(!_0x18469c[_0x5748('0x11')](_0x52cd18))return _0xc0168a(null,![],{'message':'LOGIN.INVALID'});return _0xc0168a(null,_0x18469c);});}));_0x25a175[_0x5748('0x4')](_0x5748('0x12'),new LocalStrategy({'usernameField':_0x5748('0x6'),'passwordField':_0x5748('0x9'),'passReqToCallback':!![]},function(_0x2f229b,_0x169648,_0x5824bf,_0x27dd6a){User[_0x5748('0x7')]({'username':_0x169648['toLowerCase']()[_0x5748('0xf')]()},function(_0x4e9d73,_0x23f64c){if(_0x4e9d73)return _0x27dd6a(_0x4e9d73);if(!_0x23f64c)return _0x27dd6a(null,![]);if(!_0x23f64c[_0x5748('0x13')](_0x2f229b[_0x5748('0x8')][_0x5748('0x14')]))return _0x27dd6a(null,![]);return _0x27dd6a(null,_0x23f64c);});}));};