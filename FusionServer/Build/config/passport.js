var _0xe2c2=['validPassword','validSecurityAnswer','securityanswer','passport-local','Strategy','../app/models/user','exports','deserializeUser','use','local-signup','username','findOne','toLowerCase','trim','REGISTER.ALREADY_EXISTS','body','password','generateHash','filepath','generateFileSystem','save','local-login','LOGIN.INVALID'];(function(_0x1760cb,_0x57b9d2){var _0x34e3da=function(_0x4267b4){while(--_0x4267b4){_0x1760cb['push'](_0x1760cb['shift']());}};_0x34e3da(++_0x57b9d2);}(_0xe2c2,0xe9));var _0x34d1=function(_0x34e850,_0x273e6a){_0x34e850=_0x34e850-0x0;var _0x4a19cc=_0xe2c2[_0x34e850];return _0x4a19cc;};var LocalStrategy=require(_0x34d1('0x0'))[_0x34d1('0x1')];var User=require(_0x34d1('0x2'));module[_0x34d1('0x3')]=function(_0x35f5ad){_0x35f5ad['serializeUser'](function(_0x198ea2,_0x46d576){_0x46d576(null,_0x198ea2['id']);});_0x35f5ad[_0x34d1('0x4')](function(_0x3a2295,_0xf40c92){User['findById'](_0x3a2295,function(_0x1bc15c,_0x184351){_0xf40c92(_0x1bc15c,_0x184351);});});_0x35f5ad[_0x34d1('0x5')](_0x34d1('0x6'),new LocalStrategy({'usernameField':_0x34d1('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x3c9206,_0x20b497,_0x48707a,_0x58f3f8){User[_0x34d1('0x8')]({'username':_0x20b497[_0x34d1('0x9')]()[_0x34d1('0xa')]()},async function(_0x5be4d3,_0x2f7bf5){if(_0x5be4d3)return _0x58f3f8(_0x5be4d3);if(_0x2f7bf5){return _0x58f3f8(null,_0x2f7bf5,{'message':_0x34d1('0xb')});}else{var _0x3b6591=new User(_0x3c9206[_0x34d1('0xc')]);_0x3b6591['username']=_0x20b497;_0x3b6591[_0x34d1('0xd')]=_0x3b6591[_0x34d1('0xe')](_0x48707a);_0x3b6591[_0x34d1('0xf')]=await _0x3b6591[_0x34d1('0x10')](_0x3b6591[_0x34d1('0x7')]);_0x3b6591[_0x34d1('0x11')](function(_0x5be4d3){if(_0x5be4d3)throw _0x5be4d3;return _0x58f3f8(null,_0x3b6591);});}});}));_0x35f5ad[_0x34d1('0x5')](_0x34d1('0x12'),new LocalStrategy({'usernameField':_0x34d1('0x7'),'passwordField':_0x34d1('0xd'),'passReqToCallback':!![]},function(_0x178d23,_0x3b62bf,_0x7017c8,_0x72f7e0){User[_0x34d1('0x8')]({'username':_0x3b62bf[_0x34d1('0x9')]()[_0x34d1('0xa')]()},function(_0x5eb0cb,_0x1c2401){if(_0x5eb0cb)return _0x72f7e0(_0x5eb0cb);if(!_0x1c2401)return _0x72f7e0(null,![],{'message':_0x34d1('0x13')});if(!_0x1c2401[_0x34d1('0x14')](_0x7017c8))return _0x72f7e0(null,![],{'message':'LOGIN.INVALID'});return _0x72f7e0(null,_0x1c2401);});}));_0x35f5ad['use']('local-recovery',new LocalStrategy({'usernameField':_0x34d1('0x7'),'passwordField':'password','passReqToCallback':!![]},function(_0x458f87,_0x3085b4,_0x3d9bf9,_0x3ea4e1){User[_0x34d1('0x8')]({'username':_0x3085b4[_0x34d1('0x9')]()['trim']()},function(_0x5486e2,_0xe958a0){if(_0x5486e2)return _0x3ea4e1(_0x5486e2);if(!_0xe958a0)return _0x3ea4e1(null,![]);if(!_0xe958a0[_0x34d1('0x15')](_0x458f87['body'][_0x34d1('0x16')]))return _0x3ea4e1(null,![]);return _0x3ea4e1(null,_0xe958a0);});}));};