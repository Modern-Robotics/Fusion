const _0x9048=['Cannot\x20stop\x20another\x20user\x27s\x20program.','substring','os.chdir(\x27./app/filesystem/','SIGINT','verbose','fusion_program_running','python','kill','win32','../socket','StartProgram','sendInput','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','SocketVariables','imp.load_source(\x27util\x27,\x20r\x27','program-running','../global/fusionSettings','../utils/logger','exec','/Editor\x27)\x0a','stdin','Program\x20is\x20now\x20running','import\x20imp\x0a','>\x20Program\x20Finished!','User','lastIndexOf','import\x20os\x0a','data','console-output','close','platform','spawn','SocketId','blockly-console-output','resolve','shelljs','child_process','Program\x20is\x20now\x20stopped','pipe','emit','Blockly\x20Program\x20is\x20now\x20running','gamepad-available','write','autonomous','No\x20Program\x20Running','stderr','Program\x20already\x20running','stdout','Program\x20Successfully\x20Stopped','>\x20Program\x20Finished!\x0a','KillProgram','fusion_gamepad_available','sockets'];(function(_0x347213,_0x904881){const _0x2b2ca9=function(_0x420b64){while(--_0x420b64){_0x347213['push'](_0x347213['shift']());}};_0x2b2ca9(++_0x904881);}(_0x9048,0x140));const _0x2b2c=function(_0x347213,_0x904881){_0x347213=_0x347213-0x0;let _0x2b2ca9=_0x9048[_0x347213];return _0x2b2ca9;};const logger=require(_0x2b2c('0xf'));const io=require(_0x2b2c('0x7'));const FusionSettings=require(_0x2b2c('0xe'));const spawn=require(_0x2b2c('0x22'))[_0x2b2c('0x1d')];const shell=require(_0x2b2c('0x21'));const os=require('os');const path=require('path');let python_process=null;module['exports']=function(){var _0x59179c=function(){};_0x59179c[_0x2b2c('0x8')]=function(_0x4ca8c7,_0x20ab67,_0x535f70){if(!FusionSettings['SocketVariables'][_0x2b2c('0x3')]){FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]={'Code':null,'Program':_0x20ab67,'SocketId':_0x535f70,'User':_0x4ca8c7};_0x2d68e4(_0x20ab67,_0x4ca8c7);logger[_0x2b2c('0x2')](_0x2b2c('0x13'));return{'status':0xc8,'message':'Program\x20is\x20now\x20running'};}else{if(FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')][_0x2b2c('0x16')]==_0x4ca8c7||FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]['SocketId']=='autonomous'){try{python_process[_0x2b2c('0x5')](_0x2b2c('0x1'));}catch(_0x2f53b9){}FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]={'Code':null,'Program':_0x20ab67,'SocketId':_0x535f70,'User':_0x4ca8c7};_0x2d68e4(_0x20ab67,_0x4ca8c7);logger[_0x2b2c('0x2')](_0x2b2c('0x13'));return{'status':0xc8,'message':_0x2b2c('0x13')};}else{logger[_0x2b2c('0x2')](_0x2b2c('0x2c'));return{'status':0x1f4,'message':_0x2b2c('0x2c')};}}};_0x59179c['StopProgram']=function(_0x2cd1f4){if(FusionSettings[_0x2b2c('0xb')]['fusion_program_running']){if(FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')][_0x2b2c('0x16')]==_0x2cd1f4||FusionSettings['SocketVariables']['fusion_program_running'][_0x2b2c('0x1e')]==_0x2b2c('0x29')){FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]=null;try{python_process['kill'](_0x2b2c('0x1'));}catch(_0x267f43){}logger[_0x2b2c('0x2')](_0x2b2c('0x23'));return{'status':0xc8,'message':_0x2b2c('0x2e')};}else{logger[_0x2b2c('0x2')]('Cannot\x20stop\x20another\x20user\x20program');return{'status':0x1f4,'message':_0x2b2c('0x33')};}}else{logger['verbose']('No\x20program\x20running');return{'status':0x1f4,'message':_0x2b2c('0x2a')};}};_0x59179c[_0x2b2c('0x30')]=function(){FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]=null;try{python_process[_0x2b2c('0x5')](_0x2b2c('0x1'));}catch(_0xe9be82){}logger[_0x2b2c('0x2')](_0x2b2c('0x23'));};_0x59179c['StartBlocklyProgram']=function(_0x5d2767,_0x3ccd3c,_0x3b1898){if(!FusionSettings[_0x2b2c('0xb')]['fusion_program_running']){FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]={'Code':_0x5d2767,'Program':null,'SocketId':_0x3b1898,'User':_0x3ccd3c};_0x54501f(_0x5d2767,_0x3ccd3c);logger[_0x2b2c('0x2')](_0x2b2c('0x26'));return{'status':0xc8,'message':_0x2b2c('0x26')};}else{if(FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')][_0x2b2c('0x16')]==_0x3ccd3c||FusionSettings[_0x2b2c('0xb')]['fusion_program_running'][_0x2b2c('0x1e')]==_0x2b2c('0x29')){try{python_process[_0x2b2c('0x5')]('SIGINT');}catch(_0x48553e){}FusionSettings[_0x2b2c('0xb')]['fusion_program_running']={'Code':_0x5d2767,'Program':null,'SocketId':_0x3b1898,'User':_0x3ccd3c};_0x54501f(_0x5d2767,_0x3ccd3c);logger[_0x2b2c('0x2')](_0x2b2c('0x26'));return{'status':0xc8,'message':_0x2b2c('0x26')};}else{logger['verbose'](_0x2b2c('0x2c'));return{'status':0x1f4,'message':_0x2b2c('0x2c')};}}};_0x59179c[_0x2b2c('0x9')]=function(_0x14de5c){python_process[_0x2b2c('0x12')][_0x2b2c('0x28')](_0x14de5c+'\x0a');};function _0x2d68e4(_0x3096f3,_0x1887f){let _0x358b85=_0x2b2c('0x18')+(_0x2b2c('0x0')+_0x1887f+_0x2b2c('0x11'))+_0x2b2c('0x14')+(_0x2b2c('0xc')+path[_0x2b2c('0x20')](_0x3096f3)+'\x27)');python_process=spawn(_0x2b2c('0x4'),['-u','-B','-c',_0x358b85],{'stdio':'pipe'});io[_0x2b2c('0x32')]['emit']('program-running',FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);_0x32a0fd();python_process[_0x2b2c('0x2d')]['on'](_0x2b2c('0x19'),function(_0x57bf72){logger['verbose'](String(_0x57bf72)['substring'](0x0,_0x57bf72['lastIndexOf']('\x0a')));io[_0x2b2c('0x25')](_0x2b2c('0x1a'),{'output':String(_0x57bf72)});});python_process[_0x2b2c('0x2b')]['on']('data',function(_0x620459){logger[_0x2b2c('0x2')](String(_0x620459)['substring'](0x0,_0x620459[_0x2b2c('0x17')]('\x0a')));io[_0x2b2c('0x25')](_0x2b2c('0x1a'),{'output':String(_0x620459)});io[_0x2b2c('0x32')][_0x2b2c('0x25')](_0x2b2c('0xd'),FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);io[_0x2b2c('0x32')]['emit']('gamepad-available',![]);});python_process[_0x2b2c('0x2d')]['on'](_0x2b2c('0x1b'),function(_0x598352){FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]=null;logger[_0x2b2c('0x2')](String(_0x2b2c('0x15')));io[_0x2b2c('0x25')](_0x2b2c('0x1a'),{'output':String(_0x2b2c('0x2f'))});io[_0x2b2c('0x32')]['emit']('program-running',FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);io[_0x2b2c('0x32')][_0x2b2c('0x25')](_0x2b2c('0x27'),![]);});}function _0x54501f(_0x52860b,_0x2eadab){let _0xf2b82e=_0x2b2c('0x18')+('os.chdir(\x27./app/filesystem/'+_0x2eadab+'/Blockly\x27)\x0a')+_0x2b2c('0x14')+(''+_0x52860b);if(os[_0x2b2c('0x1c')]()!=_0x2b2c('0x6')){python_process=spawn(_0x2b2c('0x4'),['-u','-B','-c',_0xf2b82e],{'stdio':_0x2b2c('0x24')});}else{python_process=spawn(_0x2b2c('0x4'),['-u','-B','-c',_0xf2b82e],{'stdio':_0x2b2c('0x24')});}io[_0x2b2c('0x32')]['emit'](_0x2b2c('0xd'),FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);_0x32a0fd();python_process['stdout']['on'](_0x2b2c('0x19'),function(_0x52044f){logger['verbose'](String(_0x52044f)[_0x2b2c('0x34')](0x0,_0x52044f[_0x2b2c('0x17')]('\x0a')));io[_0x2b2c('0x25')](_0x2b2c('0x1f'),{'output':String(_0x52044f)});});python_process[_0x2b2c('0x2b')]['on'](_0x2b2c('0x19'),function(_0x22854e){logger[_0x2b2c('0x2')](String(_0x22854e)[_0x2b2c('0x34')](0x0,_0x22854e[_0x2b2c('0x17')]('\x0a')));io[_0x2b2c('0x25')](_0x2b2c('0x1f'),{'output':String(_0x22854e)});io['sockets'][_0x2b2c('0x25')](_0x2b2c('0xd'),FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);io[_0x2b2c('0x32')][_0x2b2c('0x25')](_0x2b2c('0x27'),![]);});python_process[_0x2b2c('0x2d')]['on'](_0x2b2c('0x1b'),function(_0x3eef23){FusionSettings[_0x2b2c('0xb')]['fusion_program_running']=null;logger[_0x2b2c('0x2')](String(_0x2b2c('0x15')));io['emit'](_0x2b2c('0x1f'),{'output':String('>\x20Program\x20Finished!\x0a')});io['sockets'][_0x2b2c('0x25')](_0x2b2c('0xd'),FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x3')]);io[_0x2b2c('0x32')][_0x2b2c('0x25')]('gamepad-available',![]);});}function _0x32a0fd(){if(os[_0x2b2c('0x1c')]()!=_0x2b2c('0x6')){setTimeout(function(){var _0x54fdb7=shell[_0x2b2c('0x10')](_0x2b2c('0xa'),{'silent':!![]})['stdout'];if(!_0x54fdb7)FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x31')]=![];else FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x31')]=!![];io[_0x2b2c('0x32')][_0x2b2c('0x25')](_0x2b2c('0x27'),FusionSettings[_0x2b2c('0xb')][_0x2b2c('0x31')]);},0x3e8);}}return _0x59179c;}();