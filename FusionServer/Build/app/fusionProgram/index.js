const _0x211d=['Blockly\x20Program\x20is\x20now\x20running','program-running','sendInput','Program\x20Successfully\x20Stopped','SocketId','autonomous','../global/fusionSettings','stdin','sockets','blockly-console-output','lastIndexOf','stdout','StopProgram','>\x20Program\x20Finished!','StartProgram','>\x20Program\x20Finished!\x0a','kill','substring','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','resolve','python','win32','import\x20imp\x0a','Program\x20is\x20now\x20running','platform','close','path','gamepad-available','/Editor\x27)\x0a','User','write','Program\x20already\x20running','console-output','stderr','KillProgram','pipe','verbose','imp.load_source(\x27util\x27,\x20r\x27','SocketVariables','No\x20Program\x20Running','No\x20program\x20running','Program\x20is\x20now\x20stopped','fusion_gamepad_available','../socket','../utils/logger','import\x20os\x0a','SIGINT','Cannot\x20stop\x20another\x20user\x20program','emit','data','exec','child_process','StartBlocklyProgram','fusion_program_running'];(function(_0x31b3e3,_0x211dbc){const _0x3bdbfa=function(_0xd4c19b){while(--_0xd4c19b){_0x31b3e3['push'](_0x31b3e3['shift']());}};_0x3bdbfa(++_0x211dbc);}(_0x211d,0x134));const _0x3bdb=function(_0x31b3e3,_0x211dbc){_0x31b3e3=_0x31b3e3-0x0;let _0x3bdbfa=_0x211d[_0x31b3e3];return _0x3bdbfa;};const logger=require(_0x3bdb('0x6'));const io=require(_0x3bdb('0x5'));const FusionSettings=require(_0x3bdb('0x16'));const spawn=require(_0x3bdb('0xd'))['spawn'];const shell=require('shelljs');const os=require('os');const path=require(_0x3bdb('0x2a'));let python_process=null;module['exports']=function(){var _0x2176a4=function(){};_0x2176a4[_0x3bdb('0x1e')]=function(_0x1256d1,_0x552b85,_0x521f9a){if(!FusionSettings[_0x3bdb('0x0')]['fusion_program_running']){FusionSettings['SocketVariables'][_0x3bdb('0xf')]={'Code':null,'Program':_0x552b85,'SocketId':_0x521f9a,'User':_0x1256d1};_0x51f95b(_0x552b85,_0x1256d1);logger[_0x3bdb('0x34')]('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x3bdb('0x27')};}else{if(FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')][_0x3bdb('0x2d')]==_0x1256d1||FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')][_0x3bdb('0x14')]=='autonomous'){try{python_process[_0x3bdb('0x20')](_0x3bdb('0x8'));}catch(_0x285083){}FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]={'Code':null,'Program':_0x552b85,'SocketId':_0x521f9a,'User':_0x1256d1};_0x51f95b(_0x552b85,_0x1256d1);logger[_0x3bdb('0x34')]('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x3bdb('0x27')};}else{logger['verbose'](_0x3bdb('0x2f'));return{'status':0x1f4,'message':'Program\x20already\x20running'};}}};_0x2176a4[_0x3bdb('0x1c')]=function(_0x701c9c){if(FusionSettings['SocketVariables'][_0x3bdb('0xf')]){if(FusionSettings[_0x3bdb('0x0')]['fusion_program_running']['User']==_0x701c9c||FusionSettings[_0x3bdb('0x0')]['fusion_program_running'][_0x3bdb('0x14')]==_0x3bdb('0x15')){FusionSettings[_0x3bdb('0x0')]['fusion_program_running']=null;try{python_process[_0x3bdb('0x20')]('SIGINT');}catch(_0x579657){}logger[_0x3bdb('0x34')]('Program\x20is\x20now\x20stopped');return{'status':0xc8,'message':_0x3bdb('0x13')};}else{logger[_0x3bdb('0x34')](_0x3bdb('0x9'));return{'status':0x1f4,'message':'Cannot\x20stop\x20another\x20user\x27s\x20program.'};}}else{logger[_0x3bdb('0x34')](_0x3bdb('0x2'));return{'status':0x1f4,'message':_0x3bdb('0x1')};}};_0x2176a4[_0x3bdb('0x32')]=function(){FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]=null;try{python_process[_0x3bdb('0x20')](_0x3bdb('0x8'));}catch(_0x1c762b){}logger['verbose'](_0x3bdb('0x3'));};_0x2176a4[_0x3bdb('0xe')]=function(_0x51f33a,_0x13e002,_0x4b0839){if(!FusionSettings['SocketVariables'][_0x3bdb('0xf')]){FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]={'Code':_0x51f33a,'Program':null,'SocketId':_0x4b0839,'User':_0x13e002};_0x289a4b(_0x51f33a,_0x13e002);logger[_0x3bdb('0x34')](_0x3bdb('0x10'));return{'status':0xc8,'message':_0x3bdb('0x10')};}else{if(FusionSettings[_0x3bdb('0x0')]['fusion_program_running'][_0x3bdb('0x2d')]==_0x13e002||FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')][_0x3bdb('0x14')]==_0x3bdb('0x15')){try{python_process[_0x3bdb('0x20')]('SIGINT');}catch(_0x5247cb){}FusionSettings[_0x3bdb('0x0')]['fusion_program_running']={'Code':_0x51f33a,'Program':null,'SocketId':_0x4b0839,'User':_0x13e002};_0x289a4b(_0x51f33a,_0x13e002);logger['verbose'](_0x3bdb('0x10'));return{'status':0xc8,'message':_0x3bdb('0x10')};}else{logger[_0x3bdb('0x34')](_0x3bdb('0x2f'));return{'status':0x1f4,'message':'Program\x20already\x20running'};}}};_0x2176a4[_0x3bdb('0x12')]=function(_0x4a034b){python_process[_0x3bdb('0x17')][_0x3bdb('0x2e')](_0x4a034b+'\x0a');};function _0x51f95b(_0x9bc14,_0x52e3a5){let _0x12f910=_0x3bdb('0x7')+('os.chdir(\x27./app/filesystem/'+_0x52e3a5+_0x3bdb('0x2c'))+_0x3bdb('0x26')+(_0x3bdb('0x35')+path[_0x3bdb('0x23')](_0x9bc14)+'\x27)');python_process=spawn(_0x3bdb('0x24'),['-u','-B','-c',_0x12f910],{'stdio':_0x3bdb('0x33')});io[_0x3bdb('0x18')][_0x3bdb('0xa')](_0x3bdb('0x11'),FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]);_0x9415d5();python_process['stdout']['on']('data',function(_0x523bd2){logger[_0x3bdb('0x34')](String(_0x523bd2)[_0x3bdb('0x21')](0x0,_0x523bd2[_0x3bdb('0x1a')]('\x0a')));io[_0x3bdb('0xa')](_0x3bdb('0x30'),{'output':String(_0x523bd2)});});python_process[_0x3bdb('0x31')]['on']('data',function(_0x114f8a){logger['verbose'](String(_0x114f8a)['substring'](0x0,_0x114f8a[_0x3bdb('0x1a')]('\x0a')));io[_0x3bdb('0xa')](_0x3bdb('0x30'),{'output':String(_0x114f8a)});io[_0x3bdb('0x18')][_0x3bdb('0xa')](_0x3bdb('0x11'),FusionSettings[_0x3bdb('0x0')]['fusion_program_running']);io['sockets']['emit'](_0x3bdb('0x2b'),![]);});python_process[_0x3bdb('0x1b')]['on'](_0x3bdb('0x29'),function(_0x28265e){FusionSettings['SocketVariables']['fusion_program_running']=null;logger[_0x3bdb('0x34')](String(_0x3bdb('0x1d')));io[_0x3bdb('0xa')](_0x3bdb('0x30'),{'output':String(_0x3bdb('0x1f'))});io['sockets'][_0x3bdb('0xa')](_0x3bdb('0x11'),FusionSettings['SocketVariables'][_0x3bdb('0xf')]);io[_0x3bdb('0x18')][_0x3bdb('0xa')]('gamepad-available',![]);});}function _0x289a4b(_0x2de601,_0x5cbdea){let _0x41b052=_0x3bdb('0x7')+('os.chdir(\x27./app/filesystem/'+_0x5cbdea+'/Blockly\x27)\x0a')+'import\x20imp\x0a'+(''+_0x2de601);if(os[_0x3bdb('0x28')]()!=_0x3bdb('0x25')){python_process=spawn('python',['-u','-B','-c',_0x41b052],{'stdio':_0x3bdb('0x33')});}else{python_process=spawn(_0x3bdb('0x24'),['-u','-B','-c',_0x41b052],{'stdio':_0x3bdb('0x33')});}io['sockets'][_0x3bdb('0xa')]('program-running',FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]);_0x9415d5();python_process['stdout']['on'](_0x3bdb('0xb'),function(_0xb2fb63){logger[_0x3bdb('0x34')](String(_0xb2fb63)[_0x3bdb('0x21')](0x0,_0xb2fb63[_0x3bdb('0x1a')]('\x0a')));io[_0x3bdb('0xa')](_0x3bdb('0x19'),{'output':String(_0xb2fb63)});});python_process[_0x3bdb('0x31')]['on'](_0x3bdb('0xb'),function(_0x93c6a2){logger[_0x3bdb('0x34')](String(_0x93c6a2)['substring'](0x0,_0x93c6a2[_0x3bdb('0x1a')]('\x0a')));io[_0x3bdb('0xa')](_0x3bdb('0x19'),{'output':String(_0x93c6a2)});io[_0x3bdb('0x18')][_0x3bdb('0xa')](_0x3bdb('0x11'),FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]);io[_0x3bdb('0x18')]['emit'](_0x3bdb('0x2b'),![]);});python_process[_0x3bdb('0x1b')]['on']('close',function(_0x14dfea){FusionSettings[_0x3bdb('0x0')][_0x3bdb('0xf')]=null;logger[_0x3bdb('0x34')](String(_0x3bdb('0x1d')));io['emit'](_0x3bdb('0x19'),{'output':String(_0x3bdb('0x1f'))});io['sockets'][_0x3bdb('0xa')](_0x3bdb('0x11'),FusionSettings['SocketVariables']['fusion_program_running']);io['sockets']['emit'](_0x3bdb('0x2b'),![]);});}function _0x9415d5(){if(os[_0x3bdb('0x28')]()!=_0x3bdb('0x25')){setTimeout(function(){var _0x511f90=shell[_0x3bdb('0xc')](_0x3bdb('0x22'),{'silent':!![]})['stdout'];if(!_0x511f90)FusionSettings[_0x3bdb('0x0')][_0x3bdb('0x4')]=![];else FusionSettings[_0x3bdb('0x0')]['fusion_gamepad_available']=!![];io[_0x3bdb('0x18')][_0x3bdb('0xa')]('gamepad-available',FusionSettings[_0x3bdb('0x0')][_0x3bdb('0x4')]);},0x3e8);}}return _0x2176a4;}();