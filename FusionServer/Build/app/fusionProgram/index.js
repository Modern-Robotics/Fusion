const _0x4131=['sockets','kill','verbose','../socket','win32','console-output','fusion_gamepad_available','SIGINT','/Editor\x27)\x0a','Cannot\x20stop\x20another\x20user\x27s\x20program.','data','write','program-running','Blockly\x20Program\x20is\x20now\x20running','>\x20Program\x20Finished!\x0a','import\x20imp\x0a','resolve','>\x20Program\x20Finished!','blockly-console-output','../global/fusionSettings','gamepad-available','KillProgram','StopProgram','shelljs','No\x20Program\x20Running','autonomous','sendInput','Program\x20is\x20now\x20running','os.chdir(\x27./app/filesystem/','child_process','User','exports','substring','emit','spawn','Program\x20already\x20running','stderr','Program\x20is\x20now\x20stopped','pipe','stdout','close','No\x20program\x20running','Program\x20Successfully\x20Stopped','SocketVariables','python','lastIndexOf','platform','fusion_program_running','import\x20os\x0a','SocketId'];(function(_0x480ac5,_0x4131f6){const _0x3d2ad0=function(_0x583d0e){while(--_0x583d0e){_0x480ac5['push'](_0x480ac5['shift']());}};_0x3d2ad0(++_0x4131f6);}(_0x4131,0x192));const _0x3d2a=function(_0x480ac5,_0x4131f6){_0x480ac5=_0x480ac5-0x0;let _0x3d2ad0=_0x4131[_0x480ac5];return _0x3d2ad0;};const logger=require('../utils/logger');const io=require(_0x3d2a('0x1'));const FusionSettings=require(_0x3d2a('0x11'));const spawn=require(_0x3d2a('0x1b'))[_0x3d2a('0x20')];const shell=require(_0x3d2a('0x15'));const os=require('os');const path=require('path');let python_process=null;module[_0x3d2a('0x1d')]=function(){var _0x2fab94=function(){};_0x2fab94['StartProgram']=function(_0x4fe745,_0x535572,_0x5b374f){if(!FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]){FusionSettings[_0x3d2a('0x29')]['fusion_program_running']={'Code':null,'Program':_0x535572,'SocketId':_0x5b374f,'User':_0x4fe745};_0x3f2c49(_0x535572,_0x4fe745);logger[_0x3d2a('0x0')](_0x3d2a('0x19'));return{'status':0xc8,'message':_0x3d2a('0x19')};}else{if(FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')][_0x3d2a('0x1c')]==_0x4fe745||FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]['SocketId']==_0x3d2a('0x17')){try{python_process['kill'](_0x3d2a('0x5'));}catch(_0x3cf026){}FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]={'Code':null,'Program':_0x535572,'SocketId':_0x5b374f,'User':_0x4fe745};_0x3f2c49(_0x535572,_0x4fe745);logger[_0x3d2a('0x0')]('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x3d2a('0x19')};}else{logger[_0x3d2a('0x0')](_0x3d2a('0x21'));return{'status':0x1f4,'message':_0x3d2a('0x21')};}}};_0x2fab94[_0x3d2a('0x14')]=function(_0x484a0e){if(FusionSettings[_0x3d2a('0x29')]['fusion_program_running']){if(FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')][_0x3d2a('0x1c')]==_0x484a0e||FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')][_0x3d2a('0x2f')]==_0x3d2a('0x17')){FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]=null;try{python_process[_0x3d2a('0x31')]('SIGINT');}catch(_0x2e0b43){}logger[_0x3d2a('0x0')](_0x3d2a('0x23'));return{'status':0xc8,'message':_0x3d2a('0x28')};}else{logger[_0x3d2a('0x0')]('Cannot\x20stop\x20another\x20user\x20program');return{'status':0x1f4,'message':_0x3d2a('0x7')};}}else{logger[_0x3d2a('0x0')](_0x3d2a('0x27'));return{'status':0x1f4,'message':_0x3d2a('0x16')};}};_0x2fab94[_0x3d2a('0x13')]=function(){FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]=null;try{python_process['kill'](_0x3d2a('0x5'));}catch(_0x55b5f5){}logger['verbose'](_0x3d2a('0x23'));};_0x2fab94['StartBlocklyProgram']=function(_0x15310d,_0x44142b,_0x2afa7b){if(!FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]){FusionSettings[_0x3d2a('0x29')]['fusion_program_running']={'Code':_0x15310d,'Program':null,'SocketId':_0x2afa7b,'User':_0x44142b};_0x571579(_0x15310d,_0x44142b);logger[_0x3d2a('0x0')](_0x3d2a('0xb'));return{'status':0xc8,'message':'Blockly\x20Program\x20is\x20now\x20running'};}else{if(FusionSettings[_0x3d2a('0x29')]['fusion_program_running'][_0x3d2a('0x1c')]==_0x44142b||FusionSettings['SocketVariables'][_0x3d2a('0x2d')][_0x3d2a('0x2f')]=='autonomous'){try{python_process[_0x3d2a('0x31')](_0x3d2a('0x5'));}catch(_0x446ef2){}FusionSettings['SocketVariables'][_0x3d2a('0x2d')]={'Code':_0x15310d,'Program':null,'SocketId':_0x2afa7b,'User':_0x44142b};_0x571579(_0x15310d,_0x44142b);logger['verbose']('Blockly\x20Program\x20is\x20now\x20running');return{'status':0xc8,'message':'Blockly\x20Program\x20is\x20now\x20running'};}else{logger['verbose']('Program\x20already\x20running');return{'status':0x1f4,'message':_0x3d2a('0x21')};}}};_0x2fab94[_0x3d2a('0x18')]=function(_0x4fc5ad){python_process['stdin'][_0x3d2a('0x9')](_0x4fc5ad+'\x0a');};function _0x3f2c49(_0x35d32f,_0x21201b){let _0x5ef225=_0x3d2a('0x2e')+(_0x3d2a('0x1a')+_0x21201b+_0x3d2a('0x6'))+_0x3d2a('0xd')+('imp.load_source(\x27util\x27,\x20r\x27'+path[_0x3d2a('0xe')](_0x35d32f)+'\x27)');python_process=spawn(_0x3d2a('0x2a'),['-u','-B','-c',_0x5ef225],{'stdio':_0x3d2a('0x24')});io['sockets']['emit'](_0x3d2a('0xa'),FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]);_0x8c405e();python_process[_0x3d2a('0x25')]['on'](_0x3d2a('0x8'),function(_0xa4c654){logger[_0x3d2a('0x0')](String(_0xa4c654)[_0x3d2a('0x1e')](0x0,_0xa4c654[_0x3d2a('0x2b')]('\x0a')));io['emit'](_0x3d2a('0x3'),{'output':String(_0xa4c654)});});python_process[_0x3d2a('0x22')]['on']('data',function(_0x391e48){logger[_0x3d2a('0x0')](String(_0x391e48)[_0x3d2a('0x1e')](0x0,_0x391e48[_0x3d2a('0x2b')]('\x0a')));io[_0x3d2a('0x1f')](_0x3d2a('0x3'),{'output':String(_0x391e48)});io[_0x3d2a('0x30')][_0x3d2a('0x1f')](_0x3d2a('0xa'),FusionSettings[_0x3d2a('0x29')]['fusion_program_running']);io['sockets'][_0x3d2a('0x1f')]('gamepad-available',![]);});python_process['stdout']['on'](_0x3d2a('0x26'),function(_0x1b1fda){FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]=null;logger[_0x3d2a('0x0')](String(_0x3d2a('0xf')));io[_0x3d2a('0x1f')]('console-output',{'output':String(_0x3d2a('0xc'))});io[_0x3d2a('0x30')][_0x3d2a('0x1f')]('program-running',FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]);io[_0x3d2a('0x30')]['emit']('gamepad-available',![]);});}function _0x571579(_0x4cc7d9,_0x3cbf05){let _0x11248d='import\x20os\x0a'+(_0x3d2a('0x1a')+_0x3cbf05+'/Blockly\x27)\x0a')+'import\x20imp\x0a'+(''+_0x4cc7d9);if(os[_0x3d2a('0x2c')]()!=_0x3d2a('0x2')){python_process=spawn(_0x3d2a('0x2a'),['-u','-B','-c',_0x11248d],{'stdio':_0x3d2a('0x24')});}else{python_process=spawn(_0x3d2a('0x2a'),['-u','-B','-c',_0x11248d],{'stdio':_0x3d2a('0x24')});}io[_0x3d2a('0x30')][_0x3d2a('0x1f')]('program-running',FusionSettings['SocketVariables'][_0x3d2a('0x2d')]);_0x8c405e();python_process[_0x3d2a('0x25')]['on'](_0x3d2a('0x8'),function(_0x2dcf5a){logger[_0x3d2a('0x0')](String(_0x2dcf5a)[_0x3d2a('0x1e')](0x0,_0x2dcf5a[_0x3d2a('0x2b')]('\x0a')));io[_0x3d2a('0x1f')]('blockly-console-output',{'output':String(_0x2dcf5a)});});python_process['stderr']['on'](_0x3d2a('0x8'),function(_0x20859f){logger[_0x3d2a('0x0')](String(_0x20859f)[_0x3d2a('0x1e')](0x0,_0x20859f[_0x3d2a('0x2b')]('\x0a')));io[_0x3d2a('0x1f')](_0x3d2a('0x10'),{'output':String(_0x20859f)});io[_0x3d2a('0x30')]['emit'](_0x3d2a('0xa'),FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]);io[_0x3d2a('0x30')][_0x3d2a('0x1f')](_0x3d2a('0x12'),![]);});python_process[_0x3d2a('0x25')]['on']('close',function(_0x52c944){FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]=null;logger[_0x3d2a('0x0')](String(_0x3d2a('0xf')));io[_0x3d2a('0x1f')]('blockly-console-output',{'output':String(_0x3d2a('0xc'))});io[_0x3d2a('0x30')][_0x3d2a('0x1f')](_0x3d2a('0xa'),FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x2d')]);io[_0x3d2a('0x30')][_0x3d2a('0x1f')]('gamepad-available',![]);});}function _0x8c405e(){if(os['platform']()!=_0x3d2a('0x2')){setTimeout(function(){var _0x3f1da9=shell['exec']('sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN',{'silent':!![]})[_0x3d2a('0x25')];if(!_0x3f1da9)FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x4')]=![];else FusionSettings['SocketVariables']['fusion_gamepad_available']=!![];io['sockets']['emit'](_0x3d2a('0x12'),FusionSettings[_0x3d2a('0x29')][_0x3d2a('0x4')]);},0x3e8);}}return _0x2fab94;}();