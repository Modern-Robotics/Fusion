const _0x584a=['sockets','KillProgram','verbose','autonomous','StopProgram','../utils/logger','fusion_program_running','stdin','StartBlocklyProgram','>\x20Program\x20Finished!','No\x20program\x20running','os.chdir(\x27./app/filesystem/','platform','substring','exports','fusion_gamepad_available','Program\x20is\x20now\x20stopped','spawn','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','Blockly\x20Program\x20is\x20now\x20running','close','write','python','Cannot\x20stop\x20another\x20user\x20program','stdout','Program\x20already\x20running','SIGINT','program-running','import\x20os\x0a','StartProgram','SocketVariables','import\x20imp\x0a','User','data','gamepad-available','/Blockly\x27)\x0a','emit','SocketId','pipe','path','lastIndexOf','blockly-console-output','../socket','resolve','kill','>\x20Program\x20Finished!\x0a','No\x20Program\x20Running','Program\x20Successfully\x20Stopped','stderr','imp.load_source(\x27util\x27,\x20r\x27','shelljs','Program\x20is\x20now\x20running','console-output','/Editor\x27)\x0a','sendInput'];(function(_0x3bcf45,_0x584a4a){const _0x264ba9=function(_0x3a2dc5){while(--_0x3a2dc5){_0x3bcf45['push'](_0x3bcf45['shift']());}};_0x264ba9(++_0x584a4a);}(_0x584a,0x15f));const _0x264b=function(_0x3bcf45,_0x584a4a){_0x3bcf45=_0x3bcf45-0x0;let _0x264ba9=_0x584a[_0x3bcf45];return _0x264ba9;};const logger=require(_0x264b('0x27'));const io=require(_0x264b('0x15'));const FusionSettings=require('../global/fusionSettings');const spawn=require('child_process')[_0x264b('0x33')];const shell=require(_0x264b('0x1d'));const os=require('os');const path=require(_0x264b('0x12'));let python_process=null;module[_0x264b('0x30')]=function(){var _0x15681e=function(){};_0x15681e[_0x264b('0x8')]=function(_0xa759a1,_0x14a4c3,_0x1a7e2f){if(!FusionSettings[_0x264b('0x9')][_0x264b('0x28')]){FusionSettings[_0x264b('0x9')][_0x264b('0x28')]={'Code':null,'Program':_0x14a4c3,'SocketId':_0x1a7e2f,'User':_0xa759a1};_0x2ff4f8(_0x14a4c3,_0xa759a1);logger[_0x264b('0x24')]('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x264b('0x1e')};}else{if(FusionSettings['SocketVariables'][_0x264b('0x28')][_0x264b('0xb')]==_0xa759a1||FusionSettings['SocketVariables'][_0x264b('0x28')][_0x264b('0x10')]==_0x264b('0x25')){try{python_process[_0x264b('0x17')]('SIGINT');}catch(_0x488595){}FusionSettings['SocketVariables'][_0x264b('0x28')]={'Code':null,'Program':_0x14a4c3,'SocketId':_0x1a7e2f,'User':_0xa759a1};_0x2ff4f8(_0x14a4c3,_0xa759a1);logger['verbose']('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x264b('0x1e')};}else{logger[_0x264b('0x24')](_0x264b('0x4'));return{'status':0x1f4,'message':_0x264b('0x4')};}}};_0x15681e[_0x264b('0x26')]=function(_0x45461c){if(FusionSettings['SocketVariables'][_0x264b('0x28')]){if(FusionSettings['SocketVariables']['fusion_program_running'][_0x264b('0xb')]==_0x45461c||FusionSettings[_0x264b('0x9')][_0x264b('0x28')][_0x264b('0x10')]==_0x264b('0x25')){FusionSettings[_0x264b('0x9')]['fusion_program_running']=null;try{python_process['kill'](_0x264b('0x5'));}catch(_0x9e80e1){}logger[_0x264b('0x24')]('Program\x20is\x20now\x20stopped');return{'status':0xc8,'message':_0x264b('0x1a')};}else{logger[_0x264b('0x24')](_0x264b('0x2'));return{'status':0x1f4,'message':'Cannot\x20stop\x20another\x20user\x27s\x20program.'};}}else{logger[_0x264b('0x24')](_0x264b('0x2c'));return{'status':0x1f4,'message':_0x264b('0x19')};}};_0x15681e[_0x264b('0x23')]=function(){FusionSettings[_0x264b('0x9')][_0x264b('0x28')]=null;try{python_process[_0x264b('0x17')](_0x264b('0x5'));}catch(_0x1c0e61){}logger['verbose'](_0x264b('0x32'));};_0x15681e[_0x264b('0x2a')]=function(_0x574669,_0x5407f9,_0x42654c){if(!FusionSettings[_0x264b('0x9')][_0x264b('0x28')]){FusionSettings[_0x264b('0x9')][_0x264b('0x28')]={'Code':_0x574669,'Program':null,'SocketId':_0x42654c,'User':_0x5407f9};_0x63cd7d(_0x574669,_0x5407f9);logger[_0x264b('0x24')](_0x264b('0x35'));return{'status':0xc8,'message':_0x264b('0x35')};}else{if(FusionSettings[_0x264b('0x9')][_0x264b('0x28')][_0x264b('0xb')]==_0x5407f9||FusionSettings[_0x264b('0x9')][_0x264b('0x28')]['SocketId']==_0x264b('0x25')){try{python_process[_0x264b('0x17')]('SIGINT');}catch(_0x4b36d7){}FusionSettings[_0x264b('0x9')][_0x264b('0x28')]={'Code':_0x574669,'Program':null,'SocketId':_0x42654c,'User':_0x5407f9};_0x63cd7d(_0x574669,_0x5407f9);logger[_0x264b('0x24')](_0x264b('0x35'));return{'status':0xc8,'message':_0x264b('0x35')};}else{logger[_0x264b('0x24')](_0x264b('0x4'));return{'status':0x1f4,'message':'Program\x20already\x20running'};}}};_0x15681e[_0x264b('0x21')]=function(_0x554cdb){python_process[_0x264b('0x29')][_0x264b('0x0')](_0x554cdb+'\x0a');};function _0x2ff4f8(_0x131c51,_0x2a87c3){let _0x4c0746=_0x264b('0x7')+('os.chdir(\x27./app/filesystem/'+_0x2a87c3+_0x264b('0x20'))+'import\x20imp\x0a'+(_0x264b('0x1c')+path[_0x264b('0x16')](_0x131c51)+'\x27)');python_process=spawn('python',['-u','-B','-c',_0x4c0746],{'stdio':_0x264b('0x11')});io[_0x264b('0x22')][_0x264b('0xf')]('program-running',FusionSettings['SocketVariables'][_0x264b('0x28')]);_0x386b44();python_process[_0x264b('0x3')]['on'](_0x264b('0xc'),function(_0x4e08d2){logger[_0x264b('0x24')](String(_0x4e08d2)[_0x264b('0x2f')](0x0,_0x4e08d2[_0x264b('0x13')]('\x0a')));io[_0x264b('0xf')]('console-output',{'output':String(_0x4e08d2)});});python_process['stderr']['on'](_0x264b('0xc'),function(_0x430c6a){logger[_0x264b('0x24')](String(_0x430c6a)[_0x264b('0x2f')](0x0,_0x430c6a[_0x264b('0x13')]('\x0a')));io['emit']('console-output',{'output':String(_0x430c6a)});io['sockets'][_0x264b('0xf')](_0x264b('0x6'),FusionSettings[_0x264b('0x9')][_0x264b('0x28')]);io['sockets'][_0x264b('0xf')](_0x264b('0xd'),![]);});python_process[_0x264b('0x3')]['on'](_0x264b('0x36'),function(_0x157a20){FusionSettings[_0x264b('0x9')][_0x264b('0x28')]=null;logger['verbose'](String('>\x20Program\x20Finished!'));io[_0x264b('0xf')](_0x264b('0x1f'),{'output':String(_0x264b('0x18'))});io['sockets'][_0x264b('0xf')]('program-running',FusionSettings[_0x264b('0x9')]['fusion_program_running']);io[_0x264b('0x22')][_0x264b('0xf')]('gamepad-available',![]);});}function _0x63cd7d(_0x1b5b46,_0x5d9ecc){let _0x59f9d1='import\x20os\x0a'+(_0x264b('0x2d')+_0x5d9ecc+_0x264b('0xe'))+_0x264b('0xa')+(''+_0x1b5b46);if(os[_0x264b('0x2e')]()!='win32'){python_process=spawn('python',['-u','-B','-c',_0x59f9d1],{'stdio':_0x264b('0x11')});}else{python_process=spawn(_0x264b('0x1'),['-u','-B','-c',_0x59f9d1],{'stdio':_0x264b('0x11')});}io['sockets'][_0x264b('0xf')](_0x264b('0x6'),FusionSettings[_0x264b('0x9')][_0x264b('0x28')]);_0x386b44();python_process[_0x264b('0x3')]['on'](_0x264b('0xc'),function(_0x2093a9){logger[_0x264b('0x24')](String(_0x2093a9)['substring'](0x0,_0x2093a9[_0x264b('0x13')]('\x0a')));io[_0x264b('0xf')](_0x264b('0x14'),{'output':String(_0x2093a9)});});python_process[_0x264b('0x1b')]['on'](_0x264b('0xc'),function(_0x43083c){logger['verbose'](String(_0x43083c)['substring'](0x0,_0x43083c[_0x264b('0x13')]('\x0a')));io[_0x264b('0xf')]('blockly-console-output',{'output':String(_0x43083c)});io[_0x264b('0x22')][_0x264b('0xf')](_0x264b('0x6'),FusionSettings[_0x264b('0x9')][_0x264b('0x28')]);io[_0x264b('0x22')][_0x264b('0xf')](_0x264b('0xd'),![]);});python_process[_0x264b('0x3')]['on']('close',function(_0x51d421){FusionSettings[_0x264b('0x9')]['fusion_program_running']=null;logger[_0x264b('0x24')](String(_0x264b('0x2b')));io[_0x264b('0xf')](_0x264b('0x14'),{'output':String(_0x264b('0x18'))});io['sockets'][_0x264b('0xf')](_0x264b('0x6'),FusionSettings['SocketVariables'][_0x264b('0x28')]);io[_0x264b('0x22')][_0x264b('0xf')](_0x264b('0xd'),![]);});}function _0x386b44(){if(os[_0x264b('0x2e')]()!='win32'){setTimeout(function(){var _0x35f4b7=shell['exec'](_0x264b('0x34'),{'silent':!![]})[_0x264b('0x3')];if(!_0x35f4b7)FusionSettings[_0x264b('0x9')][_0x264b('0x31')]=![];else FusionSettings[_0x264b('0x9')][_0x264b('0x31')]=!![];io[_0x264b('0x22')]['emit'](_0x264b('0xd'),FusionSettings['SocketVariables'][_0x264b('0x31')]);},0x3e8);}}return _0x15681e;}();