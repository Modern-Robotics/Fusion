var _0x9758=['../global/fusionSettings','child_process','path','exports','StartProgram','SocketVariables','fusion_program_running','Program\x20is\x20now\x20running','User','SocketId','kill','verbose','Program\x20already\x20running','StopProgram','autonomous','SIGINT','Program\x20is\x20now\x20stopped','Program\x20Successfully\x20Stopped','No\x20program\x20running','No\x20Program\x20Running','Blockly\x20Program\x20is\x20now\x20running','sendInput','stdin','write','import\x20os\x0a','os.chdir(\x27./app/filesystem/','imp.load_source(\x27util\x27,\x20r\x27','resolve','python','pipe','sockets','emit','program-running','stdout','substring','lastIndexOf','stderr','data','console-output','gamepad-available','close','>\x20Program\x20Finished!','/Blockly\x27)\x0a','import\x20imp\x0a','platform','win32','blockly-console-output','>\x20Program\x20Finished!\x0a','exec','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','fusion_gamepad_available','../utils/logger'];(function(_0x5ecab8,_0x4ae731){var _0x31e09c=function(_0x4a7e78){while(--_0x4a7e78){_0x5ecab8['push'](_0x5ecab8['shift']());}};_0x31e09c(++_0x4ae731);}(_0x9758,0x16b));var _0x51ac=function(_0x2de17e,_0x5291e0){_0x2de17e=_0x2de17e-0x0;var _0x243aa6=_0x9758[_0x2de17e];return _0x243aa6;};const logger=require(_0x51ac('0x0'));const io=require('../socket');const FusionSettings=require(_0x51ac('0x1'));const spawn=require(_0x51ac('0x2'))['spawn'];const shell=require('shelljs');const os=require('os');const path=require(_0x51ac('0x3'));let python_process=null;module[_0x51ac('0x4')]=function(){var _0x24ae61=function(){};_0x24ae61[_0x51ac('0x5')]=function(_0x49c9d2,_0x40c2eb,_0x18c8c3){if(!FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]){FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]={'Code':null,'Program':_0x40c2eb,'SocketId':_0x18c8c3,'User':_0x49c9d2};_0x28282d(_0x40c2eb,_0x49c9d2);logger['verbose'](_0x51ac('0x8'));return{'status':0xc8,'message':_0x51ac('0x8')};}else{if(FusionSettings['SocketVariables'][_0x51ac('0x7')][_0x51ac('0x9')]==_0x49c9d2||FusionSettings['SocketVariables'][_0x51ac('0x7')][_0x51ac('0xa')]=='autonomous'){try{python_process[_0x51ac('0xb')]('SIGINT');}catch(_0x58cefa){}FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]={'Code':null,'Program':_0x40c2eb,'SocketId':_0x18c8c3,'User':_0x49c9d2};_0x28282d(_0x40c2eb,_0x49c9d2);logger[_0x51ac('0xc')](_0x51ac('0x8'));return{'status':0xc8,'message':_0x51ac('0x8')};}else{logger[_0x51ac('0xc')](_0x51ac('0xd'));return{'status':0x1f4,'message':_0x51ac('0xd')};}}};_0x24ae61[_0x51ac('0xe')]=function(_0x2eb128){if(FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]){if(FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')][_0x51ac('0x9')]==_0x2eb128||FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')][_0x51ac('0xa')]==_0x51ac('0xf')){FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]=null;try{python_process['kill'](_0x51ac('0x10'));}catch(_0x59a327){}logger[_0x51ac('0xc')](_0x51ac('0x11'));return{'status':0xc8,'message':_0x51ac('0x12')};}else{logger['verbose']('Cannot\x20stop\x20another\x20user\x20program');return{'status':0x1f4,'message':'Cannot\x20stop\x20another\x20user\x27s\x20program.'};}}else{logger['verbose'](_0x51ac('0x13'));return{'status':0x1f4,'message':_0x51ac('0x14')};}};_0x24ae61['KillProgram']=function(){FusionSettings[_0x51ac('0x6')]['fusion_program_running']=null;try{python_process['kill'](_0x51ac('0x10'));}catch(_0x524990){}logger[_0x51ac('0xc')](_0x51ac('0x11'));};_0x24ae61['StartBlocklyProgram']=function(_0x1fc50c,_0x30bde7,_0x92f1ad){if(!FusionSettings[_0x51ac('0x6')]['fusion_program_running']){FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]={'Code':_0x1fc50c,'Program':null,'SocketId':_0x92f1ad,'User':_0x30bde7};_0x3c2ff1(_0x1fc50c,_0x30bde7);logger[_0x51ac('0xc')]('Blockly\x20Program\x20is\x20now\x20running');return{'status':0xc8,'message':'Blockly\x20Program\x20is\x20now\x20running'};}else{if(FusionSettings['SocketVariables'][_0x51ac('0x7')][_0x51ac('0x9')]==_0x30bde7||FusionSettings[_0x51ac('0x6')]['fusion_program_running']['SocketId']==_0x51ac('0xf')){try{python_process[_0x51ac('0xb')](_0x51ac('0x10'));}catch(_0x1d4ed8){}FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]={'Code':_0x1fc50c,'Program':null,'SocketId':_0x92f1ad,'User':_0x30bde7};_0x3c2ff1(_0x1fc50c,_0x30bde7);logger[_0x51ac('0xc')]('Blockly\x20Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x51ac('0x15')};}else{logger[_0x51ac('0xc')](_0x51ac('0xd'));return{'status':0x1f4,'message':_0x51ac('0xd')};}}};_0x24ae61[_0x51ac('0x16')]=function(_0x155b39){python_process[_0x51ac('0x17')][_0x51ac('0x18')](_0x155b39+'\x0a');};function _0x28282d(_0x5bc8a6,_0xc6e3aa){let _0x3b2bdf=_0x51ac('0x19')+(_0x51ac('0x1a')+_0xc6e3aa+'/Editor\x27)\x0a')+'import\x20imp\x0a'+(_0x51ac('0x1b')+path[_0x51ac('0x1c')](_0x5bc8a6)+'\x27)');python_process=spawn(_0x51ac('0x1d'),['-u','-B','-c',_0x3b2bdf],{'stdio':_0x51ac('0x1e')});io[_0x51ac('0x1f')][_0x51ac('0x20')](_0x51ac('0x21'),FusionSettings['SocketVariables'][_0x51ac('0x7')]);_0x566829();python_process[_0x51ac('0x22')]['on']('data',function(_0x4e137e){logger[_0x51ac('0xc')](String(_0x4e137e)[_0x51ac('0x23')](0x0,_0x4e137e[_0x51ac('0x24')]('\x0a')));io[_0x51ac('0x20')]('console-output',{'output':String(_0x4e137e)});});python_process[_0x51ac('0x25')]['on'](_0x51ac('0x26'),function(_0x310a28){logger[_0x51ac('0xc')](String(_0x310a28)[_0x51ac('0x23')](0x0,_0x310a28[_0x51ac('0x24')]('\x0a')));io[_0x51ac('0x20')](_0x51ac('0x27'),{'output':String(_0x310a28)});io[_0x51ac('0x1f')]['emit'](_0x51ac('0x21'),FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]);io[_0x51ac('0x1f')]['emit'](_0x51ac('0x28'),![]);});python_process['stdout']['on'](_0x51ac('0x29'),function(_0x3d1128){FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]=null;logger[_0x51ac('0xc')](String(_0x51ac('0x2a')));io[_0x51ac('0x20')](_0x51ac('0x27'),{'output':String('>\x20Program\x20Finished!\x0a')});io['sockets'][_0x51ac('0x20')](_0x51ac('0x21'),FusionSettings['SocketVariables'][_0x51ac('0x7')]);io[_0x51ac('0x1f')][_0x51ac('0x20')](_0x51ac('0x28'),![]);});}function _0x3c2ff1(_0x2c3bf9,_0x8aa5cc){let _0x58baf7='import\x20os\x0a'+(_0x51ac('0x1a')+_0x8aa5cc+_0x51ac('0x2b'))+_0x51ac('0x2c')+(''+_0x2c3bf9);if(os[_0x51ac('0x2d')]()!=_0x51ac('0x2e')){python_process=spawn(_0x51ac('0x1d'),['-u','-B','-c',_0x58baf7],{'stdio':'pipe'});}else{python_process=spawn(_0x51ac('0x1d'),['-u','-B','-c',_0x58baf7],{'stdio':_0x51ac('0x1e')});}io[_0x51ac('0x1f')][_0x51ac('0x20')](_0x51ac('0x21'),FusionSettings['SocketVariables'][_0x51ac('0x7')]);_0x566829();python_process[_0x51ac('0x22')]['on'](_0x51ac('0x26'),function(_0x292866){logger[_0x51ac('0xc')](String(_0x292866)[_0x51ac('0x23')](0x0,_0x292866[_0x51ac('0x24')]('\x0a')));io['emit'](_0x51ac('0x2f'),{'output':String(_0x292866)});});python_process[_0x51ac('0x25')]['on']('data',function(_0x5b823f){logger['verbose'](String(_0x5b823f)[_0x51ac('0x23')](0x0,_0x5b823f['lastIndexOf']('\x0a')));io[_0x51ac('0x20')]('blockly-console-output',{'output':String(_0x5b823f)});io[_0x51ac('0x1f')][_0x51ac('0x20')](_0x51ac('0x21'),FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]);io[_0x51ac('0x1f')][_0x51ac('0x20')](_0x51ac('0x28'),![]);});python_process[_0x51ac('0x22')]['on'](_0x51ac('0x29'),function(_0x44d4cc){FusionSettings[_0x51ac('0x6')]['fusion_program_running']=null;logger[_0x51ac('0xc')](String(_0x51ac('0x2a')));io[_0x51ac('0x20')](_0x51ac('0x2f'),{'output':String(_0x51ac('0x30'))});io['sockets']['emit'](_0x51ac('0x21'),FusionSettings[_0x51ac('0x6')][_0x51ac('0x7')]);io[_0x51ac('0x1f')][_0x51ac('0x20')]('gamepad-available',![]);});}function _0x566829(){if(os[_0x51ac('0x2d')]()!=_0x51ac('0x2e')){setTimeout(function(){var _0xeecfe5=shell[_0x51ac('0x31')](_0x51ac('0x32'),{'silent':!![]})[_0x51ac('0x22')];if(!_0xeecfe5)FusionSettings[_0x51ac('0x6')]['fusion_gamepad_available']=![];else FusionSettings['SocketVariables'][_0x51ac('0x33')]=!![];io[_0x51ac('0x1f')]['emit'](_0x51ac('0x28'),FusionSettings[_0x51ac('0x6')][_0x51ac('0x33')]);},0x3e8);}}return _0x24ae61;}();