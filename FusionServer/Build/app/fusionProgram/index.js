const _0x29b1=['StartBlocklyProgram','lastIndexOf','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','import\x20imp\x0a','close','python','child_process','No\x20Program\x20Running','shelljs','Blockly\x20Program\x20is\x20now\x20running','emit','blockly-console-output','pipe','verbose','KillProgram','SocketVariables','kill','console-output','Cannot\x20stop\x20another\x20user\x20program','fusion_program_running','win32','Program\x20Successfully\x20Stopped','Program\x20already\x20running','../global/fusionSettings','substring','SocketId','stderr','program-running','StartProgram','resolve','os.chdir(\x27./app/filesystem/','../utils/logger','No\x20program\x20running','platform','stdout','autonomous','stdin','path','gamepad-available','SIGINT','fusion_gamepad_available','Program\x20is\x20now\x20stopped','sockets','/Editor\x27)\x0a','exec','Program\x20is\x20now\x20running','data','import\x20os\x0a','>\x20Program\x20Finished!\x0a','User','sendInput'];(function(_0x165d33,_0x29b138){const _0x44d4c3=function(_0x4630d4){while(--_0x4630d4){_0x165d33['push'](_0x165d33['shift']());}};_0x44d4c3(++_0x29b138);}(_0x29b1,0xc2));const _0x44d4=function(_0x165d33,_0x29b138){_0x165d33=_0x165d33-0x0;let _0x44d4c3=_0x29b1[_0x165d33];return _0x44d4c3;};const logger=require(_0x44d4('0x29'));const io=require('../socket');const FusionSettings=require(_0x44d4('0x21'));const spawn=require(_0x44d4('0x10'))['spawn'];const shell=require(_0x44d4('0x12'));const os=require('os');const path=require(_0x44d4('0x2f'));let python_process=null;module['exports']=function(){var _0x3b33bf=function(){};_0x3b33bf[_0x44d4('0x26')]=function(_0x28af8b,_0x3c731b,_0x379649){if(!FusionSettings['SocketVariables'][_0x44d4('0x1d')]){FusionSettings[_0x44d4('0x19')]['fusion_program_running']={'Code':null,'Program':_0x3c731b,'SocketId':_0x379649,'User':_0x28af8b};_0x1e63a9(_0x3c731b,_0x28af8b);logger['verbose'](_0x44d4('0x4'));return{'status':0xc8,'message':'Program\x20is\x20now\x20running'};}else{if(FusionSettings['SocketVariables'][_0x44d4('0x1d')][_0x44d4('0x8')]==_0x28af8b||FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]['SocketId']==_0x44d4('0x2d')){try{python_process[_0x44d4('0x1a')](_0x44d4('0x31'));}catch(_0x497961){}FusionSettings['SocketVariables'][_0x44d4('0x1d')]={'Code':null,'Program':_0x3c731b,'SocketId':_0x379649,'User':_0x28af8b};_0x1e63a9(_0x3c731b,_0x28af8b);logger[_0x44d4('0x17')](_0x44d4('0x4'));return{'status':0xc8,'message':'Program\x20is\x20now\x20running'};}else{logger[_0x44d4('0x17')]('Program\x20already\x20running');return{'status':0x1f4,'message':_0x44d4('0x20')};}}};_0x3b33bf['StopProgram']=function(_0x41bd6e){if(FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]){if(FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]['User']==_0x41bd6e||FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')][_0x44d4('0x23')]==_0x44d4('0x2d')){FusionSettings['SocketVariables'][_0x44d4('0x1d')]=null;try{python_process[_0x44d4('0x1a')](_0x44d4('0x31'));}catch(_0x6419b4){}logger[_0x44d4('0x17')](_0x44d4('0x0'));return{'status':0xc8,'message':_0x44d4('0x1f')};}else{logger[_0x44d4('0x17')](_0x44d4('0x1c'));return{'status':0x1f4,'message':'Cannot\x20stop\x20another\x20user\x27s\x20program.'};}}else{logger['verbose'](_0x44d4('0x2a'));return{'status':0x1f4,'message':_0x44d4('0x11')};}};_0x3b33bf[_0x44d4('0x18')]=function(){FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]=null;try{python_process[_0x44d4('0x1a')](_0x44d4('0x31'));}catch(_0xe6179d){}logger['verbose'](_0x44d4('0x0'));};_0x3b33bf[_0x44d4('0xa')]=function(_0x5e9741,_0x15673e,_0x28f596){if(!FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]){FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]={'Code':_0x5e9741,'Program':null,'SocketId':_0x28f596,'User':_0x15673e};_0x53db16(_0x5e9741,_0x15673e);logger[_0x44d4('0x17')]('Blockly\x20Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x44d4('0x13')};}else{if(FusionSettings[_0x44d4('0x19')]['fusion_program_running'][_0x44d4('0x8')]==_0x15673e||FusionSettings[_0x44d4('0x19')]['fusion_program_running'][_0x44d4('0x23')]==_0x44d4('0x2d')){try{python_process[_0x44d4('0x1a')]('SIGINT');}catch(_0x315012){}FusionSettings['SocketVariables'][_0x44d4('0x1d')]={'Code':_0x5e9741,'Program':null,'SocketId':_0x28f596,'User':_0x15673e};_0x53db16(_0x5e9741,_0x15673e);logger[_0x44d4('0x17')](_0x44d4('0x13'));return{'status':0xc8,'message':_0x44d4('0x13')};}else{logger[_0x44d4('0x17')]('Program\x20already\x20running');return{'status':0x1f4,'message':_0x44d4('0x20')};}}};_0x3b33bf[_0x44d4('0x9')]=function(_0x13c6ef){python_process[_0x44d4('0x2e')]['write'](_0x13c6ef+'\x0a');};function _0x1e63a9(_0x4db15e,_0x439cc4){let _0x32d812=_0x44d4('0x6')+(_0x44d4('0x28')+_0x439cc4+_0x44d4('0x2'))+_0x44d4('0xd')+('imp.load_source(\x27util\x27,\x20r\x27'+path[_0x44d4('0x27')](_0x4db15e)+'\x27)');python_process=spawn(_0x44d4('0xf'),['-u','-B','-c',_0x32d812],{'stdio':_0x44d4('0x16')});io['sockets'][_0x44d4('0x14')](_0x44d4('0x25'),FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]);_0xde7622();python_process['stdout']['on']('data',function(_0x39fd73){logger[_0x44d4('0x17')](String(_0x39fd73)['substring'](0x0,_0x39fd73[_0x44d4('0xb')]('\x0a')));io['emit'](_0x44d4('0x1b'),{'output':String(_0x39fd73)});});python_process[_0x44d4('0x24')]['on'](_0x44d4('0x5'),function(_0x281078){logger[_0x44d4('0x17')](String(_0x281078)[_0x44d4('0x22')](0x0,_0x281078['lastIndexOf']('\x0a')));io[_0x44d4('0x14')](_0x44d4('0x1b'),{'output':String(_0x281078)});io[_0x44d4('0x1')][_0x44d4('0x14')]('program-running',FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]);io[_0x44d4('0x1')]['emit'](_0x44d4('0x30'),![]);});python_process[_0x44d4('0x2c')]['on']('close',function(_0x39afc0){FusionSettings['SocketVariables']['fusion_program_running']=null;logger[_0x44d4('0x17')](String('>\x20Program\x20Finished!'));io[_0x44d4('0x14')](_0x44d4('0x1b'),{'output':String(_0x44d4('0x7'))});io['sockets'][_0x44d4('0x14')]('program-running',FusionSettings[_0x44d4('0x19')]['fusion_program_running']);io[_0x44d4('0x1')][_0x44d4('0x14')](_0x44d4('0x30'),![]);});}function _0x53db16(_0x1ed8dc,_0x3c1a4f){let _0x2362e5=_0x44d4('0x6')+('os.chdir(\x27./app/filesystem/'+_0x3c1a4f+'/Blockly\x27)\x0a')+_0x44d4('0xd')+(''+_0x1ed8dc);if(os[_0x44d4('0x2b')]()!='win32'){python_process=spawn(_0x44d4('0xf'),['-u','-B','-c',_0x2362e5],{'stdio':_0x44d4('0x16')});}else{python_process=spawn('python',['-u','-B','-c',_0x2362e5],{'stdio':'pipe'});}io[_0x44d4('0x1')][_0x44d4('0x14')](_0x44d4('0x25'),FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]);_0xde7622();python_process['stdout']['on'](_0x44d4('0x5'),function(_0x4fe3b8){logger[_0x44d4('0x17')](String(_0x4fe3b8)[_0x44d4('0x22')](0x0,_0x4fe3b8[_0x44d4('0xb')]('\x0a')));io[_0x44d4('0x14')](_0x44d4('0x15'),{'output':String(_0x4fe3b8)});});python_process[_0x44d4('0x24')]['on'](_0x44d4('0x5'),function(_0x456344){logger[_0x44d4('0x17')](String(_0x456344)[_0x44d4('0x22')](0x0,_0x456344[_0x44d4('0xb')]('\x0a')));io[_0x44d4('0x14')](_0x44d4('0x15'),{'output':String(_0x456344)});io['sockets'][_0x44d4('0x14')](_0x44d4('0x25'),FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]);io[_0x44d4('0x1')]['emit'](_0x44d4('0x30'),![]);});python_process[_0x44d4('0x2c')]['on'](_0x44d4('0xe'),function(_0x39b7d4){FusionSettings[_0x44d4('0x19')][_0x44d4('0x1d')]=null;logger[_0x44d4('0x17')](String('>\x20Program\x20Finished!'));io[_0x44d4('0x14')](_0x44d4('0x15'),{'output':String(_0x44d4('0x7'))});io['sockets'][_0x44d4('0x14')](_0x44d4('0x25'),FusionSettings['SocketVariables'][_0x44d4('0x1d')]);io[_0x44d4('0x1')][_0x44d4('0x14')](_0x44d4('0x30'),![]);});}function _0xde7622(){if(os[_0x44d4('0x2b')]()!=_0x44d4('0x1e')){setTimeout(function(){var _0x5143b4=shell[_0x44d4('0x3')](_0x44d4('0xc'),{'silent':!![]})['stdout'];if(!_0x5143b4)FusionSettings[_0x44d4('0x19')][_0x44d4('0x32')]=![];else FusionSettings[_0x44d4('0x19')]['fusion_gamepad_available']=!![];io[_0x44d4('0x1')][_0x44d4('0x14')](_0x44d4('0x30'),FusionSettings['SocketVariables']['fusion_gamepad_available']);},0x3e8);}}return _0x3b33bf;}();