const _0x27bd=['substring','win32','kill','pipe','Cannot\x20stop\x20another\x20user\x27s\x20program.','stderr','imp.load_source(\x27util\x27,\x20r\x27','Blockly\x20Program\x20is\x20now\x20running','fusion_gamepad_available','resolve','sockets','>\x20Program\x20Finished!','path','gamepad-available','verbose','SIGINT','data','../global/fusionSettings','write','Program\x20is\x20now\x20running','program-running','autonomous','console-output','sendInput','stdin','SocketId','SocketVariables','Program\x20already\x20running','No\x20program\x20running','child_process','lastIndexOf','import\x20os\x0a','StartProgram','fusion_program_running','spawn','emit','No\x20Program\x20Running','Program\x20is\x20now\x20stopped','KillProgram','/Editor\x27)\x0a','StartBlocklyProgram','/Blockly\x27)\x0a','os.chdir(\x27./app/filesystem/','stdout','close','../socket','Program\x20Successfully\x20Stopped','>\x20Program\x20Finished!\x0a','platform','blockly-console-output','StopProgram','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','shelljs','python','User'];(function(_0x1f0fc8,_0x27bddf){const _0x4016de=function(_0x4df974){while(--_0x4df974){_0x1f0fc8['push'](_0x1f0fc8['shift']());}};_0x4016de(++_0x27bddf);}(_0x27bd,0xe6));const _0x4016=function(_0x1f0fc8,_0x27bddf){_0x1f0fc8=_0x1f0fc8-0x0;let _0x4016de=_0x27bd[_0x1f0fc8];return _0x4016de;};const logger=require('../utils/logger');const io=require(_0x4016('0x23'));const FusionSettings=require(_0x4016('0x7'));const spawn=require(_0x4016('0x13'))[_0x4016('0x18')];const shell=require(_0x4016('0x2a'));const os=require('os');const path=require(_0x4016('0x2'));let python_process=null;module['exports']=function(){var _0x4ee5b5=function(){};_0x4ee5b5[_0x4016('0x16')]=function(_0x43cd57,_0x336185,_0x12aaad){if(!FusionSettings[_0x4016('0x10')][_0x4016('0x17')]){FusionSettings[_0x4016('0x10')][_0x4016('0x17')]={'Code':null,'Program':_0x336185,'SocketId':_0x12aaad,'User':_0x43cd57};_0x31d1cf(_0x336185,_0x43cd57);logger[_0x4016('0x4')]('Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x4016('0x9')};}else{if(FusionSettings[_0x4016('0x10')][_0x4016('0x17')][_0x4016('0x2c')]==_0x43cd57||FusionSettings[_0x4016('0x10')][_0x4016('0x17')][_0x4016('0xf')]==_0x4016('0xb')){try{python_process['kill'](_0x4016('0x5'));}catch(_0x2f80bf){}FusionSettings['SocketVariables']['fusion_program_running']={'Code':null,'Program':_0x336185,'SocketId':_0x12aaad,'User':_0x43cd57};_0x31d1cf(_0x336185,_0x43cd57);logger[_0x4016('0x4')](_0x4016('0x9'));return{'status':0xc8,'message':'Program\x20is\x20now\x20running'};}else{logger[_0x4016('0x4')](_0x4016('0x11'));return{'status':0x1f4,'message':_0x4016('0x11')};}}};_0x4ee5b5[_0x4016('0x28')]=function(_0x36d2e3){if(FusionSettings[_0x4016('0x10')][_0x4016('0x17')]){if(FusionSettings[_0x4016('0x10')][_0x4016('0x17')]['User']==_0x36d2e3||FusionSettings[_0x4016('0x10')]['fusion_program_running'][_0x4016('0xf')]==_0x4016('0xb')){FusionSettings[_0x4016('0x10')][_0x4016('0x17')]=null;try{python_process[_0x4016('0x2f')](_0x4016('0x5'));}catch(_0x2aa22b){}logger[_0x4016('0x4')](_0x4016('0x1b'));return{'status':0xc8,'message':_0x4016('0x24')};}else{logger[_0x4016('0x4')]('Cannot\x20stop\x20another\x20user\x20program');return{'status':0x1f4,'message':_0x4016('0x31')};}}else{logger['verbose'](_0x4016('0x12'));return{'status':0x1f4,'message':_0x4016('0x1a')};}};_0x4ee5b5[_0x4016('0x1c')]=function(){FusionSettings['SocketVariables'][_0x4016('0x17')]=null;try{python_process[_0x4016('0x2f')](_0x4016('0x5'));}catch(_0x4f3601){}logger[_0x4016('0x4')](_0x4016('0x1b'));};_0x4ee5b5[_0x4016('0x1e')]=function(_0x22f8e5,_0x22db18,_0x19d205){if(!FusionSettings['SocketVariables']['fusion_program_running']){FusionSettings['SocketVariables'][_0x4016('0x17')]={'Code':_0x22f8e5,'Program':null,'SocketId':_0x19d205,'User':_0x22db18};_0x15e198(_0x22f8e5,_0x22db18);logger[_0x4016('0x4')](_0x4016('0x34'));return{'status':0xc8,'message':'Blockly\x20Program\x20is\x20now\x20running'};}else{if(FusionSettings[_0x4016('0x10')][_0x4016('0x17')][_0x4016('0x2c')]==_0x22db18||FusionSettings['SocketVariables'][_0x4016('0x17')][_0x4016('0xf')]=='autonomous'){try{python_process['kill'](_0x4016('0x5'));}catch(_0x4b728c){}FusionSettings[_0x4016('0x10')]['fusion_program_running']={'Code':_0x22f8e5,'Program':null,'SocketId':_0x19d205,'User':_0x22db18};_0x15e198(_0x22f8e5,_0x22db18);logger[_0x4016('0x4')]('Blockly\x20Program\x20is\x20now\x20running');return{'status':0xc8,'message':_0x4016('0x34')};}else{logger[_0x4016('0x4')](_0x4016('0x11'));return{'status':0x1f4,'message':'Program\x20already\x20running'};}}};_0x4ee5b5[_0x4016('0xd')]=function(_0x42cf6c){python_process[_0x4016('0xe')][_0x4016('0x8')](_0x42cf6c+'\x0a');};function _0x31d1cf(_0x26e947,_0x2458a4){let _0x41ff32=_0x4016('0x15')+(_0x4016('0x20')+_0x2458a4+_0x4016('0x1d'))+'import\x20imp\x0a'+(_0x4016('0x33')+path[_0x4016('0x36')](_0x26e947)+'\x27)');python_process=spawn('python',['-u','-B','-c',_0x41ff32],{'stdio':_0x4016('0x30')});io['sockets'][_0x4016('0x19')]('program-running',FusionSettings[_0x4016('0x10')][_0x4016('0x17')]);_0x48d490();python_process[_0x4016('0x21')]['on']('data',function(_0x11672c){logger[_0x4016('0x4')](String(_0x11672c)['substring'](0x0,_0x11672c[_0x4016('0x14')]('\x0a')));io[_0x4016('0x19')](_0x4016('0xc'),{'output':String(_0x11672c)});});python_process['stderr']['on']('data',function(_0x1d2f07){logger[_0x4016('0x4')](String(_0x1d2f07)[_0x4016('0x2d')](0x0,_0x1d2f07[_0x4016('0x14')]('\x0a')));io['emit'](_0x4016('0xc'),{'output':String(_0x1d2f07)});io['sockets']['emit'](_0x4016('0xa'),FusionSettings[_0x4016('0x10')]['fusion_program_running']);io[_0x4016('0x0')][_0x4016('0x19')](_0x4016('0x3'),![]);});python_process[_0x4016('0x21')]['on'](_0x4016('0x22'),function(_0xb214f8){FusionSettings['SocketVariables'][_0x4016('0x17')]=null;logger['verbose'](String(_0x4016('0x1')));io[_0x4016('0x19')](_0x4016('0xc'),{'output':String(_0x4016('0x25'))});io['sockets']['emit']('program-running',FusionSettings[_0x4016('0x10')][_0x4016('0x17')]);io['sockets'][_0x4016('0x19')]('gamepad-available',![]);});}function _0x15e198(_0x2eac18,_0x195f2d){let _0x564cc3=_0x4016('0x15')+(_0x4016('0x20')+_0x195f2d+_0x4016('0x1f'))+'import\x20imp\x0a'+(''+_0x2eac18);if(os[_0x4016('0x26')]()!=_0x4016('0x2e')){python_process=spawn(_0x4016('0x2b'),['-u','-B','-c',_0x564cc3],{'stdio':_0x4016('0x30')});}else{python_process=spawn(_0x4016('0x2b'),['-u','-B','-c',_0x564cc3],{'stdio':_0x4016('0x30')});}io[_0x4016('0x0')][_0x4016('0x19')]('program-running',FusionSettings['SocketVariables'][_0x4016('0x17')]);_0x48d490();python_process[_0x4016('0x21')]['on'](_0x4016('0x6'),function(_0x4a014a){logger[_0x4016('0x4')](String(_0x4a014a)[_0x4016('0x2d')](0x0,_0x4a014a[_0x4016('0x14')]('\x0a')));io[_0x4016('0x19')]('blockly-console-output',{'output':String(_0x4a014a)});});python_process[_0x4016('0x32')]['on'](_0x4016('0x6'),function(_0x234ee5){logger[_0x4016('0x4')](String(_0x234ee5)[_0x4016('0x2d')](0x0,_0x234ee5[_0x4016('0x14')]('\x0a')));io[_0x4016('0x19')](_0x4016('0x27'),{'output':String(_0x234ee5)});io['sockets']['emit'](_0x4016('0xa'),FusionSettings['SocketVariables'][_0x4016('0x17')]);io[_0x4016('0x0')][_0x4016('0x19')](_0x4016('0x3'),![]);});python_process[_0x4016('0x21')]['on'](_0x4016('0x22'),function(_0x5aa744){FusionSettings[_0x4016('0x10')][_0x4016('0x17')]=null;logger['verbose'](String(_0x4016('0x1')));io[_0x4016('0x19')](_0x4016('0x27'),{'output':String(_0x4016('0x25'))});io[_0x4016('0x0')]['emit'](_0x4016('0xa'),FusionSettings[_0x4016('0x10')][_0x4016('0x17')]);io['sockets'][_0x4016('0x19')]('gamepad-available',![]);});}function _0x48d490(){if(os['platform']()!=_0x4016('0x2e')){setTimeout(function(){var _0x164d80=shell['exec'](_0x4016('0x29'),{'silent':!![]})[_0x4016('0x21')];if(!_0x164d80)FusionSettings[_0x4016('0x10')]['fusion_gamepad_available']=![];else FusionSettings[_0x4016('0x10')][_0x4016('0x35')]=!![];io[_0x4016('0x0')][_0x4016('0x19')](_0x4016('0x3'),FusionSettings[_0x4016('0x10')]['fusion_gamepad_available']);},0x3e8);}}return _0x4ee5b5;}();