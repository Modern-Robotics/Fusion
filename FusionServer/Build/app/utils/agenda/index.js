!function(){const e=require("./../logger"),a=new(require("agenda"))({mongo:require("mongoose").connection.db}),t=require("./../../events"),r=require("config"),n=require("./../battery"),i=(require("./../wireless"),require("./../software")),s=require("./../gamepad"),c=require("./../diagnostic"),o=require("../program"),g=require("./../network");!async function(){try{await a.purge(),a.define("checkSystemStatus",(async a=>{let i={battery:await n.getBatteryLevel(),ethernet:await g.filterByType(r.get("Wire_NET"),"IPv4"),internet:await g.hasInternetAccess(),program:await o.getRunningProgram()};e.debug(JSON.stringify(i)),t.emit("system-status-update",i)})),a.every("15 seconds","checkSystemStatus"),a.define("scanUpdate",(async e=>{await i.getUpdateAvailable()})),a.every("60 minutes","scanUpdate"),a.define("scanGamepad",(async e=>{await s.getIsGamepadAvailable()})),a.every("15 seconds","scanGamepad"),a.define("scanDiagnostics",(async e=>{await c.getIsDiagnosticRunning()})),a.every("15 seconds","scanDiagnostics"),a.start()}catch(a){e.error(a)}}(),module.exports=a}();