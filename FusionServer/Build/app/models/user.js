!function(){let e=require("mongoose"),r=require("bcrypt-nodejs"),t=require("fs-extra"),i=require("rimraf");const n=require("./../utils/logger");let s=e.Schema({username:{type:String,required:!0,lowercase:!0,trim:!0},password:{type:String,required:!0},firstname:String,lastname:String,language:String,email:String,defaultprogramminglanguage:String,filepath:{type:String,required:!0},securityquestion:{type:String,required:!0},securityanswer:{type:String,required:!0},usergroup:{type:String,required:!0}});s.methods.generateHash=function(e){return r.hashSync(e,r.genSaltSync(8),null)},s.methods.validPassword=function(e){return r.compareSync(e,this.password)},s.methods.validSecurityAnswer=function(e){return this.securityanswer==e},s.methods.generateFileSystem=function(e){return new Promise((async function(r,i){var s="app/filesystem/"+e;try{return await t.mkdirp(s),await t.mkdirp(s+"/Editor"),await t.mkdirp(s+"/Blockly"),r(s)}catch(e){return n.error("Error creating file system for user: "+e),i(e)}}))},s.statics.removeFileSystem=function(e){i("app/filesystem/"+e,(function(){n.info("Finished Deleting User Directory")}))},module.exports=e.model("User",s)}();