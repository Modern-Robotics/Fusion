var _0x5832=['user','exports','stderr','Restore\x20Finished!','status','/api/cookie','replace','child_process','/api/fusion/releaseNotes','scripts/updateFusion.sh','../../socket','/api/fusion/update','stdout','isAuthenticated','send','Error\x20Reading\x20changelog','scripts/restoreFusion.sh','User\x20Unauthenticated','Update\x20starting','json','split','Restore\x20starting','get','pipe','join','bash','--no-merges','close','update-output','Update\x20Finished!','log','sudo','info','spawn','git','length','--date=short','data','emit'];(function(_0x11ae00,_0x5832ca){var _0x1282c4=function(_0x5e917e){while(--_0x5e917e){_0x11ae00['push'](_0x11ae00['shift']());}};_0x1282c4(++_0x5832ca);}(_0x5832,0x68));var _0x1282=function(_0x11ae00,_0x5832ca){_0x11ae00=_0x11ae00-0x0;var _0x1282c4=_0x5832[_0x11ae00];return _0x1282c4;};const logger=require('../../utils/logger');const app=require('../../express');const io=require(_0x1282('0x17'));module[_0x1282('0xe')]=function(){app[_0x1282('0x23')](_0x1282('0x18'),_0x1443b0(),function(_0x2c215d,_0x324acb){try{var _0x2c3fb4=require(_0x1282('0x14'))[_0x1282('0x7')];var _0x459ac8=_0x1282('0x16');var _0x39eb16=_0x2c3fb4(_0x1282('0x5'),[_0x1282('0x26'),_0x459ac8],{'stdio':'pipe'});_0x39eb16['stdout']['on']('data',function(_0x366c28){logger[_0x1282('0x6')](String(_0x366c28));io[_0x1282('0xc')](_0x1282('0x2'),{'output':String(_0x366c28)});});_0x39eb16[_0x1282('0xf')]['on'](_0x1282('0xb'),function(_0xa42554){logger[_0x1282('0x6')](String(_0xa42554));io[_0x1282('0xc')](_0x1282('0x2'),{'output':String(_0xa42554)});});_0x39eb16[_0x1282('0x19')]['on'](_0x1282('0x1'),function(_0x305780){logger[_0x1282('0x6')](String(_0x1282('0x3')));});}catch(_0x2b7a2f){logger['info'](_0x2b7a2f);}_0x324acb[_0x1282('0x11')](0xc8)[_0x1282('0x1b')](_0x1282('0x1f'));});app[_0x1282('0x23')]('/api/fusion/restore',_0x1443b0(),function(_0x40efd3,_0x2657dd){try{var _0x12b305=require(_0x1282('0x14'))[_0x1282('0x7')];var _0x3109d8=_0x1282('0x1d');var _0x257ca3=_0x12b305(_0x1282('0x5'),[_0x1282('0x26'),_0x3109d8],{'stdio':_0x1282('0x24')});_0x257ca3[_0x1282('0x19')]['on'](_0x1282('0xb'),function(_0x50ce14){logger['info'](String(_0x50ce14));io[_0x1282('0xc')](_0x1282('0x2'),{'output':String(_0x50ce14)});});_0x257ca3[_0x1282('0xf')]['on'](_0x1282('0xb'),function(_0x20da83){logger['info'](String(_0x20da83));io[_0x1282('0xc')](_0x1282('0x2'),{'output':String(_0x20da83)});});_0x257ca3[_0x1282('0x19')]['on'](_0x1282('0x1'),function(_0x42008e){logger[_0x1282('0x6')](String(_0x1282('0x10')));});}catch(_0x7608ad){logger[_0x1282('0x6')](_0x7608ad);}_0x2657dd[_0x1282('0x11')](0xc8)[_0x1282('0x1b')](_0x1282('0x22'));});app['get'](_0x1282('0x15'),function(_0x4b6da6,_0x4fb2b9){var _0x14ef7d=require(_0x1282('0x14'))[_0x1282('0x7')];var _0x2cd87d='';var _0x58c4a8=!![];var _0x123c49=_0x14ef7d(_0x1282('0x8'),[_0x1282('0x4'),'--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22',_0x1282('0xa'),_0x1282('0x0')],{'stdio':_0x1282('0x24')});_0x123c49[_0x1282('0x19')]['on'](_0x1282('0xb'),function(_0x3cb738){_0x2cd87d+=_0x3cb738+'\x0a';});_0x123c49[_0x1282('0xf')]['on'](_0x1282('0xb'),function(_0x4207e5){logger['info'](String(_0x4207e5));_0x58c4a8=![];});_0x123c49[_0x1282('0x19')]['on'](_0x1282('0x1'),function(_0x1c071b){var _0x228232=_0x2cd87d[_0x1282('0x21')]('\x0a\x0a');for(var _0x3ad6aa=0x0;_0x3ad6aa<_0x228232[_0x1282('0x9')];_0x3ad6aa++){_0x228232[_0x3ad6aa]=_0x228232[_0x3ad6aa][_0x1282('0x13')](/"/g,'');}_0x2cd87d=_0x228232[_0x1282('0x25')]('\x0a');if(_0x58c4a8)_0x4fb2b9[_0x1282('0x11')](0xc8)[_0x1282('0x20')]({'data':_0x2cd87d});else _0x4fb2b9[_0x1282('0x11')](0x1f4)[_0x1282('0x1b')](_0x1282('0x1c'));});});app[_0x1282('0x23')](_0x1282('0x12'),_0x1443b0(),function(_0x42a980,_0x32510a){_0x32510a[_0x1282('0x11')](0xc8)[_0x1282('0x1b')](_0x42a980[_0x1282('0xd')]);});function _0x1443b0(){return function(_0x4527f7,_0x1eff60,_0x55c497){if(_0x4527f7[_0x1282('0x1a')]()){return _0x55c497();}else{_0x1eff60[_0x1282('0x11')](0x191)[_0x1282('0x1b')](_0x1282('0x1e'));}};}}();