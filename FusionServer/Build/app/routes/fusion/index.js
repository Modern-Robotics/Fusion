var _0xf018=['git','Restore\x20Finished!','close','json','User\x20Unauthenticated','bash','isAuthenticated','spawn','scripts/restoreFusion.sh','sudo','status','get','child_process','/api/fusion/restore','update-output','Update\x20starting','send','scripts/updateFusion.sh','stderr','--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22','exports','--date=short','replace','../../utils/logger','split','data','length','stdout','../../socket','pipe','user','Restore\x20starting','log','info','emit'];(function(_0x19e7b1,_0xf0185){var _0x185a03=function(_0x54e93c){while(--_0x54e93c){_0x19e7b1['push'](_0x19e7b1['shift']());}};_0x185a03(++_0xf0185);}(_0xf018,0xd0));var _0x185a=function(_0x19e7b1,_0xf0185){_0x19e7b1=_0x19e7b1-0x0;var _0x185a03=_0xf018[_0x19e7b1];return _0x185a03;};const logger=require(_0x185a('0x19'));const app=require('../../express');const io=require(_0x185a('0x1e'));module[_0x185a('0x16')]=function(){app[_0x185a('0xd')]('/api/fusion/update',_0x3488ac(),function(_0x32e533,_0x3f1041){try{var _0x327f08=require('child_process')['spawn'];var _0x3e84c7=_0x185a('0x13');var _0x1b379d=_0x327f08(_0x185a('0xb'),['bash',_0x3e84c7],{'stdio':'pipe'});_0x1b379d['stdout']['on'](_0x185a('0x1b'),function(_0x4f8a5b){logger[_0x185a('0x0')](String(_0x4f8a5b));io[_0x185a('0x1')](_0x185a('0x10'),{'output':String(_0x4f8a5b)});});_0x1b379d[_0x185a('0x14')]['on'](_0x185a('0x1b'),function(_0x3be2df){logger[_0x185a('0x0')](String(_0x3be2df));io[_0x185a('0x1')](_0x185a('0x10'),{'output':String(_0x3be2df)});});_0x1b379d['stdout']['on'](_0x185a('0x4'),function(_0x1e2452){logger[_0x185a('0x0')](String('Update\x20Finished!'));});}catch(_0x46b58e){logger[_0x185a('0x0')](_0x46b58e);}_0x3f1041[_0x185a('0xc')](0xc8)['send'](_0x185a('0x11'));});app[_0x185a('0xd')](_0x185a('0xf'),_0x3488ac(),function(_0x5befc8,_0x3416dc){try{var _0x48a7c8=require(_0x185a('0xe'))[_0x185a('0x9')];var _0x431259=_0x185a('0xa');var _0x31ac5b=_0x48a7c8('sudo',[_0x185a('0x7'),_0x431259],{'stdio':_0x185a('0x1f')});_0x31ac5b[_0x185a('0x1d')]['on'](_0x185a('0x1b'),function(_0x4e3659){logger['info'](String(_0x4e3659));io[_0x185a('0x1')]('update-output',{'output':String(_0x4e3659)});});_0x31ac5b['stderr']['on']('data',function(_0x523211){logger['info'](String(_0x523211));io[_0x185a('0x1')]('update-output',{'output':String(_0x523211)});});_0x31ac5b[_0x185a('0x1d')]['on'](_0x185a('0x4'),function(_0x18da5a){logger['info'](String(_0x185a('0x3')));});}catch(_0x32b3f1){logger[_0x185a('0x0')](_0x32b3f1);}_0x3416dc[_0x185a('0xc')](0xc8)[_0x185a('0x12')](_0x185a('0x21'));});app[_0x185a('0xd')]('/api/fusion/releaseNotes',function(_0x288959,_0x438f58){var _0x3d0019=require(_0x185a('0xe'))['spawn'];var _0x309a5c='';var _0x5628d1=!![];var _0x315f15=_0x3d0019(_0x185a('0x2'),[_0x185a('0x22'),_0x185a('0x15'),_0x185a('0x17'),'--no-merges'],{'stdio':_0x185a('0x1f')});_0x315f15['stdout']['on'](_0x185a('0x1b'),function(_0x4c9e7f){_0x309a5c+=_0x4c9e7f+'\x0a';});_0x315f15[_0x185a('0x14')]['on']('data',function(_0x307c40){logger['info'](String(_0x307c40));_0x5628d1=![];});_0x315f15['stdout']['on']('close',function(_0x4f9388){var _0x5f584f=_0x309a5c[_0x185a('0x1a')]('\x0a\x0a');for(var _0x5cee28=0x0;_0x5cee28<_0x5f584f[_0x185a('0x1c')];_0x5cee28++){_0x5f584f[_0x5cee28]=_0x5f584f[_0x5cee28][_0x185a('0x18')](/"/g,'');}_0x309a5c=_0x5f584f['join']('\x0a');if(_0x5628d1)_0x438f58[_0x185a('0xc')](0xc8)[_0x185a('0x5')]({'data':_0x309a5c});else _0x438f58[_0x185a('0xc')](0x1f4)[_0x185a('0x12')]('Error\x20Reading\x20changelog');});});app[_0x185a('0xd')]('/api/cookie',_0x3488ac(),function(_0x4b51f6,_0x49c691){_0x49c691[_0x185a('0xc')](0xc8)['send'](_0x4b51f6[_0x185a('0x20')]);});function _0x3488ac(){return function(_0x4f2ef5,_0x144c8b,_0x5cd48f){if(_0x4f2ef5[_0x185a('0x8')]()){return _0x5cd48f();}else{_0x144c8b[_0x185a('0xc')](0x191)[_0x185a('0x12')](_0x185a('0x6'));}};}}();