var _0x228d=['emit','--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22','git','Update\x20starting','--date=short','isAuthenticated','get','../../socket','info','stderr','../../utils/logger','status','scripts/restoreFusion.sh','split','join','close','json','replace','sudo','stdout','/api/fusion/update','bash','update-output','Restore\x20Finished!','User\x20Unauthenticated','child_process','data','spawn','--no-merges','send','Error\x20Reading\x20changelog','/api/fusion/releaseNotes'];(function(_0x35d898,_0x228ded){var _0x582c3e=function(_0x404509){while(--_0x404509){_0x35d898['push'](_0x35d898['shift']());}};_0x582c3e(++_0x228ded);}(_0x228d,0x146));var _0x582c=function(_0x35d898,_0x228ded){_0x35d898=_0x35d898-0x0;var _0x582c3e=_0x228d[_0x35d898];return _0x582c3e;};const logger=require(_0x582c('0x4'));const app=require('../../express');const io=require(_0x582c('0x1'));module['exports']=function(){app[_0x582c('0x0')](_0x582c('0xe'),_0x2cc3eb(),function(_0x1a5370,_0x57f9d2){try{var _0x194ba4=require(_0x582c('0x13'))[_0x582c('0x15')];var _0x2f6038='scripts/updateFusion.sh';var _0x2fc0d1=_0x194ba4(_0x582c('0xc'),[_0x582c('0xf'),_0x2f6038],{'stdio':'pipe'});_0x2fc0d1[_0x582c('0xd')]['on'](_0x582c('0x14'),function(_0x595911){logger[_0x582c('0x2')](String(_0x595911));io[_0x582c('0x1a')](_0x582c('0x10'),{'output':String(_0x595911)});});_0x2fc0d1['stderr']['on'](_0x582c('0x14'),function(_0x483438){logger[_0x582c('0x2')](String(_0x483438));io[_0x582c('0x1a')]('update-output',{'output':String(_0x483438)});});_0x2fc0d1['stdout']['on'](_0x582c('0x9'),function(_0x3a9bdf){logger[_0x582c('0x2')](String('Update\x20Finished!'));});}catch(_0x31a2c4){logger[_0x582c('0x2')](_0x31a2c4);}_0x57f9d2['status'](0xc8)[_0x582c('0x17')](_0x582c('0x1d'));});app['get']('/api/fusion/restore',_0x2cc3eb(),function(_0x245df5,_0x5134c1){try{var _0x53974e=require(_0x582c('0x13'))[_0x582c('0x15')];var _0x76aa14=_0x582c('0x6');var _0x6d5608=_0x53974e('sudo',[_0x582c('0xf'),_0x76aa14],{'stdio':'pipe'});_0x6d5608[_0x582c('0xd')]['on'](_0x582c('0x14'),function(_0x2fc3f0){logger[_0x582c('0x2')](String(_0x2fc3f0));io['emit']('update-output',{'output':String(_0x2fc3f0)});});_0x6d5608[_0x582c('0x3')]['on'](_0x582c('0x14'),function(_0x2f997e){logger[_0x582c('0x2')](String(_0x2f997e));io['emit'](_0x582c('0x10'),{'output':String(_0x2f997e)});});_0x6d5608[_0x582c('0xd')]['on'](_0x582c('0x9'),function(_0x4f86f9){logger['info'](String(_0x582c('0x11')));});}catch(_0x1b9368){logger[_0x582c('0x2')](_0x1b9368);}_0x5134c1[_0x582c('0x5')](0xc8)[_0x582c('0x17')]('Restore\x20starting');});app[_0x582c('0x0')](_0x582c('0x19'),function(_0x341ec8,_0x208435){var _0x1bf56e=require(_0x582c('0x13'))[_0x582c('0x15')];var _0x482544='';var _0xd6a873=!![];var _0x251152=_0x1bf56e(_0x582c('0x1c'),['log',_0x582c('0x1b'),_0x582c('0x1e'),_0x582c('0x16')],{'stdio':'pipe'});_0x251152[_0x582c('0xd')]['on']('data',function(_0x45b6e2){_0x482544+=_0x45b6e2+'\x0a';});_0x251152[_0x582c('0x3')]['on'](_0x582c('0x14'),function(_0xc505d0){logger['info'](String(_0xc505d0));_0xd6a873=![];});_0x251152[_0x582c('0xd')]['on'](_0x582c('0x9'),function(_0x19bd02){var _0x50c33d=_0x482544[_0x582c('0x7')]('\x0a\x0a');for(var _0x164536=0x0;_0x164536<_0x50c33d['length'];_0x164536++){_0x50c33d[_0x164536]=_0x50c33d[_0x164536][_0x582c('0xb')](/"/g,'');}_0x482544=_0x50c33d[_0x582c('0x8')]('\x0a');if(_0xd6a873)_0x208435[_0x582c('0x5')](0xc8)[_0x582c('0xa')]({'data':_0x482544});else _0x208435[_0x582c('0x5')](0x1f4)[_0x582c('0x17')](_0x582c('0x18'));});});app[_0x582c('0x0')]('/api/cookie',_0x2cc3eb(),function(_0x228f37,_0x124ab3){_0x124ab3[_0x582c('0x5')](0xc8)[_0x582c('0x17')](_0x228f37['user']);});function _0x2cc3eb(){return function(_0x1e3d98,_0x59e202,_0x5842d1){if(_0x1e3d98[_0x582c('0x1f')]()){return _0x5842d1();}else{_0x59e202['status'](0x191)[_0x582c('0x17')](_0x582c('0x12'));}};}}();