var _0x52ee=['../../utils/logger','git','json','status','Update\x20Finished!','get','update-output','--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22','join','scripts/updateFusion.sh','spawn','stdout','bash','--no-merges','Restore\x20Finished!','Error\x20Reading\x20changelog','data','child_process','/api/cookie','isAuthenticated','pipe','/api/fusion/restore','stderr','../../express','emit','info','/api/fusion/update','send','close','/api/fusion/releaseNotes','sudo','exports','user'];(function(_0x2d97f2,_0x52ee4d){var _0x5f5067=function(_0x7d1fed){while(--_0x7d1fed){_0x2d97f2['push'](_0x2d97f2['shift']());}};_0x5f5067(++_0x52ee4d);}(_0x52ee,0x123));var _0x5f50=function(_0x2d97f2,_0x52ee4d){_0x2d97f2=_0x2d97f2-0x0;var _0x5f5067=_0x52ee[_0x2d97f2];return _0x5f5067;};const logger=require(_0x5f50('0x6'));const app=require(_0x5f50('0x1d'));const io=require('../../socket');module[_0x5f50('0x4')]=function(){app[_0x5f50('0xb')](_0x5f50('0x20'),_0x28c2f3(),function(_0x30c527,_0x3c1ae9){try{var _0x14d8c3=require(_0x5f50('0x17'))[_0x5f50('0x10')];var _0x49158a=_0x5f50('0xf');var _0x594b18=_0x14d8c3(_0x5f50('0x3'),[_0x5f50('0x12'),_0x49158a],{'stdio':'pipe'});_0x594b18['stdout']['on'](_0x5f50('0x16'),function(_0x59469b){logger['info'](String(_0x59469b));io[_0x5f50('0x1e')](_0x5f50('0xc'),{'output':String(_0x59469b)});});_0x594b18[_0x5f50('0x1c')]['on']('data',function(_0x16ed23){logger[_0x5f50('0x1f')](String(_0x16ed23));io[_0x5f50('0x1e')](_0x5f50('0xc'),{'output':String(_0x16ed23)});});_0x594b18[_0x5f50('0x11')]['on'](_0x5f50('0x1'),function(_0x2177b0){logger[_0x5f50('0x1f')](String(_0x5f50('0xa')));});}catch(_0x265371){logger[_0x5f50('0x1f')](_0x265371);}_0x3c1ae9['status'](0xc8)['send']('Update\x20starting');});app[_0x5f50('0xb')](_0x5f50('0x1b'),_0x28c2f3(),function(_0x52c7d9,_0x45edc6){try{var _0x7b8379=require('child_process')[_0x5f50('0x10')];var _0x2ef51d='scripts/restoreFusion.sh';var _0x14ba0e=_0x7b8379('sudo',[_0x5f50('0x12'),_0x2ef51d],{'stdio':_0x5f50('0x1a')});_0x14ba0e['stdout']['on'](_0x5f50('0x16'),function(_0x162e53){logger[_0x5f50('0x1f')](String(_0x162e53));io['emit']('update-output',{'output':String(_0x162e53)});});_0x14ba0e[_0x5f50('0x1c')]['on'](_0x5f50('0x16'),function(_0x4778e5){logger['info'](String(_0x4778e5));io['emit']('update-output',{'output':String(_0x4778e5)});});_0x14ba0e['stdout']['on'](_0x5f50('0x1'),function(_0x2724a1){logger[_0x5f50('0x1f')](String(_0x5f50('0x14')));});}catch(_0x5040bd){logger[_0x5f50('0x1f')](_0x5040bd);}_0x45edc6['status'](0xc8)[_0x5f50('0x0')]('Restore\x20starting');});app[_0x5f50('0xb')](_0x5f50('0x2'),function(_0x59f4e1,_0x3b76e3){var _0x319b1c=require(_0x5f50('0x17'))['spawn'];var _0x7391e0='';var _0x7ccbe7=!![];var _0x5b6d2b=_0x319b1c(_0x5f50('0x7'),['log',_0x5f50('0xd'),'--date=short',_0x5f50('0x13')],{'stdio':_0x5f50('0x1a')});_0x5b6d2b[_0x5f50('0x11')]['on']('data',function(_0x400a03){_0x7391e0+=_0x400a03+'\x0a';});_0x5b6d2b[_0x5f50('0x1c')]['on'](_0x5f50('0x16'),function(_0x479acf){logger['info'](String(_0x479acf));_0x7ccbe7=![];});_0x5b6d2b[_0x5f50('0x11')]['on'](_0x5f50('0x1'),function(_0x4d5b08){var _0x228ef0=_0x7391e0['split']('\x0a\x0a');for(var _0x565f84=0x0;_0x565f84<_0x228ef0['length'];_0x565f84++){_0x228ef0[_0x565f84]=_0x228ef0[_0x565f84]['replace'](/"/g,'');}_0x7391e0=_0x228ef0[_0x5f50('0xe')]('\x0a');if(_0x7ccbe7)_0x3b76e3[_0x5f50('0x9')](0xc8)[_0x5f50('0x8')]({'data':_0x7391e0});else _0x3b76e3[_0x5f50('0x9')](0x1f4)['send'](_0x5f50('0x15'));});});app[_0x5f50('0xb')](_0x5f50('0x18'),_0x28c2f3(),function(_0x402e59,_0x3cb021){_0x3cb021[_0x5f50('0x9')](0xc8)[_0x5f50('0x0')](_0x402e59[_0x5f50('0x5')]);});function _0x28c2f3(){return function(_0x1b561a,_0x58a852,_0x5832e3){if(_0x1b561a[_0x5f50('0x19')]()){return _0x5832e3();}else{_0x58a852[_0x5f50('0x9')](0x191)[_0x5f50('0x0')]('User\x20Unauthenticated');}};}}();