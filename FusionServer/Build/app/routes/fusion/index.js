var _0x59f5=['split','update-output','emit','user','isAuthenticated','child_process','--date=short','../../socket','info','spawn','get','/api/fusion/releaseNotes','--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22','/api/fusion/update','stdout','log','length','Update\x20starting','data','join','pipe','scripts/updateFusion.sh','../../utils/logger','sudo','Restore\x20starting','send','close','Update\x20Finished!','status','stderr','User\x20Unauthenticated','/api/cookie','../../express','replace','--no-merges','bash'];(function(_0x1b6671,_0x59f54b){var _0x139ddd=function(_0x28a7a0){while(--_0x28a7a0){_0x1b6671['push'](_0x1b6671['shift']());}};_0x139ddd(++_0x59f54b);}(_0x59f5,0xd7));var _0x139d=function(_0x1b6671,_0x59f54b){_0x1b6671=_0x1b6671-0x0;var _0x139ddd=_0x59f5[_0x1b6671];return _0x139ddd;};const logger=require(_0x139d('0x17'));const app=require(_0x139d('0x21'));const io=require(_0x139d('0x8'));module['exports']=function(){app[_0x139d('0xb')](_0x139d('0xe'),_0x37544b(),function(_0x5c052c,_0x5f257c){try{var _0x48cb8c=require(_0x139d('0x6'))[_0x139d('0xa')];var _0x4485ab=_0x139d('0x16');var _0x3af65d=_0x48cb8c('sudo',[_0x139d('0x0'),_0x4485ab],{'stdio':_0x139d('0x15')});_0x3af65d[_0x139d('0xf')]['on'](_0x139d('0x13'),function(_0x45c203){logger[_0x139d('0x9')](String(_0x45c203));io[_0x139d('0x3')]('update-output',{'output':String(_0x45c203)});});_0x3af65d['stderr']['on'](_0x139d('0x13'),function(_0x3c017f){logger[_0x139d('0x9')](String(_0x3c017f));io[_0x139d('0x3')](_0x139d('0x2'),{'output':String(_0x3c017f)});});_0x3af65d[_0x139d('0xf')]['on']('close',function(_0x12e5d2){logger[_0x139d('0x9')](String(_0x139d('0x1c')));});}catch(_0x2c6bde){logger[_0x139d('0x9')](_0x2c6bde);}_0x5f257c['status'](0xc8)[_0x139d('0x1a')](_0x139d('0x12'));});app['get']('/api/fusion/restore',_0x37544b(),function(_0x5c9c7f,_0x1ad69a){try{var _0x56d4ee=require('child_process')[_0x139d('0xa')];var _0x4a47f1='scripts/restoreFusion.sh';var _0x45a088=_0x56d4ee(_0x139d('0x18'),['bash',_0x4a47f1],{'stdio':_0x139d('0x15')});_0x45a088['stdout']['on'](_0x139d('0x13'),function(_0x58f6df){logger[_0x139d('0x9')](String(_0x58f6df));io['emit'](_0x139d('0x2'),{'output':String(_0x58f6df)});});_0x45a088[_0x139d('0x1e')]['on'](_0x139d('0x13'),function(_0x2698f4){logger['info'](String(_0x2698f4));io[_0x139d('0x3')]('update-output',{'output':String(_0x2698f4)});});_0x45a088[_0x139d('0xf')]['on']('close',function(_0x1ad72c){logger[_0x139d('0x9')](String('Restore\x20Finished!'));});}catch(_0x78cf34){logger[_0x139d('0x9')](_0x78cf34);}_0x1ad69a[_0x139d('0x1d')](0xc8)[_0x139d('0x1a')](_0x139d('0x19'));});app[_0x139d('0xb')](_0x139d('0xc'),function(_0x17d33b,_0x178594){var _0x2b51cd=require('child_process')[_0x139d('0xa')];var _0x4162b2='';var _0x1a5011=!![];var _0x1bebc5=_0x2b51cd('git',[_0x139d('0x10'),_0x139d('0xd'),_0x139d('0x7'),_0x139d('0x23')],{'stdio':'pipe'});_0x1bebc5['stdout']['on']('data',function(_0x1e3726){_0x4162b2+=_0x1e3726+'\x0a';});_0x1bebc5[_0x139d('0x1e')]['on'](_0x139d('0x13'),function(_0x2dc58a){logger[_0x139d('0x9')](String(_0x2dc58a));_0x1a5011=![];});_0x1bebc5[_0x139d('0xf')]['on'](_0x139d('0x1b'),function(_0x24cb99){var _0x1e5d50=_0x4162b2[_0x139d('0x1')]('\x0a\x0a');for(var _0x465d96=0x0;_0x465d96<_0x1e5d50[_0x139d('0x11')];_0x465d96++){_0x1e5d50[_0x465d96]=_0x1e5d50[_0x465d96][_0x139d('0x22')](/"/g,'');}_0x4162b2=_0x1e5d50[_0x139d('0x14')]('\x0a');if(_0x1a5011)_0x178594[_0x139d('0x1d')](0xc8)['json']({'data':_0x4162b2});else _0x178594[_0x139d('0x1d')](0x1f4)[_0x139d('0x1a')]('Error\x20Reading\x20changelog');});});app[_0x139d('0xb')](_0x139d('0x20'),_0x37544b(),function(_0x4e4a5b,_0x149912){_0x149912[_0x139d('0x1d')](0xc8)['send'](_0x4e4a5b[_0x139d('0x4')]);});function _0x37544b(){return function(_0x4a936c,_0x3bd199,_0x3b27d2){if(_0x4a936c[_0x139d('0x5')]()){return _0x3b27d2();}else{_0x3bd199[_0x139d('0x1d')](0x191)[_0x139d('0x1a')](_0x139d('0x1f'));}};}}();