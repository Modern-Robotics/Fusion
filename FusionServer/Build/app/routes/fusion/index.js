var _0x388c=['--date=short','replace','emit','log','status','stderr','close','sudo','isAuthenticated','Restore\x20starting','../../utils/logger','bash','Update\x20starting','User\x20Unauthenticated','json','/api/fusion/releaseNotes','spawn','info','update-output','git','send','get','Restore\x20Finished!','scripts/updateFusion.sh','child_process','pipe','data','stdout','split','Update\x20Finished!','user','/api/cookie','exports','length','scripts/restoreFusion.sh','/api/fusion/update'];(function(_0x2216dc,_0x388cc4){var _0x2555fc=function(_0x64674a){while(--_0x64674a){_0x2216dc['push'](_0x2216dc['shift']());}};_0x2555fc(++_0x388cc4);}(_0x388c,0xf3));var _0x2555=function(_0x2216dc,_0x388cc4){_0x2216dc=_0x2216dc-0x0;var _0x2555fc=_0x388c[_0x2216dc];return _0x2555fc;};const logger=require(_0x2555('0x13'));const app=require('../../express');const io=require('../../socket');module[_0x2555('0x5')]=function(){app[_0x2555('0x1e')](_0x2555('0x8'),_0x287dc4(),function(_0x40bbc3,_0x5599f3){try{var _0x18ad4c=require(_0x2555('0x21'))[_0x2555('0x19')];var _0xf6cbfd=_0x2555('0x20');var _0x4837ea=_0x18ad4c('sudo',[_0x2555('0x14'),_0xf6cbfd],{'stdio':_0x2555('0x22')});_0x4837ea[_0x2555('0x0')]['on']('data',function(_0x5a31af){logger[_0x2555('0x1a')](String(_0x5a31af));io[_0x2555('0xb')](_0x2555('0x1b'),{'output':String(_0x5a31af)});});_0x4837ea[_0x2555('0xe')]['on'](_0x2555('0x23'),function(_0x1fde82){logger[_0x2555('0x1a')](String(_0x1fde82));io[_0x2555('0xb')](_0x2555('0x1b'),{'output':String(_0x1fde82)});});_0x4837ea[_0x2555('0x0')]['on']('close',function(_0xc924d7){logger['info'](String(_0x2555('0x2')));});}catch(_0x326d75){logger[_0x2555('0x1a')](_0x326d75);}_0x5599f3[_0x2555('0xd')](0xc8)[_0x2555('0x1d')](_0x2555('0x15'));});app[_0x2555('0x1e')]('/api/fusion/restore',_0x287dc4(),function(_0x11d8f0,_0x40770a){try{var _0x494aff=require(_0x2555('0x21'))[_0x2555('0x19')];var _0x7938e6=_0x2555('0x7');var _0x50666c=_0x494aff(_0x2555('0x10'),[_0x2555('0x14'),_0x7938e6],{'stdio':'pipe'});_0x50666c[_0x2555('0x0')]['on']('data',function(_0x128045){logger[_0x2555('0x1a')](String(_0x128045));io[_0x2555('0xb')]('update-output',{'output':String(_0x128045)});});_0x50666c['stderr']['on'](_0x2555('0x23'),function(_0x2fa784){logger[_0x2555('0x1a')](String(_0x2fa784));io[_0x2555('0xb')](_0x2555('0x1b'),{'output':String(_0x2fa784)});});_0x50666c['stdout']['on'](_0x2555('0xf'),function(_0x2967a0){logger[_0x2555('0x1a')](String(_0x2555('0x1f')));});}catch(_0x349df3){logger[_0x2555('0x1a')](_0x349df3);}_0x40770a[_0x2555('0xd')](0xc8)[_0x2555('0x1d')](_0x2555('0x12'));});app['get'](_0x2555('0x18'),function(_0x4b9b2c,_0xc0c0b3){var _0x4711cb=require(_0x2555('0x21'))[_0x2555('0x19')];var _0x3701dc='';var _0x36b075=!![];var _0x537325=_0x4711cb(_0x2555('0x1c'),[_0x2555('0xc'),'--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22',_0x2555('0x9'),'--no-merges'],{'stdio':_0x2555('0x22')});_0x537325['stdout']['on'](_0x2555('0x23'),function(_0x5c7172){_0x3701dc+=_0x5c7172+'\x0a';});_0x537325[_0x2555('0xe')]['on'](_0x2555('0x23'),function(_0x459f28){logger['info'](String(_0x459f28));_0x36b075=![];});_0x537325[_0x2555('0x0')]['on'](_0x2555('0xf'),function(_0x9505fa){var _0x3a528b=_0x3701dc[_0x2555('0x1')]('\x0a\x0a');for(var _0x54e73b=0x0;_0x54e73b<_0x3a528b[_0x2555('0x6')];_0x54e73b++){_0x3a528b[_0x54e73b]=_0x3a528b[_0x54e73b][_0x2555('0xa')](/"/g,'');}_0x3701dc=_0x3a528b['join']('\x0a');if(_0x36b075)_0xc0c0b3['status'](0xc8)[_0x2555('0x17')]({'data':_0x3701dc});else _0xc0c0b3[_0x2555('0xd')](0x1f4)[_0x2555('0x1d')]('Error\x20Reading\x20changelog');});});app[_0x2555('0x1e')](_0x2555('0x4'),_0x287dc4(),function(_0x30560e,_0x2962f1){_0x2962f1[_0x2555('0xd')](0xc8)[_0x2555('0x1d')](_0x30560e[_0x2555('0x3')]);});function _0x287dc4(){return function(_0x2be952,_0x24998f,_0x9bf11b){if(_0x2be952[_0x2555('0x11')]()){return _0x9bf11b();}else{_0x24998f['status'](0x191)['send'](_0x2555('0x16'));}};}}();