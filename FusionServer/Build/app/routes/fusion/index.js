const _0x4bb9=['Update\x20starting','../../socket','data','stderr','248341tQYMyh','status','/api/fusion/update','git\x20log\x20--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22\x20--date=short\x20--no-merges\x20-1','join','exports','json','utf-8','1wyQoAW','3247837NZmIVI','993931Nscskk','shelljs','1VQcRCi','67IAcstz','bash','emit','Restore\x20Finished!','User\x20Unauthenticated','482124CikOnr','error','373828jzhcFF','../../express','sudo','fs-extra','isAuthenticated','info','readFile','child_process','11qHcQSw','<div\x20style=\x22border:1px\x20solid\x20gray\x22>','Restore\x20starting','marked','pipe','6541ViPIeP','stdout','Update\x20Finished!','exec','send','spawn','</div>','/api/cookie','user','get','update-output','1qMZwlr','39421KGLmcE','close','3ozGzJG'];function _0x41a0(_0x16b8ad,_0x1ac1b8){return _0x41a0=function(_0x4bb9ce,_0x41a0e5){_0x4bb9ce=_0x4bb9ce-0xec;let _0x35c51d=_0x4bb9[_0x4bb9ce];return _0x35c51d;},_0x41a0(_0x16b8ad,_0x1ac1b8);}const _0x23b9e9=_0x41a0;(function(_0x3ca2fc,_0x361017){const _0x4b7e8f=_0x41a0;while(!![]){try{const _0x3c822f=-parseInt(_0x4b7e8f(0x11c))+parseInt(_0x4b7e8f(0x11e))*parseInt(_0x4b7e8f(0x112))+parseInt(_0x4b7e8f(0xf7))*-parseInt(_0x4b7e8f(0x117))+parseInt(_0x4b7e8f(0x116))*-parseInt(_0x4b7e8f(0x114))+-parseInt(_0x4b7e8f(0x10a))*parseInt(_0x4b7e8f(0x105))+parseInt(_0x4b7e8f(0xf2))*-parseInt(_0x4b7e8f(0x103))+-parseInt(_0x4b7e8f(0x113))*-parseInt(_0x4b7e8f(0x102));if(_0x3c822f===_0x361017)break;else _0x3ca2fc['push'](_0x3ca2fc['shift']());}catch(_0x312ac1){_0x3ca2fc['push'](_0x3ca2fc['shift']());}}}(_0x4bb9,0x81145));const logger=require('../../utils/logger'),app=require(_0x23b9e9(0x11f)),io=require(_0x23b9e9(0x107)),fs=require(_0x23b9e9(0xed)),path=require('path'),marked=require(_0x23b9e9(0xf5)),os=require('os'),shell=require(_0x23b9e9(0x115));module[_0x23b9e9(0x10f)]=function(){const _0x432293=_0x23b9e9;app[_0x432293(0x100)](_0x432293(0x10c),_0x1aafa7(),function(_0x170593,_0x222924){const _0x49a3b4=_0x432293;try{var _0x4bcc97=require(_0x49a3b4(0xf1))[_0x49a3b4(0xfc)],_0x4c6b40='scripts/updateFusion.sh',_0x4a9906=_0x4bcc97(_0x49a3b4(0xec),[_0x49a3b4(0x118),_0x4c6b40],{'stdio':_0x49a3b4(0xf6)});_0x4a9906['stdout']['on'](_0x49a3b4(0x108),function(_0x490415){const _0x2b6b53=_0x49a3b4;logger[_0x2b6b53(0xef)](String(_0x490415)),io['emit'](_0x2b6b53(0x101),{'output':String(_0x490415)});}),_0x4a9906['stderr']['on'](_0x49a3b4(0x108),function(_0x3718b6){const _0x4e63ce=_0x49a3b4;logger[_0x4e63ce(0xef)](String(_0x3718b6)),io[_0x4e63ce(0x119)](_0x4e63ce(0x101),{'output':String(_0x3718b6)});}),_0x4a9906[_0x49a3b4(0xf8)]['on'](_0x49a3b4(0x104),function(_0xfe0e06){const _0x3b5945=_0x49a3b4;logger[_0x3b5945(0xef)](String(_0x3b5945(0xf9)));});}catch(_0x4ccd58){logger['info'](_0x4ccd58);}_0x222924[_0x49a3b4(0x10b)](0xc8)[_0x49a3b4(0xfb)](_0x49a3b4(0x106));}),app[_0x432293(0x100)]('/api/fusion/restore',_0x1aafa7(),function(_0x1194dd,_0x267520){const _0x9c7c31=_0x432293;try{var _0x2cf621=require(_0x9c7c31(0xf1))['spawn'],_0x153ed2='scripts/restoreFusion.sh',_0x296064=_0x2cf621(_0x9c7c31(0xec),['bash',_0x153ed2],{'stdio':_0x9c7c31(0xf6)});_0x296064[_0x9c7c31(0xf8)]['on'](_0x9c7c31(0x108),function(_0x4362d3){const _0x2e9514=_0x9c7c31;logger[_0x2e9514(0xef)](String(_0x4362d3)),io[_0x2e9514(0x119)]('update-output',{'output':String(_0x4362d3)});}),_0x296064[_0x9c7c31(0x109)]['on']('data',function(_0x19cdaa){const _0xe697ca=_0x9c7c31;logger[_0xe697ca(0xef)](String(_0x19cdaa)),io[_0xe697ca(0x119)](_0xe697ca(0x101),{'output':String(_0x19cdaa)});}),_0x296064['stdout']['on']('close',function(_0x1eab63){const _0x802c48=_0x9c7c31;logger[_0x802c48(0xef)](String(_0x802c48(0x11a)));});}catch(_0x4237b7){logger[_0x9c7c31(0xef)](_0x4237b7);}_0x267520['status'](0xc8)[_0x9c7c31(0xfb)](_0x9c7c31(0xf4));}),app[_0x432293(0x100)]('/api/fusion/releaseNotes',async function(_0x7ae485,_0x581a8a){const _0x11455b=_0x432293;try{let _0x175818=shell[_0x11455b(0xfa)](_0x11455b(0x10d)),_0x41fc34=_0x11455b(0xf3)+_0x175818+_0x11455b(0xfd),_0x13c1c9=await fs[_0x11455b(0xf0)](path[_0x11455b(0x10e)](__dirname,'./../../../../../README.md'),_0x11455b(0x111));return _0x581a8a[_0x11455b(0x10b)](0xc8)[_0x11455b(0x110)]({'version':_0x175818,'changeLog':marked(_0x13c1c9)});}catch(_0xfb40c6){return logger[_0x11455b(0x11d)]('Error\x20reading\x20release\x20notes:\x20'+_0xfb40c6),_0x581a8a['status'](0x1f4)[_0x11455b(0xfb)]('Error\x20getting\x20release\x20notes');}}),app[_0x432293(0x100)](_0x432293(0xfe),_0x1aafa7(),function(_0x7b8931,_0x2ae920){const _0x30ed3d=_0x432293;_0x2ae920[_0x30ed3d(0x10b)](0xc8)[_0x30ed3d(0xfb)](_0x7b8931[_0x30ed3d(0xff)]);});function _0x1aafa7(){return function(_0x2fd541,_0x4006f5,_0x22d1e2){const _0x5f052e=_0x41a0;if(_0x2fd541[_0x5f052e(0xee)]())return _0x22d1e2();else _0x4006f5[_0x5f052e(0x10b)](0x191)[_0x5f052e(0xfb)](_0x5f052e(0x11b));};}}();