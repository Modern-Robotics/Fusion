const _0x3500=['emit','sudo','Restore\x20starting','utf-8','update-output','../../utils/logger','data','Error\x20getting\x20release\x20notes','Update\x20starting','exec','get','send','Update\x20Finished!','shelljs','status','User\x20Unauthenticated','./../../../../../README.md','readFile','close','pipe','spawn','/api/fusion/releaseNotes','info','scripts/updateFusion.sh','stdout','Restore\x20Finished!','child_process','/api/cookie','json','exports','scripts/restoreFusion.sh','error','stderr','/api/fusion/update','Error\x20reading\x20release\x20notes:\x20','</div>','bash','<div\x20style=\x22border:1px\x20solid\x20gray\x22>','marked','user'];(function(_0x2fa8f0,_0x3500ee){const _0x58bc05=function(_0xe99366){while(--_0xe99366){_0x2fa8f0['push'](_0x2fa8f0['shift']());}};_0x58bc05(++_0x3500ee);}(_0x3500,0x12c));const _0x58bc=function(_0x2fa8f0,_0x3500ee){_0x2fa8f0=_0x2fa8f0-0x0;let _0x58bc05=_0x3500[_0x2fa8f0];return _0x58bc05;};const logger=require(_0x58bc('0x19'));const app=require('../../express');const io=require('../../socket');const fs=require('fs-extra');const path=require('path');const marked=require(_0x58bc('0x12'));const os=require('os');const shell=require(_0x58bc('0x21'));module[_0x58bc('0x9')]=function(){app['get'](_0x58bc('0xd'),_0x3b9f9d(),function(_0x21c61a,_0x346b5e){try{var _0x4bd343=require(_0x58bc('0x6'))[_0x58bc('0x0')];var _0x42b5c1=_0x58bc('0x3');var _0x171851=_0x4bd343(_0x58bc('0x15'),['bash',_0x42b5c1],{'stdio':_0x58bc('0x27')});_0x171851[_0x58bc('0x4')]['on'](_0x58bc('0x1a'),function(_0x55c1b3){logger[_0x58bc('0x2')](String(_0x55c1b3));io[_0x58bc('0x14')](_0x58bc('0x18'),{'output':String(_0x55c1b3)});});_0x171851[_0x58bc('0xc')]['on'](_0x58bc('0x1a'),function(_0x138199){logger['info'](String(_0x138199));io[_0x58bc('0x14')]('update-output',{'output':String(_0x138199)});});_0x171851[_0x58bc('0x4')]['on'](_0x58bc('0x26'),function(_0x190d52){logger[_0x58bc('0x2')](String(_0x58bc('0x20')));});}catch(_0x54ab59){logger[_0x58bc('0x2')](_0x54ab59);}_0x346b5e['status'](0xc8)[_0x58bc('0x1f')](_0x58bc('0x1c'));});app[_0x58bc('0x1e')]('/api/fusion/restore',_0x3b9f9d(),function(_0x11d3a5,_0xab6fef){try{var _0x4b65f9=require(_0x58bc('0x6'))[_0x58bc('0x0')];var _0x53855d=_0x58bc('0xa');var _0x135c38=_0x4b65f9(_0x58bc('0x15'),[_0x58bc('0x10'),_0x53855d],{'stdio':_0x58bc('0x27')});_0x135c38[_0x58bc('0x4')]['on']('data',function(_0x32648a){logger[_0x58bc('0x2')](String(_0x32648a));io[_0x58bc('0x14')](_0x58bc('0x18'),{'output':String(_0x32648a)});});_0x135c38['stderr']['on'](_0x58bc('0x1a'),function(_0x570e39){logger[_0x58bc('0x2')](String(_0x570e39));io['emit']('update-output',{'output':String(_0x570e39)});});_0x135c38['stdout']['on']('close',function(_0x5d8491){logger[_0x58bc('0x2')](String(_0x58bc('0x5')));});}catch(_0x524d44){logger['info'](_0x524d44);}_0xab6fef[_0x58bc('0x22')](0xc8)[_0x58bc('0x1f')](_0x58bc('0x16'));});app[_0x58bc('0x1e')](_0x58bc('0x1'),async function(_0x392dc2,_0x48c2f9){try{let _0x24f3ee=shell[_0x58bc('0x1d')]('git\x20log\x20--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22\x20--date=short\x20--no-merges\x20-1');let _0x2c9a98=_0x58bc('0x11')+_0x24f3ee+_0x58bc('0xf');let _0x386c33=await fs[_0x58bc('0x25')](path['join'](__dirname,_0x58bc('0x24')),_0x58bc('0x17'));return _0x48c2f9[_0x58bc('0x22')](0xc8)[_0x58bc('0x8')]({'version':_0x24f3ee,'changeLog':marked(_0x386c33)});}catch(_0x4ea4bc){logger[_0x58bc('0xb')](_0x58bc('0xe')+_0x4ea4bc);return _0x48c2f9[_0x58bc('0x22')](0x1f4)[_0x58bc('0x1f')](_0x58bc('0x1b'));}});app[_0x58bc('0x1e')](_0x58bc('0x7'),_0x3b9f9d(),function(_0x2ecab2,_0x33f0b9){_0x33f0b9[_0x58bc('0x22')](0xc8)[_0x58bc('0x1f')](_0x2ecab2[_0x58bc('0x13')]);});function _0x3b9f9d(){return function(_0x35dbf0,_0x14ccfd,_0x31a705){if(_0x35dbf0['isAuthenticated']()){return _0x31a705();}else{_0x14ccfd[_0x58bc('0x22')](0x191)['send'](_0x58bc('0x23'));}};}}();