var _0x13cb=['/api/fusion/restore','update-output','isAuthenticated','--no-merges','close','../../express','stderr','Restore\x20Finished!','/api/fusion/releaseNotes','scripts/updateFusion.sh','split','User\x20Unauthenticated','scripts/restoreFusion.sh','/api/fusion/update','pipe','child_process','status','/api/cookie','exports','Update\x20Finished!','Restore\x20starting','info','length','bash','sudo','join','../../utils/logger','git','replace','emit','Error\x20Reading\x20changelog','get','log','json','stdout','--pretty=format:\x22[%cd]\x20(%h)\x20:\x20%s\x22','user','--date=short','send','data','spawn'];(function(_0x58a107,_0x13cb37){var _0x27cbbb=function(_0x11203d){while(--_0x11203d){_0x58a107['push'](_0x58a107['shift']());}};_0x27cbbb(++_0x13cb37);}(_0x13cb,0x1d8));var _0x27cb=function(_0x58a107,_0x13cb37){_0x58a107=_0x58a107-0x0;var _0x27cbbb=_0x13cb[_0x58a107];return _0x27cbbb;};const logger=require(_0x27cb('0x5'));const app=require(_0x27cb('0x19'));const io=require('../../socket');module[_0x27cb('0x26')]=function(){app[_0x27cb('0xa')](_0x27cb('0x21'),_0x3707b8(),function(_0x16a174,_0x2fbee0){try{var _0x1ff368=require(_0x27cb('0x23'))[_0x27cb('0x13')];var _0x5e906c=_0x27cb('0x1d');var _0xc2f78f=_0x1ff368(_0x27cb('0x3'),[_0x27cb('0x2'),_0x5e906c],{'stdio':_0x27cb('0x22')});_0xc2f78f[_0x27cb('0xd')]['on']('data',function(_0x48719a){logger['info'](String(_0x48719a));io[_0x27cb('0x8')](_0x27cb('0x15'),{'output':String(_0x48719a)});});_0xc2f78f[_0x27cb('0x1a')]['on']('data',function(_0x583ce8){logger['info'](String(_0x583ce8));io['emit']('update-output',{'output':String(_0x583ce8)});});_0xc2f78f[_0x27cb('0xd')]['on'](_0x27cb('0x18'),function(_0x5f1970){logger[_0x27cb('0x0')](String(_0x27cb('0x27')));});}catch(_0x34d118){logger[_0x27cb('0x0')](_0x34d118);}_0x2fbee0['status'](0xc8)[_0x27cb('0x11')]('Update\x20starting');});app[_0x27cb('0xa')](_0x27cb('0x14'),_0x3707b8(),function(_0x338222,_0x56a14a){try{var _0x1c6291=require('child_process')['spawn'];var _0x365f6f=_0x27cb('0x20');var _0x38e32e=_0x1c6291('sudo',[_0x27cb('0x2'),_0x365f6f],{'stdio':_0x27cb('0x22')});_0x38e32e[_0x27cb('0xd')]['on']('data',function(_0x575c10){logger[_0x27cb('0x0')](String(_0x575c10));io[_0x27cb('0x8')](_0x27cb('0x15'),{'output':String(_0x575c10)});});_0x38e32e['stderr']['on'](_0x27cb('0x12'),function(_0x57f567){logger[_0x27cb('0x0')](String(_0x57f567));io['emit'](_0x27cb('0x15'),{'output':String(_0x57f567)});});_0x38e32e['stdout']['on'](_0x27cb('0x18'),function(_0x4c70df){logger[_0x27cb('0x0')](String(_0x27cb('0x1b')));});}catch(_0x252d5d){logger[_0x27cb('0x0')](_0x252d5d);}_0x56a14a['status'](0xc8)[_0x27cb('0x11')](_0x27cb('0x28'));});app[_0x27cb('0xa')](_0x27cb('0x1c'),function(_0x46aae4,_0x229009){var _0x3ddffe=require(_0x27cb('0x23'))[_0x27cb('0x13')];var _0xf9e34a='';var _0x5b28ba=!![];var _0x1be83c=_0x3ddffe(_0x27cb('0x6'),[_0x27cb('0xb'),_0x27cb('0xe'),_0x27cb('0x10'),_0x27cb('0x17')],{'stdio':_0x27cb('0x22')});_0x1be83c[_0x27cb('0xd')]['on'](_0x27cb('0x12'),function(_0x31b550){_0xf9e34a+=_0x31b550+'\x0a';});_0x1be83c['stderr']['on'](_0x27cb('0x12'),function(_0x279bfa){logger[_0x27cb('0x0')](String(_0x279bfa));_0x5b28ba=![];});_0x1be83c['stdout']['on']('close',function(_0x3ef8a5){var _0x2baced=_0xf9e34a[_0x27cb('0x1e')]('\x0a\x0a');for(var _0x14c187=0x0;_0x14c187<_0x2baced[_0x27cb('0x1')];_0x14c187++){_0x2baced[_0x14c187]=_0x2baced[_0x14c187][_0x27cb('0x7')](/"/g,'');}_0xf9e34a=_0x2baced[_0x27cb('0x4')]('\x0a');if(_0x5b28ba)_0x229009[_0x27cb('0x24')](0xc8)[_0x27cb('0xc')]({'data':_0xf9e34a});else _0x229009['status'](0x1f4)[_0x27cb('0x11')](_0x27cb('0x9'));});});app[_0x27cb('0xa')](_0x27cb('0x25'),_0x3707b8(),function(_0x93da6a,_0x4bbf8b){_0x4bbf8b['status'](0xc8)[_0x27cb('0x11')](_0x93da6a[_0x27cb('0xf')]);});function _0x3707b8(){return function(_0x1fa841,_0x255602,_0x485e60){if(_0x1fa841[_0x27cb('0x16')]()){return _0x485e60();}else{_0x255602[_0x27cb('0x24')](0x191)[_0x27cb('0x11')](_0x27cb('0x1f'));}};}}();