var _0x3ae7=['info','ssid','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','config','readFile','/api/diagnostics/start','Wifi\x20file\x20not\x20found','INACTIVE','Not\x20configured..','User\x20Unauthenticated','\x09scan_ssid=1\x0a','sockets','join','country=US\x0a\x0a','Content-disposition','/etc/hostapd/hostapd.conf','message','Connected\x20to\x20','\x20\x20\x20\x20ssid=\x22','\x20successfully','Wireless\x20interface\x20not\x20found','.crash','filepath','length','../../diagnostics/runRemi.sh','ssid_set.py','Unable\x20to\x20stop\x20diagnostic\x20tool','python','exports','/api/admin/wirelessConnections','spawn','User\x20created!','../../socket','child_process','etc','wifi-connection','Error\x20reading\x20crash\x20file','split','Error\x20connecting\x20to\x20','get','4WAY_HANDSHAKE','stderr','diagnostics_running','readdir','SocketVariables','wireless-tools/iwlist','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','pipe','No\x20crash\x20files\x20found','platform','../../global/fusionSettings','wpa_passphrase\x20\x22','/etc/wpa_supplicant/wpa_supplicant.conf','SSID','type','hiddenNetwork','/api/autonomousPrograms','stdout','Error\x20starting\x20diagnostic\x20tool','Retreived\x20wireless\x20connections','password','emit','username','../../etc/config-wap/hostapd.conf__npp.sh','Disconnected\x20successfully','/api/admin/crashReport','Ip\x20address:\x20','\x20\x20\x20\x20key_mgmt=NONE\x0a','utf8','send','}\x0a\x0a','update_config=1\x0a','\x09key_mgmt=WPA-PSK\x0a','trim','wireless-tools/wpa_supplicant','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','../../diagnostics/diagnosticGUI.py','\x22\x20\x22','\x20assigned','Password','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','json','network={\x0a','sudo','findOne','win32','path','download','Shut\x20Down\x20Commencing','poweroff','wpa_passphrase','fusion_diagnostics_running','/api/admin/wirelessSettings','findOneAndUpdate','fusion_wifi_access','data','wpa_state','save','exec','SCANNING','Wifi_NIC','../../express','wireless-tools/wpa_cli','./app/filesystem/','DISCONNECTED','../../models/autonomous','status','setHeader','indexOf','writeFile','body','sudo\x20wpa_cli\x20-i\x20','Error\x20disconnecting','post','scan'];(function(_0xd142d5,_0x3ae768){var _0x5a526f=function(_0x5c7334){while(--_0x5c7334){_0xd142d5['push'](_0xd142d5['shift']());}};_0x5a526f(++_0x3ae768);}(_0x3ae7,0x9a));var _0x5a52=function(_0xd142d5,_0x3ae768){_0xd142d5=_0xd142d5-0x0;var _0x5a526f=_0x3ae7[_0xd142d5];return _0x5a526f;};var fs=require('fs-extra');var mkdirp=require('mkdirp');var os=require('os');var path=require(_0x5a52('0x2f'));var shell=require('shelljs');var wpa_cli=require(_0x5a52('0x3f'));var iwlist=require(_0x5a52('0x6'));var wpa_supplicant=require(_0x5a52('0x23'));var spawn=require('child_process')[_0x5a52('0x6a')];const config=require(_0x5a52('0x4f'));const autonomous=require(_0x5a52('0x42'));const logger=require('../../utils/logger');let nicInterface=config[_0x5a52('0x0')](_0x5a52('0x3d'));const app=require(_0x5a52('0x3e'));const User=require('../../models/user');const io=require(_0x5a52('0x6c'));const FusionSettings=require(_0x5a52('0xb'));module[_0x5a52('0x68')]=function(){app['post']('/api/admin/users',_0x21ead4(),function(_0x24021e,_0x4ceb3a){User[_0x5a52('0x2d')]({'username':_0x24021e[_0x5a52('0x47')][_0x5a52('0x17')]},async function(_0x25593b,_0x2018ee){if(_0x25593b)return _0x4ceb3a[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x25593b);if(_0x2018ee){return _0x4ceb3a[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')]('Username\x20already\x20taken.');}else{var _0x49d0ee=new User(_0x24021e['body']);_0x49d0ee[_0x5a52('0x17')]=_0x24021e[_0x5a52('0x47')][_0x5a52('0x17')];_0x49d0ee['password']=_0x49d0ee['generateHash'](_0x24021e[_0x5a52('0x47')]['password']);_0x49d0ee[_0x5a52('0x62')]=await _0x49d0ee['generateFileSystem'](_0x49d0ee[_0x5a52('0x17')]);_0x49d0ee[_0x5a52('0x3a')](function(_0x407fa6){if(_0x407fa6)return _0x4ceb3a[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x407fa6);return _0x4ceb3a[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'serverMessage':_0x5a52('0x6b')});});}});});app[_0x5a52('0x0')]('/api/admin/powerOff',function(_0x345135,_0x29cd92){_0x29cd92[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'serverMessage':_0x5a52('0x31')});var _0x1900fa=require(_0x5a52('0x6d'))[_0x5a52('0x6a')];var _0x28858c=_0x1900fa('sudo',[_0x5a52('0x32')]);});app[_0x5a52('0x0')]('/api/admin/restart',function(_0x3a070d,_0x5ee4fb){_0x5ee4fb[_0x5a52('0x43')](0xc8)[_0x5a52('0x1e')]('Restart\x20Commencing');var _0x4d15c5=require(_0x5a52('0x6d'))[_0x5a52('0x6a')];var _0x2f66a7=_0x4d15c5(_0x5a52('0x2c'),['reboot']);});app[_0x5a52('0x0')](_0x5a52('0x35'),function(_0x295a3e,_0x294ead){var _0x571a42;var _0x12f9b9=require('os')['EOL'];var _0x10c111;var _0x13b089;var _0x5340da={};if(os['platform']()==_0x5a52('0x2e')){_0x571a42=_0x5a52('0x18');fs[_0x5a52('0x50')](_0x571a42,_0x5a52('0x1d'),function(_0x2397f5,_0x290d67){if(_0x2397f5)_0x294ead['status'](0x1f4)[_0x5a52('0x1e')](_0x5a52('0x52'));_0x10c111=_0x290d67[_0x5a52('0x71')]('\x0a');for(var _0x4a6faa=0x0;_0x4a6faa<_0x10c111[_0x5a52('0x63')];_0x4a6faa++){_0x13b089=_0x10c111[_0x4a6faa][_0x5a52('0x71')]('=');if(_0x13b089[0x0]==_0x5a52('0x4d'))_0x5340da[_0x5a52('0xe')]=_0x13b089[0x1];else if(_0x13b089[0x0]==_0x5a52('0x33'))_0x5340da[_0x5a52('0x28')]=_0x13b089[0x1];}_0x294ead['status'](0xc8)[_0x5a52('0x2a')]({'SSID':_0x5340da['SSID'],'Password':_0x5340da['Password']});});}else{_0x571a42=_0x5a52('0x5b');fs[_0x5a52('0x50')](_0x571a42,_0x5a52('0x1d'),function(_0x8ba398,_0x258121){if(_0x8ba398)_0x294ead[_0x5a52('0x43')](0x1f4)['send'](_0x5a52('0x52'));_0x10c111=_0x258121['split'](_0x12f9b9);for(var _0x46d33e=0x0;_0x46d33e<_0x10c111[_0x5a52('0x63')];_0x46d33e++){_0x13b089=_0x10c111[_0x46d33e][_0x5a52('0x71')]('=');if(_0x13b089[0x0]==_0x5a52('0x4d'))_0x5340da[_0x5a52('0xe')]=_0x13b089[0x1];else if(_0x13b089[0x0]==_0x5a52('0x33'))_0x5340da[_0x5a52('0x28')]=_0x13b089[0x1];}if(!_0x5340da[_0x5a52('0xe')]){_0x5340da[_0x5a52('0xe')]=_0x5a52('0x54');_0x5340da['Password']='';}_0x294ead[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'SSID':_0x5340da[_0x5a52('0xe')],'Password':_0x5340da[_0x5a52('0x28')]});});}});app[_0x5a52('0x4a')]('/api/admin/wirelessSettings',function(_0x31720a,_0xac7f90){try{var _0x4d7867;var _0x453924;var _0x52e7d5=path[_0x5a52('0x58')]('..','..',_0x5a52('0x6e'),_0x5a52('0x65'));if(_0x31720a['body'][_0x5a52('0x4d')]==null&&_0x31720a[_0x5a52('0x47')][_0x5a52('0x15')]==null)_0x453924=['python',_0x52e7d5,'-d'];else _0x453924=[_0x5a52('0x67'),_0x52e7d5,'-s',_0x31720a[_0x5a52('0x47')][_0x5a52('0x4d')],'-p',_0x31720a[_0x5a52('0x47')][_0x5a52('0x15')]];var _0x4a6994=require(_0x5a52('0x6d'))['spawn'];python_process=_0x4a6994(_0x5a52('0x2c'),_0x453924,{'stdio':_0x5a52('0x8')});python_process['stderr']['on'](_0x5a52('0x38'),function(_0x3ff58c){logger[_0x5a52('0x4c')](String(_0x3ff58c));_0x4d7867=String(_0x3ff58c);});python_process['stdout']['on']('close',function(_0x1d5107){if(_0x4d7867)return _0xac7f90[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x4d7867);else return _0xac7f90[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'serverMessage':'Successfully\x20changed\x20wifi\x20settings'});});}catch(_0x53a06e){logger[_0x5a52('0x4c')](_0x53a06e);return _0xac7f90['status'](0x1f4)[_0x5a52('0x1e')](_0x53a06e);}});app[_0x5a52('0x0')](_0x5a52('0x69'),function(_0x2b8117,_0xd2f93e){if(os['platform']()=='win32'){return _0xd2f93e[_0x5a52('0x43')](0xc8)[_0x5a52('0x1e')]();}else{iwlist[_0x5a52('0x4b')](nicInterface,function(_0xaa48a4,_0x4d1c60){if(_0xaa48a4)return _0xd2f93e[_0x5a52('0x43')](0x1f4)['send'](_0x5a52('0x60'));else return _0xd2f93e[_0x5a52('0x43')](0xc8)[_0x5a52('0x1e')]({'serverMessage':_0x5a52('0x14'),'data':_0x4d1c60});});}});app['post'](_0x5a52('0x69'),function(_0x247899,_0x5db042){var _0x54fce3=undefined;var _0x2352d4='ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a'+_0x5a52('0x20')+'country=US\x0a\x0a';var _0x5a212f=_0x5a52('0x2b')+'\x09ssid=\x22'+_0x247899[_0x5a52('0x47')][_0x5a52('0x4d')]+'\x22\x0a'+_0x5a52('0x56')+'\x09psk=\x22'+_0x247899['body'][_0x5a52('0x15')]+'\x22\x0a'+_0x5a52('0x21')+_0x5a52('0x1f');if(_0x247899[_0x5a52('0x47')][_0x5a52('0x15')]){_0x54fce3=shell['exec'](_0x5a52('0xc')+_0x247899[_0x5a52('0x47')][_0x5a52('0x4d')]+_0x5a52('0x26')+_0x247899[_0x5a52('0x47')][_0x5a52('0x15')]+'\x22',{'silent':!![]})[_0x5a52('0x12')];}else{_0x54fce3=_0x5a52('0x2b')+_0x5a52('0x5e')+_0x247899[_0x5a52('0x47')][_0x5a52('0x4d')]+'\x22\x0a'+_0x5a52('0x1c')+'}\x0a';}let _0x18336a='';if(_0x247899['body'][_0x5a52('0x10')])_0x18336a=_0x2352d4+_0x5a212f;else _0x18336a=_0x2352d4+_0x54fce3;fs[_0x5a52('0x46')](_0x5a52('0xd'),_0x18336a,function(_0x1d1f78){if(_0x1d1f78)return _0x5db042[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x1d1f78);shell[_0x5a52('0x3b')]('sudo\x20wpa_cli\x20-i\x20'+nicInterface+'\x20reconfigure',{'silent':!![]});const _0x49a6ef=0x3a98;var _0x531fb0=0x12c;var _0x4a6800=0x0;var _0x2d9092=setInterval(function(){var _0x264b6d=[_0x5a52('0x3c'),_0x5a52('0x1'),'AUTHENTICATING',_0x5a52('0x41'),'ASSOCIATING'];wpa_cli[_0x5a52('0x43')](nicInterface,function(_0x51016f,_0x457484){if(_0x51016f)return _0x5db042[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x51016f);if(_0x457484['wpa_state']=='COMPLETED'){if(_0x457484['ip']){logger[_0x5a52('0x4c')](_0x5a52('0x1b')+_0x457484['ip']+_0x5a52('0x27'));clearInterval(_0x2d9092);FusionSettings[_0x5a52('0x5')][_0x5a52('0x37')]=_0x457484;io[_0x5a52('0x57')][_0x5a52('0x16')](_0x5a52('0x6f'),_0x457484);return _0x5db042[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'serverMessage':_0x5a52('0x5d')+_0x247899[_0x5a52('0x47')][_0x5a52('0x4d')]+_0x5a52('0x5f')});}else if(_0x4a6800>_0x49a6ef){logger['info']('Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.');clearInterval(_0x2d9092);return _0x5db042[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x5a52('0x72')+_0x247899['body'][_0x5a52('0x4d')]);}_0x4a6800+=_0x531fb0;}else if(_0x264b6d[_0x5a52('0x45')](_0x457484['wpa_state'])==-0x1){clearInterval(_0x2d9092);io[_0x5a52('0x57')][_0x5a52('0x16')](_0x5a52('0x6f'),_0x457484);return _0x5db042[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x5a52('0x72')+_0x247899['body'][_0x5a52('0x4d')]);}});},_0x531fb0);});});app[_0x5a52('0x0')]('/api/admin/wirelessConnections/disconnect',function(_0x20c21b,_0x5b1ba3){if(os['platform']()=='win32'){_0x5b1ba3[_0x5a52('0x43')](0x1f4)['send']('Disconnect\x20not\x20available\x20on\x20Windows');}else{var _0x22f4ef=_0x5a52('0x4e')+_0x5a52('0x20')+_0x5a52('0x59');fs[_0x5a52('0x46')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x22f4ef,function(_0x210eb7){if(_0x210eb7)return _0x5b1ba3[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x210eb7);shell[_0x5a52('0x3b')](_0x5a52('0x48')+nicInterface+'\x20reconfigure',{'silent':!![]});var _0xb900d7=setInterval(function(){var _0x57625e=[];wpa_cli[_0x5a52('0x43')](nicInterface,function(_0x4c4536,_0x20168d){if(_0x4c4536)return _0x5b1ba3[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x4c4536);FusionSettings[_0x5a52('0x5')][_0x5a52('0x37')]=_0x20168d;io[_0x5a52('0x57')][_0x5a52('0x16')](_0x5a52('0x6f'),_0x20168d);if(_0x20168d[_0x5a52('0x39')]==_0x5a52('0x41')||_0x20168d['wpa_state']==_0x5a52('0x53')){clearInterval(_0xb900d7);io[_0x5a52('0x57')][_0x5a52('0x16')](_0x5a52('0x6f'),_0x20168d);return _0x5b1ba3[_0x5a52('0x43')](0xc8)['json']({'serverMessage':_0x5a52('0x19')});}else if(connectingStatuses[_0x5a52('0x45')](_0x20168d[_0x5a52('0x39')])==-0x1){clearInterval(_0xb900d7);io[_0x5a52('0x57')][_0x5a52('0x16')](_0x5a52('0x6f'),_0x20168d);return _0x5b1ba3['status'](0x1f4)[_0x5a52('0x1e')](_0x5a52('0x49'));}});},0x12c);});}});app[_0x5a52('0x0')](_0x5a52('0x1a'),function(_0x269646,_0x274352){var _0xbeb38=_0x5a52('0x61');fs[_0x5a52('0x4')](_0xbeb38,function(_0x2ebba0,_0x4605b3){if(_0x2ebba0)return _0x274352[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x2ebba0);if(_0x4605b3[_0x5a52('0x63')]>0x0){fs['readFile'](_0xbeb38+'/'+_0x4605b3[0x0],_0x5a52('0x1d'),function(_0x18f292,_0x1c4aea){if(_0x18f292)return status(0x1f4)[_0x5a52('0x1e')](_0x5a52('0x70'));_0x274352[_0x5a52('0x44')](_0x5a52('0x5a'),'attachment;\x20filename='+_0x4605b3[0x0]);return _0x274352['status'](0xc8)[_0x5a52('0x30')](_0xbeb38+'/'+_0x4605b3[0x0]);});}else{return _0x274352['status'](0xc8)[_0x5a52('0x1e')](_0x5a52('0x9'));}});});var _0x5ce358=null;app[_0x5a52('0x4a')](_0x5a52('0x51'),function(_0x4b9462,_0x1dd43c){if(os[_0x5a52('0xa')]()!=_0x5a52('0x2e')){_0x5ce358=spawn(_0x5a52('0x2c'),['sh',_0x5a52('0x64'),_0x5a52('0x25')]);_0x5ce358[_0x5a52('0x12')]['on']('data',function(_0x222f63){logger[_0x5a52('0x4c')](String(_0x222f63));});_0x5ce358[_0x5a52('0x2')]['on'](_0x5a52('0x38'),function(_0x2390e1){logger[_0x5a52('0x4c')](String(_0x2390e1));});var _0x3c0c37=0x1;var _0xb0d71c=0x3;var _0x372a0b=setInterval(function(){if(_0x3c0c37<=_0xb0d71c){var _0x12b180=shell[_0x5a52('0x3b')](_0x5a52('0x7'),{'silent':!![]})[_0x5a52('0x12')];if(_0x12b180){clearInterval(_0x372a0b);FusionSettings[_0x5a52('0x5')][_0x5a52('0x34')]={'process':_0x12b180,'socket':_0x4b9462['body']['socketId']};io['sockets']['emit'](_0x5a52('0x3'),FusionSettings[_0x5a52('0x5')][_0x5a52('0x34')]);return _0x1dd43c['status'](0xc8)['json']({'serverMessage':'Diagnostic\x20tool\x20started\x20successfully'});}else{_0x3c0c37++;}}else{clearInterval(_0x372a0b);return _0x1dd43c[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](_0x5a52('0x13'));}},0x12c);}else{return _0x1dd43c['status'](0xc8)[_0x5a52('0x2a')]({'serverMessage':_0x5a52('0x29')});}});app[_0x5a52('0x0')]('/api/diagnostics/stop',function(_0x58dfe3,_0x17715a){if(os['platform']()!=_0x5a52('0x2e')){shell[_0x5a52('0x3b')](_0x5a52('0x24'),{'silent':!![]});shell[_0x5a52('0x3b')](_0x5a52('0x7'),{'silent':!![]},function(_0x1ab66b,_0x184844,_0x525c99){(function(_0x50488c){var _0x2ce3fc=_0x50488c[_0x5a52('0x22')]();if(_0x2ce3fc){return _0x17715a[_0x5a52('0x43')](0x1f4)['send'](_0x5a52('0x66'));}else{FusionSettings['SocketVariables'][_0x5a52('0x34')]=null;io['sockets']['emit'](_0x5a52('0x3'),FusionSettings[_0x5a52('0x5')][_0x5a52('0x34')]);_0x5ce358=null;return _0x17715a[_0x5a52('0x43')](0xc8)['json']({'serverMessage':'Diagnostic\x20tool\x20stopped\x20successfully'});}}(_0x184844[_0x5a52('0x22')]()));});}else{return _0x17715a[_0x5a52('0x43')](0xc8)[_0x5a52('0x2a')]({'serverMessage':_0x5a52('0x29')});}});app[_0x5a52('0x0')]('/api/autonomous',async function(_0x52b722,_0x382c52){try{const _0x6441dd=await autonomous[_0x5a52('0x2d')]()['exec']();return _0x382c52[_0x5a52('0x2a')](_0x6441dd);}catch(_0x50cddf){return _0x382c52[_0x5a52('0x43')](0x1f4)[_0x5a52('0x1e')](error[_0x5a52('0x5c')]);}});app[_0x5a52('0x4a')]('/api/autonomous',async function(_0xd2e791,_0x209792){try{const _0x30b1cd=await autonomous[_0x5a52('0x36')]({},_0xd2e791[_0x5a52('0x47')]);return _0x209792[_0x5a52('0x43')](0xc8)['json']({'serverMessage':'Updated\x20successfully'});}catch(_0x2326cd){return _0x209792[_0x5a52('0x43')](0x1f4)['send'](_0x2326cd[_0x5a52('0x5c')]);}});app[_0x5a52('0x4a')](_0x5a52('0x11'),async function(_0x222891,_0x3d5047){try{const _0x140f6c=_0x222891[_0x5a52('0x47')][_0x5a52('0x17')];const _0x3d3edb=_0x222891[_0x5a52('0x47')][_0x5a52('0xf')];const _0x1f88c1=await fs[_0x5a52('0x4')](_0x5a52('0x40')+_0x140f6c+'/'+_0x3d3edb);return _0x3d5047[_0x5a52('0x43')](0xc8)['json']({'files':_0x1f88c1});}catch(_0x7a2bf4){return _0x3d5047['status'](0x1f4)[_0x5a52('0x1e')](_0x7a2bf4[_0x5a52('0x5c')]);}});function _0x21ead4(){return function(_0x233cba,_0x2f93e1,_0x56d824){if(_0x233cba['isAuthenticated']()){return _0x56d824();}else{_0x2f93e1[_0x5a52('0x43')](0x191)[_0x5a52('0x1e')](_0x5a52('0x55'));}};}}();