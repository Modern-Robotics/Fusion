var _0x2dae=['INACTIVE','Error\x20reading\x20crash\x20file','Restart\x20Commencing','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','.crash','close','SSID','Retreived\x20wireless\x20connections','message','Wifi_NIC','download','save','diagnostics_running','child_process','\x09scan_ssid=1\x0a','ssid_set.py','indexOf','stderr','utf8','Error\x20starting\x20diagnostic\x20tool','get','type','exec','setHeader','fusion_wifi_access','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','ssid','\x20reconfigure','SocketVariables','sudo','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','4WAY_HANDSHAKE','Wifi\x20file\x20not\x20found','exports','Password','/api/admin/wirelessSettings','\x09psk=\x22','DISCONNECTED','/api/diagnostics/stop','json','No\x20crash\x20files\x20found','wpa_passphrase','platform','split','python','join','../../models/autonomous','win32','socketId','wireless-tools/wpa_supplicant','/api/admin/wirelessConnections/disconnect','\x22\x20\x22','Disconnected\x20successfully','Unable\x20to\x20stop\x20diagnostic\x20tool','fs-extra','Diagnostic\x20tool\x20started\x20successfully','poweroff','spawn','/api/autonomous','../../etc/config-wap/hostapd.conf__npp.sh','body','length','send','writeFile','status','wireless-tools/wpa_cli','stdout','Content-disposition','Successfully\x20changed\x20wifi\x20settings','wpa_state','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','config','readdir','Wireless\x20interface\x20not\x20found','data','findOne','Error\x20connecting\x20to\x20','Not\x20configured..','post','sockets','/api/autonomousPrograms','Shut\x20Down\x20Commencing','isAuthenticated','password','shelljs','../../diagnostics/runRemi.sh','COMPLETED','username','wireless-tools/iwlist','pipe','emit','update_config=1\x0a','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','../../utils/logger','Disconnect\x20not\x20available\x20on\x20Windows','info','readFile','wifi-connection','EOL','Ip\x20address:\x20','path','User\x20Unauthenticated','Updated\x20successfully','\x20\x20\x20\x20ssid=\x22','generateFileSystem','Diagnostic\x20tool\x20stopped\x20successfully','network={\x0a','ASSOCIATING','fusion_diagnostics_running','/api/admin/restart','/api/diagnostics/start','country=US\x0a\x0a','Connected\x20to\x20','/api/admin/wirelessConnections','/etc/wpa_supplicant/wpa_supplicant.conf','trim','sudo\x20wpa_cli\x20-i\x20','scan'];(function(_0x2f0129,_0x2dae06){var _0x1e21cb=function(_0x3f7fbf){while(--_0x3f7fbf){_0x2f0129['push'](_0x2f0129['shift']());}};_0x1e21cb(++_0x2dae06);}(_0x2dae,0x129));var _0x1e21=function(_0x2f0129,_0x2dae06){_0x2f0129=_0x2f0129-0x0;var _0x1e21cb=_0x2dae[_0x2f0129];return _0x1e21cb;};var fs=require(_0x1e21('0x6f'));var mkdirp=require('mkdirp');var os=require('os');var path=require(_0x1e21('0x27'));var shell=require(_0x1e21('0x17'));var wpa_cli=require(_0x1e21('0x4'));var iwlist=require(_0x1e21('0x1b'));var wpa_supplicant=require(_0x1e21('0x6a'));var spawn=require(_0x1e21('0x46'))['spawn'];const config=require(_0x1e21('0xa'));const autonomous=require(_0x1e21('0x67'));const logger=require(_0x1e21('0x20'));let nicInterface=config[_0x1e21('0x4d')](_0x1e21('0x42'));const app=require('../../express');const User=require('../../models/user');const io=require('../../socket');const FusionSettings=require('../../global/fusionSettings');module[_0x1e21('0x5a')]=function(){app['post']('/api/admin/users',_0x561057(),function(_0x23fb58,_0x3b5743){User[_0x1e21('0xe')]({'username':_0x23fb58['body'][_0x1e21('0x1a')]},async function(_0x4f0f6e,_0xcb6136){if(_0x4f0f6e)return _0x3b5743[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x4f0f6e);if(_0xcb6136){return _0x3b5743['status'](0x1f4)[_0x1e21('0x1')]('Username\x20already\x20taken.');}else{var _0x128271=new User(_0x23fb58[_0x1e21('0x75')]);_0x128271['username']=_0x23fb58[_0x1e21('0x75')]['username'];_0x128271[_0x1e21('0x16')]=_0x128271['generateHash'](_0x23fb58['body'][_0x1e21('0x16')]);_0x128271['filepath']=await _0x128271[_0x1e21('0x2b')](_0x128271[_0x1e21('0x1a')]);_0x128271[_0x1e21('0x44')](function(_0x4d6bb3){if(_0x4d6bb3)return _0x3b5743[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x4d6bb3);return _0x3b5743['status'](0xc8)['json']({'serverMessage':'User\x20created!'});});}});});app[_0x1e21('0x4d')]('/api/admin/powerOff',function(_0x38f4f0,_0x5646ce){_0x5646ce['status'](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x14')});var _0x70461d=require('child_process')[_0x1e21('0x72')];var _0x10ce71=_0x70461d(_0x1e21('0x56'),[_0x1e21('0x71')]);});app[_0x1e21('0x4d')](_0x1e21('0x30'),function(_0x54b8d2,_0x5da783){_0x5da783[_0x1e21('0x3')](0xc8)[_0x1e21('0x1')](_0x1e21('0x3b'));var _0x34aa27=require('child_process')[_0x1e21('0x72')];var _0x269d7e=_0x34aa27(_0x1e21('0x56'),['reboot']);});app[_0x1e21('0x4d')](_0x1e21('0x5c'),function(_0x3be513,_0x26563b){var _0x34c97f;var _0x1e0315=require('os')[_0x1e21('0x25')];var _0x3bede0;var _0x245ef1;var _0x18d31a={};if(os[_0x1e21('0x63')]()==_0x1e21('0x68')){_0x34c97f=_0x1e21('0x74');fs[_0x1e21('0x23')](_0x34c97f,_0x1e21('0x4b'),function(_0x31e64e,_0x28ae6d){if(_0x31e64e)_0x26563b[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')]('Wifi\x20file\x20not\x20found');_0x3bede0=_0x28ae6d[_0x1e21('0x64')]('\x0a');for(var _0x370033=0x0;_0x370033<_0x3bede0['length'];_0x370033++){_0x245ef1=_0x3bede0[_0x370033][_0x1e21('0x64')]('=');if(_0x245ef1[0x0]==_0x1e21('0x53'))_0x18d31a[_0x1e21('0x3f')]=_0x245ef1[0x1];else if(_0x245ef1[0x0]==_0x1e21('0x62'))_0x18d31a[_0x1e21('0x5b')]=_0x245ef1[0x1];}_0x26563b['status'](0xc8)[_0x1e21('0x60')]({'SSID':_0x18d31a[_0x1e21('0x3f')],'Password':_0x18d31a[_0x1e21('0x5b')]});});}else{_0x34c97f='/etc/hostapd/hostapd.conf';fs[_0x1e21('0x23')](_0x34c97f,'utf8',function(_0x4d179e,_0x1c9cb3){if(_0x4d179e)_0x26563b[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x1e21('0x59'));_0x3bede0=_0x1c9cb3['split'](_0x1e0315);for(var _0x31d2dd=0x0;_0x31d2dd<_0x3bede0[_0x1e21('0x0')];_0x31d2dd++){_0x245ef1=_0x3bede0[_0x31d2dd][_0x1e21('0x64')]('=');if(_0x245ef1[0x0]==_0x1e21('0x53'))_0x18d31a[_0x1e21('0x3f')]=_0x245ef1[0x1];else if(_0x245ef1[0x0]==_0x1e21('0x62'))_0x18d31a['Password']=_0x245ef1[0x1];}if(!_0x18d31a[_0x1e21('0x3f')]){_0x18d31a[_0x1e21('0x3f')]=_0x1e21('0x10');_0x18d31a['Password']='';}_0x26563b['status'](0xc8)['json']({'SSID':_0x18d31a[_0x1e21('0x3f')],'Password':_0x18d31a[_0x1e21('0x5b')]});});}});app['post'](_0x1e21('0x5c'),function(_0x2b0e30,_0x31de32){try{var _0x497cbf;var _0x3cfd68;var _0x2c3435=path[_0x1e21('0x66')]('..','..','etc',_0x1e21('0x48'));if(_0x2b0e30[_0x1e21('0x75')][_0x1e21('0x53')]==null&&_0x2b0e30[_0x1e21('0x75')][_0x1e21('0x16')]==null)_0x3cfd68=[_0x1e21('0x65'),_0x2c3435,'-d'];else _0x3cfd68=[_0x1e21('0x65'),_0x2c3435,'-s',_0x2b0e30[_0x1e21('0x75')][_0x1e21('0x53')],'-p',_0x2b0e30[_0x1e21('0x75')][_0x1e21('0x16')]];var _0x37f045=require(_0x1e21('0x46'))[_0x1e21('0x72')];python_process=_0x37f045(_0x1e21('0x56'),_0x3cfd68,{'stdio':_0x1e21('0x1c')});python_process[_0x1e21('0x4a')]['on'](_0x1e21('0xd'),function(_0x43f9d2){logger[_0x1e21('0x22')](String(_0x43f9d2));_0x497cbf=String(_0x43f9d2);});python_process[_0x1e21('0x5')]['on'](_0x1e21('0x3e'),function(_0x236b74){if(_0x497cbf)return _0x31de32[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x497cbf);else return _0x31de32[_0x1e21('0x3')](0xc8)['json']({'serverMessage':_0x1e21('0x7')});});}catch(_0x1ffdcd){logger[_0x1e21('0x22')](_0x1ffdcd);return _0x31de32[_0x1e21('0x3')](0x1f4)['send'](_0x1ffdcd);}});app[_0x1e21('0x4d')](_0x1e21('0x34'),function(_0x477a74,_0x4bd3f0){if(os[_0x1e21('0x63')]()=='win32'){return _0x4bd3f0[_0x1e21('0x3')](0xc8)[_0x1e21('0x1')]();}else{iwlist[_0x1e21('0x38')](nicInterface,function(_0x2c297c,_0x5a108e){if(_0x2c297c)return _0x4bd3f0['status'](0x1f4)[_0x1e21('0x1')](_0x1e21('0xc'));else return _0x4bd3f0[_0x1e21('0x3')](0xc8)[_0x1e21('0x1')]({'serverMessage':_0x1e21('0x40'),'data':_0x5a108e});});}});app['post'](_0x1e21('0x34'),function(_0xd22d45,_0x4a9ad4){var _0x5afcad=undefined;var _0x1bec49=_0x1e21('0x52')+_0x1e21('0x1e')+_0x1e21('0x32');var _0xfb4f7f=_0x1e21('0x2d')+'\x09ssid=\x22'+_0xd22d45[_0x1e21('0x75')][_0x1e21('0x53')]+'\x22\x0a'+_0x1e21('0x47')+_0x1e21('0x5d')+_0xd22d45[_0x1e21('0x75')]['password']+'\x22\x0a'+'\x09key_mgmt=WPA-PSK\x0a'+'}\x0a\x0a';if(_0xd22d45[_0x1e21('0x75')]['password']){_0x5afcad=shell[_0x1e21('0x4f')]('wpa_passphrase\x20\x22'+_0xd22d45[_0x1e21('0x75')][_0x1e21('0x53')]+_0x1e21('0x6c')+_0xd22d45['body']['password']+'\x22',{'silent':!![]})['stdout'];}else{_0x5afcad=_0x1e21('0x2d')+_0x1e21('0x2a')+_0xd22d45[_0x1e21('0x75')][_0x1e21('0x53')]+'\x22\x0a'+'\x20\x20\x20\x20key_mgmt=NONE\x0a'+'}\x0a';}let _0x158eb1='';if(_0xd22d45['body']['hiddenNetwork'])_0x158eb1=_0x1bec49+_0xfb4f7f;else _0x158eb1=_0x1bec49+_0x5afcad;fs[_0x1e21('0x2')](_0x1e21('0x35'),_0x158eb1,function(_0x1892d4){if(_0x1892d4)return _0x4a9ad4[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x1892d4);shell[_0x1e21('0x4f')](_0x1e21('0x37')+nicInterface+_0x1e21('0x54'),{'silent':!![]});const _0x269a58=0x3a98;var _0x342465=0x12c;var _0x2ac891=0x0;var _0x56df75=setInterval(function(){var _0x4f4e48=['SCANNING',_0x1e21('0x58'),'AUTHENTICATING',_0x1e21('0x5e'),_0x1e21('0x2e')];wpa_cli[_0x1e21('0x3')](nicInterface,function(_0x194670,_0x4cf7ab){if(_0x194670)return _0x4a9ad4['status'](0x1f4)[_0x1e21('0x1')](_0x194670);if(_0x4cf7ab[_0x1e21('0x8')]==_0x1e21('0x19')){if(_0x4cf7ab['ip']){logger['info'](_0x1e21('0x26')+_0x4cf7ab['ip']+'\x20assigned');clearInterval(_0x56df75);FusionSettings[_0x1e21('0x55')][_0x1e21('0x51')]=_0x4cf7ab;io[_0x1e21('0x12')][_0x1e21('0x1d')](_0x1e21('0x24'),_0x4cf7ab);return _0x4a9ad4[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x33')+_0xd22d45[_0x1e21('0x75')]['ssid']+'\x20successfully'});}else if(_0x2ac891>_0x269a58){logger[_0x1e21('0x22')](_0x1e21('0x3c'));clearInterval(_0x56df75);return _0x4a9ad4[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x1e21('0xf')+_0xd22d45[_0x1e21('0x75')][_0x1e21('0x53')]);}_0x2ac891+=_0x342465;}else if(_0x4f4e48[_0x1e21('0x49')](_0x4cf7ab[_0x1e21('0x8')])==-0x1){clearInterval(_0x56df75);io[_0x1e21('0x12')]['emit'](_0x1e21('0x24'),_0x4cf7ab);return _0x4a9ad4[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')]('Error\x20connecting\x20to\x20'+_0xd22d45[_0x1e21('0x75')][_0x1e21('0x53')]);}});},_0x342465);});});app[_0x1e21('0x4d')](_0x1e21('0x6b'),function(_0x20e29d,_0x30ef31){if(os[_0x1e21('0x63')]()=='win32'){_0x30ef31[_0x1e21('0x3')](0x1f4)['send'](_0x1e21('0x21'));}else{var _0x98d14=_0x1e21('0x52')+_0x1e21('0x1e')+_0x1e21('0x32');fs[_0x1e21('0x2')](_0x1e21('0x35'),_0x98d14,function(_0x4cee31){if(_0x4cee31)return _0x30ef31[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x4cee31);shell[_0x1e21('0x4f')](_0x1e21('0x37')+nicInterface+_0x1e21('0x54'),{'silent':!![]});var _0x17469b=setInterval(function(){var _0x45fec8=[];wpa_cli[_0x1e21('0x3')](nicInterface,function(_0x23e940,_0x8c5f13){if(_0x23e940)return _0x30ef31['status'](0x1f4)[_0x1e21('0x1')](_0x23e940);FusionSettings[_0x1e21('0x55')][_0x1e21('0x51')]=_0x8c5f13;io[_0x1e21('0x12')][_0x1e21('0x1d')](_0x1e21('0x24'),_0x8c5f13);if(_0x8c5f13[_0x1e21('0x8')]==_0x1e21('0x5e')||_0x8c5f13[_0x1e21('0x8')]==_0x1e21('0x39')){clearInterval(_0x17469b);io[_0x1e21('0x12')][_0x1e21('0x1d')]('wifi-connection',_0x8c5f13);return _0x30ef31[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x6d')});}else if(connectingStatuses['indexOf'](_0x8c5f13[_0x1e21('0x8')])==-0x1){clearInterval(_0x17469b);io[_0x1e21('0x12')]['emit'](_0x1e21('0x24'),_0x8c5f13);return _0x30ef31[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')]('Error\x20disconnecting');}});},0x12c);});}});app[_0x1e21('0x4d')]('/api/admin/crashReport',function(_0xf4c04c,_0x2b6dbb){var _0x36073c=_0x1e21('0x3d');fs[_0x1e21('0xb')](_0x36073c,function(_0x48ee72,_0x71c5b8){if(_0x48ee72)return _0x2b6dbb['status'](0x1f4)[_0x1e21('0x1')](_0x48ee72);if(_0x71c5b8[_0x1e21('0x0')]>0x0){fs['readFile'](_0x36073c+'/'+_0x71c5b8[0x0],'utf8',function(_0x32d4a6,_0x4e4a55){if(_0x32d4a6)return status(0x1f4)[_0x1e21('0x1')](_0x1e21('0x3a'));_0x2b6dbb[_0x1e21('0x50')](_0x1e21('0x6'),'attachment;\x20filename='+_0x71c5b8[0x0]);return _0x2b6dbb[_0x1e21('0x3')](0xc8)[_0x1e21('0x43')](_0x36073c+'/'+_0x71c5b8[0x0]);});}else{return _0x2b6dbb[_0x1e21('0x3')](0xc8)[_0x1e21('0x1')](_0x1e21('0x61'));}});});var _0x1ec7f5=null;app[_0x1e21('0x11')](_0x1e21('0x31'),function(_0x3b4190,_0x17b4b8){if(os['platform']()!=_0x1e21('0x68')){_0x1ec7f5=spawn(_0x1e21('0x56'),['sh',_0x1e21('0x18'),'../../diagnostics/diagnosticGUI.py']);_0x1ec7f5[_0x1e21('0x5')]['on'](_0x1e21('0xd'),function(_0x5a32b2){logger[_0x1e21('0x22')](String(_0x5a32b2));});_0x1ec7f5[_0x1e21('0x4a')]['on'](_0x1e21('0xd'),function(_0x21bce4){logger[_0x1e21('0x22')](String(_0x21bce4));});var _0x4c5397=0x1;var _0x2e2955=0x3;var _0x3a8d1e=setInterval(function(){if(_0x4c5397<=_0x2e2955){var _0x303a2c=shell[_0x1e21('0x4f')](_0x1e21('0x9'),{'silent':!![]})[_0x1e21('0x5')];if(_0x303a2c){clearInterval(_0x3a8d1e);FusionSettings['SocketVariables']['fusion_diagnostics_running']={'process':_0x303a2c,'socket':_0x3b4190[_0x1e21('0x75')][_0x1e21('0x69')]};io[_0x1e21('0x12')]['emit'](_0x1e21('0x45'),FusionSettings[_0x1e21('0x55')][_0x1e21('0x2f')]);return _0x17b4b8['status'](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x70')});}else{_0x4c5397++;}}else{clearInterval(_0x3a8d1e);return _0x17b4b8['status'](0x1f4)['send'](_0x1e21('0x4c'));}},0x12c);}else{return _0x17b4b8[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x57')});}});app[_0x1e21('0x4d')](_0x1e21('0x5f'),function(_0x21beaf,_0x2bbbc4){if(os['platform']()!=_0x1e21('0x68')){shell['exec'](_0x1e21('0x1f'),{'silent':!![]});shell[_0x1e21('0x4f')](_0x1e21('0x9'),{'silent':!![]},function(_0x1f0c69,_0x4b330c,_0x29f69c){(function(_0x312661){var _0x94ab56=_0x312661[_0x1e21('0x36')]();if(_0x94ab56){return _0x2bbbc4[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x1e21('0x6e'));}else{FusionSettings[_0x1e21('0x55')][_0x1e21('0x2f')]=null;io[_0x1e21('0x12')]['emit'](_0x1e21('0x45'),FusionSettings[_0x1e21('0x55')][_0x1e21('0x2f')]);_0x1ec7f5=null;return _0x2bbbc4[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'serverMessage':_0x1e21('0x2c')});}}(_0x4b330c[_0x1e21('0x36')]()));});}else{return _0x2bbbc4[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'serverMessage':'Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows'});}});app['get'](_0x1e21('0x73'),async function(_0x255277,_0x5f246a){try{const _0x8bd367=await autonomous['findOne']()[_0x1e21('0x4f')]();return _0x5f246a[_0x1e21('0x60')](_0x8bd367);}catch(_0xcaba8){return _0x5f246a['status'](0x1f4)[_0x1e21('0x1')](error[_0x1e21('0x41')]);}});app[_0x1e21('0x11')](_0x1e21('0x73'),async function(_0x12c07d,_0x2edcef){try{const _0x49e19f=await autonomous['findOneAndUpdate']({},_0x12c07d[_0x1e21('0x75')]);return _0x2edcef['status'](0xc8)['json']({'serverMessage':_0x1e21('0x29')});}catch(_0x4dae3e){return _0x2edcef[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x4dae3e[_0x1e21('0x41')]);}});app[_0x1e21('0x11')](_0x1e21('0x13'),async function(_0x3ef46f,_0x1c1336){try{const _0x206b23=_0x3ef46f[_0x1e21('0x75')][_0x1e21('0x1a')];const _0x4f19b9=_0x3ef46f[_0x1e21('0x75')][_0x1e21('0x4e')];const _0x1fcc38=await fs['readdir']('./app/filesystem/'+_0x206b23+'/'+_0x4f19b9);return _0x1c1336[_0x1e21('0x3')](0xc8)[_0x1e21('0x60')]({'files':_0x1fcc38});}catch(_0x3efd28){return _0x1c1336[_0x1e21('0x3')](0x1f4)[_0x1e21('0x1')](_0x3efd28['message']);}});function _0x561057(){return function(_0x5b2328,_0x46626c,_0x5e7815){if(_0x5b2328[_0x1e21('0x15')]()){return _0x5e7815();}else{_0x46626c[_0x1e21('0x3')](0x191)['send'](_0x1e21('0x28'));}};}}();