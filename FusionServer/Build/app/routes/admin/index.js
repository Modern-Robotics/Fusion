var _0x341f=['\x20\x20\x20\x20key_mgmt=NONE\x0a','Updated\x20successfully','/api/diagnostics/stop','\x09ssid=\x22','../../global/fusionSettings','Wifi\x20file\x20not\x20found','\x09scan_ssid=1\x0a','wireless-tools/wpa_supplicant','username','No\x20crash\x20files\x20found','win32','Error\x20reading\x20crash\x20file','wpa_state','SSID','Password','post','../../models/user','Error\x20starting\x20diagnostic\x20tool','wpa_passphrase\x20\x22','DISCONNECTED','findOne','emit','join','Shut\x20Down\x20Commencing','/api/autonomousPrograms','mkdirp','Retreived\x20wireless\x20connections','utf8','sudo\x20wpa_cli\x20-i\x20','fusion_wifi_access','ssid','AUTHENTICATING','indexOf','../../express','status','hiddenNetwork','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','info','\x20assigned','SCANNING','Successfully\x20changed\x20wifi\x20settings','path','../../socket','writeFile','../../diagnostics/runRemi.sh','json','download','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','update_config=1\x0a','/etc/wpa_supplicant/wpa_supplicant.conf','stdout','stderr','readFile','sockets','User\x20Unauthenticated','fusion_diagnostics_running','password','scan','../../diagnostics/diagnosticGUI.py','send','Ip\x20address:\x20','Username\x20already\x20taken.','/api/admin/crashReport','country=US\x0a\x0a','Wireless\x20interface\x20not\x20found','platform','fs-extra','ASSOCIATING','readdir','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','shelljs','SocketVariables','Wifi_NIC','COMPLETED','network={\x0a','\x20reconfigure','sudo','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','config','../../models/autonomous','message','save','spawn','\x22\x20\x22','Restart\x20Commencing','Connected\x20to\x20','socketId','wifi-connection','length','../../etc/config-wap/hostapd.conf__npp.sh','Disconnected\x20successfully','etc','Error\x20disconnecting','reboot','/api/admin/wirelessSettings','/etc/hostapd/hostapd.conf','exec','Disconnect\x20not\x20available\x20on\x20Windows','python','Unable\x20to\x20stop\x20diagnostic\x20tool','../../utils/logger','Not\x20configured..','setHeader','wpa_passphrase','split','generateFileSystem','get','child_process','filepath','/api/admin/wirelessConnections','data','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','Error\x20connecting\x20to\x20','type','body'];(function(_0x3cc2af,_0x341f82){var _0x2c6434=function(_0x13b181){while(--_0x13b181){_0x3cc2af['push'](_0x3cc2af['shift']());}};_0x2c6434(++_0x341f82);}(_0x341f,0x163));var _0x2c64=function(_0x3cc2af,_0x341f82){_0x3cc2af=_0x3cc2af-0x0;var _0x2c6434=_0x341f[_0x3cc2af];return _0x2c6434;};var fs=require(_0x2c64('0x38'));var mkdirp=require(_0x2c64('0xf'));var os=require('os');var path=require(_0x2c64('0x1f'));var shell=require(_0x2c64('0x3c'));var wpa_cli=require('wireless-tools/wpa_cli');var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require(_0x2c64('0x70'));var spawn=require(_0x2c64('0x61'))[_0x2c64('0x48')];const config=require(_0x2c64('0x44'));const autonomous=require(_0x2c64('0x45'));const logger=require(_0x2c64('0x5a'));let nicInterface=config[_0x2c64('0x60')](_0x2c64('0x3e'));const app=require(_0x2c64('0x17'));const User=require(_0x2c64('0x6'));const io=require(_0x2c64('0x20'));const FusionSettings=require(_0x2c64('0x6d'));module['exports']=function(){app[_0x2c64('0x5')]('/api/admin/users',_0x30947d(),function(_0x284cdf,_0x66955c){User['findOne']({'username':_0x284cdf[_0x2c64('0x68')][_0x2c64('0x71')]},async function(_0x141d98,_0x4324f1){if(_0x141d98)return _0x66955c[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x141d98);if(_0x4324f1){return _0x66955c[_0x2c64('0x18')](0x1f4)['send'](_0x2c64('0x33'));}else{var _0x1112fa=new User(_0x284cdf[_0x2c64('0x68')]);_0x1112fa[_0x2c64('0x71')]=_0x284cdf['body'][_0x2c64('0x71')];_0x1112fa[_0x2c64('0x2e')]=_0x1112fa['generateHash'](_0x284cdf[_0x2c64('0x68')][_0x2c64('0x2e')]);_0x1112fa[_0x2c64('0x62')]=await _0x1112fa[_0x2c64('0x5f')](_0x1112fa[_0x2c64('0x71')]);_0x1112fa[_0x2c64('0x47')](function(_0x69d343){if(_0x69d343)return _0x66955c[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x69d343);return _0x66955c[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':'User\x20created!'});});}});});app[_0x2c64('0x60')]('/api/admin/powerOff',function(_0xcb940e,_0x4ce52c){_0x4ce52c[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':_0x2c64('0xd')});var _0x40cba6=require('child_process')['spawn'];var _0x50488a=_0x40cba6(_0x2c64('0x42'),['poweroff']);});app[_0x2c64('0x60')]('/api/admin/restart',function(_0xbad536,_0x11831a){_0x11831a[_0x2c64('0x18')](0xc8)['send'](_0x2c64('0x4a'));var _0xf3fb46=require('child_process')['spawn'];var _0x185f74=_0xf3fb46(_0x2c64('0x42'),[_0x2c64('0x53')]);});app['get'](_0x2c64('0x54'),function(_0x554937,_0x4d35fa){var _0x68c3a7;var _0x28c5b0=require('os')['EOL'];var _0x5e8227;var _0x2cda15;var _0x214901={};if(os[_0x2c64('0x37')]()==_0x2c64('0x0')){_0x68c3a7=_0x2c64('0x4f');fs[_0x2c64('0x2a')](_0x68c3a7,_0x2c64('0x11'),function(_0x57192c,_0x46e798){if(_0x57192c)_0x4d35fa['status'](0x1f4)[_0x2c64('0x31')](_0x2c64('0x6e'));_0x5e8227=_0x46e798[_0x2c64('0x5e')]('\x0a');for(var _0x1b4e5a=0x0;_0x1b4e5a<_0x5e8227[_0x2c64('0x4e')];_0x1b4e5a++){_0x2cda15=_0x5e8227[_0x1b4e5a][_0x2c64('0x5e')]('=');if(_0x2cda15[0x0]=='ssid')_0x214901[_0x2c64('0x3')]=_0x2cda15[0x1];else if(_0x2cda15[0x0]=='wpa_passphrase')_0x214901[_0x2c64('0x4')]=_0x2cda15[0x1];}_0x4d35fa['status'](0xc8)['json']({'SSID':_0x214901['SSID'],'Password':_0x214901['Password']});});}else{_0x68c3a7=_0x2c64('0x55');fs[_0x2c64('0x2a')](_0x68c3a7,_0x2c64('0x11'),function(_0x5a4841,_0x34ebcd){if(_0x5a4841)_0x4d35fa[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')]('Wifi\x20file\x20not\x20found');_0x5e8227=_0x34ebcd[_0x2c64('0x5e')](_0x28c5b0);for(var _0x155639=0x0;_0x155639<_0x5e8227[_0x2c64('0x4e')];_0x155639++){_0x2cda15=_0x5e8227[_0x155639][_0x2c64('0x5e')]('=');if(_0x2cda15[0x0]==_0x2c64('0x14'))_0x214901[_0x2c64('0x3')]=_0x2cda15[0x1];else if(_0x2cda15[0x0]==_0x2c64('0x5d'))_0x214901[_0x2c64('0x4')]=_0x2cda15[0x1];}if(!_0x214901[_0x2c64('0x3')]){_0x214901[_0x2c64('0x3')]=_0x2c64('0x5b');_0x214901[_0x2c64('0x4')]='';}_0x4d35fa[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'SSID':_0x214901[_0x2c64('0x3')],'Password':_0x214901[_0x2c64('0x4')]});});}});app[_0x2c64('0x5')]('/api/admin/wirelessSettings',function(_0x192c74,_0x969ece){try{var _0x13e8d7;var _0x279a1b;var _0x26cd63=path[_0x2c64('0xc')]('..','..',_0x2c64('0x51'),'ssid_set.py');if(_0x192c74['body'][_0x2c64('0x14')]==null&&_0x192c74[_0x2c64('0x68')][_0x2c64('0x2e')]==null)_0x279a1b=[_0x2c64('0x58'),_0x26cd63,'-d'];else _0x279a1b=['python',_0x26cd63,'-s',_0x192c74[_0x2c64('0x68')][_0x2c64('0x14')],'-p',_0x192c74[_0x2c64('0x68')][_0x2c64('0x2e')]];var _0x67f901=require(_0x2c64('0x61'))[_0x2c64('0x48')];python_process=_0x67f901('sudo',_0x279a1b,{'stdio':'pipe'});python_process[_0x2c64('0x29')]['on'](_0x2c64('0x64'),function(_0x3d5479){logger['info'](String(_0x3d5479));_0x13e8d7=String(_0x3d5479);});python_process[_0x2c64('0x28')]['on']('close',function(_0x493cf0){if(_0x13e8d7)return _0x969ece['status'](0x1f4)['send'](_0x13e8d7);else return _0x969ece[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':_0x2c64('0x1e')});});}catch(_0x229784){logger[_0x2c64('0x1b')](_0x229784);return _0x969ece[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x229784);}});app[_0x2c64('0x60')](_0x2c64('0x63'),function(_0x461c5b,_0x37c05b){if(os[_0x2c64('0x37')]()==_0x2c64('0x0')){return _0x37c05b['status'](0xc8)[_0x2c64('0x31')]();}else{iwlist[_0x2c64('0x2f')](nicInterface,function(_0x4f466b,_0x442f84){if(_0x4f466b)return _0x37c05b[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x2c64('0x36'));else return _0x37c05b[_0x2c64('0x18')](0xc8)['send']({'serverMessage':_0x2c64('0x10'),'data':_0x442f84});});}});app[_0x2c64('0x5')](_0x2c64('0x63'),function(_0x5818a8,_0x2ab0fd){var _0x2c2a0e=undefined;var _0x1bd8f6=_0x2c64('0x25')+_0x2c64('0x26')+_0x2c64('0x35');var _0x344a08='network={\x0a'+_0x2c64('0x6c')+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x14')]+'\x22\x0a'+_0x2c64('0x6f')+'\x09psk=\x22'+_0x5818a8[_0x2c64('0x68')]['password']+'\x22\x0a'+'\x09key_mgmt=WPA-PSK\x0a'+'}\x0a\x0a';if(_0x5818a8[_0x2c64('0x68')][_0x2c64('0x2e')]){_0x2c2a0e=shell['exec'](_0x2c64('0x8')+_0x5818a8[_0x2c64('0x68')]['ssid']+_0x2c64('0x49')+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x2e')]+'\x22',{'silent':!![]})['stdout'];}else{_0x2c2a0e=_0x2c64('0x40')+'\x20\x20\x20\x20ssid=\x22'+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x14')]+'\x22\x0a'+_0x2c64('0x69')+'}\x0a';}let _0x300282='';if(_0x5818a8['body'][_0x2c64('0x19')])_0x300282=_0x1bd8f6+_0x344a08;else _0x300282=_0x1bd8f6+_0x2c2a0e;fs[_0x2c64('0x21')](_0x2c64('0x27'),_0x300282,function(_0x35ad24){if(_0x35ad24)return _0x2ab0fd['status'](0x1f4)[_0x2c64('0x31')](_0x35ad24);shell['exec'](_0x2c64('0x12')+nicInterface+_0x2c64('0x41'),{'silent':!![]});const _0x4d1a4f=0x3a98;var _0x4a6c37=0x12c;var _0x15f0e8=0x0;var _0x45fa19=setInterval(function(){var _0x46a970=[_0x2c64('0x1d'),'4WAY_HANDSHAKE',_0x2c64('0x15'),_0x2c64('0x9'),_0x2c64('0x39')];wpa_cli[_0x2c64('0x18')](nicInterface,function(_0x954922,_0x5e4be0){if(_0x954922)return _0x2ab0fd[_0x2c64('0x18')](0x1f4)['send'](_0x954922);if(_0x5e4be0['wpa_state']==_0x2c64('0x3f')){if(_0x5e4be0['ip']){logger['info'](_0x2c64('0x32')+_0x5e4be0['ip']+_0x2c64('0x1c'));clearInterval(_0x45fa19);FusionSettings[_0x2c64('0x3d')][_0x2c64('0x13')]=_0x5e4be0;io['sockets'][_0x2c64('0xb')](_0x2c64('0x4d'),_0x5e4be0);return _0x2ab0fd['status'](0xc8)[_0x2c64('0x23')]({'serverMessage':_0x2c64('0x4b')+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x14')]+'\x20successfully'});}else if(_0x15f0e8>_0x4d1a4f){logger[_0x2c64('0x1b')](_0x2c64('0x65'));clearInterval(_0x45fa19);return _0x2ab0fd[_0x2c64('0x18')](0x1f4)['send']('Error\x20connecting\x20to\x20'+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x14')]);}_0x15f0e8+=_0x4a6c37;}else if(_0x46a970[_0x2c64('0x16')](_0x5e4be0['wpa_state'])==-0x1){clearInterval(_0x45fa19);io[_0x2c64('0x2b')][_0x2c64('0xb')](_0x2c64('0x4d'),_0x5e4be0);return _0x2ab0fd['status'](0x1f4)[_0x2c64('0x31')](_0x2c64('0x66')+_0x5818a8[_0x2c64('0x68')][_0x2c64('0x14')]);}});},_0x4a6c37);});});app['get']('/api/admin/wirelessConnections/disconnect',function(_0x3e532a,_0x5355c9){if(os[_0x2c64('0x37')]()=='win32'){_0x5355c9[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x2c64('0x57'));}else{var _0x4c811b='ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a'+_0x2c64('0x26')+'country=US\x0a\x0a';fs[_0x2c64('0x21')](_0x2c64('0x27'),_0x4c811b,function(_0x446f63){if(_0x446f63)return _0x5355c9['status'](0x1f4)['send'](_0x446f63);shell[_0x2c64('0x56')](_0x2c64('0x12')+nicInterface+_0x2c64('0x41'),{'silent':!![]});var _0x552ed7=setInterval(function(){var _0x510eed=[];wpa_cli[_0x2c64('0x18')](nicInterface,function(_0x40a231,_0x5875e6){if(_0x40a231)return _0x5355c9[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x40a231);FusionSettings['SocketVariables'][_0x2c64('0x13')]=_0x5875e6;io[_0x2c64('0x2b')][_0x2c64('0xb')](_0x2c64('0x4d'),_0x5875e6);if(_0x5875e6['wpa_state']==_0x2c64('0x9')||_0x5875e6[_0x2c64('0x2')]=='INACTIVE'){clearInterval(_0x552ed7);io[_0x2c64('0x2b')][_0x2c64('0xb')]('wifi-connection',_0x5875e6);return _0x5355c9[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':_0x2c64('0x50')});}else if(connectingStatuses['indexOf'](_0x5875e6[_0x2c64('0x2')])==-0x1){clearInterval(_0x552ed7);io[_0x2c64('0x2b')][_0x2c64('0xb')](_0x2c64('0x4d'),_0x5875e6);return _0x5355c9[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x2c64('0x52'));}});},0x12c);});}});app[_0x2c64('0x60')](_0x2c64('0x34'),function(_0x5e113b,_0x2a85c4){var _0x321e71='.crash';fs['readdir'](_0x321e71,function(_0x47fa03,_0x3564f5){if(_0x47fa03)return _0x2a85c4[_0x2c64('0x18')](0x1f4)['send'](_0x47fa03);if(_0x3564f5[_0x2c64('0x4e')]>0x0){fs[_0x2c64('0x2a')](_0x321e71+'/'+_0x3564f5[0x0],_0x2c64('0x11'),function(_0x343c54,_0x6bfb57){if(_0x343c54)return status(0x1f4)[_0x2c64('0x31')](_0x2c64('0x1'));_0x2a85c4[_0x2c64('0x5c')]('Content-disposition','attachment;\x20filename='+_0x3564f5[0x0]);return _0x2a85c4['status'](0xc8)[_0x2c64('0x24')](_0x321e71+'/'+_0x3564f5[0x0]);});}else{return _0x2a85c4[_0x2c64('0x18')](0xc8)[_0x2c64('0x31')](_0x2c64('0x72'));}});});var _0x5e6427=null;app[_0x2c64('0x5')]('/api/diagnostics/start',function(_0x46c993,_0x34a316){if(os[_0x2c64('0x37')]()!=_0x2c64('0x0')){_0x5e6427=spawn('sudo',['sh',_0x2c64('0x22'),_0x2c64('0x30')]);_0x5e6427[_0x2c64('0x28')]['on']('data',function(_0xbc7e66){logger[_0x2c64('0x1b')](String(_0xbc7e66));});_0x5e6427[_0x2c64('0x29')]['on'](_0x2c64('0x64'),function(_0x2c8bae){logger['info'](String(_0x2c8bae));});var _0x44afe9=0x1;var _0x212b26=0x3;var _0xc05258=setInterval(function(){if(_0x44afe9<=_0x212b26){var _0x5bf3c6=shell['exec'](_0x2c64('0x43'),{'silent':!![]})[_0x2c64('0x28')];if(_0x5bf3c6){clearInterval(_0xc05258);FusionSettings[_0x2c64('0x3d')]['fusion_diagnostics_running']={'process':_0x5bf3c6,'socket':_0x46c993[_0x2c64('0x68')][_0x2c64('0x4c')]};io[_0x2c64('0x2b')][_0x2c64('0xb')]('diagnostics_running',FusionSettings[_0x2c64('0x3d')][_0x2c64('0x2d')]);return _0x34a316[_0x2c64('0x18')](0xc8)['json']({'serverMessage':'Diagnostic\x20tool\x20started\x20successfully'});}else{_0x44afe9++;}}else{clearInterval(_0xc05258);return _0x34a316[_0x2c64('0x18')](0x1f4)['send'](_0x2c64('0x7'));}},0x12c);}else{return _0x34a316[_0x2c64('0x18')](0xc8)['json']({'serverMessage':_0x2c64('0x3b')});}});app['get'](_0x2c64('0x6b'),function(_0x1b236a,_0x359787){if(os[_0x2c64('0x37')]()!=_0x2c64('0x0')){shell[_0x2c64('0x56')](_0x2c64('0x1a'),{'silent':!![]});shell[_0x2c64('0x56')](_0x2c64('0x43'),{'silent':!![]},function(_0x40fa69,_0x11d551,_0x179ab7){(function(_0x3bdb28){var _0x2c1c33=_0x3bdb28['trim']();if(_0x2c1c33){return _0x359787[_0x2c64('0x18')](0x1f4)['send'](_0x2c64('0x59'));}else{FusionSettings[_0x2c64('0x3d')][_0x2c64('0x2d')]=null;io['sockets']['emit']('diagnostics_running',FusionSettings['SocketVariables']['fusion_diagnostics_running']);_0x5e6427=null;return _0x359787[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':'Diagnostic\x20tool\x20stopped\x20successfully'});}}(_0x11d551['trim']()));});}else{return _0x359787['status'](0xc8)['json']({'serverMessage':_0x2c64('0x3b')});}});app[_0x2c64('0x60')]('/api/autonomous',async function(_0x493a91,_0x554d40){try{const _0x42e88e=await autonomous[_0x2c64('0xa')]()[_0x2c64('0x56')]();return _0x554d40[_0x2c64('0x23')](_0x42e88e);}catch(_0x4294c8){return _0x554d40[_0x2c64('0x18')](0x1f4)['send'](error['message']);}});app['post']('/api/autonomous',async function(_0x5cbf31,_0x30382b){try{const _0xa6724=await autonomous['findOneAndUpdate']({},_0x5cbf31[_0x2c64('0x68')]);return _0x30382b[_0x2c64('0x18')](0xc8)[_0x2c64('0x23')]({'serverMessage':_0x2c64('0x6a')});}catch(_0x3f378e){return _0x30382b[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x3f378e[_0x2c64('0x46')]);}});app[_0x2c64('0x5')](_0x2c64('0xe'),async function(_0x3ee43f,_0x13e013){try{const _0x43abc1=_0x3ee43f[_0x2c64('0x68')][_0x2c64('0x71')];const _0x3429ad=_0x3ee43f[_0x2c64('0x68')][_0x2c64('0x67')];const _0x3a738c=await fs[_0x2c64('0x3a')]('./app/filesystem/'+_0x43abc1+'/'+_0x3429ad);return _0x13e013['status'](0xc8)[_0x2c64('0x23')]({'files':_0x3a738c});}catch(_0x202bd8){return _0x13e013[_0x2c64('0x18')](0x1f4)[_0x2c64('0x31')](_0x202bd8[_0x2c64('0x46')]);}});function _0x30947d(){return function(_0x263067,_0x4e15d2,_0xbee5b1){if(_0x263067['isAuthenticated']()){return _0xbee5b1();}else{_0x4e15d2[_0x2c64('0x18')](0x191)['send'](_0x2c64('0x2c'));}};}}();