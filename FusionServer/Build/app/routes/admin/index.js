var _0x5c2a=['shelljs','Wifi\x20file\x20not\x20found','split','/etc/hostapd/hostapd.conf','Restart\x20Commencing','attachment;\x20filename=','wifi-connection','config','/api/admin/wirelessConnections','pipe','sudo\x20wpa_cli\x20-i\x20','SSID','win32','Unable\x20to\x20stop\x20diagnostic\x20tool','Error\x20disconnecting','wireless-tools/wpa_cli','hiddenNetwork','Content-disposition','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','../../etc/config-wap/hostapd.conf__npp.sh','/api/autonomousPrograms','INACTIVE','utf8','../../express','get','wpa_passphrase','SocketVariables','wireless-tools/wpa_supplicant','poweroff','length','\x09psk=\x22','sockets','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','COMPLETED','exec','generateHash','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','wpa_passphrase\x20\x22','Retreived\x20wireless\x20connections','ASSOCIATING','findOneAndUpdate','\x20\x20\x20\x20ssid=\x22','\x20\x20\x20\x20key_mgmt=NONE\x0a','/api/admin/wirelessSettings','\x22\x20\x22','Error\x20reading\x20crash\x20file','message','/api/admin/crashReport','ssid','readdir','platform','Username\x20already\x20taken.','Successfully\x20changed\x20wifi\x20settings','No\x20crash\x20files\x20found','download','type','/api/autonomous','Error\x20connecting\x20to\x20','readFile','fs-extra','Wifi_NIC','etc','../../global/fusionSettings','\x09ssid=\x22','body','\x20reconfigure','Ip\x20address:\x20','Not\x20configured..','update_config=1\x0a','../../diagnostics/runRemi.sh','DISCONNECTED','AUTHENTICATING','socketId','../../socket','fusion_diagnostics_running','send','join','network={\x0a','username','save','\x20successfully','stdout','python','exports','Diagnostic\x20tool\x20stopped\x20successfully','indexOf','/api/admin/wirelessConnections/disconnect','/api/admin/powerOff','scan','child_process','EOL','Disconnect\x20not\x20available\x20on\x20Windows','../../models/user','json','ssid_set.py','Password','emit','status','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','post','mkdirp','trim','data','Updated\x20successfully','info','\x09key_mgmt=WPA-PSK\x0a','}\x0a\x0a','password','Diagnostic\x20tool\x20started\x20successfully','close','.crash','./app/filesystem/','country=US\x0a\x0a','sudo','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','writeFile','generateFileSystem','wpa_state','diagnostics_running','spawn','User\x20Unauthenticated'];(function(_0x342e54,_0x5c2abc){var _0x4f29b8=function(_0xa9328d){while(--_0xa9328d){_0x342e54['push'](_0x342e54['shift']());}};_0x4f29b8(++_0x5c2abc);}(_0x5c2a,0x13f));var _0x4f29=function(_0x342e54,_0x5c2abc){_0x342e54=_0x342e54-0x0;var _0x4f29b8=_0x5c2a[_0x342e54];return _0x4f29b8;};var fs=require(_0x4f29('0x67'));var mkdirp=require(_0x4f29('0x17'));var os=require('os');var path=require('path');var shell=require(_0x4f29('0x2c'));var wpa_cli=require(_0x4f29('0x3b'));var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require(_0x4f29('0x47'));var spawn=require(_0x4f29('0xc'))[_0x4f29('0x2a')];const config=require(_0x4f29('0x33'));const autonomous=require('../../models/autonomous');const logger=require('../../utils/logger');let nicInterface=config[_0x4f29('0x44')](_0x4f29('0x68'));const app=require(_0x4f29('0x43'));const User=require(_0x4f29('0xf'));const io=require(_0x4f29('0x75'));const FusionSettings=require(_0x4f29('0x6a'));module[_0x4f29('0x6')]=function(){app[_0x4f29('0x16')]('/api/admin/users',_0x74bce2(),function(_0x1c5990,_0x1b6ed4){User['findOne']({'username':_0x1c5990[_0x4f29('0x6c')][_0x4f29('0x1')]},async function(_0x58a355,_0x30a86b){if(_0x58a355)return _0x1b6ed4[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x58a355);if(_0x30a86b){return _0x1b6ed4[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x4f29('0x5f'));}else{var _0x2ec3f7=new User(_0x1c5990['body']);_0x2ec3f7[_0x4f29('0x1')]=_0x1c5990[_0x4f29('0x6c')]['username'];_0x2ec3f7[_0x4f29('0x1e')]=_0x2ec3f7[_0x4f29('0x4f')](_0x1c5990[_0x4f29('0x6c')][_0x4f29('0x1e')]);_0x2ec3f7['filepath']=await _0x2ec3f7[_0x4f29('0x27')](_0x2ec3f7['username']);_0x2ec3f7[_0x4f29('0x2')](function(_0x3e070b){if(_0x3e070b)return _0x1b6ed4['status'](0x1f4)[_0x4f29('0x77')](_0x3e070b);return _0x1b6ed4[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':'User\x20created!'});});}});});app['get'](_0x4f29('0xa'),function(_0xa75313,_0xab7cab){_0xab7cab[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':'Shut\x20Down\x20Commencing'});var _0x3417a9=require('child_process')[_0x4f29('0x2a')];var _0x3196d0=_0x3417a9(_0x4f29('0x24'),[_0x4f29('0x48')]);});app[_0x4f29('0x44')]('/api/admin/restart',function(_0x16b48e,_0x1dcfdb){_0x1dcfdb[_0x4f29('0x14')](0xc8)['send'](_0x4f29('0x30'));var _0xe9469b=require('child_process')[_0x4f29('0x2a')];var _0x415cbb=_0xe9469b('sudo',['reboot']);});app[_0x4f29('0x44')]('/api/admin/wirelessSettings',function(_0x3f7ba,_0x2f8cdf){var _0x57ae4e;var _0x4dcafa=require('os')[_0x4f29('0xd')];var _0x3e92c6;var _0x54de94;var _0x84c1eb={};if(os[_0x4f29('0x5e')]()==_0x4f29('0x38')){_0x57ae4e=_0x4f29('0x3f');fs[_0x4f29('0x66')](_0x57ae4e,_0x4f29('0x42'),function(_0x28b775,_0x418237){if(_0x28b775)_0x2f8cdf[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x4f29('0x2d'));_0x3e92c6=_0x418237[_0x4f29('0x2e')]('\x0a');for(var _0x213601=0x0;_0x213601<_0x3e92c6[_0x4f29('0x49')];_0x213601++){_0x54de94=_0x3e92c6[_0x213601]['split']('=');if(_0x54de94[0x0]==_0x4f29('0x5c'))_0x84c1eb[_0x4f29('0x37')]=_0x54de94[0x1];else if(_0x54de94[0x0]==_0x4f29('0x45'))_0x84c1eb['Password']=_0x54de94[0x1];}_0x2f8cdf[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'SSID':_0x84c1eb[_0x4f29('0x37')],'Password':_0x84c1eb['Password']});});}else{_0x57ae4e=_0x4f29('0x2f');fs['readFile'](_0x57ae4e,'utf8',function(_0x4ad330,_0x26e988){if(_0x4ad330)_0x2f8cdf[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x4f29('0x2d'));_0x3e92c6=_0x26e988[_0x4f29('0x2e')](_0x4dcafa);for(var _0x57d2d7=0x0;_0x57d2d7<_0x3e92c6[_0x4f29('0x49')];_0x57d2d7++){_0x54de94=_0x3e92c6[_0x57d2d7][_0x4f29('0x2e')]('=');if(_0x54de94[0x0]=='ssid')_0x84c1eb['SSID']=_0x54de94[0x1];else if(_0x54de94[0x0]=='wpa_passphrase')_0x84c1eb[_0x4f29('0x12')]=_0x54de94[0x1];}if(!_0x84c1eb[_0x4f29('0x37')]){_0x84c1eb[_0x4f29('0x37')]=_0x4f29('0x6f');_0x84c1eb[_0x4f29('0x12')]='';}_0x2f8cdf[_0x4f29('0x14')](0xc8)['json']({'SSID':_0x84c1eb['SSID'],'Password':_0x84c1eb[_0x4f29('0x12')]});});}});app[_0x4f29('0x16')](_0x4f29('0x57'),function(_0xeabfca,_0x2cbd8e){try{var _0x43fdf9;var _0x86d942;var _0x451cd9=path[_0x4f29('0x78')]('..','..',_0x4f29('0x69'),_0x4f29('0x11'));if(_0xeabfca[_0x4f29('0x6c')][_0x4f29('0x5c')]==null&&_0xeabfca['body'][_0x4f29('0x1e')]==null)_0x86d942=['python',_0x451cd9,'-d'];else _0x86d942=[_0x4f29('0x5'),_0x451cd9,'-s',_0xeabfca[_0x4f29('0x6c')]['ssid'],'-p',_0xeabfca[_0x4f29('0x6c')][_0x4f29('0x1e')]];var _0x4e3a49=require('child_process')[_0x4f29('0x2a')];python_process=_0x4e3a49(_0x4f29('0x24'),_0x86d942,{'stdio':_0x4f29('0x35')});python_process['stderr']['on'](_0x4f29('0x19'),function(_0x4ab5d2){logger['info'](String(_0x4ab5d2));_0x43fdf9=String(_0x4ab5d2);});python_process[_0x4f29('0x4')]['on'](_0x4f29('0x20'),function(_0x340cf8){if(_0x43fdf9)return _0x2cbd8e[_0x4f29('0x14')](0x1f4)['send'](_0x43fdf9);else return _0x2cbd8e['status'](0xc8)['json']({'serverMessage':_0x4f29('0x60')});});}catch(_0x4a5d92){logger['info'](_0x4a5d92);return _0x2cbd8e['status'](0x1f4)[_0x4f29('0x77')](_0x4a5d92);}});app[_0x4f29('0x44')]('/api/admin/wirelessConnections',function(_0x1188a1,_0x59695c){if(os[_0x4f29('0x5e')]()=='win32'){return _0x59695c[_0x4f29('0x14')](0xc8)[_0x4f29('0x77')]();}else{iwlist[_0x4f29('0xb')](nicInterface,function(_0x538ded,_0x3dcc95){if(_0x538ded)return _0x59695c[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')]('Wireless\x20interface\x20not\x20found');else return _0x59695c[_0x4f29('0x14')](0xc8)[_0x4f29('0x77')]({'serverMessage':_0x4f29('0x52'),'data':_0x3dcc95});});}});app['post'](_0x4f29('0x34'),function(_0xcde059,_0x29fae7){var _0x53a772=undefined;var _0x194785=_0x4f29('0x3e')+_0x4f29('0x70')+_0x4f29('0x23');var _0x537e7b=_0x4f29('0x0')+_0x4f29('0x6b')+_0xcde059['body'][_0x4f29('0x5c')]+'\x22\x0a'+'\x09scan_ssid=1\x0a'+_0x4f29('0x4a')+_0xcde059['body'][_0x4f29('0x1e')]+'\x22\x0a'+_0x4f29('0x1c')+_0x4f29('0x1d');if(_0xcde059['body'][_0x4f29('0x1e')]){_0x53a772=shell['exec'](_0x4f29('0x51')+_0xcde059[_0x4f29('0x6c')][_0x4f29('0x5c')]+_0x4f29('0x58')+_0xcde059[_0x4f29('0x6c')][_0x4f29('0x1e')]+'\x22',{'silent':!![]})[_0x4f29('0x4')];}else{_0x53a772=_0x4f29('0x0')+_0x4f29('0x55')+_0xcde059[_0x4f29('0x6c')][_0x4f29('0x5c')]+'\x22\x0a'+_0x4f29('0x56')+'}\x0a';}let _0x12598c='';if(_0xcde059[_0x4f29('0x6c')][_0x4f29('0x3c')])_0x12598c=_0x194785+_0x537e7b;else _0x12598c=_0x194785+_0x53a772;fs[_0x4f29('0x26')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x12598c,function(_0x575476){if(_0x575476)return _0x29fae7[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x575476);shell[_0x4f29('0x4e')]('sudo\x20wpa_cli\x20-i\x20'+nicInterface+'\x20reconfigure',{'silent':!![]});const _0x18564a=0x3a98;var _0x34ed1a=0x12c;var _0x36dac4=0x0;var _0x3c8529=setInterval(function(){var _0x66ebdb=['SCANNING','4WAY_HANDSHAKE',_0x4f29('0x73'),_0x4f29('0x72'),_0x4f29('0x53')];wpa_cli[_0x4f29('0x14')](nicInterface,function(_0x518132,_0x451128){if(_0x518132)return _0x29fae7[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x518132);if(_0x451128[_0x4f29('0x28')]==_0x4f29('0x4d')){if(_0x451128['ip']){logger[_0x4f29('0x1b')](_0x4f29('0x6e')+_0x451128['ip']+'\x20assigned');clearInterval(_0x3c8529);FusionSettings[_0x4f29('0x46')]['fusion_wifi_access']=_0x451128;io[_0x4f29('0x4b')][_0x4f29('0x13')](_0x4f29('0x32'),_0x451128);return _0x29fae7[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':'Connected\x20to\x20'+_0xcde059[_0x4f29('0x6c')][_0x4f29('0x5c')]+_0x4f29('0x3')});}else if(_0x36dac4>_0x18564a){logger[_0x4f29('0x1b')](_0x4f29('0x50'));clearInterval(_0x3c8529);return _0x29fae7['status'](0x1f4)[_0x4f29('0x77')]('Error\x20connecting\x20to\x20'+_0xcde059['body'][_0x4f29('0x5c')]);}_0x36dac4+=_0x34ed1a;}else if(_0x66ebdb[_0x4f29('0x8')](_0x451128[_0x4f29('0x28')])==-0x1){clearInterval(_0x3c8529);io[_0x4f29('0x4b')][_0x4f29('0x13')]('wifi-connection',_0x451128);return _0x29fae7['status'](0x1f4)[_0x4f29('0x77')](_0x4f29('0x65')+_0xcde059['body'][_0x4f29('0x5c')]);}});},_0x34ed1a);});});app['get'](_0x4f29('0x9'),function(_0x5cec1c,_0x334691){if(os[_0x4f29('0x5e')]()==_0x4f29('0x38')){_0x334691[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x4f29('0xe'));}else{var _0x4c55dc=_0x4f29('0x3e')+'update_config=1\x0a'+_0x4f29('0x23');fs[_0x4f29('0x26')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x4c55dc,function(_0x2d57d0){if(_0x2d57d0)return _0x334691[_0x4f29('0x14')](0x1f4)['send'](_0x2d57d0);shell[_0x4f29('0x4e')](_0x4f29('0x36')+nicInterface+_0x4f29('0x6d'),{'silent':!![]});var _0x424b60=setInterval(function(){var _0xad9251=[];wpa_cli[_0x4f29('0x14')](nicInterface,function(_0x249bfa,_0x1e8452){if(_0x249bfa)return _0x334691['status'](0x1f4)[_0x4f29('0x77')](_0x249bfa);FusionSettings[_0x4f29('0x46')]['fusion_wifi_access']=_0x1e8452;io['sockets'][_0x4f29('0x13')]('wifi-connection',_0x1e8452);if(_0x1e8452[_0x4f29('0x28')]==_0x4f29('0x72')||_0x1e8452[_0x4f29('0x28')]==_0x4f29('0x41')){clearInterval(_0x424b60);io[_0x4f29('0x4b')][_0x4f29('0x13')](_0x4f29('0x32'),_0x1e8452);return _0x334691[_0x4f29('0x14')](0xc8)['json']({'serverMessage':'Disconnected\x20successfully'});}else if(connectingStatuses['indexOf'](_0x1e8452[_0x4f29('0x28')])==-0x1){clearInterval(_0x424b60);io['sockets'][_0x4f29('0x13')]('wifi-connection',_0x1e8452);return _0x334691['status'](0x1f4)[_0x4f29('0x77')](_0x4f29('0x3a'));}});},0x12c);});}});app[_0x4f29('0x44')](_0x4f29('0x5b'),function(_0x521a72,_0x5160ff){var _0x2a5f81=_0x4f29('0x21');fs[_0x4f29('0x5d')](_0x2a5f81,function(_0x587565,_0x4ba333){if(_0x587565)return _0x5160ff[_0x4f29('0x14')](0x1f4)['send'](_0x587565);if(_0x4ba333[_0x4f29('0x49')]>0x0){fs['readFile'](_0x2a5f81+'/'+_0x4ba333[0x0],_0x4f29('0x42'),function(_0x124780,_0x5930bf){if(_0x124780)return status(0x1f4)[_0x4f29('0x77')](_0x4f29('0x59'));_0x5160ff['setHeader'](_0x4f29('0x3d'),_0x4f29('0x31')+_0x4ba333[0x0]);return _0x5160ff[_0x4f29('0x14')](0xc8)[_0x4f29('0x62')](_0x2a5f81+'/'+_0x4ba333[0x0]);});}else{return _0x5160ff[_0x4f29('0x14')](0xc8)[_0x4f29('0x77')](_0x4f29('0x61'));}});});var _0x1356be=null;app['post']('/api/diagnostics/start',function(_0x188a9b,_0x2c8d6f){if(os[_0x4f29('0x5e')]()!=_0x4f29('0x38')){_0x1356be=spawn('sudo',['sh',_0x4f29('0x71'),'../../diagnostics/diagnosticGUI.py']);_0x1356be[_0x4f29('0x4')]['on']('data',function(_0x2c2def){logger[_0x4f29('0x1b')](String(_0x2c2def));});_0x1356be['stderr']['on'](_0x4f29('0x19'),function(_0x345e74){logger[_0x4f29('0x1b')](String(_0x345e74));});var _0xf76ccb=0x1;var _0x4bc179=0x3;var _0xa20d5b=setInterval(function(){if(_0xf76ccb<=_0x4bc179){var _0x5b51c0=shell[_0x4f29('0x4e')]('ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27',{'silent':!![]})[_0x4f29('0x4')];if(_0x5b51c0){clearInterval(_0xa20d5b);FusionSettings[_0x4f29('0x46')][_0x4f29('0x76')]={'process':_0x5b51c0,'socket':_0x188a9b['body'][_0x4f29('0x74')]};io[_0x4f29('0x4b')][_0x4f29('0x13')](_0x4f29('0x29'),FusionSettings['SocketVariables'][_0x4f29('0x76')]);return _0x2c8d6f[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':_0x4f29('0x1f')});}else{_0xf76ccb++;}}else{clearInterval(_0xa20d5b);return _0x2c8d6f['status'](0x1f4)[_0x4f29('0x77')]('Error\x20starting\x20diagnostic\x20tool');}},0x12c);}else{return _0x2c8d6f['status'](0xc8)[_0x4f29('0x10')]({'serverMessage':_0x4f29('0x15')});}});app[_0x4f29('0x44')]('/api/diagnostics/stop',function(_0x1a1818,_0x4a6eb2){if(os[_0x4f29('0x5e')]()!='win32'){shell[_0x4f29('0x4e')](_0x4f29('0x4c'),{'silent':!![]});shell[_0x4f29('0x4e')](_0x4f29('0x25'),{'silent':!![]},function(_0xc22a90,_0xdc5ed3,_0x25d600){(function(_0x5cbff0){var _0x48f44a=_0x5cbff0[_0x4f29('0x18')]();if(_0x48f44a){return _0x4a6eb2[_0x4f29('0x14')](0x1f4)['send'](_0x4f29('0x39'));}else{FusionSettings[_0x4f29('0x46')][_0x4f29('0x76')]=null;io[_0x4f29('0x4b')]['emit']('diagnostics_running',FusionSettings['SocketVariables'][_0x4f29('0x76')]);_0x1356be=null;return _0x4a6eb2[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':_0x4f29('0x7')});}}(_0xdc5ed3['trim']()));});}else{return _0x4a6eb2[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':_0x4f29('0x15')});}});app['get'](_0x4f29('0x64'),async function(_0x428ea5,_0x59bc5a){try{const _0x44c690=await autonomous['findOne']()['exec']();return _0x59bc5a[_0x4f29('0x10')](_0x44c690);}catch(_0x5a7153){return _0x59bc5a[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](error['message']);}});app['post'](_0x4f29('0x64'),async function(_0x30946f,_0xef8bdd){try{const _0x26ff8e=await autonomous[_0x4f29('0x54')]({},_0x30946f[_0x4f29('0x6c')]);return _0xef8bdd[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'serverMessage':_0x4f29('0x1a')});}catch(_0x2199f6){return _0xef8bdd[_0x4f29('0x14')](0x1f4)[_0x4f29('0x77')](_0x2199f6[_0x4f29('0x5a')]);}});app[_0x4f29('0x16')](_0x4f29('0x40'),async function(_0x448d29,_0x335fbf){try{const _0x5e6ac8=_0x448d29['body'][_0x4f29('0x1')];const _0x27fe05=_0x448d29['body'][_0x4f29('0x63')];const _0x1660e6=await fs[_0x4f29('0x5d')](_0x4f29('0x22')+_0x5e6ac8+'/'+_0x27fe05);return _0x335fbf[_0x4f29('0x14')](0xc8)[_0x4f29('0x10')]({'files':_0x1660e6});}catch(_0x18130d){return _0x335fbf[_0x4f29('0x14')](0x1f4)['send'](_0x18130d[_0x4f29('0x5a')]);}});function _0x74bce2(){return function(_0x2aecf3,_0x6b2ea1,_0x494048){if(_0x2aecf3['isAuthenticated']()){return _0x494048();}else{_0x6b2ea1[_0x4f29('0x14')](0x191)[_0x4f29('0x77')](_0x4f29('0x2b'));}};}}();