var _0x557e=['/api/admin/wirelessConnections/disconnect','SSID','../../express','info','Password','\x09key_mgmt=WPA-PSK\x0a','indexOf','Retreived\x20wireless\x20connections','wifi-connection','utf8','update_config=1\x0a','scan','exec','No\x20crash\x20files\x20found','Not\x20configured..','close','stderr','Ip\x20address:\x20','/api/admin/users','Error\x20connecting\x20to\x20','data','filepath','ASSOCIATING','split','wpa_passphrase','Updated\x20successfully','status','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','../../socket','child_process','etc','../../models/autonomous','User\x20created!','Shut\x20Down\x20Commencing','sockets','/api/admin/powerOff','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','platform','path','wireless-tools/iwlist','body','exports','Error\x20reading\x20crash\x20file','../../utils/logger','wpa_state','Disconnected\x20successfully','/api/admin/wirelessConnections','AUTHENTICATING','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','/api/autonomousPrograms','/api/admin/crashReport','../../global/fusionSettings','mkdirp','/api/admin/wirelessSettings','/etc/hostapd/hostapd.conf','join','../../diagnostics/runRemi.sh','../../models/user','shelljs','fs-extra','post','readFile','ssid','\x20reconfigure','\x20\x20\x20\x20ssid=\x22','network={\x0a','fusion_wifi_access','emit','.crash','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','wireless-tools/wpa_supplicant','readdir','fusion_diagnostics_running','Successfully\x20changed\x20wifi\x20settings','sudo','../../diagnostics/diagnosticGUI.py','spawn','username','download','reboot','EOL','trim','/api/admin/restart','/api/diagnostics/start','get','SocketVariables','User\x20Unauthenticated','Wireless\x20interface\x20not\x20found','4WAY_HANDSHAKE','send','sudo\x20wpa_cli\x20-i\x20','win32','length','attachment;\x20filename=','generateFileSystem','country=US\x0a\x0a','message','python','ssid_set.py','\x20successfully','findOneAndUpdate','password','writeFile','../../etc/config-wap/hostapd.conf__npp.sh','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','Diagnostic\x20tool\x20stopped\x20successfully','DISCONNECTED','Connected\x20to\x20','stdout','Wifi\x20file\x20not\x20found','setHeader','diagnostics_running','/api/autonomous','Disconnect\x20not\x20available\x20on\x20Windows','poweroff','/etc/wpa_supplicant/wpa_supplicant.conf','Unable\x20to\x20stop\x20diagnostic\x20tool','\x09scan_ssid=1\x0a','json','Error\x20starting\x20diagnostic\x20tool','Error\x20disconnecting','type','pipe'];(function(_0x43bebd,_0x557edf){var _0x51deff=function(_0x44919f){while(--_0x44919f){_0x43bebd['push'](_0x43bebd['shift']());}};_0x51deff(++_0x557edf);}(_0x557e,0x180));var _0x51de=function(_0x43bebd,_0x557edf){_0x43bebd=_0x43bebd-0x0;var _0x51deff=_0x557e[_0x43bebd];return _0x51deff;};var fs=require(_0x51de('0x2c'));var mkdirp=require(_0x51de('0x25'));var os=require('os');var path=require(_0x51de('0x17'));var shell=require(_0x51de('0x2b'));var wpa_cli=require('wireless-tools/wpa_cli');var iwlist=require(_0x51de('0x18'));var wpa_supplicant=require(_0x51de('0x37'));var spawn=require(_0x51de('0xe'))[_0x51de('0x3d')];const config=require('config');const autonomous=require(_0x51de('0x10'));const logger=require(_0x51de('0x1c'));let nicInterface=config[_0x51de('0x45')]('Wifi_NIC');const app=require(_0x51de('0x6e'));const User=require(_0x51de('0x2a'));const io=require(_0x51de('0xd'));const FusionSettings=require(_0x51de('0x24'));module[_0x51de('0x1a')]=function(){app[_0x51de('0x2d')](_0x51de('0x3'),_0x68c03f(),function(_0x15550c,_0xcfc928){User['findOne']({'username':_0x15550c[_0x51de('0x19')][_0x51de('0x3e')]},async function(_0x213e83,_0x1039d0){if(_0x213e83)return _0xcfc928[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x213e83);if(_0x1039d0){return _0xcfc928['status'](0x1f4)['send']('Username\x20already\x20taken.');}else{var _0x1cb5a6=new User(_0x15550c[_0x51de('0x19')]);_0x1cb5a6[_0x51de('0x3e')]=_0x15550c[_0x51de('0x19')][_0x51de('0x3e')];_0x1cb5a6[_0x51de('0x56')]=_0x1cb5a6['generateHash'](_0x15550c[_0x51de('0x19')][_0x51de('0x56')]);_0x1cb5a6[_0x51de('0x6')]=await _0x1cb5a6[_0x51de('0x4f')](_0x1cb5a6[_0x51de('0x3e')]);_0x1cb5a6['save'](function(_0x223827){if(_0x223827)return _0xcfc928[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x223827);return _0xcfc928[_0x51de('0xb')](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0x11')});});}});});app[_0x51de('0x45')](_0x51de('0x14'),function(_0x4dc8d4,_0x5a277a){_0x5a277a[_0x51de('0xb')](0xc8)['json']({'serverMessage':_0x51de('0x12')});var _0x4bd4ce=require('child_process')[_0x51de('0x3d')];var _0x47ff73=_0x4bd4ce(_0x51de('0x3b'),[_0x51de('0x63')]);});app[_0x51de('0x45')](_0x51de('0x43'),function(_0x28c9b9,_0x50f1cc){_0x50f1cc[_0x51de('0xb')](0xc8)[_0x51de('0x4a')]('Restart\x20Commencing');var _0x530c78=require(_0x51de('0xe'))['spawn'];var _0x27fc8c=_0x530c78(_0x51de('0x3b'),[_0x51de('0x40')]);});app[_0x51de('0x45')](_0x51de('0x26'),function(_0x1317e4,_0xbb44c9){var _0x37589d;var _0x1f0e90=require('os')[_0x51de('0x41')];var _0x2a3243;var _0x59b30a;var _0x3f78de={};if(os[_0x51de('0x16')]()==_0x51de('0x4c')){_0x37589d=_0x51de('0x58');fs[_0x51de('0x2e')](_0x37589d,_0x51de('0x75'),function(_0x475b62,_0x230196){if(_0x475b62)_0xbb44c9['status'](0x1f4)[_0x51de('0x4a')](_0x51de('0x5e'));_0x2a3243=_0x230196[_0x51de('0x8')]('\x0a');for(var _0x425922=0x0;_0x425922<_0x2a3243[_0x51de('0x4d')];_0x425922++){_0x59b30a=_0x2a3243[_0x425922]['split']('=');if(_0x59b30a[0x0]==_0x51de('0x2f'))_0x3f78de[_0x51de('0x6d')]=_0x59b30a[0x1];else if(_0x59b30a[0x0]==_0x51de('0x9'))_0x3f78de[_0x51de('0x70')]=_0x59b30a[0x1];}_0xbb44c9['status'](0xc8)[_0x51de('0x67')]({'SSID':_0x3f78de['SSID'],'Password':_0x3f78de[_0x51de('0x70')]});});}else{_0x37589d=_0x51de('0x27');fs['readFile'](_0x37589d,_0x51de('0x75'),function(_0x1054ac,_0xb29bb){if(_0x1054ac)_0xbb44c9[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x5e'));_0x2a3243=_0xb29bb[_0x51de('0x8')](_0x1f0e90);for(var _0xae9113=0x0;_0xae9113<_0x2a3243[_0x51de('0x4d')];_0xae9113++){_0x59b30a=_0x2a3243[_0xae9113][_0x51de('0x8')]('=');if(_0x59b30a[0x0]==_0x51de('0x2f'))_0x3f78de['SSID']=_0x59b30a[0x1];else if(_0x59b30a[0x0]==_0x51de('0x9'))_0x3f78de['Password']=_0x59b30a[0x1];}if(!_0x3f78de[_0x51de('0x6d')]){_0x3f78de[_0x51de('0x6d')]=_0x51de('0x7a');_0x3f78de[_0x51de('0x70')]='';}_0xbb44c9[_0x51de('0xb')](0xc8)[_0x51de('0x67')]({'SSID':_0x3f78de[_0x51de('0x6d')],'Password':_0x3f78de[_0x51de('0x70')]});});}});app[_0x51de('0x2d')](_0x51de('0x26'),function(_0x4e97ff,_0x29ce89){try{var _0x1f5223;var _0x51e6ee;var _0x2929b2=path[_0x51de('0x28')]('..','..',_0x51de('0xf'),_0x51de('0x53'));if(_0x4e97ff[_0x51de('0x19')]['ssid']==null&&_0x4e97ff[_0x51de('0x19')][_0x51de('0x56')]==null)_0x51e6ee=[_0x51de('0x52'),_0x2929b2,'-d'];else _0x51e6ee=[_0x51de('0x52'),_0x2929b2,'-s',_0x4e97ff[_0x51de('0x19')][_0x51de('0x2f')],'-p',_0x4e97ff[_0x51de('0x19')]['password']];var _0x1f899f=require('child_process')[_0x51de('0x3d')];python_process=_0x1f899f(_0x51de('0x3b'),_0x51e6ee,{'stdio':_0x51de('0x6b')});python_process[_0x51de('0x1')]['on']('data',function(_0x193754){logger[_0x51de('0x6f')](String(_0x193754));_0x1f5223=String(_0x193754);});python_process['stdout']['on'](_0x51de('0x0'),function(_0x459c9b){if(_0x1f5223)return _0x29ce89[_0x51de('0xb')](0x1f4)['send'](_0x1f5223);else return _0x29ce89[_0x51de('0xb')](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0x3a')});});}catch(_0x11616e){logger[_0x51de('0x6f')](_0x11616e);return _0x29ce89[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x11616e);}});app[_0x51de('0x45')]('/api/admin/wirelessConnections',function(_0x2439e7,_0x5b4269){if(os[_0x51de('0x16')]()==_0x51de('0x4c')){return _0x5b4269['status'](0xc8)[_0x51de('0x4a')]();}else{iwlist[_0x51de('0x77')](nicInterface,function(_0x48a3ab,_0x502c1f){if(_0x48a3ab)return _0x5b4269[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x48'));else return _0x5b4269[_0x51de('0xb')](0xc8)[_0x51de('0x4a')]({'serverMessage':_0x51de('0x73'),'data':_0x502c1f});});}});app[_0x51de('0x2d')](_0x51de('0x1f'),function(_0x165942,_0x50e93d){var _0x2702d9=undefined;var _0xdc8079=_0x51de('0x15')+_0x51de('0x76')+'country=US\x0a\x0a';var _0x131820=_0x51de('0x32')+'\x09ssid=\x22'+_0x165942[_0x51de('0x19')]['ssid']+'\x22\x0a'+_0x51de('0x66')+'\x09psk=\x22'+_0x165942[_0x51de('0x19')][_0x51de('0x56')]+'\x22\x0a'+_0x51de('0x71')+'}\x0a\x0a';if(_0x165942[_0x51de('0x19')][_0x51de('0x56')]){_0x2702d9=shell[_0x51de('0x78')]('wpa_passphrase\x20\x22'+_0x165942['body']['ssid']+'\x22\x20\x22'+_0x165942[_0x51de('0x19')][_0x51de('0x56')]+'\x22',{'silent':!![]})['stdout'];}else{_0x2702d9=_0x51de('0x32')+_0x51de('0x31')+_0x165942[_0x51de('0x19')][_0x51de('0x2f')]+'\x22\x0a'+'\x20\x20\x20\x20key_mgmt=NONE\x0a'+'}\x0a';}let _0x373b9a='';if(_0x165942['body']['hiddenNetwork'])_0x373b9a=_0xdc8079+_0x131820;else _0x373b9a=_0xdc8079+_0x2702d9;fs[_0x51de('0x57')](_0x51de('0x64'),_0x373b9a,function(_0x13c027){if(_0x13c027)return _0x50e93d[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x13c027);shell[_0x51de('0x78')](_0x51de('0x4b')+nicInterface+_0x51de('0x30'),{'silent':!![]});const _0x4e99ec=0x3a98;var _0x4c8005=0x12c;var _0x226702=0x0;var _0x31b4f7=setInterval(function(){var _0x460034=['SCANNING',_0x51de('0x49'),_0x51de('0x20'),_0x51de('0x5b'),_0x51de('0x7')];wpa_cli['status'](nicInterface,function(_0x74935b,_0x38dde9){if(_0x74935b)return _0x50e93d[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x74935b);if(_0x38dde9['wpa_state']=='COMPLETED'){if(_0x38dde9['ip']){logger[_0x51de('0x6f')](_0x51de('0x2')+_0x38dde9['ip']+'\x20assigned');clearInterval(_0x31b4f7);FusionSettings[_0x51de('0x46')][_0x51de('0x33')]=_0x38dde9;io[_0x51de('0x13')][_0x51de('0x34')](_0x51de('0x74'),_0x38dde9);return _0x50e93d['status'](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0x5c')+_0x165942[_0x51de('0x19')][_0x51de('0x2f')]+_0x51de('0x54')});}else if(_0x226702>_0x4e99ec){logger['info'](_0x51de('0x36'));clearInterval(_0x31b4f7);return _0x50e93d['status'](0x1f4)[_0x51de('0x4a')](_0x51de('0x4')+_0x165942['body']['ssid']);}_0x226702+=_0x4c8005;}else if(_0x460034[_0x51de('0x72')](_0x38dde9[_0x51de('0x1d')])==-0x1){clearInterval(_0x31b4f7);io['sockets'][_0x51de('0x34')](_0x51de('0x74'),_0x38dde9);return _0x50e93d[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x4')+_0x165942[_0x51de('0x19')][_0x51de('0x2f')]);}});},_0x4c8005);});});app['get'](_0x51de('0x6c'),function(_0x1d8711,_0x57ef07){if(os[_0x51de('0x16')]()==_0x51de('0x4c')){_0x57ef07[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x62'));}else{var _0x2f6539=_0x51de('0x15')+_0x51de('0x76')+_0x51de('0x50');fs['writeFile'](_0x51de('0x64'),_0x2f6539,function(_0x5b81ce){if(_0x5b81ce)return _0x57ef07[_0x51de('0xb')](0x1f4)['send'](_0x5b81ce);shell[_0x51de('0x78')](_0x51de('0x4b')+nicInterface+'\x20reconfigure',{'silent':!![]});var _0x5a195d=setInterval(function(){var _0xa8737b=[];wpa_cli[_0x51de('0xb')](nicInterface,function(_0xa7050c,_0x3a50f4){if(_0xa7050c)return _0x57ef07['status'](0x1f4)[_0x51de('0x4a')](_0xa7050c);FusionSettings['SocketVariables']['fusion_wifi_access']=_0x3a50f4;io[_0x51de('0x13')]['emit']('wifi-connection',_0x3a50f4);if(_0x3a50f4[_0x51de('0x1d')]==_0x51de('0x5b')||_0x3a50f4[_0x51de('0x1d')]=='INACTIVE'){clearInterval(_0x5a195d);io[_0x51de('0x13')][_0x51de('0x34')](_0x51de('0x74'),_0x3a50f4);return _0x57ef07[_0x51de('0xb')](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0x1e')});}else if(connectingStatuses['indexOf'](_0x3a50f4[_0x51de('0x1d')])==-0x1){clearInterval(_0x5a195d);io[_0x51de('0x13')][_0x51de('0x34')](_0x51de('0x74'),_0x3a50f4);return _0x57ef07[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x69'));}});},0x12c);});}});app[_0x51de('0x45')](_0x51de('0x23'),function(_0x3fe7b8,_0xe2afb6){var _0x53ac2c=_0x51de('0x35');fs[_0x51de('0x38')](_0x53ac2c,function(_0x2151b7,_0x3c0383){if(_0x2151b7)return _0xe2afb6[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x2151b7);if(_0x3c0383['length']>0x0){fs[_0x51de('0x2e')](_0x53ac2c+'/'+_0x3c0383[0x0],_0x51de('0x75'),function(_0x3282e0,_0x1f2a71){if(_0x3282e0)return status(0x1f4)[_0x51de('0x4a')](_0x51de('0x1b'));_0xe2afb6[_0x51de('0x5f')]('Content-disposition',_0x51de('0x4e')+_0x3c0383[0x0]);return _0xe2afb6[_0x51de('0xb')](0xc8)[_0x51de('0x3f')](_0x53ac2c+'/'+_0x3c0383[0x0]);});}else{return _0xe2afb6[_0x51de('0xb')](0xc8)['send'](_0x51de('0x79'));}});});var _0x416922=null;app[_0x51de('0x2d')](_0x51de('0x44'),function(_0x52f90a,_0x3f66d8){if(os[_0x51de('0x16')]()!=_0x51de('0x4c')){_0x416922=spawn(_0x51de('0x3b'),['sh',_0x51de('0x29'),_0x51de('0x3c')]);_0x416922[_0x51de('0x5d')]['on'](_0x51de('0x5'),function(_0x2dbb9e){logger['info'](String(_0x2dbb9e));});_0x416922['stderr']['on']('data',function(_0x390dc7){logger['info'](String(_0x390dc7));});var _0x4cad4d=0x1;var _0xa60fa6=0x3;var _0x66baf7=setInterval(function(){if(_0x4cad4d<=_0xa60fa6){var _0x2e5099=shell[_0x51de('0x78')](_0x51de('0x59'),{'silent':!![]})[_0x51de('0x5d')];if(_0x2e5099){clearInterval(_0x66baf7);FusionSettings[_0x51de('0x46')][_0x51de('0x39')]={'process':_0x2e5099,'socket':_0x52f90a[_0x51de('0x19')]['socketId']};io[_0x51de('0x13')][_0x51de('0x34')]('diagnostics_running',FusionSettings['SocketVariables'][_0x51de('0x39')]);return _0x3f66d8[_0x51de('0xb')](0xc8)[_0x51de('0x67')]({'serverMessage':'Diagnostic\x20tool\x20started\x20successfully'});}else{_0x4cad4d++;}}else{clearInterval(_0x66baf7);return _0x3f66d8[_0x51de('0xb')](0x1f4)['send'](_0x51de('0x68'));}},0x12c);}else{return _0x3f66d8[_0x51de('0xb')](0xc8)['json']({'serverMessage':_0x51de('0xc')});}});app[_0x51de('0x45')]('/api/diagnostics/stop',function(_0x5dd979,_0x250362){if(os[_0x51de('0x16')]()!=_0x51de('0x4c')){shell[_0x51de('0x78')](_0x51de('0x21'),{'silent':!![]});shell['exec']('ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27',{'silent':!![]},function(_0x4b7d69,_0x51e7da,_0xa99465){(function(_0xf582e9){var _0xb43c4d=_0xf582e9[_0x51de('0x42')]();if(_0xb43c4d){return _0x250362[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x51de('0x65'));}else{FusionSettings[_0x51de('0x46')][_0x51de('0x39')]=null;io[_0x51de('0x13')][_0x51de('0x34')](_0x51de('0x60'),FusionSettings[_0x51de('0x46')][_0x51de('0x39')]);_0x416922=null;return _0x250362['status'](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0x5a')});}}(_0x51e7da[_0x51de('0x42')]()));});}else{return _0x250362['status'](0xc8)[_0x51de('0x67')]({'serverMessage':_0x51de('0xc')});}});app[_0x51de('0x45')](_0x51de('0x61'),async function(_0x23e808,_0x5dc6c0){try{const _0x27aa45=await autonomous['findOne']()[_0x51de('0x78')]();return _0x5dc6c0[_0x51de('0x67')](_0x27aa45);}catch(_0x1cc883){return _0x5dc6c0[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](error[_0x51de('0x51')]);}});app[_0x51de('0x2d')](_0x51de('0x61'),async function(_0x29a631,_0x3733e6){try{const _0x609d91=await autonomous[_0x51de('0x55')]({},_0x29a631[_0x51de('0x19')]);return _0x3733e6['status'](0xc8)['json']({'serverMessage':_0x51de('0xa')});}catch(_0x38b6c1){return _0x3733e6[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x38b6c1[_0x51de('0x51')]);}});app[_0x51de('0x2d')](_0x51de('0x22'),async function(_0x36c093,_0x384215){try{const _0x2fde50=_0x36c093[_0x51de('0x19')]['username'];const _0x36b59d=_0x36c093[_0x51de('0x19')][_0x51de('0x6a')];const _0x370cb0=await fs[_0x51de('0x38')]('./app/filesystem/'+_0x2fde50+'/'+_0x36b59d);return _0x384215['status'](0xc8)[_0x51de('0x67')]({'files':_0x370cb0});}catch(_0x319a9b){return _0x384215[_0x51de('0xb')](0x1f4)[_0x51de('0x4a')](_0x319a9b['message']);}});function _0x68c03f(){return function(_0xd5514,_0x1b6969,_0x5cc86f){if(_0xd5514['isAuthenticated']()){return _0x5cc86f();}else{_0x1b6969[_0x51de('0xb')](0x191)[_0x51de('0x4a')](_0x51de('0x47'));}};}}();