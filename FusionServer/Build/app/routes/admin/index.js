var _0xd44a=['exec','stdout','send','/api/admin/wirelessConnections/disconnect','Password','path','get','mkdirp','/api/admin/wirelessConnections','hiddenNetwork','attachment;\x20filename=','indexOf','/api/autonomousPrograms','Retreived\x20wireless\x20connections','emit','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','Successfully\x20changed\x20wifi\x20settings','/etc/wpa_supplicant/wpa_supplicant.conf','generateFileSystem','type','python','\x20successfully','../../etc/config-wap/hostapd.conf__npp.sh','Restart\x20Commencing','../../models/user','.crash','AUTHENTICATING','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','fs-extra','/api/admin/restart','DISCONNECTED','wpa_passphrase','scan','sockets','status','socketId','wpa_passphrase\x20\x22','Disconnected\x20successfully','\x09psk=\x22','wifi-connection','pipe','../../diagnostics/runRemi.sh','Error\x20starting\x20diagnostic\x20tool','Not\x20configured..','/api/autonomous','4WAY_HANDSHAKE','body','stderr','win32','utf8','\x09ssid=\x22','country=US\x0a\x0a','wireless-tools/iwlist','SocketVariables','\x20\x20\x20\x20key_mgmt=NONE\x0a','Ip\x20address:\x20','findOne','readFile','trim','info','ASSOCIATING','ssid_set.py','etc','isAuthenticated','EOL','Diagnostic\x20tool\x20started\x20successfully','post','Wifi_NIC','\x09key_mgmt=WPA-PSK\x0a','password','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','data','../../utils/logger','Error\x20connecting\x20to\x20','setHeader','Shut\x20Down\x20Commencing','writeFile','wpa_state','generateHash','/api/diagnostics/stop','fusion_wifi_access','filepath','sudo\x20wpa_cli\x20-i\x20','fusion_diagnostics_running','platform','network={\x0a','\x20reconfigure','username','Unable\x20to\x20stop\x20diagnostic\x20tool','child_process','\x20assigned','readdir','Error\x20disconnecting','Content-disposition','SSID','Wifi\x20file\x20not\x20found','message','ssid','/api/admin/crashReport','\x20\x20\x20\x20ssid=\x22','../../global/fusionSettings','split','sudo','close','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','Error\x20reading\x20crash\x20file','json','/api/admin/powerOff','diagnostics_running','Updated\x20successfully','/api/admin/wirelessSettings','findOneAndUpdate','Connected\x20to\x20','shelljs','../../models/autonomous','update_config=1\x0a','exports','spawn','config','./app/filesystem/','/api/diagnostics/start','length','join','\x09scan_ssid=1\x0a','User\x20created!','/etc/hostapd/hostapd.conf'];(function(_0xaf6821,_0xd44a5){var _0x5c9eae=function(_0x415087){while(--_0x415087){_0xaf6821['push'](_0xaf6821['shift']());}};_0x5c9eae(++_0xd44a5);}(_0xd44a,0x92));var _0x5c9e=function(_0xaf6821,_0xd44a5){_0xaf6821=_0xaf6821-0x0;var _0x5c9eae=_0xd44a[_0xaf6821];return _0x5c9eae;};var fs=require(_0x5c9e('0x9'));var mkdirp=require(_0x5c9e('0x73'));var os=require('os');var path=require(_0x5c9e('0x71'));var shell=require(_0x5c9e('0x5f'));var wpa_cli=require('wireless-tools/wpa_cli');var iwlist=require(_0x5c9e('0x21'));var wpa_supplicant=require('wireless-tools/wpa_supplicant');var spawn=require(_0x5c9e('0x47'))[_0x5c9e('0x63')];const config=require(_0x5c9e('0x64'));const autonomous=require(_0x5c9e('0x60'));const logger=require(_0x5c9e('0x36'));let nicInterface=config['get'](_0x5c9e('0x30'));const app=require('../../express');const User=require(_0x5c9e('0x5'));const io=require('../../socket');const FusionSettings=require(_0x5c9e('0x52'));module[_0x5c9e('0x62')]=function(){app['post']('/api/admin/users',_0x5db0a9(),function(_0x5976d8,_0x52220e){User[_0x5c9e('0x25')]({'username':_0x5976d8[_0x5c9e('0x1b')][_0x5c9e('0x45')]},async function(_0x3dda2d,_0x439e73){if(_0x3dda2d)return _0x52220e[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x3dda2d);if(_0x439e73){return _0x52220e[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')]('Username\x20already\x20taken.');}else{var _0x564379=new User(_0x5976d8[_0x5c9e('0x1b')]);_0x564379[_0x5c9e('0x45')]=_0x5976d8['body'][_0x5c9e('0x45')];_0x564379[_0x5c9e('0x32')]=_0x564379[_0x5c9e('0x3c')](_0x5976d8[_0x5c9e('0x1b')][_0x5c9e('0x32')]);_0x564379[_0x5c9e('0x3f')]=await _0x564379[_0x5c9e('0x7e')](_0x564379['username']);_0x564379['save'](function(_0x486938){if(_0x486938)return _0x52220e['status'](0x1f4)[_0x5c9e('0x6e')](_0x486938);return _0x52220e['status'](0xc8)['json']({'serverMessage':_0x5c9e('0x6a')});});}});});app[_0x5c9e('0x72')](_0x5c9e('0x59'),function(_0x312e86,_0x244074){_0x244074['status'](0xc8)[_0x5c9e('0x58')]({'serverMessage':_0x5c9e('0x39')});var _0x25dee6=require(_0x5c9e('0x47'))['spawn'];var _0x216360=_0x25dee6(_0x5c9e('0x54'),['poweroff']);});app[_0x5c9e('0x72')](_0x5c9e('0xa'),function(_0x178e2b,_0x467a9a){_0x467a9a['status'](0xc8)['send'](_0x5c9e('0x4'));var _0x539191=require('child_process')[_0x5c9e('0x63')];var _0x3d46d0=_0x539191('sudo',['reboot']);});app['get'](_0x5c9e('0x5c'),function(_0x30be9e,_0x1db496){var _0x232e52;var _0x1bea1a=require('os')[_0x5c9e('0x2d')];var _0xce197e;var _0x3f050e;var _0x31f68e={};if(os['platform']()==_0x5c9e('0x1d')){_0x232e52=_0x5c9e('0x3');fs[_0x5c9e('0x26')](_0x232e52,_0x5c9e('0x1e'),function(_0x65d99c,_0x589856){if(_0x65d99c)_0x1db496[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x4d'));_0xce197e=_0x589856[_0x5c9e('0x53')]('\x0a');for(var _0x2985de=0x0;_0x2985de<_0xce197e[_0x5c9e('0x67')];_0x2985de++){_0x3f050e=_0xce197e[_0x2985de][_0x5c9e('0x53')]('=');if(_0x3f050e[0x0]=='ssid')_0x31f68e[_0x5c9e('0x4c')]=_0x3f050e[0x1];else if(_0x3f050e[0x0]==_0x5c9e('0xc'))_0x31f68e[_0x5c9e('0x70')]=_0x3f050e[0x1];}_0x1db496[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'SSID':_0x31f68e[_0x5c9e('0x4c')],'Password':_0x31f68e[_0x5c9e('0x70')]});});}else{_0x232e52=_0x5c9e('0x6b');fs[_0x5c9e('0x26')](_0x232e52,'utf8',function(_0x275b15,_0x31129b){if(_0x275b15)_0x1db496[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x4d'));_0xce197e=_0x31129b[_0x5c9e('0x53')](_0x1bea1a);for(var _0x146859=0x0;_0x146859<_0xce197e[_0x5c9e('0x67')];_0x146859++){_0x3f050e=_0xce197e[_0x146859]['split']('=');if(_0x3f050e[0x0]==_0x5c9e('0x4f'))_0x31f68e['SSID']=_0x3f050e[0x1];else if(_0x3f050e[0x0]=='wpa_passphrase')_0x31f68e[_0x5c9e('0x70')]=_0x3f050e[0x1];}if(!_0x31f68e[_0x5c9e('0x4c')]){_0x31f68e[_0x5c9e('0x4c')]=_0x5c9e('0x18');_0x31f68e[_0x5c9e('0x70')]='';}_0x1db496[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'SSID':_0x31f68e['SSID'],'Password':_0x31f68e['Password']});});}});app[_0x5c9e('0x2f')]('/api/admin/wirelessSettings',function(_0x16e413,_0x161c28){try{var _0x20cae2;var _0x13e156;var _0x2d940c=path[_0x5c9e('0x68')]('..','..',_0x5c9e('0x2b'),_0x5c9e('0x2a'));if(_0x16e413[_0x5c9e('0x1b')][_0x5c9e('0x4f')]==null&&_0x16e413[_0x5c9e('0x1b')][_0x5c9e('0x32')]==null)_0x13e156=[_0x5c9e('0x1'),_0x2d940c,'-d'];else _0x13e156=[_0x5c9e('0x1'),_0x2d940c,'-s',_0x16e413[_0x5c9e('0x1b')][_0x5c9e('0x4f')],'-p',_0x16e413['body'][_0x5c9e('0x32')]];var _0x38e8dd=require(_0x5c9e('0x47'))[_0x5c9e('0x63')];python_process=_0x38e8dd('sudo',_0x13e156,{'stdio':_0x5c9e('0x15')});python_process['stderr']['on'](_0x5c9e('0x35'),function(_0x45782e){logger['info'](String(_0x45782e));_0x20cae2=String(_0x45782e);});python_process[_0x5c9e('0x6d')]['on'](_0x5c9e('0x55'),function(_0x52fad0){if(_0x20cae2)return _0x161c28[_0x5c9e('0xf')](0x1f4)['send'](_0x20cae2);else return _0x161c28[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'serverMessage':_0x5c9e('0x7c')});});}catch(_0x5b937a){logger['info'](_0x5b937a);return _0x161c28[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5b937a);}});app['get'](_0x5c9e('0x74'),function(_0x2a9a35,_0x21d1d9){if(os[_0x5c9e('0x42')]()=='win32'){return _0x21d1d9[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x6e')]();}else{iwlist[_0x5c9e('0xd')](nicInterface,function(_0x2ae6bc,_0x2b7aaa){if(_0x2ae6bc)return _0x21d1d9[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')]('Wireless\x20interface\x20not\x20found');else return _0x21d1d9[_0x5c9e('0xf')](0xc8)['send']({'serverMessage':_0x5c9e('0x79'),'data':_0x2b7aaa});});}});app[_0x5c9e('0x2f')]('/api/admin/wirelessConnections',function(_0x4ead24,_0x51fe9c){var _0x394d3a=undefined;var _0x561f5e=_0x5c9e('0x7b')+_0x5c9e('0x61')+'country=US\x0a\x0a';var _0x51e849=_0x5c9e('0x43')+_0x5c9e('0x1f')+_0x4ead24['body'][_0x5c9e('0x4f')]+'\x22\x0a'+_0x5c9e('0x69')+_0x5c9e('0x13')+_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x32')]+'\x22\x0a'+_0x5c9e('0x31')+'}\x0a\x0a';if(_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x32')]){_0x394d3a=shell[_0x5c9e('0x6c')](_0x5c9e('0x11')+_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x4f')]+'\x22\x20\x22'+_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x32')]+'\x22',{'silent':!![]})['stdout'];}else{_0x394d3a='network={\x0a'+_0x5c9e('0x51')+_0x4ead24['body'][_0x5c9e('0x4f')]+'\x22\x0a'+_0x5c9e('0x23')+'}\x0a';}let _0x52c9d9='';if(_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x75')])_0x52c9d9=_0x561f5e+_0x51e849;else _0x52c9d9=_0x561f5e+_0x394d3a;fs[_0x5c9e('0x3a')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x52c9d9,function(_0x22c1c7){if(_0x22c1c7)return _0x51fe9c[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x22c1c7);shell[_0x5c9e('0x6c')](_0x5c9e('0x40')+nicInterface+_0x5c9e('0x44'),{'silent':!![]});const _0x2d8964=0x3a98;var _0x51bf67=0x12c;var _0x35439e=0x0;var _0x31a57c=setInterval(function(){var _0x4af2a7=['SCANNING',_0x5c9e('0x1a'),_0x5c9e('0x7'),_0x5c9e('0xb'),_0x5c9e('0x29')];wpa_cli[_0x5c9e('0xf')](nicInterface,function(_0x3e14cb,_0x3ab63a){if(_0x3e14cb)return _0x51fe9c[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x3e14cb);if(_0x3ab63a[_0x5c9e('0x3b')]=='COMPLETED'){if(_0x3ab63a['ip']){logger[_0x5c9e('0x28')](_0x5c9e('0x24')+_0x3ab63a['ip']+_0x5c9e('0x48'));clearInterval(_0x31a57c);FusionSettings[_0x5c9e('0x22')][_0x5c9e('0x3e')]=_0x3ab63a;io[_0x5c9e('0xe')][_0x5c9e('0x7a')]('wifi-connection',_0x3ab63a);return _0x51fe9c['status'](0xc8)['json']({'serverMessage':_0x5c9e('0x5e')+_0x4ead24[_0x5c9e('0x1b')][_0x5c9e('0x4f')]+_0x5c9e('0x2')});}else if(_0x35439e>_0x2d8964){logger['info'](_0x5c9e('0x34'));clearInterval(_0x31a57c);return _0x51fe9c[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x37')+_0x4ead24[_0x5c9e('0x1b')]['ssid']);}_0x35439e+=_0x51bf67;}else if(_0x4af2a7[_0x5c9e('0x77')](_0x3ab63a[_0x5c9e('0x3b')])==-0x1){clearInterval(_0x31a57c);io[_0x5c9e('0xe')]['emit'](_0x5c9e('0x14'),_0x3ab63a);return _0x51fe9c[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x37')+_0x4ead24['body'][_0x5c9e('0x4f')]);}});},_0x51bf67);});});app[_0x5c9e('0x72')](_0x5c9e('0x6f'),function(_0x2ec178,_0x375f3a){if(os[_0x5c9e('0x42')]()==_0x5c9e('0x1d')){_0x375f3a[_0x5c9e('0xf')](0x1f4)['send']('Disconnect\x20not\x20available\x20on\x20Windows');}else{var _0x173850=_0x5c9e('0x7b')+_0x5c9e('0x61')+_0x5c9e('0x20');fs[_0x5c9e('0x3a')](_0x5c9e('0x7d'),_0x173850,function(_0x5967d3){if(_0x5967d3)return _0x375f3a[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5967d3);shell[_0x5c9e('0x6c')](_0x5c9e('0x40')+nicInterface+_0x5c9e('0x44'),{'silent':!![]});var _0x3bb9eb=setInterval(function(){var _0x3f1581=[];wpa_cli[_0x5c9e('0xf')](nicInterface,function(_0xb0ce91,_0x4853d5){if(_0xb0ce91)return _0x375f3a[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0xb0ce91);FusionSettings[_0x5c9e('0x22')][_0x5c9e('0x3e')]=_0x4853d5;io[_0x5c9e('0xe')][_0x5c9e('0x7a')](_0x5c9e('0x14'),_0x4853d5);if(_0x4853d5['wpa_state']==_0x5c9e('0xb')||_0x4853d5[_0x5c9e('0x3b')]=='INACTIVE'){clearInterval(_0x3bb9eb);io[_0x5c9e('0xe')][_0x5c9e('0x7a')](_0x5c9e('0x14'),_0x4853d5);return _0x375f3a[_0x5c9e('0xf')](0xc8)['json']({'serverMessage':_0x5c9e('0x12')});}else if(connectingStatuses[_0x5c9e('0x77')](_0x4853d5['wpa_state'])==-0x1){clearInterval(_0x3bb9eb);io[_0x5c9e('0xe')]['emit'](_0x5c9e('0x14'),_0x4853d5);return _0x375f3a['status'](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x4a'));}});},0x12c);});}});app['get'](_0x5c9e('0x50'),function(_0x4f7f86,_0x368477){var _0x51f5ae=_0x5c9e('0x6');fs['readdir'](_0x51f5ae,function(_0x3c4180,_0x1ae397){if(_0x3c4180)return _0x368477[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x3c4180);if(_0x1ae397['length']>0x0){fs['readFile'](_0x51f5ae+'/'+_0x1ae397[0x0],_0x5c9e('0x1e'),function(_0x34c338,_0x117cda){if(_0x34c338)return status(0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x57'));_0x368477[_0x5c9e('0x38')](_0x5c9e('0x4b'),_0x5c9e('0x76')+_0x1ae397[0x0]);return _0x368477[_0x5c9e('0xf')](0xc8)['download'](_0x51f5ae+'/'+_0x1ae397[0x0]);});}else{return _0x368477['status'](0xc8)[_0x5c9e('0x6e')]('No\x20crash\x20files\x20found');}});});var _0x2d58d1=null;app[_0x5c9e('0x2f')](_0x5c9e('0x66'),function(_0x1e318f,_0x47a4a1){if(os[_0x5c9e('0x42')]()!='win32'){_0x2d58d1=spawn(_0x5c9e('0x54'),['sh',_0x5c9e('0x16'),'../../diagnostics/diagnosticGUI.py']);_0x2d58d1['stdout']['on'](_0x5c9e('0x35'),function(_0x5c0f89){logger[_0x5c9e('0x28')](String(_0x5c0f89));});_0x2d58d1[_0x5c9e('0x1c')]['on'](_0x5c9e('0x35'),function(_0x5cf36f){logger[_0x5c9e('0x28')](String(_0x5cf36f));});var _0x5d80c0=0x1;var _0x575cd3=0x3;var _0x557d7a=setInterval(function(){if(_0x5d80c0<=_0x575cd3){var _0xf8afee=shell[_0x5c9e('0x6c')](_0x5c9e('0x56'),{'silent':!![]})[_0x5c9e('0x6d')];if(_0xf8afee){clearInterval(_0x557d7a);FusionSettings[_0x5c9e('0x22')][_0x5c9e('0x41')]={'process':_0xf8afee,'socket':_0x1e318f['body'][_0x5c9e('0x10')]};io[_0x5c9e('0xe')][_0x5c9e('0x7a')](_0x5c9e('0x5a'),FusionSettings['SocketVariables']['fusion_diagnostics_running']);return _0x47a4a1[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'serverMessage':_0x5c9e('0x2e')});}else{_0x5d80c0++;}}else{clearInterval(_0x557d7a);return _0x47a4a1['status'](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x17'));}},0x12c);}else{return _0x47a4a1[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'serverMessage':_0x5c9e('0x33')});}});app['get'](_0x5c9e('0x3d'),function(_0x35ea5d,_0x1910ea){if(os[_0x5c9e('0x42')]()!=_0x5c9e('0x1d')){shell['exec'](_0x5c9e('0x8'),{'silent':!![]});shell[_0x5c9e('0x6c')]('ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27',{'silent':!![]},function(_0x4b22d0,_0x5939ce,_0x4240da){(function(_0x287e8c){var _0x54099f=_0x287e8c[_0x5c9e('0x27')]();if(_0x54099f){return _0x1910ea[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x5c9e('0x46'));}else{FusionSettings[_0x5c9e('0x22')][_0x5c9e('0x41')]=null;io[_0x5c9e('0xe')][_0x5c9e('0x7a')](_0x5c9e('0x5a'),FusionSettings[_0x5c9e('0x22')]['fusion_diagnostics_running']);_0x2d58d1=null;return _0x1910ea['status'](0xc8)[_0x5c9e('0x58')]({'serverMessage':'Diagnostic\x20tool\x20stopped\x20successfully'});}}(_0x5939ce[_0x5c9e('0x27')]()));});}else{return _0x1910ea[_0x5c9e('0xf')](0xc8)['json']({'serverMessage':_0x5c9e('0x33')});}});app[_0x5c9e('0x72')](_0x5c9e('0x19'),async function(_0x57c089,_0x1a3c66){try{const _0xb74740=await autonomous[_0x5c9e('0x25')]()[_0x5c9e('0x6c')]();return _0x1a3c66['json'](_0xb74740);}catch(_0x251b59){return _0x1a3c66[_0x5c9e('0xf')](0x1f4)['send'](error[_0x5c9e('0x4e')]);}});app[_0x5c9e('0x2f')](_0x5c9e('0x19'),async function(_0x27947e,_0x469e8b){try{const _0x52ee95=await autonomous[_0x5c9e('0x5d')]({},_0x27947e['body']);return _0x469e8b[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'serverMessage':_0x5c9e('0x5b')});}catch(_0x592651){return _0x469e8b[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x592651[_0x5c9e('0x4e')]);}});app['post'](_0x5c9e('0x78'),async function(_0x13d621,_0x4e544f){try{const _0x310d7c=_0x13d621['body'][_0x5c9e('0x45')];const _0x27775b=_0x13d621['body'][_0x5c9e('0x0')];const _0x1322ec=await fs[_0x5c9e('0x49')](_0x5c9e('0x65')+_0x310d7c+'/'+_0x27775b);return _0x4e544f[_0x5c9e('0xf')](0xc8)[_0x5c9e('0x58')]({'files':_0x1322ec});}catch(_0x269106){return _0x4e544f[_0x5c9e('0xf')](0x1f4)[_0x5c9e('0x6e')](_0x269106[_0x5c9e('0x4e')]);}});function _0x5db0a9(){return function(_0x4f7cfe,_0x2bcfb1,_0x4a54ac){if(_0x4f7cfe[_0x5c9e('0x2c')]()){return _0x4a54ac();}else{_0x2bcfb1[_0x5c9e('0xf')](0x191)['send']('User\x20Unauthenticated');}};}}();