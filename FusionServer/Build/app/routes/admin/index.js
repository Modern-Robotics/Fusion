var _0x47ad=['download','Username\x20already\x20taken.','info','hiddenNetwork','Error\x20connecting\x20to\x20','diagnostics_running','length','Wifi\x20file\x20not\x20found','network={\x0a','\x09ssid=\x22','../../socket','Password','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','/etc/wpa_supplicant/wpa_supplicant.conf','\x09key_mgmt=WPA-PSK\x0a','stdout','fusion_diagnostics_running','wpa_passphrase\x20\x22','Disconnected\x20successfully','\x20\x20\x20\x20ssid=\x22','COMPLETED','data','Restart\x20Commencing','../../models/user','utf8','Error\x20reading\x20crash\x20file','../../global/fusionSettings','split','update_config=1\x0a','Content-disposition','filepath','sockets','/etc/hostapd/hostapd.conf','status','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','/api/admin/users','EOL','\x09psk=\x22','readFile','\x20reconfigure','shelljs','generateHash','readdir','setHeader','SocketVariables','fusion_wifi_access','exports','4WAY_HANDSHAKE','send','spawn','fs-extra','wireless-tools/wpa_cli','DISCONNECTED','/api/diagnostics/stop','writeFile','ssid','poweroff','python','exec','/api/admin/restart','sudo','join','\x20\x20\x20\x20key_mgmt=NONE\x0a','/api/admin/wirelessSettings','/api/diagnostics/start','socketId','INACTIVE','platform','wireless-tools/wpa_supplicant','path','win32','get','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','../../diagnostics/diagnosticGUI.py','password','\x20successfully','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','scan','User\x20Unauthenticated','No\x20crash\x20files\x20found','save','findOneAndUpdate','child_process','indexOf','config','./app/filesystem/','username','post','\x22\x20\x22','Wifi_NIC','Unable\x20to\x20stop\x20diagnostic\x20tool','SCANNING','json','Not\x20configured..','SSID','../../express','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','stderr','/api/admin/wirelessConnections/disconnect','wifi-connection','body','reboot','/api/autonomous','emit','Connected\x20to\x20','wpa_state','Shut\x20Down\x20Commencing','ASSOCIATING','Error\x20starting\x20diagnostic\x20tool','Wireless\x20interface\x20not\x20found','isAuthenticated','Updated\x20successfully','\x20assigned','../../diagnostics/runRemi.sh','trim','sudo\x20wpa_cli\x20-i\x20','country=US\x0a\x0a','/api/admin/wirelessConnections','message','Ip\x20address:\x20','\x09scan_ssid=1\x0a','Retreived\x20wireless\x20connections','findOne'];(function(_0x371d44,_0x47adeb){var _0x2c599e=function(_0x2a74f6){while(--_0x2a74f6){_0x371d44['push'](_0x371d44['shift']());}};_0x2c599e(++_0x47adeb);}(_0x47ad,0x14b));var _0x2c59=function(_0x371d44,_0x47adeb){_0x371d44=_0x371d44-0x0;var _0x2c599e=_0x47ad[_0x371d44];return _0x2c599e;};var fs=require(_0x2c59('0x58'));var mkdirp=require('mkdirp');var os=require('os');var path=require(_0x2c59('0x6b'));var shell=require(_0x2c59('0x4e'));var wpa_cli=require(_0x2c59('0x59'));var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require(_0x2c59('0x6a'));var spawn=require('child_process')[_0x2c59('0x57')];const config=require(_0x2c59('0x7a'));const autonomous=require('../../models/autonomous');const logger=require('../../utils/logger');let nicInterface=config[_0x2c59('0x6d')](_0x2c59('0x4'));const app=require(_0x2c59('0xa'));const User=require(_0x2c59('0x3d'));const io=require(_0x2c59('0x30'));const FusionSettings=require(_0x2c59('0x40'));module[_0x2c59('0x54')]=function(){app[_0x2c59('0x2')](_0x2c59('0x49'),_0x89cae5(),function(_0x2749be,_0x41e286){User[_0x2c59('0x25')]({'username':_0x2749be['body'][_0x2c59('0x1')]},async function(_0x1d5a19,_0xe47b6f){if(_0x1d5a19)return _0x41e286[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x1d5a19);if(_0xe47b6f){return _0x41e286['status'](0x1f4)[_0x2c59('0x56')](_0x2c59('0x27'));}else{var _0xe375e1=new User(_0x2749be[_0x2c59('0xf')]);_0xe375e1[_0x2c59('0x1')]=_0x2749be[_0x2c59('0xf')]['username'];_0xe375e1[_0x2c59('0x70')]=_0xe375e1[_0x2c59('0x4f')](_0x2749be[_0x2c59('0xf')][_0x2c59('0x70')]);_0xe375e1[_0x2c59('0x44')]=await _0xe375e1['generateFileSystem'](_0xe375e1[_0x2c59('0x1')]);_0xe375e1[_0x2c59('0x76')](function(_0x33fcf4){if(_0x33fcf4)return _0x41e286[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x33fcf4);return _0x41e286[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':'User\x20created!'});});}});});app[_0x2c59('0x6d')]('/api/admin/powerOff',function(_0x4cfdf1,_0x5beee0){_0x5beee0[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x15')});var _0x42206a=require(_0x2c59('0x78'))[_0x2c59('0x57')];var _0x18abe7=_0x42206a('sudo',[_0x2c59('0x5e')]);});app[_0x2c59('0x6d')](_0x2c59('0x61'),function(_0x318dc9,_0x345944){_0x345944[_0x2c59('0x47')](0xc8)[_0x2c59('0x56')](_0x2c59('0x3c'));var _0x2aad39=require(_0x2c59('0x78'))[_0x2c59('0x57')];var _0x493337=_0x2aad39('sudo',[_0x2c59('0x10')]);});app[_0x2c59('0x6d')](_0x2c59('0x65'),function(_0x257ea0,_0x1e545a){var _0x14c12e;var _0x4b3b25=require('os')[_0x2c59('0x4a')];var _0x540a79;var _0x4b76fc;var _0x1c31e5={};if(os[_0x2c59('0x69')]()==_0x2c59('0x6c')){_0x14c12e='../../etc/config-wap/hostapd.conf__npp.sh';fs[_0x2c59('0x4c')](_0x14c12e,_0x2c59('0x3e'),function(_0x4bb8ea,_0x1dae6a){if(_0x4bb8ea)_0x1e545a['status'](0x1f4)['send'](_0x2c59('0x2d'));_0x540a79=_0x1dae6a[_0x2c59('0x41')]('\x0a');for(var _0x406005=0x0;_0x406005<_0x540a79[_0x2c59('0x2c')];_0x406005++){_0x4b76fc=_0x540a79[_0x406005][_0x2c59('0x41')]('=');if(_0x4b76fc[0x0]=='ssid')_0x1c31e5[_0x2c59('0x9')]=_0x4b76fc[0x1];else if(_0x4b76fc[0x0]=='wpa_passphrase')_0x1c31e5[_0x2c59('0x31')]=_0x4b76fc[0x1];}_0x1e545a[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'SSID':_0x1c31e5[_0x2c59('0x9')],'Password':_0x1c31e5[_0x2c59('0x31')]});});}else{_0x14c12e=_0x2c59('0x46');fs[_0x2c59('0x4c')](_0x14c12e,_0x2c59('0x3e'),function(_0x336b70,_0xea6d77){if(_0x336b70)_0x1e545a[_0x2c59('0x47')](0x1f4)['send'](_0x2c59('0x2d'));_0x540a79=_0xea6d77[_0x2c59('0x41')](_0x4b3b25);for(var _0x2d257d=0x0;_0x2d257d<_0x540a79[_0x2c59('0x2c')];_0x2d257d++){_0x4b76fc=_0x540a79[_0x2d257d][_0x2c59('0x41')]('=');if(_0x4b76fc[0x0]==_0x2c59('0x5d'))_0x1c31e5[_0x2c59('0x9')]=_0x4b76fc[0x1];else if(_0x4b76fc[0x0]=='wpa_passphrase')_0x1c31e5[_0x2c59('0x31')]=_0x4b76fc[0x1];}if(!_0x1c31e5[_0x2c59('0x9')]){_0x1c31e5[_0x2c59('0x9')]=_0x2c59('0x8');_0x1c31e5[_0x2c59('0x31')]='';}_0x1e545a[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'SSID':_0x1c31e5['SSID'],'Password':_0x1c31e5['Password']});});}});app[_0x2c59('0x2')](_0x2c59('0x65'),function(_0x523153,_0x535295){try{var _0x56e80f;var _0x53fee7;var _0x22ba41=path[_0x2c59('0x63')]('..','..','etc','ssid_set.py');if(_0x523153[_0x2c59('0xf')][_0x2c59('0x5d')]==null&&_0x523153['body']['password']==null)_0x53fee7=['python',_0x22ba41,'-d'];else _0x53fee7=[_0x2c59('0x5f'),_0x22ba41,'-s',_0x523153['body'][_0x2c59('0x5d')],'-p',_0x523153['body']['password']];var _0xb473c1=require(_0x2c59('0x78'))[_0x2c59('0x57')];python_process=_0xb473c1(_0x2c59('0x62'),_0x53fee7,{'stdio':'pipe'});python_process['stderr']['on'](_0x2c59('0x3b'),function(_0x2e3f53){logger[_0x2c59('0x28')](String(_0x2e3f53));_0x56e80f=String(_0x2e3f53);});python_process[_0x2c59('0x35')]['on']('close',function(_0x268368){if(_0x56e80f)return _0x535295[_0x2c59('0x47')](0x1f4)['send'](_0x56e80f);else return _0x535295[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':'Successfully\x20changed\x20wifi\x20settings'});});}catch(_0x19cacf){logger['info'](_0x19cacf);return _0x535295[_0x2c59('0x47')](0x1f4)['send'](_0x19cacf);}});app['get'](_0x2c59('0x20'),function(_0x477326,_0x216805){if(os[_0x2c59('0x69')]()==_0x2c59('0x6c')){return _0x216805[_0x2c59('0x47')](0xc8)['send']();}else{iwlist[_0x2c59('0x73')](nicInterface,function(_0x4680fe,_0x5d4c47){if(_0x4680fe)return _0x216805[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x2c59('0x18'));else return _0x216805[_0x2c59('0x47')](0xc8)[_0x2c59('0x56')]({'serverMessage':_0x2c59('0x24'),'data':_0x5d4c47});});}});app[_0x2c59('0x2')](_0x2c59('0x20'),function(_0x2ed8cb,_0x1a8099){var _0x37eda8=undefined;var _0x484cc3=_0x2c59('0x32')+'update_config=1\x0a'+_0x2c59('0x1f');var _0x944338=_0x2c59('0x2e')+_0x2c59('0x2f')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x5d')]+'\x22\x0a'+_0x2c59('0x23')+_0x2c59('0x4b')+_0x2ed8cb[_0x2c59('0xf')]['password']+'\x22\x0a'+_0x2c59('0x34')+'}\x0a\x0a';if(_0x2ed8cb['body'][_0x2c59('0x70')]){_0x37eda8=shell[_0x2c59('0x60')](_0x2c59('0x37')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x5d')]+_0x2c59('0x3')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x70')]+'\x22',{'silent':!![]})[_0x2c59('0x35')];}else{_0x37eda8='network={\x0a'+_0x2c59('0x39')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x5d')]+'\x22\x0a'+_0x2c59('0x64')+'}\x0a';}let _0x197557='';if(_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x29')])_0x197557=_0x484cc3+_0x944338;else _0x197557=_0x484cc3+_0x37eda8;fs[_0x2c59('0x5c')](_0x2c59('0x33'),_0x197557,function(_0xfb5141){if(_0xfb5141)return _0x1a8099[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0xfb5141);shell[_0x2c59('0x60')](_0x2c59('0x1e')+nicInterface+_0x2c59('0x4d'),{'silent':!![]});const _0x160081=0x3a98;var _0x43ace4=0x12c;var _0x43557e=0x0;var _0x15df96=setInterval(function(){var _0x587d2b=[_0x2c59('0x6'),_0x2c59('0x55'),'AUTHENTICATING',_0x2c59('0x5a'),_0x2c59('0x16')];wpa_cli[_0x2c59('0x47')](nicInterface,function(_0x380feb,_0x2beb25){if(_0x380feb)return _0x1a8099[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x380feb);if(_0x2beb25[_0x2c59('0x14')]==_0x2c59('0x3a')){if(_0x2beb25['ip']){logger[_0x2c59('0x28')](_0x2c59('0x22')+_0x2beb25['ip']+_0x2c59('0x1b'));clearInterval(_0x15df96);FusionSettings['SocketVariables'][_0x2c59('0x53')]=_0x2beb25;io[_0x2c59('0x45')][_0x2c59('0x12')](_0x2c59('0xe'),_0x2beb25);return _0x1a8099[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x13')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x5d')]+_0x2c59('0x71')});}else if(_0x43557e>_0x160081){logger[_0x2c59('0x28')](_0x2c59('0x48'));clearInterval(_0x15df96);return _0x1a8099[_0x2c59('0x47')](0x1f4)['send'](_0x2c59('0x2a')+_0x2ed8cb[_0x2c59('0xf')][_0x2c59('0x5d')]);}_0x43557e+=_0x43ace4;}else if(_0x587d2b[_0x2c59('0x79')](_0x2beb25['wpa_state'])==-0x1){clearInterval(_0x15df96);io[_0x2c59('0x45')][_0x2c59('0x12')]('wifi-connection',_0x2beb25);return _0x1a8099['status'](0x1f4)[_0x2c59('0x56')](_0x2c59('0x2a')+_0x2ed8cb['body'][_0x2c59('0x5d')]);}});},_0x43ace4);});});app['get'](_0x2c59('0xd'),function(_0xcbea91,_0x5e7cfc){if(os[_0x2c59('0x69')]()==_0x2c59('0x6c')){_0x5e7cfc[_0x2c59('0x47')](0x1f4)['send']('Disconnect\x20not\x20available\x20on\x20Windows');}else{var _0x32ad19='ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a'+_0x2c59('0x42')+_0x2c59('0x1f');fs[_0x2c59('0x5c')](_0x2c59('0x33'),_0x32ad19,function(_0x86b968){if(_0x86b968)return _0x5e7cfc[_0x2c59('0x47')](0x1f4)['send'](_0x86b968);shell[_0x2c59('0x60')](_0x2c59('0x1e')+nicInterface+_0x2c59('0x4d'),{'silent':!![]});var _0x381682=setInterval(function(){var _0x37c8b8=[];wpa_cli[_0x2c59('0x47')](nicInterface,function(_0x5b4e62,_0x426b42){if(_0x5b4e62)return _0x5e7cfc[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x5b4e62);FusionSettings['SocketVariables']['fusion_wifi_access']=_0x426b42;io['sockets'][_0x2c59('0x12')]('wifi-connection',_0x426b42);if(_0x426b42[_0x2c59('0x14')]==_0x2c59('0x5a')||_0x426b42[_0x2c59('0x14')]==_0x2c59('0x68')){clearInterval(_0x381682);io[_0x2c59('0x45')][_0x2c59('0x12')]('wifi-connection',_0x426b42);return _0x5e7cfc['status'](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x38')});}else if(connectingStatuses[_0x2c59('0x79')](_0x426b42[_0x2c59('0x14')])==-0x1){clearInterval(_0x381682);io[_0x2c59('0x45')][_0x2c59('0x12')](_0x2c59('0xe'),_0x426b42);return _0x5e7cfc[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')]('Error\x20disconnecting');}});},0x12c);});}});app[_0x2c59('0x6d')]('/api/admin/crashReport',function(_0x575ad9,_0x1a5eea){var _0x45a8ed='.crash';fs[_0x2c59('0x50')](_0x45a8ed,function(_0x250a58,_0x190b3d){if(_0x250a58)return _0x1a5eea[_0x2c59('0x47')](0x1f4)['send'](_0x250a58);if(_0x190b3d['length']>0x0){fs[_0x2c59('0x4c')](_0x45a8ed+'/'+_0x190b3d[0x0],'utf8',function(_0xeae0dc,_0x5b9719){if(_0xeae0dc)return status(0x1f4)[_0x2c59('0x56')](_0x2c59('0x3f'));_0x1a5eea[_0x2c59('0x51')](_0x2c59('0x43'),'attachment;\x20filename='+_0x190b3d[0x0]);return _0x1a5eea[_0x2c59('0x47')](0xc8)[_0x2c59('0x26')](_0x45a8ed+'/'+_0x190b3d[0x0]);});}else{return _0x1a5eea[_0x2c59('0x47')](0xc8)[_0x2c59('0x56')](_0x2c59('0x75'));}});});var _0x400962=null;app[_0x2c59('0x2')](_0x2c59('0x66'),function(_0x2913f4,_0x181c6f){if(os['platform']()!=_0x2c59('0x6c')){_0x400962=spawn(_0x2c59('0x62'),['sh',_0x2c59('0x1c'),_0x2c59('0x6f')]);_0x400962[_0x2c59('0x35')]['on']('data',function(_0x4fcda9){logger['info'](String(_0x4fcda9));});_0x400962[_0x2c59('0xc')]['on']('data',function(_0x2e4ee1){logger[_0x2c59('0x28')](String(_0x2e4ee1));});var _0x281459=0x1;var _0x4e5791=0x3;var _0x58671c=setInterval(function(){if(_0x281459<=_0x4e5791){var _0xcf64d7=shell[_0x2c59('0x60')](_0x2c59('0xb'),{'silent':!![]})[_0x2c59('0x35')];if(_0xcf64d7){clearInterval(_0x58671c);FusionSettings['SocketVariables'][_0x2c59('0x36')]={'process':_0xcf64d7,'socket':_0x2913f4[_0x2c59('0xf')][_0x2c59('0x67')]};io[_0x2c59('0x45')][_0x2c59('0x12')](_0x2c59('0x2b'),FusionSettings[_0x2c59('0x52')]['fusion_diagnostics_running']);return _0x181c6f[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':'Diagnostic\x20tool\x20started\x20successfully'});}else{_0x281459++;}}else{clearInterval(_0x58671c);return _0x181c6f[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x2c59('0x17'));}},0x12c);}else{return _0x181c6f['status'](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x6e')});}});app[_0x2c59('0x6d')](_0x2c59('0x5b'),function(_0x528624,_0x46bd0d){if(os[_0x2c59('0x69')]()!='win32'){shell[_0x2c59('0x60')](_0x2c59('0x72'),{'silent':!![]});shell['exec'](_0x2c59('0xb'),{'silent':!![]},function(_0xdf91ce,_0x5ed19c,_0x5e2bed){(function(_0x1c629e){var _0x52cd46=_0x1c629e['trim']();if(_0x52cd46){return _0x46bd0d[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x2c59('0x5'));}else{FusionSettings[_0x2c59('0x52')][_0x2c59('0x36')]=null;io[_0x2c59('0x45')][_0x2c59('0x12')](_0x2c59('0x2b'),FusionSettings[_0x2c59('0x52')][_0x2c59('0x36')]);_0x400962=null;return _0x46bd0d[_0x2c59('0x47')](0xc8)['json']({'serverMessage':'Diagnostic\x20tool\x20stopped\x20successfully'});}}(_0x5ed19c[_0x2c59('0x1d')]()));});}else{return _0x46bd0d[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x6e')});}});app['get'](_0x2c59('0x11'),async function(_0x154f59,_0x5130ed){try{const _0x5c5d69=await autonomous[_0x2c59('0x25')]()[_0x2c59('0x60')]();return _0x5130ed[_0x2c59('0x7')](_0x5c5d69);}catch(_0x5d852e){return _0x5130ed[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](error[_0x2c59('0x21')]);}});app[_0x2c59('0x2')]('/api/autonomous',async function(_0xbae38c,_0xfc55c1){try{const _0x408030=await autonomous[_0x2c59('0x77')]({},_0xbae38c[_0x2c59('0xf')]);return _0xfc55c1[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'serverMessage':_0x2c59('0x1a')});}catch(_0x4c016b){return _0xfc55c1[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x4c016b[_0x2c59('0x21')]);}});app[_0x2c59('0x2')]('/api/autonomousPrograms',async function(_0x1f6410,_0x4e903d){try{const _0x20d001=_0x1f6410[_0x2c59('0xf')][_0x2c59('0x1')];const _0x4d8368=_0x1f6410['body']['type'];const _0x4904b9=await fs['readdir'](_0x2c59('0x0')+_0x20d001+'/'+_0x4d8368);return _0x4e903d[_0x2c59('0x47')](0xc8)[_0x2c59('0x7')]({'files':_0x4904b9});}catch(_0x4379c0){return _0x4e903d[_0x2c59('0x47')](0x1f4)[_0x2c59('0x56')](_0x4379c0['message']);}});function _0x89cae5(){return function(_0x45cfae,_0xb0f944,_0x3ed73f){if(_0x45cfae[_0x2c59('0x19')]()){return _0x3ed73f();}else{_0xb0f944[_0x2c59('0x47')](0x191)['send'](_0x2c59('0x74'));}};}}();