var _0x5c53=['EOL','Successfully\x20changed\x20wifi\x20settings','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','reboot','SSID','send','../../diagnostics/diagnosticGUI.py','body','\x20reconfigure','readFile','data','../../utils/logger','\x09ssid=\x22','Diagnostic\x20tool\x20started\x20successfully','/api/admin/wirelessSettings','diagnostics_running','\x20\x20\x20\x20key_mgmt=NONE\x0a','wpa_passphrase','User\x20Unauthenticated','ASSOCIATING','indexOf','\x20\x20\x20\x20ssid=\x22','split','Restart\x20Commencing','/api/admin/powerOff','Wifi\x20file\x20not\x20found','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','update_config=1\x0a','stderr','Wireless\x20interface\x20not\x20found','socketId','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','Error\x20connecting\x20to\x20','path','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','Unable\x20to\x20stop\x20diagnostic\x20tool','Ip\x20address:\x20','pipe','COMPLETED','writeFile','./app/filesystem/','spawn','\x22\x20\x22','../../express','/etc/wpa_supplicant/wpa_supplicant.conf','Error\x20disconnecting','INACTIVE','filepath','python','fusion_wifi_access','Error\x20starting\x20diagnostic\x20tool','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','/api/admin/wirelessConnections/disconnect','utf8','type','child_process','SocketVariables','Not\x20configured..','stdout','info','sudo\x20wpa_cli\x20-i\x20','Retreived\x20wireless\x20connections','sudo','get','Error\x20reading\x20crash\x20file','length','trim','wpa_state','post','/api/admin/restart','Updated\x20successfully','AUTHENTICATING','wireless-tools/wpa_cli','/api/admin/users','status','wifi-connection','findOne','/api/admin/crashReport','/etc/hostapd/hostapd.conf','ssid','../../etc/config-wap/hostapd.conf__npp.sh','exec','username','json','join','message','../../socket','sockets','win32','platform','fusion_diagnostics_running','password','hiddenNetwork','fs-extra','Diagnostic\x20tool\x20stopped\x20successfully','close','isAuthenticated','4WAY_HANDSHAKE','country=US\x0a\x0a','Shut\x20Down\x20Commencing','DISCONNECTED','shelljs','exports','setHeader','Password','Wifi_NIC','readdir','network={\x0a','/api/autonomous','Username\x20already\x20taken.','download','/api/diagnostics/stop','emit','}\x0a\x0a'];(function(_0x1f71ec,_0x5c537b){var _0x352c52=function(_0x98e817){while(--_0x98e817){_0x1f71ec['push'](_0x1f71ec['shift']());}};_0x352c52(++_0x5c537b);}(_0x5c53,0xe8));var _0x352c=function(_0x1f71ec,_0x5c537b){_0x1f71ec=_0x1f71ec-0x0;var _0x352c52=_0x5c53[_0x1f71ec];return _0x352c52;};var fs=require(_0x352c('0x59'));var mkdirp=require('mkdirp');var os=require('os');var path=require(_0x352c('0x1d'));var shell=require(_0x352c('0x61'));var wpa_cli=require(_0x352c('0x44'));var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require('wireless-tools/wpa_supplicant');var spawn=require(_0x352c('0x33'))[_0x352c('0x25')];const config=require('config');const autonomous=require('../../models/autonomous');const logger=require(_0x352c('0x7'));let nicInterface=config[_0x352c('0x3b')](_0x352c('0x65'));const app=require(_0x352c('0x27'));const User=require('../../models/user');const io=require(_0x352c('0x52'));const FusionSettings=require('../../global/fusionSettings');module[_0x352c('0x62')]=function(){app[_0x352c('0x40')](_0x352c('0x45'),_0x3956e3(),function(_0x1c4b19,_0x1a266f){User[_0x352c('0x48')]({'username':_0x1c4b19[_0x352c('0x3')]['username']},async function(_0x588295,_0x29700f){if(_0x588295)return _0x1a266f[_0x352c('0x46')](0x1f4)['send'](_0x588295);if(_0x29700f){return _0x1a266f[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x352c('0x69'));}else{var _0x4869e1=new User(_0x1c4b19['body']);_0x4869e1[_0x352c('0x4e')]=_0x1c4b19[_0x352c('0x3')][_0x352c('0x4e')];_0x4869e1['password']=_0x4869e1['generateHash'](_0x1c4b19[_0x352c('0x3')][_0x352c('0x57')]);_0x4869e1[_0x352c('0x2b')]=await _0x4869e1['generateFileSystem'](_0x4869e1[_0x352c('0x4e')]);_0x4869e1['save'](function(_0x3b3f1d){if(_0x3b3f1d)return _0x1a266f[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x3b3f1d);return _0x1a266f[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':'User\x20created!'});});}});});app[_0x352c('0x3b')](_0x352c('0x14'),function(_0x55c83b,_0xdae13d){_0xdae13d['status'](0xc8)['json']({'serverMessage':_0x352c('0x5f')});var _0x39b19a=require(_0x352c('0x33'))[_0x352c('0x25')];var _0xf6cf6=_0x39b19a(_0x352c('0x3a'),['poweroff']);});app[_0x352c('0x3b')](_0x352c('0x41'),function(_0x307bf2,_0x593c16){_0x593c16[_0x352c('0x46')](0xc8)[_0x352c('0x1')](_0x352c('0x13'));var _0x35bd21=require('child_process')[_0x352c('0x25')];var _0x1bae71=_0x35bd21(_0x352c('0x3a'),[_0x352c('0x71')]);});app[_0x352c('0x3b')](_0x352c('0xa'),function(_0x3e053f,_0x21cf41){var _0x4c1a6c;var _0x5ceb9c=require('os')[_0x352c('0x6e')];var _0x5331e1;var _0x463e63;var _0x2b27aa={};if(os[_0x352c('0x55')]()==_0x352c('0x54')){_0x4c1a6c=_0x352c('0x4c');fs['readFile'](_0x4c1a6c,_0x352c('0x31'),function(_0x1ad01f,_0x529e8d){if(_0x1ad01f)_0x21cf41[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x352c('0x15'));_0x5331e1=_0x529e8d[_0x352c('0x12')]('\x0a');for(var _0x3c3e22=0x0;_0x3c3e22<_0x5331e1[_0x352c('0x3d')];_0x3c3e22++){_0x463e63=_0x5331e1[_0x3c3e22]['split']('=');if(_0x463e63[0x0]==_0x352c('0x4b'))_0x2b27aa['SSID']=_0x463e63[0x1];else if(_0x463e63[0x0]==_0x352c('0xd'))_0x2b27aa[_0x352c('0x64')]=_0x463e63[0x1];}_0x21cf41[_0x352c('0x46')](0xc8)['json']({'SSID':_0x2b27aa[_0x352c('0x0')],'Password':_0x2b27aa[_0x352c('0x64')]});});}else{_0x4c1a6c=_0x352c('0x4a');fs[_0x352c('0x5')](_0x4c1a6c,_0x352c('0x31'),function(_0x38f8bc,_0x3b6377){if(_0x38f8bc)_0x21cf41[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x352c('0x15'));_0x5331e1=_0x3b6377[_0x352c('0x12')](_0x5ceb9c);for(var _0x1fca41=0x0;_0x1fca41<_0x5331e1[_0x352c('0x3d')];_0x1fca41++){_0x463e63=_0x5331e1[_0x1fca41]['split']('=');if(_0x463e63[0x0]==_0x352c('0x4b'))_0x2b27aa[_0x352c('0x0')]=_0x463e63[0x1];else if(_0x463e63[0x0]==_0x352c('0xd'))_0x2b27aa['Password']=_0x463e63[0x1];}if(!_0x2b27aa[_0x352c('0x0')]){_0x2b27aa[_0x352c('0x0')]=_0x352c('0x35');_0x2b27aa[_0x352c('0x64')]='';}_0x21cf41['status'](0xc8)[_0x352c('0x4f')]({'SSID':_0x2b27aa[_0x352c('0x0')],'Password':_0x2b27aa[_0x352c('0x64')]});});}});app['post'](_0x352c('0xa'),function(_0x1dbc54,_0x14e590){try{var _0x283817;var _0x16b573;var _0x4e6c89=path[_0x352c('0x50')]('..','..','etc','ssid_set.py');if(_0x1dbc54[_0x352c('0x3')]['ssid']==null&&_0x1dbc54[_0x352c('0x3')][_0x352c('0x57')]==null)_0x16b573=['python',_0x4e6c89,'-d'];else _0x16b573=[_0x352c('0x2c'),_0x4e6c89,'-s',_0x1dbc54[_0x352c('0x3')][_0x352c('0x4b')],'-p',_0x1dbc54[_0x352c('0x3')][_0x352c('0x57')]];var _0x56516b=require(_0x352c('0x33'))[_0x352c('0x25')];python_process=_0x56516b(_0x352c('0x3a'),_0x16b573,{'stdio':_0x352c('0x21')});python_process[_0x352c('0x18')]['on'](_0x352c('0x6'),function(_0x22d9f2){logger['info'](String(_0x22d9f2));_0x283817=String(_0x22d9f2);});python_process['stdout']['on'](_0x352c('0x5b'),function(_0x232f67){if(_0x283817)return _0x14e590[_0x352c('0x46')](0x1f4)['send'](_0x283817);else return _0x14e590[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':_0x352c('0x6f')});});}catch(_0x309c3d){logger['info'](_0x309c3d);return _0x14e590['status'](0x1f4)[_0x352c('0x1')](_0x309c3d);}});app[_0x352c('0x3b')]('/api/admin/wirelessConnections',function(_0x1c1d71,_0xf58b47){if(os[_0x352c('0x55')]()=='win32'){return _0xf58b47[_0x352c('0x46')](0xc8)[_0x352c('0x1')]();}else{iwlist['scan'](nicInterface,function(_0x295519,_0x29a489){if(_0x295519)return _0xf58b47[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x352c('0x19'));else return _0xf58b47[_0x352c('0x46')](0xc8)[_0x352c('0x1')]({'serverMessage':_0x352c('0x39'),'data':_0x29a489});});}});app['post']('/api/admin/wirelessConnections',function(_0xa88314,_0x146b35){var _0x4beca0=undefined;var _0x2956cb=_0x352c('0x1b')+'update_config=1\x0a'+_0x352c('0x5e');var _0x538f2b=_0x352c('0x67')+_0x352c('0x8')+_0xa88314[_0x352c('0x3')]['ssid']+'\x22\x0a'+'\x09scan_ssid=1\x0a'+'\x09psk=\x22'+_0xa88314['body'][_0x352c('0x57')]+'\x22\x0a'+'\x09key_mgmt=WPA-PSK\x0a'+_0x352c('0x6d');if(_0xa88314[_0x352c('0x3')][_0x352c('0x57')]){_0x4beca0=shell[_0x352c('0x4d')]('wpa_passphrase\x20\x22'+_0xa88314[_0x352c('0x3')][_0x352c('0x4b')]+_0x352c('0x26')+_0xa88314['body']['password']+'\x22',{'silent':!![]})[_0x352c('0x36')];}else{_0x4beca0=_0x352c('0x67')+_0x352c('0x11')+_0xa88314[_0x352c('0x3')][_0x352c('0x4b')]+'\x22\x0a'+_0x352c('0xc')+'}\x0a';}let _0x5b2a61='';if(_0xa88314[_0x352c('0x3')][_0x352c('0x58')])_0x5b2a61=_0x2956cb+_0x538f2b;else _0x5b2a61=_0x2956cb+_0x4beca0;fs[_0x352c('0x23')](_0x352c('0x28'),_0x5b2a61,function(_0x505121){if(_0x505121)return _0x146b35[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x505121);shell[_0x352c('0x4d')](_0x352c('0x38')+nicInterface+_0x352c('0x4'),{'silent':!![]});const _0x26fc4f=0x3a98;var _0x5d1edc=0x12c;var _0x23fd18=0x0;var _0x37f702=setInterval(function(){var _0x2dcaf5=['SCANNING',_0x352c('0x5d'),_0x352c('0x43'),_0x352c('0x60'),_0x352c('0xf')];wpa_cli[_0x352c('0x46')](nicInterface,function(_0x480f60,_0xc3bd92){if(_0x480f60)return _0x146b35[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x480f60);if(_0xc3bd92[_0x352c('0x3f')]==_0x352c('0x22')){if(_0xc3bd92['ip']){logger[_0x352c('0x37')](_0x352c('0x20')+_0xc3bd92['ip']+'\x20assigned');clearInterval(_0x37f702);FusionSettings[_0x352c('0x34')][_0x352c('0x2d')]=_0xc3bd92;io['sockets'][_0x352c('0x6c')](_0x352c('0x47'),_0xc3bd92);return _0x146b35[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':'Connected\x20to\x20'+_0xa88314[_0x352c('0x3')][_0x352c('0x4b')]+'\x20successfully'});}else if(_0x23fd18>_0x26fc4f){logger['info'](_0x352c('0x16'));clearInterval(_0x37f702);return _0x146b35['status'](0x1f4)[_0x352c('0x1')]('Error\x20connecting\x20to\x20'+_0xa88314[_0x352c('0x3')][_0x352c('0x4b')]);}_0x23fd18+=_0x5d1edc;}else if(_0x2dcaf5[_0x352c('0x10')](_0xc3bd92[_0x352c('0x3f')])==-0x1){clearInterval(_0x37f702);io[_0x352c('0x53')]['emit']('wifi-connection',_0xc3bd92);return _0x146b35[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x352c('0x1c')+_0xa88314['body'][_0x352c('0x4b')]);}});},_0x5d1edc);});});app[_0x352c('0x3b')](_0x352c('0x30'),function(_0x32d46,_0x33683c){if(os[_0x352c('0x55')]()=='win32'){_0x33683c[_0x352c('0x46')](0x1f4)[_0x352c('0x1')]('Disconnect\x20not\x20available\x20on\x20Windows');}else{var _0x5bd730=_0x352c('0x1b')+_0x352c('0x17')+'country=US\x0a\x0a';fs['writeFile'](_0x352c('0x28'),_0x5bd730,function(_0x4833cd){if(_0x4833cd)return _0x33683c[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x4833cd);shell[_0x352c('0x4d')]('sudo\x20wpa_cli\x20-i\x20'+nicInterface+'\x20reconfigure',{'silent':!![]});var _0x2b0238=setInterval(function(){var _0x94f4e6=[];wpa_cli['status'](nicInterface,function(_0x45944a,_0x317628){if(_0x45944a)return _0x33683c[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x45944a);FusionSettings['SocketVariables']['fusion_wifi_access']=_0x317628;io[_0x352c('0x53')][_0x352c('0x6c')]('wifi-connection',_0x317628);if(_0x317628[_0x352c('0x3f')]=='DISCONNECTED'||_0x317628[_0x352c('0x3f')]==_0x352c('0x2a')){clearInterval(_0x2b0238);io[_0x352c('0x53')]['emit'](_0x352c('0x47'),_0x317628);return _0x33683c[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':'Disconnected\x20successfully'});}else if(connectingStatuses[_0x352c('0x10')](_0x317628[_0x352c('0x3f')])==-0x1){clearInterval(_0x2b0238);io[_0x352c('0x53')][_0x352c('0x6c')](_0x352c('0x47'),_0x317628);return _0x33683c['status'](0x1f4)[_0x352c('0x1')](_0x352c('0x29'));}});},0x12c);});}});app[_0x352c('0x3b')](_0x352c('0x49'),function(_0x5c2d5f,_0x1c8478){var _0x14ec4c='.crash';fs[_0x352c('0x66')](_0x14ec4c,function(_0x2c1039,_0x2f483e){if(_0x2c1039)return _0x1c8478[_0x352c('0x46')](0x1f4)['send'](_0x2c1039);if(_0x2f483e[_0x352c('0x3d')]>0x0){fs[_0x352c('0x5')](_0x14ec4c+'/'+_0x2f483e[0x0],_0x352c('0x31'),function(_0x107c83,_0x2d1eb8){if(_0x107c83)return status(0x1f4)[_0x352c('0x1')](_0x352c('0x3c'));_0x1c8478[_0x352c('0x63')]('Content-disposition','attachment;\x20filename='+_0x2f483e[0x0]);return _0x1c8478['status'](0xc8)[_0x352c('0x6a')](_0x14ec4c+'/'+_0x2f483e[0x0]);});}else{return _0x1c8478[_0x352c('0x46')](0xc8)[_0x352c('0x1')]('No\x20crash\x20files\x20found');}});});var _0x24b7e1=null;app[_0x352c('0x40')]('/api/diagnostics/start',function(_0x121d12,_0x3e9cb4){if(os['platform']()!=_0x352c('0x54')){_0x24b7e1=spawn(_0x352c('0x3a'),['sh','../../diagnostics/runRemi.sh',_0x352c('0x2')]);_0x24b7e1[_0x352c('0x36')]['on'](_0x352c('0x6'),function(_0x175ec1){logger[_0x352c('0x37')](String(_0x175ec1));});_0x24b7e1[_0x352c('0x18')]['on'](_0x352c('0x6'),function(_0x590a5c){logger[_0x352c('0x37')](String(_0x590a5c));});var _0x29b6a3=0x1;var _0x3bc9d3=0x3;var _0x47c8b6=setInterval(function(){if(_0x29b6a3<=_0x3bc9d3){var _0x1e7b3b=shell['exec'](_0x352c('0x1e'),{'silent':!![]})['stdout'];if(_0x1e7b3b){clearInterval(_0x47c8b6);FusionSettings[_0x352c('0x34')][_0x352c('0x56')]={'process':_0x1e7b3b,'socket':_0x121d12[_0x352c('0x3')][_0x352c('0x1a')]};io[_0x352c('0x53')][_0x352c('0x6c')]('diagnostics_running',FusionSettings[_0x352c('0x34')][_0x352c('0x56')]);return _0x3e9cb4[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':_0x352c('0x9')});}else{_0x29b6a3++;}}else{clearInterval(_0x47c8b6);return _0x3e9cb4['status'](0x1f4)['send'](_0x352c('0x2e'));}},0x12c);}else{return _0x3e9cb4['status'](0xc8)[_0x352c('0x4f')]({'serverMessage':_0x352c('0x2f')});}});app[_0x352c('0x3b')](_0x352c('0x6b'),function(_0x30ef8a,_0x4f8a62){if(os['platform']()!='win32'){shell['exec'](_0x352c('0x70'),{'silent':!![]});shell[_0x352c('0x4d')](_0x352c('0x1e'),{'silent':!![]},function(_0x223105,_0x4e2c41,_0x3f7ec6){(function(_0x5464fb){var _0x591b2f=_0x5464fb[_0x352c('0x3e')]();if(_0x591b2f){return _0x4f8a62['status'](0x1f4)[_0x352c('0x1')](_0x352c('0x1f'));}else{FusionSettings[_0x352c('0x34')][_0x352c('0x56')]=null;io[_0x352c('0x53')][_0x352c('0x6c')](_0x352c('0xb'),FusionSettings[_0x352c('0x34')][_0x352c('0x56')]);_0x24b7e1=null;return _0x4f8a62[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':_0x352c('0x5a')});}}(_0x4e2c41[_0x352c('0x3e')]()));});}else{return _0x4f8a62[_0x352c('0x46')](0xc8)[_0x352c('0x4f')]({'serverMessage':_0x352c('0x2f')});}});app[_0x352c('0x3b')]('/api/autonomous',async function(_0x48fa46,_0xb7000c){try{const _0x18f712=await autonomous[_0x352c('0x48')]()['exec']();return _0xb7000c['json'](_0x18f712);}catch(_0x575f4c){return _0xb7000c[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](error[_0x352c('0x51')]);}});app['post'](_0x352c('0x68'),async function(_0x10c575,_0x4f03bf){try{const _0x3f750e=await autonomous['findOneAndUpdate']({},_0x10c575[_0x352c('0x3')]);return _0x4f03bf['status'](0xc8)['json']({'serverMessage':_0x352c('0x42')});}catch(_0x353f9f){return _0x4f03bf[_0x352c('0x46')](0x1f4)[_0x352c('0x1')](_0x353f9f[_0x352c('0x51')]);}});app[_0x352c('0x40')]('/api/autonomousPrograms',async function(_0x387b3b,_0x427c97){try{const _0x308e72=_0x387b3b[_0x352c('0x3')][_0x352c('0x4e')];const _0x4b0fdc=_0x387b3b[_0x352c('0x3')][_0x352c('0x32')];const _0x4ecd4e=await fs[_0x352c('0x66')](_0x352c('0x24')+_0x308e72+'/'+_0x4b0fdc);return _0x427c97['status'](0xc8)[_0x352c('0x4f')]({'files':_0x4ecd4e});}catch(_0x441bfd){return _0x427c97[_0x352c('0x46')](0x1f4)['send'](_0x441bfd[_0x352c('0x51')]);}});function _0x3956e3(){return function(_0x3e9b98,_0x1523e6,_0x39fd0e){if(_0x3e9b98[_0x352c('0x5c')]()){return _0x39fd0e();}else{_0x1523e6['status'](0x191)[_0x352c('0x1')](_0x352c('0xe'));}};}}();