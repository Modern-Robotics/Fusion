var _0x2323=['etc','length','User\x20created!','findOneAndUpdate','save','config','post','wpa_passphrase','diagnostics_running','Restart\x20Commencing','/api/admin/wirelessConnections','utf8','Error\x20connecting\x20to\x20','\x09psk=\x22','Error\x20disconnecting','wireless-tools/wpa_cli','.crash','Wifi\x20file\x20not\x20found','4WAY_HANDSHAKE','mkdirp','type','indexOf','Content-disposition','sockets','/api/autonomous','fusion_wifi_access','SocketVariables','../../global/fusionSettings','Error\x20reading\x20crash\x20file','COMPLETED','findOne','json','info','trim','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','User\x20Unauthenticated','exec','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','Password','wireless-tools/wpa_supplicant','Not\x20configured..','SSID','../../socket','scan','hiddenNetwork','child_process','\x20\x20\x20\x20key_mgmt=NONE\x0a','filepath','Unable\x20to\x20stop\x20diagnostic\x20tool','country=US\x0a\x0a','fusion_diagnostics_running','ssid','exports','python','update_config=1\x0a','poweroff','network={\x0a','/api/admin/wirelessSettings','../../diagnostics/runRemi.sh','Retreived\x20wireless\x20connections','ASSOCIATING','\x09key_mgmt=WPA-PSK\x0a','body','stderr','socketId','win32','\x20successfully','split','fs-extra','SCANNING','Username\x20already\x20taken.','Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.','stdout','spawn','writeFile','message','sudo\x20wpa_cli\x20-i\x20','attachment;\x20filename=','setHeader','INACTIVE','Shut\x20Down\x20Commencing','download','/etc/hostapd/hostapd.conf','Disconnected\x20successfully','No\x20crash\x20files\x20found','AUTHENTICATING','send','\x09ssid=\x22','isAuthenticated','pipe','wifi-connection','\x20reconfigure','join','wpa_passphrase\x20\x22','Diagnostic\x20tool\x20started\x20successfully','/api/admin/users','../../models/autonomous','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','password','platform','wpa_state','Connected\x20to\x20','close','../../etc/config-wap/hostapd.conf__npp.sh','sudo','data','/api/autonomousPrograms','username','../../utils/logger','/api/admin/crashReport','readFile','Updated\x20successfully','emit','get','Disconnect\x20not\x20available\x20on\x20Windows','/api/admin/powerOff','generateFileSystem','/api/admin/wirelessConnections/disconnect','status','\x09scan_ssid=1\x0a','readdir'];(function(_0x3ee95d,_0x23238f){var _0x4b3592=function(_0x77536d){while(--_0x77536d){_0x3ee95d['push'](_0x3ee95d['shift']());}};_0x4b3592(++_0x23238f);}(_0x2323,0x16c));var _0x4b35=function(_0x3ee95d,_0x23238f){_0x3ee95d=_0x3ee95d-0x0;var _0x4b3592=_0x2323[_0x3ee95d];return _0x4b3592;};var fs=require(_0x4b35('0x43'));var mkdirp=require(_0x4b35('0x12'));var os=require('os');var path=require('path');var shell=require('shelljs');var wpa_cli=require(_0x4b35('0xe'));var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require(_0x4b35('0x26'));var spawn=require(_0x4b35('0x2c'))['spawn'];const config=require(_0x4b35('0x4'));const autonomous=require(_0x4b35('0x5f'));const logger=require(_0x4b35('0x6b'));let nicInterface=config[_0x4b35('0x70')]('Wifi_NIC');const app=require('../../express');const User=require('../../models/user');const io=require(_0x4b35('0x29'));const FusionSettings=require(_0x4b35('0x1a'));module[_0x4b35('0x33')]=function(){app[_0x4b35('0x5')](_0x4b35('0x5e'),_0x286609(),function(_0x49c02c,_0x23ad74){User['findOne']({'username':_0x49c02c[_0x4b35('0x3d')]['username']},async function(_0x1cfc15,_0x53b119){if(_0x1cfc15)return _0x23ad74[_0x4b35('0x75')](0x1f4)['send'](_0x1cfc15);if(_0x53b119){return _0x23ad74[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x4b35('0x45'));}else{var _0x1c146f=new User(_0x49c02c['body']);_0x1c146f[_0x4b35('0x6a')]=_0x49c02c[_0x4b35('0x3d')][_0x4b35('0x6a')];_0x1c146f['password']=_0x1c146f['generateHash'](_0x49c02c['body'][_0x4b35('0x61')]);_0x1c146f[_0x4b35('0x2e')]=await _0x1c146f[_0x4b35('0x73')](_0x1c146f[_0x4b35('0x6a')]);_0x1c146f[_0x4b35('0x3')](function(_0x2f0227){if(_0x2f0227)return _0x23ad74['status'](0x1f4)['send'](_0x2f0227);return _0x23ad74[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'serverMessage':_0x4b35('0x1')});});}});});app[_0x4b35('0x70')](_0x4b35('0x72'),function(_0x19dda1,_0x58b9c4){_0x58b9c4[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'serverMessage':_0x4b35('0x4f')});var _0x2bd3c2=require(_0x4b35('0x2c'))['spawn'];var _0x2a154b=_0x2bd3c2(_0x4b35('0x67'),[_0x4b35('0x36')]);});app[_0x4b35('0x70')]('/api/admin/restart',function(_0x357f3e,_0x45b289){_0x45b289[_0x4b35('0x75')](0xc8)[_0x4b35('0x55')](_0x4b35('0x8'));var _0x67362d=require(_0x4b35('0x2c'))[_0x4b35('0x48')];var _0x17bedb=_0x67362d('sudo',['reboot']);});app[_0x4b35('0x70')](_0x4b35('0x38'),function(_0x3dcd6a,_0x192668){var _0x3a884e;var _0x363086=require('os')['EOL'];var _0x37bc4d;var _0x8d58e1;var _0x5edb06={};if(os[_0x4b35('0x62')]()==_0x4b35('0x40')){_0x3a884e=_0x4b35('0x66');fs['readFile'](_0x3a884e,_0x4b35('0xa'),function(_0x28bd00,_0x187c4a){if(_0x28bd00)_0x192668[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x4b35('0x10'));_0x37bc4d=_0x187c4a[_0x4b35('0x42')]('\x0a');for(var _0x3165de=0x0;_0x3165de<_0x37bc4d[_0x4b35('0x0')];_0x3165de++){_0x8d58e1=_0x37bc4d[_0x3165de][_0x4b35('0x42')]('=');if(_0x8d58e1[0x0]=='ssid')_0x5edb06[_0x4b35('0x28')]=_0x8d58e1[0x1];else if(_0x8d58e1[0x0]==_0x4b35('0x6'))_0x5edb06[_0x4b35('0x25')]=_0x8d58e1[0x1];}_0x192668[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'SSID':_0x5edb06[_0x4b35('0x28')],'Password':_0x5edb06[_0x4b35('0x25')]});});}else{_0x3a884e=_0x4b35('0x51');fs[_0x4b35('0x6d')](_0x3a884e,_0x4b35('0xa'),function(_0x5d9d10,_0x473ac4){if(_0x5d9d10)_0x192668[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')]('Wifi\x20file\x20not\x20found');_0x37bc4d=_0x473ac4['split'](_0x363086);for(var _0xea9eca=0x0;_0xea9eca<_0x37bc4d[_0x4b35('0x0')];_0xea9eca++){_0x8d58e1=_0x37bc4d[_0xea9eca]['split']('=');if(_0x8d58e1[0x0]==_0x4b35('0x32'))_0x5edb06[_0x4b35('0x28')]=_0x8d58e1[0x1];else if(_0x8d58e1[0x0]==_0x4b35('0x6'))_0x5edb06[_0x4b35('0x25')]=_0x8d58e1[0x1];}if(!_0x5edb06[_0x4b35('0x28')]){_0x5edb06[_0x4b35('0x28')]=_0x4b35('0x27');_0x5edb06[_0x4b35('0x25')]='';}_0x192668[_0x4b35('0x75')](0xc8)['json']({'SSID':_0x5edb06[_0x4b35('0x28')],'Password':_0x5edb06[_0x4b35('0x25')]});});}});app[_0x4b35('0x5')](_0x4b35('0x38'),function(_0x153e9e,_0x493c1e){try{var _0x36f65a;var _0x5213c8;var _0x57d75c=path[_0x4b35('0x5b')]('..','..',_0x4b35('0x78'),'ssid_set.py');if(_0x153e9e[_0x4b35('0x3d')][_0x4b35('0x32')]==null&&_0x153e9e[_0x4b35('0x3d')][_0x4b35('0x61')]==null)_0x5213c8=['python',_0x57d75c,'-d'];else _0x5213c8=[_0x4b35('0x34'),_0x57d75c,'-s',_0x153e9e['body'][_0x4b35('0x32')],'-p',_0x153e9e[_0x4b35('0x3d')][_0x4b35('0x61')]];var _0x3ef8ba=require(_0x4b35('0x2c'))[_0x4b35('0x48')];python_process=_0x3ef8ba('sudo',_0x5213c8,{'stdio':_0x4b35('0x58')});python_process[_0x4b35('0x3e')]['on'](_0x4b35('0x68'),function(_0x2cf3a7){logger[_0x4b35('0x1f')](String(_0x2cf3a7));_0x36f65a=String(_0x2cf3a7);});python_process[_0x4b35('0x47')]['on'](_0x4b35('0x65'),function(_0x3de545){if(_0x36f65a)return _0x493c1e['status'](0x1f4)['send'](_0x36f65a);else return _0x493c1e['status'](0xc8)[_0x4b35('0x1e')]({'serverMessage':'Successfully\x20changed\x20wifi\x20settings'});});}catch(_0x52da59){logger[_0x4b35('0x1f')](_0x52da59);return _0x493c1e['status'](0x1f4)['send'](_0x52da59);}});app[_0x4b35('0x70')](_0x4b35('0x9'),function(_0x12c3fd,_0x2dae79){if(os[_0x4b35('0x62')]()=='win32'){return _0x2dae79['status'](0xc8)[_0x4b35('0x55')]();}else{iwlist[_0x4b35('0x2a')](nicInterface,function(_0x802b31,_0x23b8ee){if(_0x802b31)return _0x2dae79[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')]('Wireless\x20interface\x20not\x20found');else return _0x2dae79['status'](0xc8)[_0x4b35('0x55')]({'serverMessage':_0x4b35('0x3a'),'data':_0x23b8ee});});}});app[_0x4b35('0x5')]('/api/admin/wirelessConnections',function(_0x140585,_0x4c74f1){var _0x1bd04a=undefined;var _0x221a75=_0x4b35('0x24')+_0x4b35('0x35')+_0x4b35('0x30');var _0x554e0c=_0x4b35('0x37')+_0x4b35('0x56')+_0x140585['body'][_0x4b35('0x32')]+'\x22\x0a'+_0x4b35('0x76')+_0x4b35('0xc')+_0x140585[_0x4b35('0x3d')][_0x4b35('0x61')]+'\x22\x0a'+_0x4b35('0x3c')+'}\x0a\x0a';if(_0x140585[_0x4b35('0x3d')][_0x4b35('0x61')]){_0x1bd04a=shell[_0x4b35('0x23')](_0x4b35('0x5c')+_0x140585['body'][_0x4b35('0x32')]+'\x22\x20\x22'+_0x140585[_0x4b35('0x3d')][_0x4b35('0x61')]+'\x22',{'silent':!![]})[_0x4b35('0x47')];}else{_0x1bd04a=_0x4b35('0x37')+'\x20\x20\x20\x20ssid=\x22'+_0x140585[_0x4b35('0x3d')][_0x4b35('0x32')]+'\x22\x0a'+_0x4b35('0x2d')+'}\x0a';}let _0x36fc6a='';if(_0x140585['body'][_0x4b35('0x2b')])_0x36fc6a=_0x221a75+_0x554e0c;else _0x36fc6a=_0x221a75+_0x1bd04a;fs[_0x4b35('0x49')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x36fc6a,function(_0x98b2e4){if(_0x98b2e4)return _0x4c74f1['status'](0x1f4)[_0x4b35('0x55')](_0x98b2e4);shell['exec']('sudo\x20wpa_cli\x20-i\x20'+nicInterface+'\x20reconfigure',{'silent':!![]});const _0x428ae4=0x3a98;var _0x1da470=0x12c;var _0x1492a9=0x0;var _0x261020=setInterval(function(){var _0x208414=[_0x4b35('0x44'),_0x4b35('0x11'),_0x4b35('0x54'),'DISCONNECTED',_0x4b35('0x3b')];wpa_cli[_0x4b35('0x75')](nicInterface,function(_0xe15ba2,_0x5d7d36){if(_0xe15ba2)return _0x4c74f1[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0xe15ba2);if(_0x5d7d36[_0x4b35('0x63')]==_0x4b35('0x1c')){if(_0x5d7d36['ip']){logger[_0x4b35('0x1f')]('Ip\x20address:\x20'+_0x5d7d36['ip']+'\x20assigned');clearInterval(_0x261020);FusionSettings[_0x4b35('0x19')][_0x4b35('0x18')]=_0x5d7d36;io[_0x4b35('0x16')][_0x4b35('0x6f')](_0x4b35('0x59'),_0x5d7d36);return _0x4c74f1['status'](0xc8)['json']({'serverMessage':_0x4b35('0x64')+_0x140585[_0x4b35('0x3d')]['ssid']+_0x4b35('0x41')});}else if(_0x1492a9>_0x428ae4){logger['info'](_0x4b35('0x46'));clearInterval(_0x261020);return _0x4c74f1[_0x4b35('0x75')](0x1f4)['send'](_0x4b35('0xb')+_0x140585[_0x4b35('0x3d')][_0x4b35('0x32')]);}_0x1492a9+=_0x1da470;}else if(_0x208414[_0x4b35('0x14')](_0x5d7d36[_0x4b35('0x63')])==-0x1){clearInterval(_0x261020);io[_0x4b35('0x16')][_0x4b35('0x6f')](_0x4b35('0x59'),_0x5d7d36);return _0x4c74f1[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x4b35('0xb')+_0x140585[_0x4b35('0x3d')][_0x4b35('0x32')]);}});},_0x1da470);});});app[_0x4b35('0x70')](_0x4b35('0x74'),function(_0x27fdc0,_0x45065e){if(os[_0x4b35('0x62')]()==_0x4b35('0x40')){_0x45065e[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x4b35('0x71'));}else{var _0xee1b4a=_0x4b35('0x24')+_0x4b35('0x35')+'country=US\x0a\x0a';fs[_0x4b35('0x49')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0xee1b4a,function(_0xcf62a8){if(_0xcf62a8)return _0x45065e[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0xcf62a8);shell[_0x4b35('0x23')](_0x4b35('0x4b')+nicInterface+_0x4b35('0x5a'),{'silent':!![]});var _0x4710c4=setInterval(function(){var _0x390f2c=[];wpa_cli[_0x4b35('0x75')](nicInterface,function(_0x35b5d6,_0x17b508){if(_0x35b5d6)return _0x45065e['status'](0x1f4)[_0x4b35('0x55')](_0x35b5d6);FusionSettings[_0x4b35('0x19')][_0x4b35('0x18')]=_0x17b508;io['sockets'][_0x4b35('0x6f')](_0x4b35('0x59'),_0x17b508);if(_0x17b508[_0x4b35('0x63')]=='DISCONNECTED'||_0x17b508[_0x4b35('0x63')]==_0x4b35('0x4e')){clearInterval(_0x4710c4);io[_0x4b35('0x16')][_0x4b35('0x6f')](_0x4b35('0x59'),_0x17b508);return _0x45065e[_0x4b35('0x75')](0xc8)['json']({'serverMessage':_0x4b35('0x52')});}else if(connectingStatuses[_0x4b35('0x14')](_0x17b508[_0x4b35('0x63')])==-0x1){clearInterval(_0x4710c4);io['sockets'][_0x4b35('0x6f')]('wifi-connection',_0x17b508);return _0x45065e[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x4b35('0xd'));}});},0x12c);});}});app['get'](_0x4b35('0x6c'),function(_0x3b8cbc,_0xa30bba){var _0x188bcc=_0x4b35('0xf');fs[_0x4b35('0x77')](_0x188bcc,function(_0x29b791,_0x3818fc){if(_0x29b791)return _0xa30bba['status'](0x1f4)[_0x4b35('0x55')](_0x29b791);if(_0x3818fc[_0x4b35('0x0')]>0x0){fs['readFile'](_0x188bcc+'/'+_0x3818fc[0x0],_0x4b35('0xa'),function(_0x14093b,_0x3dd465){if(_0x14093b)return status(0x1f4)[_0x4b35('0x55')](_0x4b35('0x1b'));_0xa30bba[_0x4b35('0x4d')](_0x4b35('0x15'),_0x4b35('0x4c')+_0x3818fc[0x0]);return _0xa30bba[_0x4b35('0x75')](0xc8)[_0x4b35('0x50')](_0x188bcc+'/'+_0x3818fc[0x0]);});}else{return _0xa30bba['status'](0xc8)[_0x4b35('0x55')](_0x4b35('0x53'));}});});var _0xd0731d=null;app[_0x4b35('0x5')]('/api/diagnostics/start',function(_0xed9798,_0x5bcd85){if(os['platform']()!=_0x4b35('0x40')){_0xd0731d=spawn(_0x4b35('0x67'),['sh',_0x4b35('0x39'),'../../diagnostics/diagnosticGUI.py']);_0xd0731d['stdout']['on'](_0x4b35('0x68'),function(_0x34aefb){logger[_0x4b35('0x1f')](String(_0x34aefb));});_0xd0731d[_0x4b35('0x3e')]['on'](_0x4b35('0x68'),function(_0x85ff6d){logger[_0x4b35('0x1f')](String(_0x85ff6d));});var _0x1a7a08=0x1;var _0x186432=0x3;var _0x369adc=setInterval(function(){if(_0x1a7a08<=_0x186432){var _0xfd9abd=shell[_0x4b35('0x23')](_0x4b35('0x21'),{'silent':!![]})['stdout'];if(_0xfd9abd){clearInterval(_0x369adc);FusionSettings[_0x4b35('0x19')][_0x4b35('0x31')]={'process':_0xfd9abd,'socket':_0xed9798[_0x4b35('0x3d')][_0x4b35('0x3f')]};io['sockets'][_0x4b35('0x6f')](_0x4b35('0x7'),FusionSettings[_0x4b35('0x19')][_0x4b35('0x31')]);return _0x5bcd85[_0x4b35('0x75')](0xc8)['json']({'serverMessage':_0x4b35('0x5d')});}else{_0x1a7a08++;}}else{clearInterval(_0x369adc);return _0x5bcd85[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')]('Error\x20starting\x20diagnostic\x20tool');}},0x12c);}else{return _0x5bcd85[_0x4b35('0x75')](0xc8)['json']({'serverMessage':_0x4b35('0x60')});}});app['get']('/api/diagnostics/stop',function(_0x23cf4c,_0x1849b5){if(os['platform']()!='win32'){shell[_0x4b35('0x23')]('sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)',{'silent':!![]});shell[_0x4b35('0x23')](_0x4b35('0x21'),{'silent':!![]},function(_0x377575,_0x4940b4,_0x31fb91){(function(_0x1fdddb){var _0x484b2e=_0x1fdddb[_0x4b35('0x20')]();if(_0x484b2e){return _0x1849b5['status'](0x1f4)[_0x4b35('0x55')](_0x4b35('0x2f'));}else{FusionSettings[_0x4b35('0x19')]['fusion_diagnostics_running']=null;io[_0x4b35('0x16')]['emit']('diagnostics_running',FusionSettings[_0x4b35('0x19')][_0x4b35('0x31')]);_0xd0731d=null;return _0x1849b5[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'serverMessage':'Diagnostic\x20tool\x20stopped\x20successfully'});}}(_0x4940b4[_0x4b35('0x20')]()));});}else{return _0x1849b5[_0x4b35('0x75')](0xc8)['json']({'serverMessage':'Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows'});}});app[_0x4b35('0x70')](_0x4b35('0x17'),async function(_0x4f25bc,_0x21d80e){try{const _0x1ce49b=await autonomous[_0x4b35('0x1d')]()[_0x4b35('0x23')]();return _0x21d80e[_0x4b35('0x1e')](_0x1ce49b);}catch(_0x49df21){return _0x21d80e[_0x4b35('0x75')](0x1f4)['send'](error[_0x4b35('0x4a')]);}});app[_0x4b35('0x5')]('/api/autonomous',async function(_0x250bc2,_0x2a9c06){try{const _0x93a22d=await autonomous[_0x4b35('0x2')]({},_0x250bc2[_0x4b35('0x3d')]);return _0x2a9c06[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'serverMessage':_0x4b35('0x6e')});}catch(_0x5dc77a){return _0x2a9c06[_0x4b35('0x75')](0x1f4)[_0x4b35('0x55')](_0x5dc77a[_0x4b35('0x4a')]);}});app[_0x4b35('0x5')](_0x4b35('0x69'),async function(_0xdb994f,_0x4c84b2){try{const _0x49664b=_0xdb994f[_0x4b35('0x3d')][_0x4b35('0x6a')];const _0x570a1e=_0xdb994f['body'][_0x4b35('0x13')];const _0x1898cf=await fs[_0x4b35('0x77')]('./app/filesystem/'+_0x49664b+'/'+_0x570a1e);return _0x4c84b2[_0x4b35('0x75')](0xc8)[_0x4b35('0x1e')]({'files':_0x1898cf});}catch(_0x46ff7d){return _0x4c84b2['status'](0x1f4)['send'](_0x46ff7d[_0x4b35('0x4a')]);}});function _0x286609(){return function(_0x39f808,_0x46d9f5,_0x1108e8){if(_0x39f808[_0x4b35('0x57')]()){return _0x1108e8();}else{_0x46d9f5[_0x4b35('0x75')](0x191)[_0x4b35('0x55')](_0x4b35('0x22'));}};}}();