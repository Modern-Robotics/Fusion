var _0x25d1=['/api/admin/crashReport','/api/admin/users','close','json','SocketVariables','wireless-tools/wpa_supplicant','/api/autonomous','}\x0a\x0a','../../models/autonomous','reboot','config','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','/api/diagnostics/stop','stdout','Diagnostic\x20tool\x20stopped\x20successfully','User\x20Unauthenticated','diagnostics_running','ssid','attachment;\x20filename=','\x20successfully','save','../../etc/config-wap/hostapd.conf__npp.sh','sudo\x20wpa_cli\x20-i\x20','Wireless\x20interface\x20not\x20found','wireless-tools/wpa_cli','Shut\x20Down\x20Commencing','password','/api/autonomousPrograms','Wifi\x20file\x20not\x20found','../../global/fusionSettings','\x09scan_ssid=1\x0a','Unable\x20to\x20stop\x20diagnostic\x20tool','Diagnostic\x20tool\x20started\x20successfully','\x20assigned','sockets','Error\x20starting\x20diagnostic\x20tool','platform','\x09key_mgmt=WPA-PSK\x0a','python','Ip\x20address:\x20','exports','findOneAndUpdate','../../utils/logger','\x20reconfigure','Error\x20disconnecting','Retreived\x20wireless\x20connections','win32','No\x20crash\x20files\x20found','SSID','status','indexOf','../../diagnostics/runRemi.sh','socketId','type','readFile','EOL','length','split','body','Disconnected\x20successfully','utf8','message','\x09psk=\x22','Username\x20already\x20taken.','sudo','fusion_wifi_access','.crash','\x20\x20\x20\x20ssid=\x22','Content-disposition','emit','Restart\x20Commencing','join','network={\x0a','\x09ssid=\x22','wpa_state','exec','etc','writeFile','send','filepath','scan','child_process','Wifi_NIC','wpa_passphrase\x20\x22','\x20\x20\x20\x20key_mgmt=NONE\x0a','Successfully\x20changed\x20wifi\x20settings','/etc/hostapd/hostapd.conf','/api/diagnostics/start','/api/admin/wirelessSettings','Password','generateFileSystem','get','./app/filesystem/','Connected\x20to\x20','isAuthenticated','country=US\x0a\x0a','data','/api/admin/wirelessConnections','/api/admin/powerOff','findOne','info','username','fusion_diagnostics_running','wpa_passphrase','User\x20created!','sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)','\x22\x20\x22','post','/api/admin/wirelessConnections/disconnect','stderr','readdir','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','spawn','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','wifi-connection','setHeader','4WAY_HANDSHAKE','update_config=1\x0a','DISCONNECTED','trim','/etc/wpa_supplicant/wpa_supplicant.conf'];(function(_0x589327,_0x25d1dc){var _0x3c9a14=function(_0x564135){while(--_0x564135){_0x589327['push'](_0x589327['shift']());}};_0x3c9a14(++_0x25d1dc);}(_0x25d1,0x1d8));var _0x3c9a=function(_0x589327,_0x25d1dc){_0x589327=_0x589327-0x0;var _0x3c9a14=_0x25d1[_0x589327];return _0x3c9a14;};var fs=require('fs-extra');var mkdirp=require('mkdirp');var os=require('os');var path=require('path');var shell=require('shelljs');var wpa_cli=require(_0x3c9a('0x24'));var iwlist=require('wireless-tools/iwlist');var wpa_supplicant=require(_0x3c9a('0x11'));var spawn=require(_0x3c9a('0x5d'))[_0x3c9a('0x3')];const config=require(_0x3c9a('0x16'));const autonomous=require(_0x3c9a('0x14'));const logger=require(_0x3c9a('0x36'));let nicInterface=config[_0x3c9a('0x67')](_0x3c9a('0x5e'));const app=require('../../express');const User=require('../../models/user');const io=require('../../socket');const FusionSettings=require(_0x3c9a('0x29'));module[_0x3c9a('0x34')]=function(){app[_0x3c9a('0x77')](_0x3c9a('0xd'),_0x1794b7(),function(_0x4817a4,_0x103417){User[_0x3c9a('0x6f')]({'username':_0x4817a4['body']['username']},async function(_0x562404,_0x40b722){if(_0x562404)return _0x103417[_0x3c9a('0x3d')](0x1f4)['send'](_0x562404);if(_0x40b722){return _0x103417['status'](0x1f4)[_0x3c9a('0x5a')](_0x3c9a('0x4b'));}else{var _0x3a8015=new User(_0x4817a4['body']);_0x3a8015[_0x3c9a('0x71')]=_0x4817a4[_0x3c9a('0x46')][_0x3c9a('0x71')];_0x3a8015[_0x3c9a('0x26')]=_0x3a8015['generateHash'](_0x4817a4['body']['password']);_0x3a8015[_0x3c9a('0x5b')]=await _0x3a8015[_0x3c9a('0x66')](_0x3a8015['username']);_0x3a8015[_0x3c9a('0x20')](function(_0x5db104){if(_0x5db104)return _0x103417[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x5db104);return _0x103417[_0x3c9a('0x3d')](0xc8)['json']({'serverMessage':_0x3c9a('0x74')});});}});});app[_0x3c9a('0x67')](_0x3c9a('0x6e'),function(_0x3ef13e,_0x58bb08){_0x58bb08[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x25')});var _0x507ef9=require(_0x3c9a('0x5d'))[_0x3c9a('0x3')];var _0x553b38=_0x507ef9('sudo',['poweroff']);});app[_0x3c9a('0x67')]('/api/admin/restart',function(_0x2232b8,_0x73497f){_0x73497f[_0x3c9a('0x3d')](0xc8)['send'](_0x3c9a('0x52'));var _0x1f3e11=require('child_process')['spawn'];var _0x4f5ca3=_0x1f3e11(_0x3c9a('0x4c'),[_0x3c9a('0x15')]);});app[_0x3c9a('0x67')](_0x3c9a('0x64'),function(_0x48f091,_0x1db725){var _0x1536b7;var _0x49b55a=require('os')[_0x3c9a('0x43')];var _0x4e5336;var _0x346e07;var _0xbe0b6e={};if(os[_0x3c9a('0x30')]()==_0x3c9a('0x3a')){_0x1536b7=_0x3c9a('0x21');fs[_0x3c9a('0x42')](_0x1536b7,_0x3c9a('0x48'),function(_0x97461e,_0x461531){if(_0x97461e)_0x1db725[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x3c9a('0x28'));_0x4e5336=_0x461531['split']('\x0a');for(var _0x5933a5=0x0;_0x5933a5<_0x4e5336[_0x3c9a('0x44')];_0x5933a5++){_0x346e07=_0x4e5336[_0x5933a5][_0x3c9a('0x45')]('=');if(_0x346e07[0x0]==_0x3c9a('0x1d'))_0xbe0b6e[_0x3c9a('0x3c')]=_0x346e07[0x1];else if(_0x346e07[0x0]=='wpa_passphrase')_0xbe0b6e[_0x3c9a('0x65')]=_0x346e07[0x1];}_0x1db725[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'SSID':_0xbe0b6e['SSID'],'Password':_0xbe0b6e[_0x3c9a('0x65')]});});}else{_0x1536b7=_0x3c9a('0x62');fs[_0x3c9a('0x42')](_0x1536b7,_0x3c9a('0x48'),function(_0x32f1e6,_0x4c02b8){if(_0x32f1e6)_0x1db725[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')]('Wifi\x20file\x20not\x20found');_0x4e5336=_0x4c02b8[_0x3c9a('0x45')](_0x49b55a);for(var _0x334371=0x0;_0x334371<_0x4e5336[_0x3c9a('0x44')];_0x334371++){_0x346e07=_0x4e5336[_0x334371]['split']('=');if(_0x346e07[0x0]==_0x3c9a('0x1d'))_0xbe0b6e['SSID']=_0x346e07[0x1];else if(_0x346e07[0x0]==_0x3c9a('0x73'))_0xbe0b6e[_0x3c9a('0x65')]=_0x346e07[0x1];}if(!_0xbe0b6e[_0x3c9a('0x3c')]){_0xbe0b6e[_0x3c9a('0x3c')]='Not\x20configured..';_0xbe0b6e[_0x3c9a('0x65')]='';}_0x1db725[_0x3c9a('0x3d')](0xc8)['json']({'SSID':_0xbe0b6e['SSID'],'Password':_0xbe0b6e['Password']});});}});app[_0x3c9a('0x77')](_0x3c9a('0x64'),function(_0x374866,_0x22f51f){try{var _0x4d5d1f;var _0x52e2be;var _0x541da7=path[_0x3c9a('0x53')]('..','..',_0x3c9a('0x58'),'ssid_set.py');if(_0x374866[_0x3c9a('0x46')]['ssid']==null&&_0x374866[_0x3c9a('0x46')][_0x3c9a('0x26')]==null)_0x52e2be=['python',_0x541da7,'-d'];else _0x52e2be=[_0x3c9a('0x32'),_0x541da7,'-s',_0x374866['body'][_0x3c9a('0x1d')],'-p',_0x374866[_0x3c9a('0x46')][_0x3c9a('0x26')]];var _0x1576b7=require(_0x3c9a('0x5d'))[_0x3c9a('0x3')];python_process=_0x1576b7('sudo',_0x52e2be,{'stdio':'pipe'});python_process[_0x3c9a('0x0')]['on'](_0x3c9a('0x6c'),function(_0x1b8134){logger['info'](String(_0x1b8134));_0x4d5d1f=String(_0x1b8134);});python_process[_0x3c9a('0x19')]['on'](_0x3c9a('0xe'),function(_0x404c58){if(_0x4d5d1f)return _0x22f51f[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x4d5d1f);else return _0x22f51f[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x61')});});}catch(_0x30ea3a){logger[_0x3c9a('0x70')](_0x30ea3a);return _0x22f51f[_0x3c9a('0x3d')](0x1f4)['send'](_0x30ea3a);}});app[_0x3c9a('0x67')](_0x3c9a('0x6d'),function(_0x2b3b82,_0x11f9ba){if(os['platform']()==_0x3c9a('0x3a')){return _0x11f9ba[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0x5a')]();}else{iwlist[_0x3c9a('0x5c')](nicInterface,function(_0x4109d8,_0x1fd7ac){if(_0x4109d8)return _0x11f9ba[_0x3c9a('0x3d')](0x1f4)['send'](_0x3c9a('0x23'));else return _0x11f9ba[_0x3c9a('0x3d')](0xc8)['send']({'serverMessage':_0x3c9a('0x39'),'data':_0x1fd7ac});});}});app[_0x3c9a('0x77')](_0x3c9a('0x6d'),function(_0x1dabff,_0x41f8f2){var _0xd5fed0=undefined;var _0x5e0f2a=_0x3c9a('0x17')+_0x3c9a('0x8')+_0x3c9a('0x6b');var _0x26d112=_0x3c9a('0x54')+_0x3c9a('0x55')+_0x1dabff['body'][_0x3c9a('0x1d')]+'\x22\x0a'+_0x3c9a('0x2a')+_0x3c9a('0x4a')+_0x1dabff['body'][_0x3c9a('0x26')]+'\x22\x0a'+_0x3c9a('0x31')+_0x3c9a('0x13');if(_0x1dabff['body'][_0x3c9a('0x26')]){_0xd5fed0=shell[_0x3c9a('0x57')](_0x3c9a('0x5f')+_0x1dabff['body'][_0x3c9a('0x1d')]+_0x3c9a('0x76')+_0x1dabff['body']['password']+'\x22',{'silent':!![]})[_0x3c9a('0x19')];}else{_0xd5fed0='network={\x0a'+_0x3c9a('0x4f')+_0x1dabff[_0x3c9a('0x46')][_0x3c9a('0x1d')]+'\x22\x0a'+_0x3c9a('0x60')+'}\x0a';}let _0x3501f0='';if(_0x1dabff['body']['hiddenNetwork'])_0x3501f0=_0x5e0f2a+_0x26d112;else _0x3501f0=_0x5e0f2a+_0xd5fed0;fs[_0x3c9a('0x59')]('/etc/wpa_supplicant/wpa_supplicant.conf',_0x3501f0,function(_0x14c6bd){if(_0x14c6bd)return _0x41f8f2[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x14c6bd);shell['exec']('sudo\x20wpa_cli\x20-i\x20'+nicInterface+_0x3c9a('0x37'),{'silent':!![]});const _0x325f9d=0x3a98;var _0x3b1515=0x12c;var _0x46ba85=0x0;var _0xa32ac2=setInterval(function(){var _0x5d846a=['SCANNING',_0x3c9a('0x7'),'AUTHENTICATING',_0x3c9a('0x9'),'ASSOCIATING'];wpa_cli[_0x3c9a('0x3d')](nicInterface,function(_0x560597,_0x3eb199){if(_0x560597)return _0x41f8f2[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x560597);if(_0x3eb199[_0x3c9a('0x56')]=='COMPLETED'){if(_0x3eb199['ip']){logger[_0x3c9a('0x70')](_0x3c9a('0x33')+_0x3eb199['ip']+_0x3c9a('0x2d'));clearInterval(_0xa32ac2);FusionSettings['SocketVariables'][_0x3c9a('0x4d')]=_0x3eb199;io[_0x3c9a('0x2e')][_0x3c9a('0x51')]('wifi-connection',_0x3eb199);return _0x41f8f2[_0x3c9a('0x3d')](0xc8)['json']({'serverMessage':_0x3c9a('0x69')+_0x1dabff[_0x3c9a('0x46')][_0x3c9a('0x1d')]+_0x3c9a('0x1f')});}else if(_0x46ba85>_0x325f9d){logger[_0x3c9a('0x70')]('Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.');clearInterval(_0xa32ac2);return _0x41f8f2['status'](0x1f4)[_0x3c9a('0x5a')]('Error\x20connecting\x20to\x20'+_0x1dabff[_0x3c9a('0x46')][_0x3c9a('0x1d')]);}_0x46ba85+=_0x3b1515;}else if(_0x5d846a[_0x3c9a('0x3e')](_0x3eb199[_0x3c9a('0x56')])==-0x1){clearInterval(_0xa32ac2);io[_0x3c9a('0x2e')]['emit'](_0x3c9a('0x5'),_0x3eb199);return _0x41f8f2[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')]('Error\x20connecting\x20to\x20'+_0x1dabff[_0x3c9a('0x46')][_0x3c9a('0x1d')]);}});},_0x3b1515);});});app[_0x3c9a('0x67')](_0x3c9a('0x78'),function(_0x28a29e,_0x1b9e28){if(os['platform']()==_0x3c9a('0x3a')){_0x1b9e28['status'](0x1f4)[_0x3c9a('0x5a')]('Disconnect\x20not\x20available\x20on\x20Windows');}else{var _0x327231=_0x3c9a('0x17')+_0x3c9a('0x8')+_0x3c9a('0x6b');fs[_0x3c9a('0x59')](_0x3c9a('0xb'),_0x327231,function(_0x43a8f8){if(_0x43a8f8)return _0x1b9e28[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x43a8f8);shell[_0x3c9a('0x57')](_0x3c9a('0x22')+nicInterface+_0x3c9a('0x37'),{'silent':!![]});var _0x4b67e9=setInterval(function(){var _0x235325=[];wpa_cli['status'](nicInterface,function(_0x2551ec,_0x525577){if(_0x2551ec)return _0x1b9e28[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x2551ec);FusionSettings[_0x3c9a('0x10')][_0x3c9a('0x4d')]=_0x525577;io[_0x3c9a('0x2e')][_0x3c9a('0x51')](_0x3c9a('0x5'),_0x525577);if(_0x525577[_0x3c9a('0x56')]==_0x3c9a('0x9')||_0x525577[_0x3c9a('0x56')]=='INACTIVE'){clearInterval(_0x4b67e9);io[_0x3c9a('0x2e')][_0x3c9a('0x51')](_0x3c9a('0x5'),_0x525577);return _0x1b9e28['status'](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x47')});}else if(connectingStatuses[_0x3c9a('0x3e')](_0x525577[_0x3c9a('0x56')])==-0x1){clearInterval(_0x4b67e9);io['sockets'][_0x3c9a('0x51')](_0x3c9a('0x5'),_0x525577);return _0x1b9e28[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x3c9a('0x38'));}});},0x12c);});}});app[_0x3c9a('0x67')](_0x3c9a('0xc'),function(_0x5c84c2,_0x5f09f5){var _0x3f78c3=_0x3c9a('0x4e');fs['readdir'](_0x3f78c3,function(_0x1fdac6,_0x722786){if(_0x1fdac6)return _0x5f09f5[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x1fdac6);if(_0x722786[_0x3c9a('0x44')]>0x0){fs[_0x3c9a('0x42')](_0x3f78c3+'/'+_0x722786[0x0],_0x3c9a('0x48'),function(_0x2aae6a,_0x8462f4){if(_0x2aae6a)return status(0x1f4)['send']('Error\x20reading\x20crash\x20file');_0x5f09f5[_0x3c9a('0x6')](_0x3c9a('0x50'),_0x3c9a('0x1e')+_0x722786[0x0]);return _0x5f09f5[_0x3c9a('0x3d')](0xc8)['download'](_0x3f78c3+'/'+_0x722786[0x0]);});}else{return _0x5f09f5[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0x5a')](_0x3c9a('0x3b'));}});});var _0x20851d=null;app[_0x3c9a('0x77')](_0x3c9a('0x63'),function(_0x44af90,_0x220124){if(os[_0x3c9a('0x30')]()!=_0x3c9a('0x3a')){_0x20851d=spawn('sudo',['sh',_0x3c9a('0x3f'),'../../diagnostics/diagnosticGUI.py']);_0x20851d[_0x3c9a('0x19')]['on'](_0x3c9a('0x6c'),function(_0x40302b){logger[_0x3c9a('0x70')](String(_0x40302b));});_0x20851d['stderr']['on'](_0x3c9a('0x6c'),function(_0x45225e){logger[_0x3c9a('0x70')](String(_0x45225e));});var _0x52962b=0x1;var _0x5c6ac2=0x3;var _0x2e765e=setInterval(function(){if(_0x52962b<=_0x5c6ac2){var _0x513926=shell[_0x3c9a('0x57')](_0x3c9a('0x4'),{'silent':!![]})[_0x3c9a('0x19')];if(_0x513926){clearInterval(_0x2e765e);FusionSettings[_0x3c9a('0x10')][_0x3c9a('0x72')]={'process':_0x513926,'socket':_0x44af90[_0x3c9a('0x46')][_0x3c9a('0x40')]};io[_0x3c9a('0x2e')][_0x3c9a('0x51')](_0x3c9a('0x1c'),FusionSettings[_0x3c9a('0x10')][_0x3c9a('0x72')]);return _0x220124[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x2c')});}else{_0x52962b++;}}else{clearInterval(_0x2e765e);return _0x220124[_0x3c9a('0x3d')](0x1f4)['send'](_0x3c9a('0x2f'));}},0x12c);}else{return _0x220124['status'](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x2')});}});app[_0x3c9a('0x67')](_0x3c9a('0x18'),function(_0x1371d1,_0x42ab53){if(os[_0x3c9a('0x30')]()!=_0x3c9a('0x3a')){shell['exec'](_0x3c9a('0x75'),{'silent':!![]});shell[_0x3c9a('0x57')](_0x3c9a('0x4'),{'silent':!![]},function(_0x1590c1,_0xb05e3b,_0x4cbe56){(function(_0x32900f){var _0x36a89d=_0x32900f[_0x3c9a('0xa')]();if(_0x36a89d){return _0x42ab53['status'](0x1f4)[_0x3c9a('0x5a')](_0x3c9a('0x2b'));}else{FusionSettings[_0x3c9a('0x10')]['fusion_diagnostics_running']=null;io['sockets']['emit']('diagnostics_running',FusionSettings[_0x3c9a('0x10')][_0x3c9a('0x72')]);_0x20851d=null;return _0x42ab53['status'](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x1a')});}}(_0xb05e3b[_0x3c9a('0xa')]()));});}else{return _0x42ab53[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'serverMessage':_0x3c9a('0x2')});}});app[_0x3c9a('0x67')](_0x3c9a('0x12'),async function(_0x5b8685,_0x5a3dc3){try{const _0x376f88=await autonomous[_0x3c9a('0x6f')]()[_0x3c9a('0x57')]();return _0x5a3dc3[_0x3c9a('0xf')](_0x376f88);}catch(_0x309958){return _0x5a3dc3[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](error[_0x3c9a('0x49')]);}});app[_0x3c9a('0x77')]('/api/autonomous',async function(_0x57fba8,_0x5a096f){try{const _0x19ba62=await autonomous[_0x3c9a('0x35')]({},_0x57fba8[_0x3c9a('0x46')]);return _0x5a096f[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'serverMessage':'Updated\x20successfully'});}catch(_0x359920){return _0x5a096f[_0x3c9a('0x3d')](0x1f4)[_0x3c9a('0x5a')](_0x359920[_0x3c9a('0x49')]);}});app[_0x3c9a('0x77')](_0x3c9a('0x27'),async function(_0x2b1c2f,_0x1e53ff){try{const _0xf974f=_0x2b1c2f[_0x3c9a('0x46')][_0x3c9a('0x71')];const _0x49c762=_0x2b1c2f['body'][_0x3c9a('0x41')];const _0x46b497=await fs[_0x3c9a('0x1')](_0x3c9a('0x68')+_0xf974f+'/'+_0x49c762);return _0x1e53ff[_0x3c9a('0x3d')](0xc8)[_0x3c9a('0xf')]({'files':_0x46b497});}catch(_0xb578de){return _0x1e53ff['status'](0x1f4)[_0x3c9a('0x5a')](_0xb578de[_0x3c9a('0x49')]);}});function _0x1794b7(){return function(_0x160f2c,_0x58b5cd,_0x3ab2a7){if(_0x160f2c[_0x3c9a('0x6a')]()){return _0x3ab2a7();}else{_0x58b5cd[_0x3c9a('0x3d')](0x191)[_0x3c9a('0x5a')](_0x3c9a('0x1b'));}};}}();