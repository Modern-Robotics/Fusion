var _0x4f82=['COMPLETED','Ip\x20address:\x20','\x20assigned','SocketVariables','sockets','emit','Connected\x20to\x20','indexOf','wifi-connection','Error\x20connecting\x20to\x20','/api/admin/wirelessConnections/disconnect','Disconnect\x20not\x20available\x20on\x20Windows','\x20reconfigure','fusion_wifi_access','INACTIVE','Error\x20disconnecting','/api/admin/crashReport','.crash','readdir','Error\x20reading\x20crash\x20file','Content-disposition','download','No\x20crash\x20files\x20found','../../diagnostics/runRemi.sh','../../diagnostics/diagnosticGUI.py','stdout','fusion_diagnostics_running','Diagnostic\x20tool\x20started\x20successfully','Error\x20starting\x20diagnostic\x20tool','Diagnostic\x20tool\x20does\x20not\x20run\x20on\x20windows','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','Unable\x20to\x20stop\x20diagnostic\x20tool','diagnostics_running','Diagnostic\x20tool\x20stopped\x20successfully','isAuthenticated','User\x20Unauthenticated','path','shelljs','wireless-tools/wpa_cli','wireless-tools/iwlist','wireless-tools/wpa_supplicant','spawn','config','get','exports','post','/api/admin/users','body','username','status','send','generateFileSystem','json','User\x20created!','/api/admin/powerOff','Shut\x20Down\x20Commencing','child_process','sudo','poweroff','/api/admin/restart','Restart\x20Commencing','reboot','/api/admin/wirelessSettings','EOL','platform','win32','../../etc/config-wap/hostapd.conf__npp.sh','readFile','utf8','Wifi\x20file\x20not\x20found','split','length','ssid','SSID','wpa_passphrase','Password','Not\x20configured..','join','etc','ssid_set.py','password','python','stderr','data','log','Successfully\x20changed\x20wifi\x20settings','scan','Wireless\x20interface\x20not\x20found','/api/admin/wirelessConnections','ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a','update_config=1\x0a','country=US\x0a\x0a','network={\x0a','\x09ssid=\x22','\x09scan_ssid=1\x0a','exec','wpa_passphrase\x20\x22','/etc/wpa_supplicant/wpa_supplicant.conf','sudo\x20wpa_cli\x20-i\x20','SCANNING','4WAY_HANDSHAKE','DISCONNECTED','ASSOCIATING','wpa_state'];(function(_0x416204,_0x986097){var _0x1f6a64=function(_0x15208e){while(--_0x15208e){_0x416204['push'](_0x416204['shift']());}};_0x1f6a64(++_0x986097);}(_0x4f82,0x8c));var _0x3583=function(_0x4c8d6c,_0x33f597){_0x4c8d6c=_0x4c8d6c-0x0;var _0x2a69fd=_0x4f82[_0x4c8d6c];return _0x2a69fd;};var fs=require('fs');var mkdirp=require('mkdirp');var os=require('os');var path=require(_0x3583('0x0'));var shell=require(_0x3583('0x1'));var wpa_cli=require(_0x3583('0x2'));var iwlist=require(_0x3583('0x3'));var wpa_supplicant=require(_0x3583('0x4'));var spawn=require('child_process')[_0x3583('0x5')];const config=require(_0x3583('0x6'));let nicInterface=config[_0x3583('0x7')]('Wifi_NIC');module[_0x3583('0x8')]=function(_0xe822bd,_0x5e71f6,_0x220cfa,_0x391673,_0x208a3d){_0xe822bd[_0x3583('0x9')](_0x3583('0xa'),_0x4b91c6(),function(_0x197dbc,_0x183f76){_0x5e71f6['findOne']({'username':_0x197dbc[_0x3583('0xb')][_0x3583('0xc')]},function(_0x3bf810,_0x5ceb60){if(_0x3bf810)return _0x183f76[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x3bf810);if(_0x5ceb60){return _0x183f76[_0x3583('0xd')](0x1f4)[_0x3583('0xe')]('Username\x20already\x20taken.');}else{var _0x1666cf=new _0x5e71f6(_0x197dbc['body']);_0x1666cf['username']=_0x197dbc['body'][_0x3583('0xc')];_0x1666cf['password']=_0x1666cf['generateHash'](_0x197dbc[_0x3583('0xb')]['password']);_0x1666cf['filepath']=_0x1666cf[_0x3583('0xf')](_0x1666cf[_0x3583('0xc')]);_0x1666cf['save'](function(_0x140ad6){if(_0x140ad6)return _0x183f76['status'](0x1f4)[_0x3583('0xe')](_0x140ad6);return _0x183f76['status'](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x11')});});}});});_0xe822bd[_0x3583('0x7')](_0x3583('0x12'),function(_0x58d82b,_0x446ffc){_0x446ffc[_0x3583('0xd')](0xc8)['json']({'serverMessage':_0x3583('0x13')});var _0x4db39d=require(_0x3583('0x14'))[_0x3583('0x5')];var _0x2c5155=_0x4db39d(_0x3583('0x15'),[_0x3583('0x16')]);});_0xe822bd[_0x3583('0x7')](_0x3583('0x17'),function(_0xb7a986,_0x31a350){_0x31a350[_0x3583('0xd')](0xc8)[_0x3583('0xe')](_0x3583('0x18'));var _0x1c3779=require(_0x3583('0x14'))['spawn'];var _0x5688ed=_0x1c3779(_0x3583('0x15'),[_0x3583('0x19')]);});_0xe822bd[_0x3583('0x7')](_0x3583('0x1a'),function(_0x34899b,_0x28a706){var _0x2c1810;var _0x32954d=require('os')[_0x3583('0x1b')];var _0x3291cd;var _0x2caa29;var _0x177025={};if(os[_0x3583('0x1c')]()==_0x3583('0x1d')){_0x2c1810=_0x3583('0x1e');fs[_0x3583('0x1f')](_0x2c1810,_0x3583('0x20'),function(_0x3b6b93,_0x673943){if(_0x3b6b93)_0x28a706['status'](0x1f4)['send'](_0x3583('0x21'));_0x3291cd=_0x673943[_0x3583('0x22')]('\x0a');for(var _0x1cb292=0x0;_0x1cb292<_0x3291cd[_0x3583('0x23')];_0x1cb292++){_0x2caa29=_0x3291cd[_0x1cb292][_0x3583('0x22')]('=');if(_0x2caa29[0x0]==_0x3583('0x24'))_0x177025[_0x3583('0x25')]=_0x2caa29[0x1];else if(_0x2caa29[0x0]==_0x3583('0x26'))_0x177025[_0x3583('0x27')]=_0x2caa29[0x1];}_0x28a706[_0x3583('0xd')](0xc8)['json']({'SSID':_0x177025['SSID'],'Password':_0x177025['Password']});});}else{_0x2c1810='/etc/hostapd/hostapd.conf';fs[_0x3583('0x1f')](_0x2c1810,_0x3583('0x20'),function(_0x351d3d,_0x190bca){if(_0x351d3d)_0x28a706[_0x3583('0xd')](0x1f4)['send']('Wifi\x20file\x20not\x20found');_0x3291cd=_0x190bca['split'](_0x32954d);for(var _0x1e6866=0x0;_0x1e6866<_0x3291cd[_0x3583('0x23')];_0x1e6866++){_0x2caa29=_0x3291cd[_0x1e6866][_0x3583('0x22')]('=');if(_0x2caa29[0x0]=='ssid')_0x177025[_0x3583('0x25')]=_0x2caa29[0x1];else if(_0x2caa29[0x0]=='wpa_passphrase')_0x177025[_0x3583('0x27')]=_0x2caa29[0x1];}if(!_0x177025[_0x3583('0x25')]){_0x177025[_0x3583('0x25')]=_0x3583('0x28');_0x177025[_0x3583('0x27')]='';}_0x28a706[_0x3583('0xd')](0xc8)['json']({'SSID':_0x177025[_0x3583('0x25')],'Password':_0x177025[_0x3583('0x27')]});});}});_0xe822bd[_0x3583('0x9')]('/api/admin/wirelessSettings',function(_0x69806d,_0x4c8a9b){try{var _0x578e6e;var _0x3b8015;var _0x3eb00d=path[_0x3583('0x29')]('..','..',_0x3583('0x2a'),_0x3583('0x2b'));if(_0x69806d[_0x3583('0xb')][_0x3583('0x24')]==null&&_0x69806d[_0x3583('0xb')][_0x3583('0x2c')]==null)_0x3b8015=[_0x3583('0x2d'),_0x3eb00d,'-d'];else _0x3b8015=[_0x3583('0x2d'),_0x3eb00d,'-s',_0x69806d[_0x3583('0xb')][_0x3583('0x24')],'-p',_0x69806d[_0x3583('0xb')][_0x3583('0x2c')]];var _0x23e305=require(_0x3583('0x14'))['spawn'];python_process=_0x23e305('sudo',_0x3b8015,{'stdio':'pipe'});python_process[_0x3583('0x2e')]['on'](_0x3583('0x2f'),function(_0x549a74){console[_0x3583('0x30')](String(_0x549a74));_0x578e6e=String(_0x549a74);});python_process['stdout']['on']('close',function(_0x4c5f8d){if(_0x578e6e)return _0x4c8a9b[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x578e6e);else return _0x4c8a9b[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x31')});});}catch(_0x4c3c38){console['log'](_0x4c3c38);return _0x4c8a9b['status'](0x1f4)[_0x3583('0xe')](_0x4c3c38);}});_0xe822bd['get']('/api/admin/wirelessConnections',function(_0xba38a4,_0x37146d){if(os[_0x3583('0x1c')]()==_0x3583('0x1d')){return _0x37146d[_0x3583('0xd')](0xc8)[_0x3583('0xe')]();}else{iwlist[_0x3583('0x32')](nicInterface,function(_0x1f27f5,_0x18752a){if(_0x1f27f5)return _0x37146d['status'](0x1f4)['send'](_0x3583('0x33'));else return _0x37146d[_0x3583('0xd')](0xc8)['send']({'serverMessage':'Retreived\x20wireless\x20connections','data':_0x18752a});});}});_0xe822bd[_0x3583('0x9')](_0x3583('0x34'),function(_0x4d310b,_0x121f1f){var _0x21868d=undefined;var _0x42aa82=_0x3583('0x35')+_0x3583('0x36')+_0x3583('0x37');var _0x2a18c3=_0x3583('0x38')+_0x3583('0x39')+_0x4d310b[_0x3583('0xb')][_0x3583('0x24')]+'\x22\x0a'+_0x3583('0x3a')+'\x09psk=\x22'+_0x4d310b[_0x3583('0xb')][_0x3583('0x2c')]+'\x22\x0a'+'\x09key_mgmt=WPA-PSK\x0a'+'}\x0a\x0a';if(_0x4d310b[_0x3583('0xb')][_0x3583('0x2c')]){_0x21868d=shell[_0x3583('0x3b')](_0x3583('0x3c')+_0x4d310b[_0x3583('0xb')]['ssid']+'\x22\x20\x22'+_0x4d310b[_0x3583('0xb')][_0x3583('0x2c')]+'\x22',{'silent':!![]})['stdout'];}else{_0x21868d=_0x3583('0x38')+'\x20\x20\x20\x20ssid=\x22'+_0x4d310b[_0x3583('0xb')][_0x3583('0x24')]+'\x22\x0a'+'\x20\x20\x20\x20key_mgmt=NONE\x0a'+'}\x0a';}let _0x1d582a='';if(_0x4d310b[_0x3583('0xb')]['hiddenNetwork'])_0x1d582a=_0x42aa82+_0x2a18c3;else _0x1d582a=_0x42aa82+_0x21868d;fs['writeFile'](_0x3583('0x3d'),_0x1d582a,function(_0x54f690){if(_0x54f690)return _0x121f1f[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x54f690);shell[_0x3583('0x3b')](_0x3583('0x3e')+nicInterface+'\x20reconfigure',{'silent':!![]});const _0x53fd25=0x3a98;var _0x1852f2=0x12c;var _0x5a0ca6=0x0;var _0x4fed9c=setInterval(function(){var _0x2cf686=[_0x3583('0x3f'),_0x3583('0x40'),'AUTHENTICATING',_0x3583('0x41'),_0x3583('0x42')];wpa_cli[_0x3583('0xd')](nicInterface,function(_0x122856,_0x42314b){if(_0x122856)return _0x121f1f[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x122856);if(_0x42314b[_0x3583('0x43')]==_0x3583('0x44')){if(_0x42314b['ip']){console[_0x3583('0x30')](_0x3583('0x45')+_0x42314b['ip']+_0x3583('0x46'));clearInterval(_0x4fed9c);_0x208a3d[_0x3583('0x47')]['fusion_wifi_access']=_0x42314b;_0x391673[_0x3583('0x48')][_0x3583('0x49')]('wifi-connection',_0x42314b);return _0x121f1f[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x4a')+_0x4d310b[_0x3583('0xb')]['ssid']+'\x20successfully'});}else if(_0x5a0ca6>_0x53fd25){console[_0x3583('0x30')]('Took\x20too\x20long\x20to\x20connect.\x20Something\x20must\x20be\x20wrong.');clearInterval(_0x4fed9c);return _0x121f1f['status'](0x1f4)[_0x3583('0xe')]('Error\x20connecting\x20to\x20'+_0x4d310b['body'][_0x3583('0x24')]);}_0x5a0ca6+=_0x1852f2;}else if(_0x2cf686[_0x3583('0x4b')](_0x42314b[_0x3583('0x43')])==-0x1){clearInterval(_0x4fed9c);_0x391673[_0x3583('0x48')][_0x3583('0x49')](_0x3583('0x4c'),_0x42314b);return _0x121f1f[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x3583('0x4d')+_0x4d310b[_0x3583('0xb')][_0x3583('0x24')]);}});},_0x1852f2);});});_0xe822bd[_0x3583('0x7')](_0x3583('0x4e'),function(_0x1a1cdc,_0x265f88){if(os['platform']()==_0x3583('0x1d')){_0x265f88[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x3583('0x4f'));}else{var _0x9bf8fa='ctrl_interface=DIR=/var/run/wpa_supplicant\x20GROUP=netdev\x0a'+'update_config=1\x0a'+'country=US\x0a\x0a';fs['writeFile'](_0x3583('0x3d'),_0x9bf8fa,function(_0x2cc6ea){if(_0x2cc6ea)return _0x265f88[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x2cc6ea);shell['exec']('sudo\x20wpa_cli\x20-i\x20'+nicInterface+_0x3583('0x50'),{'silent':!![]});var _0x6ef12d=setInterval(function(){var _0x28121a=[];wpa_cli['status'](nicInterface,function(_0x2657bc,_0x2252ef){if(_0x2657bc)return _0x265f88[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x2657bc);_0x208a3d[_0x3583('0x47')][_0x3583('0x51')]=_0x2252ef;_0x391673[_0x3583('0x48')][_0x3583('0x49')](_0x3583('0x4c'),_0x2252ef);if(_0x2252ef[_0x3583('0x43')]==_0x3583('0x41')||_0x2252ef[_0x3583('0x43')]==_0x3583('0x52')){clearInterval(_0x6ef12d);_0x391673[_0x3583('0x48')][_0x3583('0x49')](_0x3583('0x4c'),_0x2252ef);return _0x265f88[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':'Disconnected\x20successfully'});}else if(connectingStatuses[_0x3583('0x4b')](_0x2252ef['wpa_state'])==-0x1){clearInterval(_0x6ef12d);_0x391673['sockets'][_0x3583('0x49')]('wifi-connection',_0x2252ef);return _0x265f88[_0x3583('0xd')](0x1f4)[_0x3583('0xe')](_0x3583('0x53'));}});},0x12c);});}});_0xe822bd[_0x3583('0x7')](_0x3583('0x54'),function(_0x22d56f,_0x39385f){var _0x1b2979=_0x3583('0x55');fs[_0x3583('0x56')](_0x1b2979,function(_0x41cbd9,_0x4ebd8f){if(_0x41cbd9)return _0x39385f['status'](0x1f4)[_0x3583('0xe')](_0x41cbd9);if(_0x4ebd8f[_0x3583('0x23')]>0x0){fs['readFile'](_0x1b2979+'/'+_0x4ebd8f[0x0],'utf8',function(_0x227a08,_0x210ea9){if(_0x227a08)return status(0x1f4)[_0x3583('0xe')](_0x3583('0x57'));_0x39385f['setHeader'](_0x3583('0x58'),'attachment;\x20filename='+_0x4ebd8f[0x0]);return _0x39385f[_0x3583('0xd')](0xc8)[_0x3583('0x59')](_0x1b2979+'/'+_0x4ebd8f[0x0]);});}else{return _0x39385f['status'](0xc8)[_0x3583('0xe')](_0x3583('0x5a'));}});});var _0x44636e=null;_0xe822bd[_0x3583('0x9')]('/api/diagnostics/start',function(_0x1b5b39,_0x5dc55){if(os[_0x3583('0x1c')]()!=_0x3583('0x1d')){_0x44636e=spawn(_0x3583('0x15'),['sh',_0x3583('0x5b'),_0x3583('0x5c')]);_0x44636e[_0x3583('0x5d')]['on'](_0x3583('0x2f'),function(_0x544f10){console[_0x3583('0x30')](String(_0x544f10));});_0x44636e['stderr']['on']('data',function(_0x31b50e){console[_0x3583('0x30')](String(_0x31b50e));});var _0x529cb2=0x1;var _0x2d2a7e=0x3;var _0x58b879=setInterval(function(){if(_0x529cb2<=_0x2d2a7e){var _0x16d581=shell[_0x3583('0x3b')]('ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27',{'silent':!![]})[_0x3583('0x5d')];if(_0x16d581){clearInterval(_0x58b879);_0x208a3d[_0x3583('0x47')]['fusion_diagnostics_running']={'process':_0x16d581,'socket':_0x1b5b39['body']['socketId']};_0x391673[_0x3583('0x48')][_0x3583('0x49')]('diagnostics_running',_0x208a3d[_0x3583('0x47')][_0x3583('0x5e')]);return _0x5dc55['status'](0xc8)['json']({'serverMessage':_0x3583('0x5f')});}else{_0x529cb2++;}}else{clearInterval(_0x58b879);return _0x5dc55['status'](0x1f4)['send'](_0x3583('0x60'));}},0x12c);}else{return _0x5dc55[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x61')});}});_0xe822bd[_0x3583('0x7')]('/api/diagnostics/stop',function(_0xeeb228,_0x5101d0){if(os[_0x3583('0x1c')]()!='win32'){shell[_0x3583('0x3b')]('sudo\x20kill\x20$(ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27)',{'silent':!![]});shell['exec'](_0x3583('0x62'),{'silent':!![]},function(_0x26e2a6,_0x4c1136,_0x282263){(function(_0x15a849){var _0x16acb7=_0x15a849['trim']();if(_0x16acb7){return _0x5101d0['status'](0x1f4)[_0x3583('0xe')](_0x3583('0x63'));}else{_0x208a3d['SocketVariables'][_0x3583('0x5e')]=null;_0x391673[_0x3583('0x48')]['emit'](_0x3583('0x64'),_0x208a3d[_0x3583('0x47')][_0x3583('0x5e')]);_0x44636e=null;return _0x5101d0[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x65')});}}(_0x4c1136['trim']()));});}else{return _0x5101d0[_0x3583('0xd')](0xc8)[_0x3583('0x10')]({'serverMessage':_0x3583('0x61')});}});function _0x4b91c6(){return function(_0x349306,_0x49ff6f,_0x2959ca){if(_0x349306[_0x3583('0x66')]()){return _0x2959ca();}else{_0x49ff6f[_0x3583('0xd')](0x191)[_0x3583('0xe')](_0x3583('0x67'));}};}};