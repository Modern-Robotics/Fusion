const _0x18e2=['validPassword','password','local-signup','body','save','LOGIN.INVALID','Strategy','../models/user','serializeUser','trim','filepath','toLowerCase','generateHash','findById','findOne','username','securityanswer','exports','validSecurityAnswer','use'];(function(_0x1802ac,_0x18e249){const _0x4fc23c=function(_0x494f5d){while(--_0x494f5d){_0x1802ac['push'](_0x1802ac['shift']());}};_0x4fc23c(++_0x18e249);}(_0x18e2,0xc8));const _0x4fc2=function(_0x1802ac,_0x18e249){_0x1802ac=_0x1802ac-0x0;let _0x4fc23c=_0x18e2[_0x1802ac];return _0x4fc23c;};const passport=require('passport');const LocalStrategy=require('passport-local')[_0x4fc2('0x6')];const User=require(_0x4fc2('0x7'));module[_0x4fc2('0x11')]=function(){passport[_0x4fc2('0x8')](function(_0x36cf12,_0x50f7a1){_0x50f7a1(null,_0x36cf12['id']);});passport['deserializeUser'](function(_0x58cecd,_0x34e25f){User[_0x4fc2('0xd')](_0x58cecd,function(_0x21ec7a,_0x5cdc9d){_0x34e25f(_0x21ec7a,_0x5cdc9d);});});passport[_0x4fc2('0x13')](_0x4fc2('0x2'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x102da8,_0x544f56,_0x12c2ed,_0x4721a0){User['findOne']({'username':_0x544f56['toLowerCase']()[_0x4fc2('0x9')]()},async function(_0x459cd8,_0xa68a36){if(_0x459cd8)return _0x4721a0(_0x459cd8);if(_0xa68a36){return _0x4721a0(null,_0xa68a36,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x2f450a=new User(_0x102da8[_0x4fc2('0x3')]);_0x2f450a[_0x4fc2('0xf')]=_0x544f56;_0x2f450a[_0x4fc2('0x1')]=_0x2f450a[_0x4fc2('0xc')](_0x12c2ed);_0x2f450a[_0x4fc2('0xa')]=await _0x2f450a['generateFileSystem'](_0x2f450a['username']);_0x2f450a[_0x4fc2('0x4')](function(_0x489366){if(_0x489366)throw _0x489366;return _0x4721a0(null,_0x2f450a);});}});}));passport['use']('local-login',new LocalStrategy({'usernameField':_0x4fc2('0xf'),'passwordField':'password','passReqToCallback':!![]},function(_0x518bf1,_0x5e5390,_0x2a7921,_0x15ae5a){User['findOne']({'username':_0x5e5390[_0x4fc2('0xb')]()[_0x4fc2('0x9')]()},function(_0x4d120a,_0x871913){if(_0x4d120a)return _0x15ae5a(_0x4d120a);if(!_0x871913)return _0x15ae5a(null,![],{'message':'LOGIN.INVALID'});if(!_0x871913[_0x4fc2('0x0')](_0x2a7921))return _0x15ae5a(null,![],{'message':_0x4fc2('0x5')});return _0x15ae5a(null,_0x871913);});}));passport[_0x4fc2('0x13')]('local-recovery',new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x14a4ab,_0x463b93,_0x48ed1b,_0x1d9f37){User[_0x4fc2('0xe')]({'username':_0x463b93['toLowerCase']()[_0x4fc2('0x9')]()},function(_0x2059c8,_0x3fc7c7){if(_0x2059c8)return _0x1d9f37(_0x2059c8);if(!_0x3fc7c7)return _0x1d9f37(null,![]);if(!_0x3fc7c7[_0x4fc2('0x12')](_0x14a4ab['body'][_0x4fc2('0x10')]))return _0x1d9f37(null,![]);return _0x1d9f37(null,_0x3fc7c7);});}));}();