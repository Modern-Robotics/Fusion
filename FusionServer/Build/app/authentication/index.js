const _0x26a9=['REGISTER.ALREADY_EXISTS','568237IOQtWG','125717JayYWk','local-signup','serializeUser','findOne','1GFpTKz','validPassword','generateHash','trim','LOGIN.INVALID','findById','../models/user','securityanswer','386724RbHwxb','username','use','exports','4BAYskA','10077eOUAYT','711874wsniWk','42917LuAJmO','207uWGApt','1wvfjTo','local-recovery','save','password','toLowerCase','body','703767jTPCNU','passport','Strategy','local-login','generateFileSystem','validSecurityAnswer'];const _0x7b98=function(_0x29655d,_0x2b209b){_0x29655d=_0x29655d-0xe8;let _0x26a9cd=_0x26a9[_0x29655d];return _0x26a9cd;};const _0x2478b9=_0x7b98;(function(_0x702d52,_0x547fe6){const _0x53b2d5=_0x7b98;while(!![]){try{const _0x4195b4=-parseInt(_0x53b2d5(0x109))+parseInt(_0x53b2d5(0xf7))+parseInt(_0x53b2d5(0x103))+-parseInt(_0x53b2d5(0x10a))*parseInt(_0x53b2d5(0x107))+parseInt(_0x53b2d5(0xf6))*-parseInt(_0x53b2d5(0xfb))+parseInt(_0x53b2d5(0xe9))*-parseInt(_0x53b2d5(0xef))+parseInt(_0x53b2d5(0x108))*parseInt(_0x53b2d5(0xe8));if(_0x4195b4===_0x547fe6)break;else _0x702d52['push'](_0x702d52['shift']());}catch(_0x524b39){_0x702d52['push'](_0x702d52['shift']());}}}(_0x26a9,0x6c1d2));const passport=require(_0x2478b9(0xf0)),LocalStrategy=require('passport-local')[_0x2478b9(0xf1)],User=require(_0x2478b9(0x101));module[_0x2478b9(0x106)]=function(){const _0x980e71=_0x2478b9;passport[_0x980e71(0xf9)](function(_0x5c3a7d,_0x46d89a){_0x46d89a(null,_0x5c3a7d['id']);}),passport['deserializeUser'](function(_0x34784b,_0x310052){const _0x574905=_0x980e71;User[_0x574905(0x100)](_0x34784b,function(_0x46dea4,_0x19d89d){_0x310052(_0x46dea4,_0x19d89d);});}),passport['use'](_0x980e71(0xf8),new LocalStrategy({'usernameField':_0x980e71(0x104),'passwordField':_0x980e71(0xec),'passReqToCallback':!![]},function(_0xbb0650,_0x50732a,_0x534824,_0x17d135){const _0x2d6a5a=_0x980e71;User['findOne']({'username':_0x50732a[_0x2d6a5a(0xed)]()[_0x2d6a5a(0xfe)]()},async function(_0x37733a,_0x453532){const _0x3545a=_0x2d6a5a;if(_0x37733a)return _0x17d135(_0x37733a);if(_0x453532)return _0x17d135(null,_0x453532,{'message':_0x3545a(0xf5)});else{var _0x452be3=new User(_0xbb0650['body']);_0x452be3[_0x3545a(0x104)]=_0x50732a,_0x452be3['password']=_0x452be3[_0x3545a(0xfd)](_0x534824),_0x452be3['filepath']=await _0x452be3[_0x3545a(0xf3)](_0x452be3[_0x3545a(0x104)]),_0x452be3[_0x3545a(0xeb)](function(_0x1cef5c){if(_0x1cef5c)throw _0x1cef5c;return _0x17d135(null,_0x452be3);});}});})),passport[_0x980e71(0x105)](_0x980e71(0xf2),new LocalStrategy({'usernameField':'username','passwordField':_0x980e71(0xec),'passReqToCallback':!![]},function(_0x8c6277,_0x336588,_0x16466f,_0xa8a732){const _0x188b65=_0x980e71;User[_0x188b65(0xfa)]({'username':_0x336588[_0x188b65(0xed)]()[_0x188b65(0xfe)]()},function(_0x1880de,_0x136950){const _0x5a6bc5=_0x188b65;if(_0x1880de)return _0xa8a732(_0x1880de);if(!_0x136950)return _0xa8a732(null,![],{'message':'LOGIN.INVALID'});if(!_0x136950[_0x5a6bc5(0xfc)](_0x16466f))return _0xa8a732(null,![],{'message':_0x5a6bc5(0xff)});return _0xa8a732(null,_0x136950);});})),passport[_0x980e71(0x105)](_0x980e71(0xea),new LocalStrategy({'usernameField':_0x980e71(0x104),'passwordField':_0x980e71(0xec),'passReqToCallback':!![]},function(_0xd5deba,_0x24eb8a,_0x4a316e,_0x43aa5d){const _0x1b1257=_0x980e71;User[_0x1b1257(0xfa)]({'username':_0x24eb8a['toLowerCase']()[_0x1b1257(0xfe)]()},function(_0xd975c3,_0x27e0a9){const _0x35790b=_0x1b1257;if(_0xd975c3)return _0x43aa5d(_0xd975c3);if(!_0x27e0a9)return _0x43aa5d(null,![]);if(!_0x27e0a9[_0x35790b(0xf4)](_0xd5deba[_0x35790b(0xee)][_0x35790b(0x102)]))return _0x43aa5d(null,![]);return _0x43aa5d(null,_0x27e0a9);});}));}();