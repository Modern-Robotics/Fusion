const _0x4a83=['validPassword','LOGIN.INVALID','filepath','local-signup','REGISTER.ALREADY_EXISTS','securityanswer','toLowerCase','save','passport-local','generateHash','trim','../models/user','local-recovery','local-login','deserializeUser','serializeUser','username','body','generateFileSystem','passport','use','password','validSecurityAnswer','findOne'];(function(_0x3ab7cc,_0x4a836c){const _0x5ec903=function(_0xacb319){while(--_0xacb319){_0x3ab7cc['push'](_0x3ab7cc['shift']());}};_0x5ec903(++_0x4a836c);}(_0x4a83,0x15a));const _0x5ec9=function(_0x3ab7cc,_0x4a836c){_0x3ab7cc=_0x3ab7cc-0x0;let _0x5ec903=_0x4a83[_0x3ab7cc];return _0x5ec903;};const passport=require(_0x5ec9('0x9'));const LocalStrategy=require(_0x5ec9('0x16'))['Strategy'];const User=require(_0x5ec9('0x1'));module['exports']=function(){passport[_0x5ec9('0x5')](function(_0x243122,_0x19b72c){_0x19b72c(null,_0x243122['id']);});passport[_0x5ec9('0x4')](function(_0x57957d,_0x2d6f21){User['findById'](_0x57957d,function(_0x250f8f,_0x577afb){_0x2d6f21(_0x250f8f,_0x577afb);});});passport[_0x5ec9('0xa')](_0x5ec9('0x11'),new LocalStrategy({'usernameField':_0x5ec9('0x6'),'passwordField':_0x5ec9('0xb'),'passReqToCallback':!![]},function(_0xe7e41e,_0x2272c8,_0x38d31c,_0x5da361){User['findOne']({'username':_0x2272c8['toLowerCase']()[_0x5ec9('0x0')]()},async function(_0x563598,_0x4d01e3){if(_0x563598)return _0x5da361(_0x563598);if(_0x4d01e3){return _0x5da361(null,_0x4d01e3,{'message':_0x5ec9('0x12')});}else{var _0x5c8f3d=new User(_0xe7e41e[_0x5ec9('0x7')]);_0x5c8f3d[_0x5ec9('0x6')]=_0x2272c8;_0x5c8f3d['password']=_0x5c8f3d[_0x5ec9('0x17')](_0x38d31c);_0x5c8f3d[_0x5ec9('0x10')]=await _0x5c8f3d[_0x5ec9('0x8')](_0x5c8f3d[_0x5ec9('0x6')]);_0x5c8f3d[_0x5ec9('0x15')](function(_0x22bd6c){if(_0x22bd6c)throw _0x22bd6c;return _0x5da361(null,_0x5c8f3d);});}});}));passport[_0x5ec9('0xa')](_0x5ec9('0x3'),new LocalStrategy({'usernameField':_0x5ec9('0x6'),'passwordField':_0x5ec9('0xb'),'passReqToCallback':!![]},function(_0x110417,_0x48230c,_0x4849de,_0x37748e){User[_0x5ec9('0xd')]({'username':_0x48230c[_0x5ec9('0x14')]()[_0x5ec9('0x0')]()},function(_0x3f4c74,_0x5f0212){if(_0x3f4c74)return _0x37748e(_0x3f4c74);if(!_0x5f0212)return _0x37748e(null,![],{'message':_0x5ec9('0xf')});if(!_0x5f0212[_0x5ec9('0xe')](_0x4849de))return _0x37748e(null,![],{'message':'LOGIN.INVALID'});return _0x37748e(null,_0x5f0212);});}));passport['use'](_0x5ec9('0x2'),new LocalStrategy({'usernameField':'username','passwordField':_0x5ec9('0xb'),'passReqToCallback':!![]},function(_0x187db0,_0x514b67,_0x66528b,_0x1db6c9){User[_0x5ec9('0xd')]({'username':_0x514b67[_0x5ec9('0x14')]()[_0x5ec9('0x0')]()},function(_0x43474d,_0x4cae60){if(_0x43474d)return _0x1db6c9(_0x43474d);if(!_0x4cae60)return _0x1db6c9(null,![]);if(!_0x4cae60[_0x5ec9('0xc')](_0x187db0[_0x5ec9('0x7')][_0x5ec9('0x13')]))return _0x1db6c9(null,![]);return _0x1db6c9(null,_0x4cae60);});}));}();