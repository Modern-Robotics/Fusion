const _0x21e9=['passport-local','body','REGISTER.ALREADY_EXISTS','findById','deserializeUser','passport','save','LOGIN.INVALID','Strategy','local-signup','toLowerCase','password','local-login','local-recovery','generateFileSystem','username','securityanswer','../models/user','findOne','use','trim','validPassword'];(function(_0x316991,_0x21e963){const _0x5d474d=function(_0x2ffb49){while(--_0x2ffb49){_0x316991['push'](_0x316991['shift']());}};_0x5d474d(++_0x21e963);}(_0x21e9,0x133));const _0x5d47=function(_0x316991,_0x21e963){_0x316991=_0x316991-0x0;let _0x5d474d=_0x21e9[_0x316991];return _0x5d474d;};const passport=require(_0x5d47('0x6'));const LocalStrategy=require(_0x5d47('0x1'))[_0x5d47('0x9')];const User=require(_0x5d47('0x12'));module['exports']=function(){passport['serializeUser'](function(_0x2ae5da,_0x554e5e){_0x554e5e(null,_0x2ae5da['id']);});passport[_0x5d47('0x5')](function(_0xa43d93,_0x1d71a3){User[_0x5d47('0x4')](_0xa43d93,function(_0x4b86ad,_0x4ac98a){_0x1d71a3(_0x4b86ad,_0x4ac98a);});});passport[_0x5d47('0x14')](_0x5d47('0xa'),new LocalStrategy({'usernameField':_0x5d47('0x10'),'passwordField':_0x5d47('0xc'),'passReqToCallback':!![]},function(_0x21d0ca,_0x428ea6,_0x2496f0,_0x1d7c79){User[_0x5d47('0x13')]({'username':_0x428ea6[_0x5d47('0xb')]()[_0x5d47('0x15')]()},async function(_0x4c1166,_0x59c832){if(_0x4c1166)return _0x1d7c79(_0x4c1166);if(_0x59c832){return _0x1d7c79(null,_0x59c832,{'message':_0x5d47('0x3')});}else{var _0x4cbded=new User(_0x21d0ca[_0x5d47('0x2')]);_0x4cbded['username']=_0x428ea6;_0x4cbded[_0x5d47('0xc')]=_0x4cbded['generateHash'](_0x2496f0);_0x4cbded['filepath']=await _0x4cbded[_0x5d47('0xf')](_0x4cbded[_0x5d47('0x10')]);_0x4cbded[_0x5d47('0x7')](function(_0x58cd24){if(_0x58cd24)throw _0x58cd24;return _0x1d7c79(null,_0x4cbded);});}});}));passport['use'](_0x5d47('0xd'),new LocalStrategy({'usernameField':_0x5d47('0x10'),'passwordField':_0x5d47('0xc'),'passReqToCallback':!![]},function(_0x1580e2,_0x573f5c,_0x53ea94,_0x20fb47){User['findOne']({'username':_0x573f5c['toLowerCase']()['trim']()},function(_0x252164,_0xde3c9d){if(_0x252164)return _0x20fb47(_0x252164);if(!_0xde3c9d)return _0x20fb47(null,![],{'message':_0x5d47('0x8')});if(!_0xde3c9d[_0x5d47('0x0')](_0x53ea94))return _0x20fb47(null,![],{'message':'LOGIN.INVALID'});return _0x20fb47(null,_0xde3c9d);});}));passport[_0x5d47('0x14')](_0x5d47('0xe'),new LocalStrategy({'usernameField':_0x5d47('0x10'),'passwordField':_0x5d47('0xc'),'passReqToCallback':!![]},function(_0x50e533,_0x85127d,_0x570615,_0x12a20d){User[_0x5d47('0x13')]({'username':_0x85127d[_0x5d47('0xb')]()[_0x5d47('0x15')]()},function(_0x14afe4,_0x1968a4){if(_0x14afe4)return _0x12a20d(_0x14afe4);if(!_0x1968a4)return _0x12a20d(null,![]);if(!_0x1968a4['validSecurityAnswer'](_0x50e533['body'][_0x5d47('0x11')]))return _0x12a20d(null,![]);return _0x12a20d(null,_0x1968a4);});}));}();