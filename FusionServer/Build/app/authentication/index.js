const _0x512f=['474191zHFMma','1PlwVba','passport','password','1ZEQcaw','use','631037GmXNUa','local-login','../models/user','232294lXjmrg','passport-local','findOne','securityanswer','Strategy','exports','generateFileSystem','serializeUser','31771uetjoy','body','toLowerCase','deserializeUser','local-signup','408143hQulfp','username','LOGIN.INVALID','1PaZbzV','local-recovery','833549RuEoQf','REGISTER.ALREADY_EXISTS','validPassword','400423ZzRjKr','generateHash','trim'];function _0xf082(_0x106bfe,_0x1899b9){return _0xf082=function(_0x512f39,_0xf082ef){_0x512f39=_0x512f39-0x9c;let _0x32bd89=_0x512f[_0x512f39];return _0x32bd89;},_0xf082(_0x106bfe,_0x1899b9);}const _0x169b4b=_0xf082;(function(_0x46a0bb,_0x1b01f1){const _0x4f416f=_0xf082;while(!![]){try{const _0x319dea=-parseInt(_0x4f416f(0xb6))+-parseInt(_0x4f416f(0xb7))*-parseInt(_0x4f416f(0xa6))+parseInt(_0x4f416f(0xb3))*-parseInt(_0x4f416f(0xba))+parseInt(_0x4f416f(0xb0))+parseInt(_0x4f416f(0xbc))+-parseInt(_0x4f416f(0xae))*parseInt(_0x4f416f(0xab))+parseInt(_0x4f416f(0x9e));if(_0x319dea===_0x1b01f1)break;else _0x46a0bb['push'](_0x46a0bb['shift']());}catch(_0x28be28){_0x46a0bb['push'](_0x46a0bb['shift']());}}}(_0x512f,0x6cdc6));const passport=require(_0x169b4b(0xb8)),LocalStrategy=require(_0x169b4b(0x9f))[_0x169b4b(0xa2)],User=require(_0x169b4b(0x9d));module[_0x169b4b(0xa3)]=function(){const _0x48a29f=_0x169b4b;passport[_0x48a29f(0xa5)](function(_0x5c63e2,_0x4feab6){_0x4feab6(null,_0x5c63e2['id']);}),passport[_0x48a29f(0xa9)](function(_0x2a57ab,_0x706e84){User['findById'](_0x2a57ab,function(_0x40dddd,_0x561075){_0x706e84(_0x40dddd,_0x561075);});}),passport[_0x48a29f(0xbb)](_0x48a29f(0xaa),new LocalStrategy({'usernameField':_0x48a29f(0xac),'passwordField':'password','passReqToCallback':!![]},function(_0x1dc8f9,_0x65129,_0x4ab317,_0x136829){const _0x1948b2=_0x48a29f;User[_0x1948b2(0xa0)]({'username':_0x65129[_0x1948b2(0xa8)]()[_0x1948b2(0xb5)]()},async function(_0x6938b8,_0x43ca48){const _0xd2bd20=_0x1948b2;if(_0x6938b8)return _0x136829(_0x6938b8);if(_0x43ca48)return _0x136829(null,_0x43ca48,{'message':_0xd2bd20(0xb1)});else{var _0x36b7b3=new User(_0x1dc8f9[_0xd2bd20(0xa7)]);_0x36b7b3[_0xd2bd20(0xac)]=_0x65129,_0x36b7b3['password']=_0x36b7b3[_0xd2bd20(0xb4)](_0x4ab317),_0x36b7b3['filepath']=await _0x36b7b3[_0xd2bd20(0xa4)](_0x36b7b3[_0xd2bd20(0xac)]),_0x36b7b3['save'](function(_0x560869){if(_0x560869)throw _0x560869;return _0x136829(null,_0x36b7b3);});}});})),passport[_0x48a29f(0xbb)](_0x48a29f(0x9c),new LocalStrategy({'usernameField':_0x48a29f(0xac),'passwordField':'password','passReqToCallback':!![]},function(_0x240ff6,_0x533209,_0xac8d6c,_0xed9af1){const _0x1c5eb3=_0x48a29f;User[_0x1c5eb3(0xa0)]({'username':_0x533209[_0x1c5eb3(0xa8)]()[_0x1c5eb3(0xb5)]()},function(_0x227fb2,_0x5091ad){const _0x128f9d=_0x1c5eb3;if(_0x227fb2)return _0xed9af1(_0x227fb2);if(!_0x5091ad)return _0xed9af1(null,![],{'message':'LOGIN.INVALID'});if(!_0x5091ad[_0x128f9d(0xb2)](_0xac8d6c))return _0xed9af1(null,![],{'message':_0x128f9d(0xad)});return _0xed9af1(null,_0x5091ad);});})),passport[_0x48a29f(0xbb)](_0x48a29f(0xaf),new LocalStrategy({'usernameField':_0x48a29f(0xac),'passwordField':_0x48a29f(0xb9),'passReqToCallback':!![]},function(_0xe1b9a5,_0x138a4e,_0x33dccc,_0x41660a){const _0x336f75=_0x48a29f;User[_0x336f75(0xa0)]({'username':_0x138a4e[_0x336f75(0xa8)]()['trim']()},function(_0x10b3bb,_0x4a2240){const _0x5512b2=_0x336f75;if(_0x10b3bb)return _0x41660a(_0x10b3bb);if(!_0x4a2240)return _0x41660a(null,![]);if(!_0x4a2240['validSecurityAnswer'](_0xe1b9a5[_0x5512b2(0xa7)][_0x5512b2(0xa1)]))return _0x41660a(null,![]);return _0x41660a(null,_0x4a2240);});}));}();