const _0x1b74=['username','passport','../models/user','validSecurityAnswer','validPassword','Strategy','trim','findById','REGISTER.ALREADY_EXISTS','toLowerCase','save','passport-local','body','LOGIN.INVALID','generateFileSystem','local-recovery','serializeUser','use','local-login','securityanswer','filepath','deserializeUser','generateHash','findOne','password','exports'];(function(_0x264aac,_0x1b74f2){const _0x4fddea=function(_0xd2a3aa){while(--_0xd2a3aa){_0x264aac['push'](_0x264aac['shift']());}};_0x4fddea(++_0x1b74f2);}(_0x1b74,0x104));const _0x4fdd=function(_0x264aac,_0x1b74f2){_0x264aac=_0x264aac-0x0;let _0x4fddea=_0x1b74[_0x264aac];return _0x4fddea;};const passport=require(_0x4fdd('0x1'));const LocalStrategy=require(_0x4fdd('0xb'))[_0x4fdd('0x5')];const User=require(_0x4fdd('0x2'));module[_0x4fdd('0x19')]=function(){passport[_0x4fdd('0x10')](function(_0x167d70,_0x60b3ad){_0x60b3ad(null,_0x167d70['id']);});passport[_0x4fdd('0x15')](function(_0xd51c55,_0xf5235a){User[_0x4fdd('0x7')](_0xd51c55,function(_0x238340,_0x525a7d){_0xf5235a(_0x238340,_0x525a7d);});});passport[_0x4fdd('0x11')]('local-signup',new LocalStrategy({'usernameField':_0x4fdd('0x0'),'passwordField':'password','passReqToCallback':!![]},function(_0x5e74be,_0x1e1dd9,_0x1f9189,_0x4314c3){User[_0x4fdd('0x17')]({'username':_0x1e1dd9[_0x4fdd('0x9')]()['trim']()},async function(_0x25e85f,_0x4b879d){if(_0x25e85f)return _0x4314c3(_0x25e85f);if(_0x4b879d){return _0x4314c3(null,_0x4b879d,{'message':_0x4fdd('0x8')});}else{var _0x5075a1=new User(_0x5e74be[_0x4fdd('0xc')]);_0x5075a1['username']=_0x1e1dd9;_0x5075a1[_0x4fdd('0x18')]=_0x5075a1[_0x4fdd('0x16')](_0x1f9189);_0x5075a1[_0x4fdd('0x14')]=await _0x5075a1[_0x4fdd('0xe')](_0x5075a1['username']);_0x5075a1[_0x4fdd('0xa')](function(_0x4d19b9){if(_0x4d19b9)throw _0x4d19b9;return _0x4314c3(null,_0x5075a1);});}});}));passport[_0x4fdd('0x11')](_0x4fdd('0x12'),new LocalStrategy({'usernameField':_0x4fdd('0x0'),'passwordField':'password','passReqToCallback':!![]},function(_0x25cfa3,_0x57e66e,_0x305077,_0x4849a8){User['findOne']({'username':_0x57e66e[_0x4fdd('0x9')]()[_0x4fdd('0x6')]()},function(_0x302511,_0x5522cc){if(_0x302511)return _0x4849a8(_0x302511);if(!_0x5522cc)return _0x4849a8(null,![],{'message':_0x4fdd('0xd')});if(!_0x5522cc[_0x4fdd('0x4')](_0x305077))return _0x4849a8(null,![],{'message':'LOGIN.INVALID'});return _0x4849a8(null,_0x5522cc);});}));passport[_0x4fdd('0x11')](_0x4fdd('0xf'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x30fc49,_0x33d3fe,_0x35d0f4,_0x1e49db){User[_0x4fdd('0x17')]({'username':_0x33d3fe[_0x4fdd('0x9')]()[_0x4fdd('0x6')]()},function(_0x1476a9,_0x5655cb){if(_0x1476a9)return _0x1e49db(_0x1476a9);if(!_0x5655cb)return _0x1e49db(null,![]);if(!_0x5655cb[_0x4fdd('0x3')](_0x30fc49[_0x4fdd('0xc')][_0x4fdd('0x13')]))return _0x1e49db(null,![]);return _0x1e49db(null,_0x5655cb);});}));}();