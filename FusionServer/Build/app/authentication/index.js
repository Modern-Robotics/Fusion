var _0x1f80=['trim','body','username','password','generateHash','filepath','generateFileSystem','save','local-login','toLowerCase','LOGIN.INVALID','validPassword','validSecurityAnswer','securityanswer','passport','passport-local','Strategy','exports','deserializeUser','findById','local-signup','findOne'];(function(_0xe65104,_0x189e35){var _0xc7f208=function(_0x498b5f){while(--_0x498b5f){_0xe65104['push'](_0xe65104['shift']());}};_0xc7f208(++_0x189e35);}(_0x1f80,0x1f2));var _0x5d4e=function(_0x3bbff2,_0x56210d){_0x3bbff2=_0x3bbff2-0x0;var _0x1c6d1f=_0x1f80[_0x3bbff2];return _0x1c6d1f;};const passport=require(_0x5d4e('0x0'));const LocalStrategy=require(_0x5d4e('0x1'))[_0x5d4e('0x2')];const User=require('../models/user');module[_0x5d4e('0x3')]=function(){passport['serializeUser'](function(_0x154982,_0x4f2aa0){_0x4f2aa0(null,_0x154982['id']);});passport[_0x5d4e('0x4')](function(_0x2b00c4,_0xba9019){User[_0x5d4e('0x5')](_0x2b00c4,function(_0x5e325c,_0x44216c){_0xba9019(_0x5e325c,_0x44216c);});});passport['use'](_0x5d4e('0x6'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x240ae7,_0xd5efe9,_0x58cd76,_0x433092){User[_0x5d4e('0x7')]({'username':_0xd5efe9['toLowerCase']()[_0x5d4e('0x8')]()},async function(_0x388eac,_0x526e52){if(_0x388eac)return _0x433092(_0x388eac);if(_0x526e52){return _0x433092(null,_0x526e52,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x40238d=new User(_0x240ae7[_0x5d4e('0x9')]);_0x40238d[_0x5d4e('0xa')]=_0xd5efe9;_0x40238d[_0x5d4e('0xb')]=_0x40238d[_0x5d4e('0xc')](_0x58cd76);_0x40238d[_0x5d4e('0xd')]=await _0x40238d[_0x5d4e('0xe')](_0x40238d[_0x5d4e('0xa')]);_0x40238d[_0x5d4e('0xf')](function(_0x388eac){if(_0x388eac)throw _0x388eac;return _0x433092(null,_0x40238d);});}});}));passport['use'](_0x5d4e('0x10'),new LocalStrategy({'usernameField':_0x5d4e('0xa'),'passwordField':_0x5d4e('0xb'),'passReqToCallback':!![]},function(_0x4d7dd,_0x1bf2aa,_0x58024b,_0x46a19a){User[_0x5d4e('0x7')]({'username':_0x1bf2aa[_0x5d4e('0x11')]()[_0x5d4e('0x8')]()},function(_0x34431b,_0x3d3653){if(_0x34431b)return _0x46a19a(_0x34431b);if(!_0x3d3653)return _0x46a19a(null,![],{'message':_0x5d4e('0x12')});if(!_0x3d3653[_0x5d4e('0x13')](_0x58024b))return _0x46a19a(null,![],{'message':_0x5d4e('0x12')});return _0x46a19a(null,_0x3d3653);});}));passport['use']('local-recovery',new LocalStrategy({'usernameField':'username','passwordField':_0x5d4e('0xb'),'passReqToCallback':!![]},function(_0x3c2c5e,_0x2cee35,_0x202a27,_0x13f479){User[_0x5d4e('0x7')]({'username':_0x2cee35[_0x5d4e('0x11')]()[_0x5d4e('0x8')]()},function(_0x2ab1fd,_0x5bde9d){if(_0x2ab1fd)return _0x13f479(_0x2ab1fd);if(!_0x5bde9d)return _0x13f479(null,![]);if(!_0x5bde9d[_0x5d4e('0x14')](_0x3c2c5e[_0x5d4e('0x9')][_0x5d4e('0x15')]))return _0x13f479(null,![]);return _0x13f479(null,_0x5bde9d);});}));}();