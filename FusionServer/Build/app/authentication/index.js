const _0x58e3=['username','securityanswer','body','REGISTER.ALREADY_EXISTS','local-signup','passport-local','trim','password','exports','findById','generateFileSystem','passport','validPassword','use','serializeUser','LOGIN.INVALID','toLowerCase','validSecurityAnswer','findOne','../models/user','local-recovery','save','local-login'];(function(_0x30284c,_0x58e31b){const _0x16cea1=function(_0x2e650f){while(--_0x2e650f){_0x30284c['push'](_0x30284c['shift']());}};_0x16cea1(++_0x58e31b);}(_0x58e3,0x12e));const _0x16ce=function(_0x30284c,_0x58e31b){_0x30284c=_0x30284c-0x0;let _0x16cea1=_0x58e3[_0x30284c];return _0x16cea1;};const passport=require(_0x16ce('0x8'));const LocalStrategy=require(_0x16ce('0x2'))['Strategy'];const User=require(_0x16ce('0x10'));module[_0x16ce('0x5')]=function(){passport[_0x16ce('0xb')](function(_0x26a077,_0x44cd16){_0x44cd16(null,_0x26a077['id']);});passport['deserializeUser'](function(_0x39f21e,_0x5908d2){User[_0x16ce('0x6')](_0x39f21e,function(_0x4c09a3,_0x52fc7d){_0x5908d2(_0x4c09a3,_0x52fc7d);});});passport[_0x16ce('0xa')](_0x16ce('0x1'),new LocalStrategy({'usernameField':_0x16ce('0x14'),'passwordField':_0x16ce('0x4'),'passReqToCallback':!![]},function(_0x1788fa,_0x4f9b57,_0x4f1e46,_0x52fb71){User[_0x16ce('0xf')]({'username':_0x4f9b57[_0x16ce('0xd')]()[_0x16ce('0x3')]()},async function(_0x1d1fe8,_0x41d547){if(_0x1d1fe8)return _0x52fb71(_0x1d1fe8);if(_0x41d547){return _0x52fb71(null,_0x41d547,{'message':_0x16ce('0x0')});}else{var _0x116d5c=new User(_0x1788fa[_0x16ce('0x16')]);_0x116d5c[_0x16ce('0x14')]=_0x4f9b57;_0x116d5c[_0x16ce('0x4')]=_0x116d5c['generateHash'](_0x4f1e46);_0x116d5c['filepath']=await _0x116d5c[_0x16ce('0x7')](_0x116d5c[_0x16ce('0x14')]);_0x116d5c[_0x16ce('0x12')](function(_0x45bad7){if(_0x45bad7)throw _0x45bad7;return _0x52fb71(null,_0x116d5c);});}});}));passport[_0x16ce('0xa')](_0x16ce('0x13'),new LocalStrategy({'usernameField':_0x16ce('0x14'),'passwordField':_0x16ce('0x4'),'passReqToCallback':!![]},function(_0x134b47,_0x4302ad,_0xc707f0,_0x523d1c){User['findOne']({'username':_0x4302ad[_0x16ce('0xd')]()[_0x16ce('0x3')]()},function(_0xe8e6d9,_0x3cf7ce){if(_0xe8e6d9)return _0x523d1c(_0xe8e6d9);if(!_0x3cf7ce)return _0x523d1c(null,![],{'message':_0x16ce('0xc')});if(!_0x3cf7ce[_0x16ce('0x9')](_0xc707f0))return _0x523d1c(null,![],{'message':'LOGIN.INVALID'});return _0x523d1c(null,_0x3cf7ce);});}));passport[_0x16ce('0xa')](_0x16ce('0x11'),new LocalStrategy({'usernameField':_0x16ce('0x14'),'passwordField':_0x16ce('0x4'),'passReqToCallback':!![]},function(_0x223b98,_0x5c47d5,_0x234069,_0x3b262f){User['findOne']({'username':_0x5c47d5[_0x16ce('0xd')]()[_0x16ce('0x3')]()},function(_0x1d575d,_0x112292){if(_0x1d575d)return _0x3b262f(_0x1d575d);if(!_0x112292)return _0x3b262f(null,![]);if(!_0x112292[_0x16ce('0xe')](_0x223b98['body'][_0x16ce('0x15')]))return _0x3b262f(null,![]);return _0x3b262f(null,_0x112292);});}));}();