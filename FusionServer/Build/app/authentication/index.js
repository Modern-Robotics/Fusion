const _0xf130=['../models/user','validSecurityAnswer','toLowerCase','passport','LOGIN.INVALID','body','serializeUser','exports','findById','use','trim','generateFileSystem','local-signup','username','local-login','save','password','findOne'];(function(_0x4e06ff,_0xf13014){const _0x2c553b=function(_0x44a120){while(--_0x44a120){_0x4e06ff['push'](_0x4e06ff['shift']());}};_0x2c553b(++_0xf13014);}(_0xf130,0x78));const _0x2c55=function(_0x4e06ff,_0xf13014){_0x4e06ff=_0x4e06ff-0x0;let _0x2c553b=_0xf130[_0x4e06ff];return _0x2c553b;};const passport=require(_0x2c55('0x9'));const LocalStrategy=require('passport-local')['Strategy'];const User=require(_0x2c55('0x6'));module[_0x2c55('0xd')]=function(){passport[_0x2c55('0xc')](function(_0x11c225,_0x20e010){_0x20e010(null,_0x11c225['id']);});passport['deserializeUser'](function(_0x2e27dc,_0x5acbca){User[_0x2c55('0xe')](_0x2e27dc,function(_0x14a2c8,_0x2c240e){_0x5acbca(_0x14a2c8,_0x2c240e);});});passport[_0x2c55('0xf')](_0x2c55('0x0'),new LocalStrategy({'usernameField':_0x2c55('0x1'),'passwordField':_0x2c55('0x4'),'passReqToCallback':!![]},function(_0x1ebf37,_0x546de9,_0x394f75,_0x363fde){User[_0x2c55('0x5')]({'username':_0x546de9['toLowerCase']()[_0x2c55('0x10')]()},async function(_0x311bae,_0x1552ec){if(_0x311bae)return _0x363fde(_0x311bae);if(_0x1552ec){return _0x363fde(null,_0x1552ec,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x3f2fbf=new User(_0x1ebf37[_0x2c55('0xb')]);_0x3f2fbf[_0x2c55('0x1')]=_0x546de9;_0x3f2fbf['password']=_0x3f2fbf['generateHash'](_0x394f75);_0x3f2fbf['filepath']=await _0x3f2fbf[_0x2c55('0x11')](_0x3f2fbf[_0x2c55('0x1')]);_0x3f2fbf[_0x2c55('0x3')](function(_0x20ed3e){if(_0x20ed3e)throw _0x20ed3e;return _0x363fde(null,_0x3f2fbf);});}});}));passport['use'](_0x2c55('0x2'),new LocalStrategy({'usernameField':_0x2c55('0x1'),'passwordField':_0x2c55('0x4'),'passReqToCallback':!![]},function(_0xaabfe1,_0x32a9b4,_0x5d6a63,_0x150d76){User[_0x2c55('0x5')]({'username':_0x32a9b4['toLowerCase']()[_0x2c55('0x10')]()},function(_0x172d90,_0xf47753){if(_0x172d90)return _0x150d76(_0x172d90);if(!_0xf47753)return _0x150d76(null,![],{'message':_0x2c55('0xa')});if(!_0xf47753['validPassword'](_0x5d6a63))return _0x150d76(null,![],{'message':_0x2c55('0xa')});return _0x150d76(null,_0xf47753);});}));passport[_0x2c55('0xf')]('local-recovery',new LocalStrategy({'usernameField':'username','passwordField':_0x2c55('0x4'),'passReqToCallback':!![]},function(_0x33e9b2,_0x26a55c,_0x20226e,_0x58d8fb){User['findOne']({'username':_0x26a55c[_0x2c55('0x8')]()['trim']()},function(_0x19147a,_0x2d8cb9){if(_0x19147a)return _0x58d8fb(_0x19147a);if(!_0x2d8cb9)return _0x58d8fb(null,![]);if(!_0x2d8cb9[_0x2c55('0x7')](_0x33e9b2[_0x2c55('0xb')]['securityanswer']))return _0x58d8fb(null,![]);return _0x58d8fb(null,_0x2d8cb9);});}));}();