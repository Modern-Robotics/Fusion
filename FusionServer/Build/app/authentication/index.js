const _0x2a62=['password','passport-local','generateHash','LOGIN.INVALID','validSecurityAnswer','local-signup','../models/user','filepath','body','local-login','trim','username','Strategy','serializeUser','passport','securityanswer','findOne','use','toLowerCase','exports'];(function(_0x152826,_0x2a6235){const _0x2c8da4=function(_0x218d76){while(--_0x218d76){_0x152826['push'](_0x152826['shift']());}};_0x2c8da4(++_0x2a6235);}(_0x2a62,0xbc));const _0x2c8d=function(_0x152826,_0x2a6235){_0x152826=_0x152826-0x0;let _0x2c8da4=_0x2a62[_0x152826];return _0x2c8da4;};const passport=require(_0x2c8d('0x6'));const LocalStrategy=require(_0x2c8d('0xd'))[_0x2c8d('0x4')];const User=require(_0x2c8d('0x12'));module[_0x2c8d('0xb')]=function(){passport[_0x2c8d('0x5')](function(_0xb343b1,_0xf31794){_0xf31794(null,_0xb343b1['id']);});passport['deserializeUser'](function(_0x5ac3e8,_0x2dbe35){User['findById'](_0x5ac3e8,function(_0x504f5b,_0x240025){_0x2dbe35(_0x504f5b,_0x240025);});});passport[_0x2c8d('0x9')](_0x2c8d('0x11'),new LocalStrategy({'usernameField':_0x2c8d('0x3'),'passwordField':_0x2c8d('0xc'),'passReqToCallback':!![]},function(_0x17ada2,_0x3faaad,_0x5b46be,_0x45f74f){User[_0x2c8d('0x8')]({'username':_0x3faaad[_0x2c8d('0xa')]()['trim']()},async function(_0xcdd37a,_0x2bf287){if(_0xcdd37a)return _0x45f74f(_0xcdd37a);if(_0x2bf287){return _0x45f74f(null,_0x2bf287,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x3225da=new User(_0x17ada2[_0x2c8d('0x0')]);_0x3225da[_0x2c8d('0x3')]=_0x3faaad;_0x3225da[_0x2c8d('0xc')]=_0x3225da[_0x2c8d('0xe')](_0x5b46be);_0x3225da[_0x2c8d('0x13')]=await _0x3225da['generateFileSystem'](_0x3225da[_0x2c8d('0x3')]);_0x3225da['save'](function(_0x586c95){if(_0x586c95)throw _0x586c95;return _0x45f74f(null,_0x3225da);});}});}));passport['use'](_0x2c8d('0x1'),new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0x55eb24,_0x319f08,_0x2434e5,_0x3532ed){User[_0x2c8d('0x8')]({'username':_0x319f08[_0x2c8d('0xa')]()['trim']()},function(_0x281baf,_0x5c3ff7){if(_0x281baf)return _0x3532ed(_0x281baf);if(!_0x5c3ff7)return _0x3532ed(null,![],{'message':_0x2c8d('0xf')});if(!_0x5c3ff7['validPassword'](_0x2434e5))return _0x3532ed(null,![],{'message':_0x2c8d('0xf')});return _0x3532ed(null,_0x5c3ff7);});}));passport['use']('local-recovery',new LocalStrategy({'usernameField':_0x2c8d('0x3'),'passwordField':_0x2c8d('0xc'),'passReqToCallback':!![]},function(_0x4e4559,_0x1d22d8,_0x14fe61,_0x8eddb5){User[_0x2c8d('0x8')]({'username':_0x1d22d8[_0x2c8d('0xa')]()[_0x2c8d('0x2')]()},function(_0x236258,_0x5995f3){if(_0x236258)return _0x8eddb5(_0x236258);if(!_0x5995f3)return _0x8eddb5(null,![]);if(!_0x5995f3[_0x2c8d('0x10')](_0x4e4559[_0x2c8d('0x0')][_0x2c8d('0x7')]))return _0x8eddb5(null,![]);return _0x8eddb5(null,_0x5995f3);});}));}();