const _0x41f4=['toLowerCase','use','securityanswer','deserializeUser','passport','username','trim','exports','findOne','local-recovery','generateFileSystem','passport-local','serializeUser','LOGIN.INVALID','password','Strategy','validPassword','findById','filepath','validSecurityAnswer','local-signup'];(function(_0x1d71a2,_0x41f4e2){const _0x4183d7=function(_0x425f6a){while(--_0x425f6a){_0x1d71a2['push'](_0x1d71a2['shift']());}};_0x4183d7(++_0x41f4e2);}(_0x41f4,0xdf));const _0x4183=function(_0x1d71a2,_0x41f4e2){_0x1d71a2=_0x1d71a2-0x0;let _0x4183d7=_0x41f4[_0x1d71a2];return _0x4183d7;};const passport=require(_0x4183('0xc'));const LocalStrategy=require(_0x4183('0x13'))[_0x4183('0x2')];const User=require('../models/user');module[_0x4183('0xf')]=function(){passport[_0x4183('0x14')](function(_0x434304,_0x1590d8){_0x1590d8(null,_0x434304['id']);});passport[_0x4183('0xb')](function(_0x38426b,_0x180f03){User[_0x4183('0x4')](_0x38426b,function(_0xa14990,_0x1783d4){_0x180f03(_0xa14990,_0x1783d4);});});passport[_0x4183('0x9')](_0x4183('0x7'),new LocalStrategy({'usernameField':_0x4183('0xd'),'passwordField':_0x4183('0x1'),'passReqToCallback':!![]},function(_0x585da4,_0x16d9e5,_0x37482d,_0x5f268f){User[_0x4183('0x10')]({'username':_0x16d9e5[_0x4183('0x8')]()[_0x4183('0xe')]()},async function(_0x225055,_0x53c47e){if(_0x225055)return _0x5f268f(_0x225055);if(_0x53c47e){return _0x5f268f(null,_0x53c47e,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x43fc9d=new User(_0x585da4['body']);_0x43fc9d[_0x4183('0xd')]=_0x16d9e5;_0x43fc9d[_0x4183('0x1')]=_0x43fc9d['generateHash'](_0x37482d);_0x43fc9d[_0x4183('0x5')]=await _0x43fc9d[_0x4183('0x12')](_0x43fc9d[_0x4183('0xd')]);_0x43fc9d['save'](function(_0x58fa80){if(_0x58fa80)throw _0x58fa80;return _0x5f268f(null,_0x43fc9d);});}});}));passport[_0x4183('0x9')]('local-login',new LocalStrategy({'usernameField':'username','passwordField':'password','passReqToCallback':!![]},function(_0xfb9025,_0x6cb508,_0x49ac19,_0x16624d){User['findOne']({'username':_0x6cb508['toLowerCase']()['trim']()},function(_0x45b3bb,_0x1ac239){if(_0x45b3bb)return _0x16624d(_0x45b3bb);if(!_0x1ac239)return _0x16624d(null,![],{'message':_0x4183('0x0')});if(!_0x1ac239[_0x4183('0x3')](_0x49ac19))return _0x16624d(null,![],{'message':'LOGIN.INVALID'});return _0x16624d(null,_0x1ac239);});}));passport[_0x4183('0x9')](_0x4183('0x11'),new LocalStrategy({'usernameField':'username','passwordField':_0x4183('0x1'),'passReqToCallback':!![]},function(_0x8f79a1,_0x3bd046,_0x2d98a7,_0x2ff9c3){User[_0x4183('0x10')]({'username':_0x3bd046['toLowerCase']()[_0x4183('0xe')]()},function(_0x59ecb7,_0x36c352){if(_0x59ecb7)return _0x2ff9c3(_0x59ecb7);if(!_0x36c352)return _0x2ff9c3(null,![]);if(!_0x36c352[_0x4183('0x6')](_0x8f79a1['body'][_0x4183('0xa')]))return _0x2ff9c3(null,![]);return _0x2ff9c3(null,_0x36c352);});}));}();