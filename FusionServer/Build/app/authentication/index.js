const _0x401b=['generateHash','use','validSecurityAnswer','exports','securityanswer','filepath','validPassword','findById','body','trim','toLowerCase','Strategy','findOne','deserializeUser','password','passport-local','serializeUser','username','LOGIN.INVALID','local-login','save'];(function(_0x24c2ec,_0x401b89){const _0x3c197d=function(_0x54e237){while(--_0x54e237){_0x24c2ec['push'](_0x24c2ec['shift']());}};_0x3c197d(++_0x401b89);}(_0x401b,0xfe));const _0x3c19=function(_0x24c2ec,_0x401b89){_0x24c2ec=_0x24c2ec-0x0;let _0x3c197d=_0x401b[_0x24c2ec];return _0x3c197d;};const passport=require('passport');const LocalStrategy=require(_0x3c19('0xd'))[_0x3c19('0x9')];const User=require('../models/user');module[_0x3c19('0x1')]=function(){passport[_0x3c19('0xe')](function(_0x3fc641,_0x3b4d97){_0x3b4d97(null,_0x3fc641['id']);});passport[_0x3c19('0xb')](function(_0x521ff6,_0x14e55e){User[_0x3c19('0x5')](_0x521ff6,function(_0x311419,_0x526b76){_0x14e55e(_0x311419,_0x526b76);});});passport[_0x3c19('0x14')]('local-signup',new LocalStrategy({'usernameField':'username','passwordField':_0x3c19('0xc'),'passReqToCallback':!![]},function(_0x3693ab,_0x9d01ea,_0x30f465,_0x2f50a9){User[_0x3c19('0xa')]({'username':_0x9d01ea[_0x3c19('0x8')]()[_0x3c19('0x7')]()},async function(_0x3c295d,_0x538994){if(_0x3c295d)return _0x2f50a9(_0x3c295d);if(_0x538994){return _0x2f50a9(null,_0x538994,{'message':'REGISTER.ALREADY_EXISTS'});}else{var _0x46a887=new User(_0x3693ab[_0x3c19('0x6')]);_0x46a887[_0x3c19('0xf')]=_0x9d01ea;_0x46a887[_0x3c19('0xc')]=_0x46a887[_0x3c19('0x13')](_0x30f465);_0x46a887[_0x3c19('0x3')]=await _0x46a887['generateFileSystem'](_0x46a887[_0x3c19('0xf')]);_0x46a887[_0x3c19('0x12')](function(_0x7cd661){if(_0x7cd661)throw _0x7cd661;return _0x2f50a9(null,_0x46a887);});}});}));passport['use'](_0x3c19('0x11'),new LocalStrategy({'usernameField':_0x3c19('0xf'),'passwordField':_0x3c19('0xc'),'passReqToCallback':!![]},function(_0x33c4f6,_0x499852,_0x1e0b20,_0x4cfc85){User[_0x3c19('0xa')]({'username':_0x499852[_0x3c19('0x8')]()[_0x3c19('0x7')]()},function(_0x4ae70c,_0x4a61f1){if(_0x4ae70c)return _0x4cfc85(_0x4ae70c);if(!_0x4a61f1)return _0x4cfc85(null,![],{'message':'LOGIN.INVALID'});if(!_0x4a61f1[_0x3c19('0x4')](_0x1e0b20))return _0x4cfc85(null,![],{'message':_0x3c19('0x10')});return _0x4cfc85(null,_0x4a61f1);});}));passport[_0x3c19('0x14')]('local-recovery',new LocalStrategy({'usernameField':_0x3c19('0xf'),'passwordField':'password','passReqToCallback':!![]},function(_0x1b8afa,_0x460a10,_0x42b56a,_0x29f8c2){User[_0x3c19('0xa')]({'username':_0x460a10[_0x3c19('0x8')]()[_0x3c19('0x7')]()},function(_0x3a8393,_0x423769){if(_0x3a8393)return _0x29f8c2(_0x3a8393);if(!_0x423769)return _0x29f8c2(null,![]);if(!_0x423769[_0x3c19('0x0')](_0x1b8afa[_0x3c19('0x6')][_0x3c19('0x2')]))return _0x29f8c2(null,![]);return _0x29f8c2(null,_0x423769);});}));}();