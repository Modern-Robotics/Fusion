const _0x33f4=['toLowerCase','username','generateFileSystem','use','password','securityanswer','passport','REGISTER.ALREADY_EXISTS','findOne','local-signup','body','validPassword','Strategy','serializeUser','filepath','LOGIN.INVALID','local-login','trim','validSecurityAnswer','../models/user','exports','deserializeUser','passport-local','findById','local-recovery'];(function(_0x472d4c,_0x33f421){const _0x216824=function(_0x60cc9d){while(--_0x60cc9d){_0x472d4c['push'](_0x472d4c['shift']());}};_0x216824(++_0x33f421);}(_0x33f4,0x18f));const _0x2168=function(_0x472d4c,_0x33f421){_0x472d4c=_0x472d4c-0x0;let _0x216824=_0x33f4[_0x472d4c];return _0x216824;};const passport=require(_0x2168('0x7'));const LocalStrategy=require(_0x2168('0x17'))[_0x2168('0xd')];const User=require(_0x2168('0x14'));module[_0x2168('0x15')]=function(){passport[_0x2168('0xe')](function(_0x27dcc6,_0xd52483){_0xd52483(null,_0x27dcc6['id']);});passport[_0x2168('0x16')](function(_0xe9be8b,_0x25f2fd){User[_0x2168('0x18')](_0xe9be8b,function(_0x33a271,_0xbf8d9a){_0x25f2fd(_0x33a271,_0xbf8d9a);});});passport[_0x2168('0x4')](_0x2168('0xa'),new LocalStrategy({'usernameField':_0x2168('0x2'),'passwordField':_0x2168('0x5'),'passReqToCallback':!![]},function(_0x592458,_0x183549,_0xfd6791,_0x2b0cfa){User['findOne']({'username':_0x183549['toLowerCase']()['trim']()},async function(_0x68514d,_0x252dfd){if(_0x68514d)return _0x2b0cfa(_0x68514d);if(_0x252dfd){return _0x2b0cfa(null,_0x252dfd,{'message':_0x2168('0x8')});}else{var _0x13e68d=new User(_0x592458[_0x2168('0xb')]);_0x13e68d['username']=_0x183549;_0x13e68d[_0x2168('0x5')]=_0x13e68d['generateHash'](_0xfd6791);_0x13e68d[_0x2168('0xf')]=await _0x13e68d[_0x2168('0x3')](_0x13e68d[_0x2168('0x2')]);_0x13e68d['save'](function(_0x3a4fcb){if(_0x3a4fcb)throw _0x3a4fcb;return _0x2b0cfa(null,_0x13e68d);});}});}));passport[_0x2168('0x4')](_0x2168('0x11'),new LocalStrategy({'usernameField':_0x2168('0x2'),'passwordField':_0x2168('0x5'),'passReqToCallback':!![]},function(_0x5ae06d,_0x5467a0,_0x2549f2,_0x3fb540){User[_0x2168('0x9')]({'username':_0x5467a0['toLowerCase']()[_0x2168('0x12')]()},function(_0x34fd44,_0xadedba){if(_0x34fd44)return _0x3fb540(_0x34fd44);if(!_0xadedba)return _0x3fb540(null,![],{'message':_0x2168('0x10')});if(!_0xadedba[_0x2168('0xc')](_0x2549f2))return _0x3fb540(null,![],{'message':'LOGIN.INVALID'});return _0x3fb540(null,_0xadedba);});}));passport[_0x2168('0x4')](_0x2168('0x0'),new LocalStrategy({'usernameField':_0x2168('0x2'),'passwordField':_0x2168('0x5'),'passReqToCallback':!![]},function(_0x546287,_0x3c4062,_0xdac73e,_0x28364a){User['findOne']({'username':_0x3c4062[_0x2168('0x1')]()['trim']()},function(_0x3523b4,_0x5588b3){if(_0x3523b4)return _0x28364a(_0x3523b4);if(!_0x5588b3)return _0x28364a(null,![]);if(!_0x5588b3[_0x2168('0x13')](_0x546287[_0x2168('0xb')][_0x2168('0x6')]))return _0x28364a(null,![]);return _0x28364a(null,_0x5588b3);});}));}();