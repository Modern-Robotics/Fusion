const _0x333c=['findOne','findById','Strategy','securityanswer','toLowerCase','generateFileSystem','local-signup','generateHash','REGISTER.ALREADY_EXISTS','filepath','passport','serializeUser','trim','../models/user','body','use','local-recovery','username','local-login','validSecurityAnswer','deserializeUser','password'];(function(_0x8c6bd,_0x333ce8){const _0xaa9824=function(_0x2da28f){while(--_0x2da28f){_0x8c6bd['push'](_0x8c6bd['shift']());}};_0xaa9824(++_0x333ce8);}(_0x333c,0x66));const _0xaa98=function(_0x8c6bd,_0x333ce8){_0x8c6bd=_0x8c6bd-0x0;let _0xaa9824=_0x333c[_0x8c6bd];return _0xaa9824;};const passport=require(_0xaa98('0x12'));const LocalStrategy=require('passport-local')[_0xaa98('0xa')];const User=require(_0xaa98('0x15'));module['exports']=function(){passport[_0xaa98('0x13')](function(_0x365d9b,_0x290645){_0x290645(null,_0x365d9b['id']);});passport[_0xaa98('0x6')](function(_0x37f3fc,_0x25776b){User[_0xaa98('0x9')](_0x37f3fc,function(_0x26ba15,_0x88b281){_0x25776b(_0x26ba15,_0x88b281);});});passport[_0xaa98('0x1')](_0xaa98('0xe'),new LocalStrategy({'usernameField':_0xaa98('0x3'),'passwordField':_0xaa98('0x7'),'passReqToCallback':!![]},function(_0x285573,_0x4d5039,_0x1843eb,_0x21c178){User[_0xaa98('0x8')]({'username':_0x4d5039[_0xaa98('0xc')]()[_0xaa98('0x14')]()},async function(_0x1ab116,_0x42c434){if(_0x1ab116)return _0x21c178(_0x1ab116);if(_0x42c434){return _0x21c178(null,_0x42c434,{'message':_0xaa98('0x10')});}else{var _0x26cf8d=new User(_0x285573[_0xaa98('0x0')]);_0x26cf8d[_0xaa98('0x3')]=_0x4d5039;_0x26cf8d[_0xaa98('0x7')]=_0x26cf8d[_0xaa98('0xf')](_0x1843eb);_0x26cf8d[_0xaa98('0x11')]=await _0x26cf8d[_0xaa98('0xd')](_0x26cf8d[_0xaa98('0x3')]);_0x26cf8d['save'](function(_0x2a2c10){if(_0x2a2c10)throw _0x2a2c10;return _0x21c178(null,_0x26cf8d);});}});}));passport[_0xaa98('0x1')](_0xaa98('0x4'),new LocalStrategy({'usernameField':_0xaa98('0x3'),'passwordField':_0xaa98('0x7'),'passReqToCallback':!![]},function(_0x5f4c54,_0x3f086c,_0x401413,_0x73a056){User['findOne']({'username':_0x3f086c[_0xaa98('0xc')]()[_0xaa98('0x14')]()},function(_0x48854d,_0x5c2fce){if(_0x48854d)return _0x73a056(_0x48854d);if(!_0x5c2fce)return _0x73a056(null,![],{'message':'LOGIN.INVALID'});if(!_0x5c2fce['validPassword'](_0x401413))return _0x73a056(null,![],{'message':'LOGIN.INVALID'});return _0x73a056(null,_0x5c2fce);});}));passport[_0xaa98('0x1')](_0xaa98('0x2'),new LocalStrategy({'usernameField':_0xaa98('0x3'),'passwordField':'password','passReqToCallback':!![]},function(_0x40b8b2,_0x12e848,_0x54eb57,_0x40dd63){User[_0xaa98('0x8')]({'username':_0x12e848['toLowerCase']()['trim']()},function(_0x4cb250,_0x18ef46){if(_0x4cb250)return _0x40dd63(_0x4cb250);if(!_0x18ef46)return _0x40dd63(null,![]);if(!_0x18ef46[_0xaa98('0x5')](_0x40b8b2[_0xaa98('0x0')][_0xaa98('0xb')]))return _0x40dd63(null,![]);return _0x40dd63(null,_0x18ef46);});}));}();