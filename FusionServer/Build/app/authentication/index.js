const _0x494d=['local-signup','password','use','filepath','save','passport-local','validPassword','local-recovery','Strategy','generateFileSystem','REGISTER.ALREADY_EXISTS','body','findById','local-login','findOne','validSecurityAnswer','LOGIN.INVALID','toLowerCase','trim','../models/user','username','exports'];(function(_0x18c238,_0x494dee){const _0x28a612=function(_0x4f9199){while(--_0x4f9199){_0x18c238['push'](_0x18c238['shift']());}};_0x28a612(++_0x494dee);}(_0x494d,0xcc));const _0x28a6=function(_0x18c238,_0x494dee){_0x18c238=_0x18c238-0x0;let _0x28a612=_0x494d[_0x18c238];return _0x28a612;};const passport=require('passport');const LocalStrategy=require(_0x28a6('0x15'))[_0x28a6('0x2')];const User=require(_0x28a6('0xd'));module[_0x28a6('0xf')]=function(){passport['serializeUser'](function(_0x4ed0dc,_0x232bb8){_0x232bb8(null,_0x4ed0dc['id']);});passport['deserializeUser'](function(_0x4c2491,_0xd387d8){User[_0x28a6('0x6')](_0x4c2491,function(_0x16da5b,_0xa419f3){_0xd387d8(_0x16da5b,_0xa419f3);});});passport[_0x28a6('0x12')](_0x28a6('0x10'),new LocalStrategy({'usernameField':_0x28a6('0xe'),'passwordField':_0x28a6('0x11'),'passReqToCallback':!![]},function(_0x53f72d,_0x46ce47,_0x390f67,_0x46ef57){User[_0x28a6('0x8')]({'username':_0x46ce47[_0x28a6('0xb')]()['trim']()},async function(_0x57d3ee,_0x3d744f){if(_0x57d3ee)return _0x46ef57(_0x57d3ee);if(_0x3d744f){return _0x46ef57(null,_0x3d744f,{'message':_0x28a6('0x4')});}else{var _0x385516=new User(_0x53f72d[_0x28a6('0x5')]);_0x385516['username']=_0x46ce47;_0x385516[_0x28a6('0x11')]=_0x385516['generateHash'](_0x390f67);_0x385516[_0x28a6('0x13')]=await _0x385516[_0x28a6('0x3')](_0x385516[_0x28a6('0xe')]);_0x385516[_0x28a6('0x14')](function(_0x2b4c9d){if(_0x2b4c9d)throw _0x2b4c9d;return _0x46ef57(null,_0x385516);});}});}));passport['use'](_0x28a6('0x7'),new LocalStrategy({'usernameField':_0x28a6('0xe'),'passwordField':_0x28a6('0x11'),'passReqToCallback':!![]},function(_0x9969e7,_0x44ac0b,_0x454c62,_0x4c53ba){User['findOne']({'username':_0x44ac0b[_0x28a6('0xb')]()[_0x28a6('0xc')]()},function(_0x1db994,_0x450852){if(_0x1db994)return _0x4c53ba(_0x1db994);if(!_0x450852)return _0x4c53ba(null,![],{'message':_0x28a6('0xa')});if(!_0x450852[_0x28a6('0x0')](_0x454c62))return _0x4c53ba(null,![],{'message':'LOGIN.INVALID'});return _0x4c53ba(null,_0x450852);});}));passport[_0x28a6('0x12')](_0x28a6('0x1'),new LocalStrategy({'usernameField':_0x28a6('0xe'),'passwordField':_0x28a6('0x11'),'passReqToCallback':!![]},function(_0x5466d7,_0x3690d7,_0x245ab5,_0x16d112){User[_0x28a6('0x8')]({'username':_0x3690d7['toLowerCase']()[_0x28a6('0xc')]()},function(_0x556243,_0x80ee1c){if(_0x556243)return _0x16d112(_0x556243);if(!_0x80ee1c)return _0x16d112(null,![]);if(!_0x80ee1c[_0x28a6('0x9')](_0x5466d7[_0x28a6('0x5')]['securityanswer']))return _0x16d112(null,![]);return _0x16d112(null,_0x80ee1c);});}));}();