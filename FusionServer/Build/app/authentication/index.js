const _0x5326=['Strategy','use','securityanswer','generateHash','exports','validSecurityAnswer','username','local-login','toLowerCase','LOGIN.INVALID','passport','filepath','passport-local','local-recovery','password','trim','REGISTER.ALREADY_EXISTS','generateFileSystem','body','validPassword','findOne','deserializeUser','../models/user'];(function(_0x3ee28b,_0x532668){const _0x17f9e8=function(_0x53f80b){while(--_0x53f80b){_0x3ee28b['push'](_0x3ee28b['shift']());}};_0x17f9e8(++_0x532668);}(_0x5326,0x16c));const _0x17f9=function(_0x3ee28b,_0x532668){_0x3ee28b=_0x3ee28b-0x0;let _0x17f9e8=_0x5326[_0x3ee28b];return _0x17f9e8;};const passport=require(_0x17f9('0xe'));const LocalStrategy=require(_0x17f9('0x10'))[_0x17f9('0x4')];const User=require(_0x17f9('0x3'));module[_0x17f9('0x8')]=function(){passport['serializeUser'](function(_0x4dd239,_0x12570d){_0x12570d(null,_0x4dd239['id']);});passport[_0x17f9('0x2')](function(_0x4bce84,_0x30e8c9){User['findById'](_0x4bce84,function(_0x5de68c,_0x32125d){_0x30e8c9(_0x5de68c,_0x32125d);});});passport[_0x17f9('0x5')]('local-signup',new LocalStrategy({'usernameField':_0x17f9('0xa'),'passwordField':_0x17f9('0x12'),'passReqToCallback':!![]},function(_0x34e8eb,_0x1585fc,_0x1393bc,_0x432d89){User[_0x17f9('0x1')]({'username':_0x1585fc[_0x17f9('0xc')]()[_0x17f9('0x13')]()},async function(_0x122692,_0x28bdf8){if(_0x122692)return _0x432d89(_0x122692);if(_0x28bdf8){return _0x432d89(null,_0x28bdf8,{'message':_0x17f9('0x14')});}else{var _0x30dcf2=new User(_0x34e8eb[_0x17f9('0x16')]);_0x30dcf2[_0x17f9('0xa')]=_0x1585fc;_0x30dcf2[_0x17f9('0x12')]=_0x30dcf2[_0x17f9('0x7')](_0x1393bc);_0x30dcf2[_0x17f9('0xf')]=await _0x30dcf2[_0x17f9('0x15')](_0x30dcf2['username']);_0x30dcf2['save'](function(_0x5a6b7f){if(_0x5a6b7f)throw _0x5a6b7f;return _0x432d89(null,_0x30dcf2);});}});}));passport['use'](_0x17f9('0xb'),new LocalStrategy({'usernameField':_0x17f9('0xa'),'passwordField':_0x17f9('0x12'),'passReqToCallback':!![]},function(_0x5b6b0b,_0x5de540,_0xa7b572,_0x46fe24){User[_0x17f9('0x1')]({'username':_0x5de540['toLowerCase']()[_0x17f9('0x13')]()},function(_0x189f0a,_0x1b6519){if(_0x189f0a)return _0x46fe24(_0x189f0a);if(!_0x1b6519)return _0x46fe24(null,![],{'message':_0x17f9('0xd')});if(!_0x1b6519[_0x17f9('0x0')](_0xa7b572))return _0x46fe24(null,![],{'message':_0x17f9('0xd')});return _0x46fe24(null,_0x1b6519);});}));passport['use'](_0x17f9('0x11'),new LocalStrategy({'usernameField':_0x17f9('0xa'),'passwordField':_0x17f9('0x12'),'passReqToCallback':!![]},function(_0x40fd4c,_0x49af38,_0xb41ba5,_0x1794a3){User[_0x17f9('0x1')]({'username':_0x49af38[_0x17f9('0xc')]()[_0x17f9('0x13')]()},function(_0x3b70c7,_0x4f1a0e){if(_0x3b70c7)return _0x1794a3(_0x3b70c7);if(!_0x4f1a0e)return _0x1794a3(null,![]);if(!_0x4f1a0e[_0x17f9('0x9')](_0x40fd4c[_0x17f9('0x16')][_0x17f9('0x6')]))return _0x1794a3(null,![]);return _0x1794a3(null,_0x4f1a0e);});}));}();