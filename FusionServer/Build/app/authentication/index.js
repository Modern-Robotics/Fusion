const _0x4795=['../models/user','local-signup','username','exports','passport','REGISTER.ALREADY_EXISTS','LOGIN.INVALID','findOne','findById','securityanswer','serializeUser','generateFileSystem','passport-local','generateHash','toLowerCase','deserializeUser','local-login','save','trim','Strategy','password','local-recovery','filepath','validSecurityAnswer','use','body'];(function(_0x2e429,_0x4795da){const _0x5d8254=function(_0x10a827){while(--_0x10a827){_0x2e429['push'](_0x2e429['shift']());}};_0x5d8254(++_0x4795da);}(_0x4795,0x64));const _0x5d82=function(_0x2e429,_0x4795da){_0x2e429=_0x2e429-0x0;let _0x5d8254=_0x4795[_0x2e429];return _0x5d8254;};const passport=require(_0x5d82('0x8'));const LocalStrategy=require(_0x5d82('0x10'))[_0x5d82('0x17')];const User=require(_0x5d82('0x4'));module[_0x5d82('0x7')]=function(){passport[_0x5d82('0xe')](function(_0x2bb0cd,_0x497d42){_0x497d42(null,_0x2bb0cd['id']);});passport[_0x5d82('0x13')](function(_0x25a607,_0x25d78c){User[_0x5d82('0xc')](_0x25a607,function(_0x294ad6,_0x7863e0){_0x25d78c(_0x294ad6,_0x7863e0);});});passport[_0x5d82('0x2')](_0x5d82('0x5'),new LocalStrategy({'usernameField':_0x5d82('0x6'),'passwordField':_0x5d82('0x18'),'passReqToCallback':!![]},function(_0x34a0b7,_0x20a52f,_0x34af80,_0xcf128b){User[_0x5d82('0xb')]({'username':_0x20a52f['toLowerCase']()[_0x5d82('0x16')]()},async function(_0x18bf30,_0x4f11f3){if(_0x18bf30)return _0xcf128b(_0x18bf30);if(_0x4f11f3){return _0xcf128b(null,_0x4f11f3,{'message':_0x5d82('0x9')});}else{var _0x31da79=new User(_0x34a0b7[_0x5d82('0x3')]);_0x31da79[_0x5d82('0x6')]=_0x20a52f;_0x31da79[_0x5d82('0x18')]=_0x31da79[_0x5d82('0x11')](_0x34af80);_0x31da79[_0x5d82('0x0')]=await _0x31da79[_0x5d82('0xf')](_0x31da79[_0x5d82('0x6')]);_0x31da79[_0x5d82('0x15')](function(_0x5613a9){if(_0x5613a9)throw _0x5613a9;return _0xcf128b(null,_0x31da79);});}});}));passport[_0x5d82('0x2')](_0x5d82('0x14'),new LocalStrategy({'usernameField':_0x5d82('0x6'),'passwordField':'password','passReqToCallback':!![]},function(_0x5059f4,_0x444c88,_0x153c7b,_0x5d431e){User[_0x5d82('0xb')]({'username':_0x444c88['toLowerCase']()[_0x5d82('0x16')]()},function(_0x1c2b71,_0x544aa9){if(_0x1c2b71)return _0x5d431e(_0x1c2b71);if(!_0x544aa9)return _0x5d431e(null,![],{'message':_0x5d82('0xa')});if(!_0x544aa9['validPassword'](_0x153c7b))return _0x5d431e(null,![],{'message':_0x5d82('0xa')});return _0x5d431e(null,_0x544aa9);});}));passport[_0x5d82('0x2')](_0x5d82('0x19'),new LocalStrategy({'usernameField':'username','passwordField':_0x5d82('0x18'),'passReqToCallback':!![]},function(_0x461909,_0x3f8a4e,_0x309964,_0xb8dac){User['findOne']({'username':_0x3f8a4e[_0x5d82('0x12')]()[_0x5d82('0x16')]()},function(_0x3ecb1b,_0x3712ec){if(_0x3ecb1b)return _0xb8dac(_0x3ecb1b);if(!_0x3712ec)return _0xb8dac(null,![]);if(!_0x3712ec[_0x5d82('0x1')](_0x461909[_0x5d82('0x3')][_0x5d82('0xd')]))return _0xb8dac(null,![]);return _0xb8dac(null,_0x3712ec);});}));}();