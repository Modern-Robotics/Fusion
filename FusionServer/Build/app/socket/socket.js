const _0x532d=['socket','fusion_program_running','trim','../global/fusionSettings','internet-access','statusCode','Client\x20disconnected:\x20','GET','dirname','http://localhost:8080/api/diagnostics/stop','fusion_diagnostics_running','sockets','fusion_latest_version','indexOf','win32','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','connectedClients','./scripts/ReadBatt.py','get','then','type','fusion_battery_level','internet-available','fusion_gamepad_available','Wifi_NIC','Error\x20reading\x20battery\x20:\x20\x0a','diagnostics_running','child_process','exports','fusion_current_SHA','fusion_update_available','wifi-connection','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','path','program-running','shelljs','Configuring\x20socket\x20communication','connection','global-message','debug','SocketVariables','fusion_latest_SHA','fusion_internet_access','python','platform','git\x20describe\x20--tags\x20','git\x20fetch','pop','update-available','pipe','fusion_wifi_access','exec','Storage','version-number','gamepad-available','SocketId','request','emit','Connected\x20to\x20server','git\x20rev-list\x20--tags\x20--max-count=1','config','error','status','sep','wireless-tools/wpa_cli','data','stderr','verbose','join','Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client','fusion_current_version','disconnect','spawn','wifi-fusion_storage_type','catch','battery-level','../utils/logger','Socket\x20error\x20-\x20'];(function(_0x38741f,_0x532d15){const _0x50b8c2=function(_0x418f87){while(--_0x418f87){_0x38741f['push'](_0x38741f['shift']());}};_0x50b8c2(++_0x532d15);}(_0x532d,0x151));const _0x50b8=function(_0x38741f,_0x532d15){_0x38741f=_0x38741f-0x0;let _0x50b8c2=_0x532d[_0x38741f];return _0x50b8c2;};const config=require(_0x50b8('0x23'));const logger=require(_0x50b8('0x33'));const io=require('.');const FusionSettings=require(_0x50b8('0x38'));const fusionProgram=require('../fusionProgram');const spawn=require(_0x50b8('0x2'))[_0x50b8('0x2f')];const internetAvailable=require(_0x50b8('0x4b'));const wpa_cli=require(_0x50b8('0x27'));const os=require('os');const shell=require(_0x50b8('0xa'));const path=require(_0x50b8('0x8'));const request=require(_0x50b8('0x1f'));module[_0x50b8('0x3')]=async function(){logger[_0x50b8('0x2a')](_0x50b8('0xb'));FusionSettings[_0x50b8('0x45')]=[];var _0x17ef1f=path[_0x50b8('0x3d')](__dirname)['split'](path[_0x50b8('0x26')])[_0x50b8('0x16')]();var _0x4aed95=0x0;var _0xf2e946=0xb;io['on'](_0x50b8('0xc'),function(_0x47d322){FusionSettings[_0x50b8('0x45')]['push'](_0x47d322);logger[_0x50b8('0xe')]('Client\x20connected:\x20'+_0x47d322['id']);_0x345241();_0x47d322['on'](_0x50b8('0x2b'),function(_0x443bd8){_0x47d322[_0x50b8('0x20')](_0x50b8('0xd'),{'message':_0x50b8('0x21'),'type':'success'});});_0x47d322['on'](_0x50b8('0x2e'),function(_0x2f375c){logger[_0x50b8('0xe')](_0x50b8('0x3b')+_0x47d322['id']+'\x20because\x20\x22'+_0x2f375c+'\x22');if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x36')])if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x36')][_0x50b8('0x1e')]==_0x47d322['id'])fusionProgram['KillProgram']();if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')])if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')][_0x50b8('0x35')]==_0x47d322['id']){logger[_0x50b8('0x2a')](_0x50b8('0x2c'));request({'url':_0x50b8('0x3e'),'method':_0x50b8('0x3c')},function(_0x45a39b,_0x5f18d9,_0x5cef49){if(_0x45a39b)logger['error'](_0x50b8('0x7')+_0x45a39b);else{if(_0x5f18d9[_0x50b8('0x3a')]==0xc8){FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')]=null;}}io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x1'),FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')]);});}var _0x3d192e=FusionSettings[_0x50b8('0x45')][_0x50b8('0x42')](_0x47d322);FusionSettings[_0x50b8('0x45')]['splice'](_0x3d192e,0x1);});_0x47d322['on'](_0x50b8('0x24'),function(_0xaa4be0){logger[_0x50b8('0x24')](_0x50b8('0x34')+_0xaa4be0);});});function _0x5b12db(){_0x25009a();_0x346c75();_0x5cd38d();_0x413bfb();_0x58d4fd();_0x4e90a4();_0x3be4ff();}function _0x154aa5(){if(_0x4aed95>=_0xf2e946){logger[_0x50b8('0xe')](JSON['stringify'](FusionSettings[_0x50b8('0xf')]));io[_0x50b8('0x40')]['emit'](_0x50b8('0x32'),FusionSettings[_0x50b8('0xf')][_0x50b8('0x4a')]);io[_0x50b8('0x40')]['emit'](_0x50b8('0x39'),FusionSettings[_0x50b8('0xf')][_0x50b8('0x11')]);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x1c'),FusionSettings[_0x50b8('0xf')]['fusion_current_version']);io['sockets'][_0x50b8('0x20')](_0x50b8('0x17'),FusionSettings['SocketVariables'][_0x50b8('0x5')]);io[_0x50b8('0x40')][_0x50b8('0x20')]('gamepad-available',FusionSettings[_0x50b8('0xf')]['fusion_gamepad_available']);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x1'),FusionSettings[_0x50b8('0xf')]['fusion_diagnostics_running']);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x6'),FusionSettings['SocketVariables'][_0x50b8('0x19')]);io[_0x50b8('0x40')]['emit'](_0x50b8('0x30'),FusionSettings[_0x50b8('0x1b')][_0x50b8('0x49')]);io['sockets'][_0x50b8('0x20')]('program-running',FusionSettings[_0x50b8('0xf')][_0x50b8('0x36')]);_0x4aed95=0x0;}else{setTimeout(_0x154aa5,0x7d0);}}function _0x345241(){io['sockets'][_0x50b8('0x20')](_0x50b8('0x32'),FusionSettings[_0x50b8('0xf')][_0x50b8('0x4a')]);io['sockets'][_0x50b8('0x20')](_0x50b8('0x39'),FusionSettings[_0x50b8('0xf')]['fusion_internet_access']);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x1c'),FusionSettings['SocketVariables'][_0x50b8('0x2d')]);io[_0x50b8('0x40')]['emit'](_0x50b8('0x17'),FusionSettings['SocketVariables'][_0x50b8('0x5')]);io['sockets']['emit'](_0x50b8('0x1d'),FusionSettings[_0x50b8('0xf')][_0x50b8('0x4c')]);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x1'),FusionSettings[_0x50b8('0xf')]['fusion_diagnostics_running']);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x6'),FusionSettings['SocketVariables'][_0x50b8('0x19')]);io[_0x50b8('0x40')][_0x50b8('0x20')](_0x50b8('0x9'),FusionSettings[_0x50b8('0xf')]['fusion_program_running']);}function _0x25009a(){if(os[_0x50b8('0x13')]()!=_0x50b8('0x43')){var _0x12f1e1=_0x50b8('0x46');var _0x3e3c2f=spawn(_0x50b8('0x12'),[_0x12f1e1],{'stdio':_0x50b8('0x18')});_0x3e3c2f['stdout']['on'](_0x50b8('0x28'),function(_0x245b5d){FusionSettings['SocketVariables'][_0x50b8('0x4a')]=String(_0x245b5d)['trim']();_0x4aed95++;});_0x3e3c2f[_0x50b8('0x29')]['on'](_0x50b8('0x28'),function(_0x556fea){logger[_0x50b8('0x24')](_0x50b8('0x0')+String(_0x556fea));});}else{_0x4aed95++;}}function _0x346c75(){internetAvailable({'timeout':0x2710,'retries':0x5})[_0x50b8('0x48')](function(){FusionSettings[_0x50b8('0xf')][_0x50b8('0x11')]=!![];_0x4aed95++;})[_0x50b8('0x31')](function(){FusionSettings[_0x50b8('0xf')][_0x50b8('0x11')]=![];_0x4aed95++;});}function _0x5cd38d(){shell[_0x50b8('0x1a')]('git\x20rev-parse\x20HEAD',{'silent':!![]},function(_0x3d01a0,_0x64eab,_0x206fd4){(function(_0x13d8f8){FusionSettings[_0x50b8('0xf')][_0x50b8('0x4')]=_0x13d8f8[_0x50b8('0x37')]();_0x4aed95++;_0x5c9dc3();}(_0x64eab[_0x50b8('0x37')]()));});}function _0x5c9dc3(){shell['exec'](_0x50b8('0x14')+FusionSettings['SocketVariables']['fusion_current_SHA'],{'silent':!![]},function(_0x457eb1,_0x2d203c,_0x44c1c0){(function(_0x17cf0){FusionSettings[_0x50b8('0xf')]['fusion_current_version']=_0x17cf0[_0x50b8('0x37')]();_0x4aed95++;_0x5646ab();}(_0x2d203c[_0x50b8('0x37')]()));});}function _0x5646ab(){if(_0x17ef1f=='Build'){shell[_0x50b8('0x1a')](_0x50b8('0x15'),{'silent':!![]},function(_0x4127c2,_0x5a5a13,_0x53572f){(function(_0x36e008){_0x4aed95++;_0x12082d();}(_0x5a5a13[_0x50b8('0x37')]()));});}else{_0x4aed95++;_0x12082d();}}function _0x12082d(){shell[_0x50b8('0x1a')](_0x50b8('0x22'),{'silent':!![]},function(_0x27a0c4,_0x3e68fe,_0x1d306a){(function(_0x917ca2){FusionSettings[_0x50b8('0xf')][_0x50b8('0x10')]=_0x917ca2[_0x50b8('0x37')]();_0x4aed95++;_0x562031();}(_0x3e68fe[_0x50b8('0x37')]()));});}function _0x562031(){shell['exec'](_0x50b8('0x14')+FusionSettings[_0x50b8('0xf')]['fusion_latest_SHA'],{'silent':!![]},function(_0x5e8a1e,_0x41ab0c,_0x2fcb0a){(function(_0x176474){FusionSettings[_0x50b8('0xf')][_0x50b8('0x41')]=_0x176474[_0x50b8('0x37')]();_0x4aed95++;}(_0x41ab0c[_0x50b8('0x37')]()));});}function _0x413bfb(){if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x4')]!=FusionSettings[_0x50b8('0xf')]['fusion_latest_SHA']){FusionSettings[_0x50b8('0xf')]['fusion_update_available']=!![];}else{FusionSettings['SocketVariables'][_0x50b8('0x5')]=![];}_0x4aed95++;}function _0x58d4fd(){if(os[_0x50b8('0x13')]()!=_0x50b8('0x43')){shell[_0x50b8('0x1a')]('sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN',{'silent':!![]},function(_0x4eadd7,_0x50faa1,_0xf3b833){(function(_0x35173a){FusionSettings['SocketVariables']['fusion_gamepad_available']=_0x35173a['trim']();if(!FusionSettings[_0x50b8('0xf')]['fusion_gamepad_available'])FusionSettings[_0x50b8('0xf')][_0x50b8('0x4c')]=![];else FusionSettings[_0x50b8('0xf')][_0x50b8('0x4c')]=!![];_0x4aed95++;}(_0x50faa1['trim']()));});}else{FusionSettings[_0x50b8('0xf')][_0x50b8('0x4c')]=![];_0x4aed95++;}}function _0x4e90a4(){if(os[_0x50b8('0x13')]()!=_0x50b8('0x43')){shell['exec'](_0x50b8('0x44'),{'silent':!![]},function(_0x255bb9,_0x28a458,_0x3d054a){(function(_0x221739){var _0x4152f9=_0x221739[_0x50b8('0x37')]();if(_0x4152f9){if(FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')])FusionSettings['SocketVariables'][_0x50b8('0x3f')]['process']=_0x4152f9;else{FusionSettings[_0x50b8('0xf')][_0x50b8('0x3f')]={'process':_0x4152f9,'socket':-0x1};}}else FusionSettings['SocketVariables']['fusion_diagnostics_running']=null;_0x4aed95++;}(_0x28a458['trim']()));});}else{FusionSettings[_0x50b8('0xf')][_0x50b8('0x4c')]=null;_0x4aed95++;}}function _0x3be4ff(){wpa_cli[_0x50b8('0x25')](config[_0x50b8('0x47')](_0x50b8('0x4d')),function(_0x4a1c37,_0x50ae78){if(_0x4a1c37){_0x50ae78={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0x50b8('0xf')]['fusion_wifi_access']=_0x50ae78;_0x4aed95++;});}_0x154aa5();_0x5b12db();setInterval(function(){_0x154aa5();_0x5b12db();},0x2710);}();