const _0x5e7f=['debug','SocketId','../fusionProgram','fusion_program_running','emit','internet-available','status','catch','error','fusion_internet_access','spawn','SocketVariables','platform','fusion_current_SHA','internet-access','Client\x20connected:\x20','diagnostics_running','win32','git\x20rev-parse\x20HEAD','fusion_diagnostics_running','pipe','connection','shelljs','trim','update-available','Configuring\x20socket\x20communication','indexOf','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','disconnect','battery-level','git\x20fetch','Socket\x20error\x20-\x20','fusion_current_version','program-running','splice','wifi-connection','fusion_update_available','success','Client\x20disconnected:\x20','http://localhost:8080/api/diagnostics/stop','then','Build','fusion_gamepad_available','stderr','stdout','sockets','KillProgram','statusCode','Wifi_NIC','exec','fusion_wifi_access','push','\x20because\x20\x22','fusion_battery_level','socket','process','git\x20rev-list\x20--tags\x20--max-count=1','fusion_latest_version','data','GET','Storage','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','join','Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client','Connected\x20to\x20server','python','split','global-message','wifi-fusion_storage_type','verbose','Error\x20reading\x20battery\x20:\x20\x0a','path','git\x20describe\x20--tags\x20','../utils/logger','dirname','child_process','connectedClients','request','../global/fusionSettings','fusion_latest_SHA','version-number'];(function(_0x2be023,_0x5e7f79){const _0x5ed24f=function(_0x50f7ee){while(--_0x50f7ee){_0x2be023['push'](_0x2be023['shift']());}};_0x5ed24f(++_0x5e7f79);}(_0x5e7f,0x11c));const _0x5ed2=function(_0x2be023,_0x5e7f79){_0x2be023=_0x2be023-0x0;let _0x5ed24f=_0x5e7f[_0x2be023];return _0x5ed24f;};const config=require('config');const logger=require(_0x5ed2('0x20'));const io=require('.');const FusionSettings=require(_0x5ed2('0x25'));const fusionProgram=require(_0x5ed2('0x2a'));const spawn=require(_0x5ed2('0x22'))[_0x5ed2('0x32')];const internetAvailable=require(_0x5ed2('0x2d'));const wpa_cli=require('wireless-tools/wpa_cli');const os=require('os');const shell=require(_0x5ed2('0x3e'));const path=require(_0x5ed2('0x1e'));const request=require(_0x5ed2('0x24'));module['exports']=async function(){logger[_0x5ed2('0x1c')](_0x5ed2('0x41'));FusionSettings[_0x5ed2('0x23')]=[];var _0x952194=path[_0x5ed2('0x21')](__dirname)[_0x5ed2('0x19')](path['sep'])['pop']();var _0x4f8089=0x0;var _0x378df3=0xb;io['on'](_0x5ed2('0x3d'),function(_0x43275a){FusionSettings['connectedClients'][_0x5ed2('0xa')](_0x43275a);logger[_0x5ed2('0x28')](_0x5ed2('0x37')+_0x43275a['id']);_0x507846();_0x43275a['on'](_0x5ed2('0x15'),function(_0x3d2691){_0x43275a[_0x5ed2('0x2c')](_0x5ed2('0x1a'),{'message':_0x5ed2('0x17'),'type':_0x5ed2('0x4d')});});_0x43275a['on'](_0x5ed2('0x44'),function(_0x21b70d){logger[_0x5ed2('0x28')](_0x5ed2('0x4e')+_0x43275a['id']+_0x5ed2('0xb')+_0x21b70d+'\x22');if(FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x2b')])if(FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x2b')][_0x5ed2('0x29')]==_0x43275a['id'])fusionProgram[_0x5ed2('0x5')]();if(FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x3b')])if(FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x3b')][_0x5ed2('0xd')]==_0x43275a['id']){logger[_0x5ed2('0x1c')](_0x5ed2('0x16'));request({'url':_0x5ed2('0x4f'),'method':_0x5ed2('0x12')},function(_0x2d5093,_0xdb8db3,_0x30807e){if(_0x2d5093)logger[_0x5ed2('0x30')](_0x5ed2('0x14')+_0x2d5093);else{if(_0xdb8db3[_0x5ed2('0x6')]==0xc8){FusionSettings[_0x5ed2('0x33')]['fusion_diagnostics_running']=null;}}io[_0x5ed2('0x4')][_0x5ed2('0x2c')]('diagnostics_running',FusionSettings['SocketVariables']['fusion_diagnostics_running']);});}var _0x578523=FusionSettings[_0x5ed2('0x23')][_0x5ed2('0x42')](_0x43275a);FusionSettings[_0x5ed2('0x23')][_0x5ed2('0x4a')](_0x578523,0x1);});_0x43275a['on'](_0x5ed2('0x30'),function(_0x4a41b6){logger[_0x5ed2('0x30')](_0x5ed2('0x47')+_0x4a41b6);});});function _0xc26489(){_0x28b8b2();_0x2d3e85();_0x46aed2();_0xb728df();_0xec13d6();_0x248c36();_0x3e21b5();}function _0x1f57dc(){if(_0x4f8089>=_0x378df3){logger['debug'](JSON['stringify'](FusionSettings['SocketVariables']));io['sockets']['emit'](_0x5ed2('0x45'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0xc')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x36'),FusionSettings['SocketVariables']['fusion_internet_access']);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x27'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x48')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x40'),FusionSettings[_0x5ed2('0x33')]['fusion_update_available']);io['sockets'][_0x5ed2('0x2c')]('gamepad-available',FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x1')]);io[_0x5ed2('0x4')]['emit'](_0x5ed2('0x38'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x3b')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x4b'),FusionSettings[_0x5ed2('0x33')]['fusion_wifi_access']);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x1b'),FusionSettings[_0x5ed2('0x13')]['type']);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x49'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x2b')]);_0x4f8089=0x0;}else{setTimeout(_0x1f57dc,0x7d0);}}function _0x507846(){io[_0x5ed2('0x4')][_0x5ed2('0x2c')]('battery-level',FusionSettings[_0x5ed2('0x33')][_0x5ed2('0xc')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')]('internet-access',FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x31')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x27'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x48')]);io['sockets']['emit'](_0x5ed2('0x40'),FusionSettings['SocketVariables'][_0x5ed2('0x4c')]);io[_0x5ed2('0x4')]['emit']('gamepad-available',FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x1')]);io[_0x5ed2('0x4')][_0x5ed2('0x2c')](_0x5ed2('0x38'),FusionSettings['SocketVariables'][_0x5ed2('0x3b')]);io['sockets'][_0x5ed2('0x2c')](_0x5ed2('0x4b'),FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x9')]);io['sockets']['emit']('program-running',FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x2b')]);}function _0x28b8b2(){if(os['platform']()!=_0x5ed2('0x39')){var _0x3bd173='./scripts/ReadBatt.py';var _0x4320cc=spawn(_0x5ed2('0x18'),[_0x3bd173],{'stdio':_0x5ed2('0x3c')});_0x4320cc[_0x5ed2('0x3')]['on'](_0x5ed2('0x11'),function(_0x29a76a){FusionSettings[_0x5ed2('0x33')][_0x5ed2('0xc')]=String(_0x29a76a)[_0x5ed2('0x3f')]();_0x4f8089++;});_0x4320cc[_0x5ed2('0x2')]['on'](_0x5ed2('0x11'),function(_0x349252){logger['error'](_0x5ed2('0x1d')+String(_0x349252));});}else{_0x4f8089++;}}function _0x2d3e85(){internetAvailable({'timeout':0x2710,'retries':0x5})[_0x5ed2('0x50')](function(){FusionSettings[_0x5ed2('0x33')]['fusion_internet_access']=!![];_0x4f8089++;})[_0x5ed2('0x2f')](function(){FusionSettings[_0x5ed2('0x33')]['fusion_internet_access']=![];_0x4f8089++;});}function _0x46aed2(){shell[_0x5ed2('0x8')](_0x5ed2('0x3a'),{'silent':!![]},function(_0x4d7e0f,_0x3d4637,_0x175c27){(function(_0x578269){FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x35')]=_0x578269[_0x5ed2('0x3f')]();_0x4f8089++;_0x5e2f7d();}(_0x3d4637[_0x5ed2('0x3f')]()));});}function _0x5e2f7d(){shell[_0x5ed2('0x8')](_0x5ed2('0x1f')+FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x35')],{'silent':!![]},function(_0x963e7c,_0x2a19e8,_0x37fc4c){(function(_0x6758cd){FusionSettings['SocketVariables'][_0x5ed2('0x48')]=_0x6758cd[_0x5ed2('0x3f')]();_0x4f8089++;_0x1bb7a8();}(_0x2a19e8[_0x5ed2('0x3f')]()));});}function _0x1bb7a8(){if(_0x952194==_0x5ed2('0x0')){shell[_0x5ed2('0x8')](_0x5ed2('0x46'),{'silent':!![]},function(_0x285211,_0x472820,_0x42704b){(function(_0x50b4d3){_0x4f8089++;_0xd85585();}(_0x472820[_0x5ed2('0x3f')]()));});}else{_0x4f8089++;_0xd85585();}}function _0xd85585(){shell['exec'](_0x5ed2('0xf'),{'silent':!![]},function(_0x23862c,_0x34f8e5,_0x293b49){(function(_0x293c85){FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x26')]=_0x293c85[_0x5ed2('0x3f')]();_0x4f8089++;_0x2cf9e3();}(_0x34f8e5[_0x5ed2('0x3f')]()));});}function _0x2cf9e3(){shell['exec'](_0x5ed2('0x1f')+FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x26')],{'silent':!![]},function(_0xd8ff07,_0x46ec06,_0x1c65e0){(function(_0x513ae7){FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x10')]=_0x513ae7[_0x5ed2('0x3f')]();_0x4f8089++;}(_0x46ec06[_0x5ed2('0x3f')]()));});}function _0xb728df(){if(FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x35')]!=FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x26')]){FusionSettings['SocketVariables'][_0x5ed2('0x4c')]=!![];}else{FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x4c')]=![];}_0x4f8089++;}function _0xec13d6(){if(os['platform']()!='win32'){shell[_0x5ed2('0x8')]('sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN',{'silent':!![]},function(_0x3ae8cb,_0x2d77a8,_0xc517ca){(function(_0x173ba5){FusionSettings[_0x5ed2('0x33')]['fusion_gamepad_available']=_0x173ba5['trim']();if(!FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x1')])FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x1')]=![];else FusionSettings['SocketVariables'][_0x5ed2('0x1')]=!![];_0x4f8089++;}(_0x2d77a8[_0x5ed2('0x3f')]()));});}else{FusionSettings[_0x5ed2('0x33')]['fusion_gamepad_available']=![];_0x4f8089++;}}function _0x248c36(){if(os[_0x5ed2('0x34')]()!=_0x5ed2('0x39')){shell['exec'](_0x5ed2('0x43'),{'silent':!![]},function(_0xcfc65c,_0x1ceb7c,_0x32ba32){(function(_0x15d40f){var _0x4acb5a=_0x15d40f[_0x5ed2('0x3f')]();if(_0x4acb5a){if(FusionSettings['SocketVariables'][_0x5ed2('0x3b')])FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x3b')][_0x5ed2('0xe')]=_0x4acb5a;else{FusionSettings['SocketVariables']['fusion_diagnostics_running']={'process':_0x4acb5a,'socket':-0x1};}}else FusionSettings[_0x5ed2('0x33')]['fusion_diagnostics_running']=null;_0x4f8089++;}(_0x1ceb7c[_0x5ed2('0x3f')]()));});}else{FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x1')]=null;_0x4f8089++;}}function _0x3e21b5(){wpa_cli[_0x5ed2('0x2e')](config['get'](_0x5ed2('0x7')),function(_0x185b0c,_0x1a0b77){if(_0x185b0c){_0x1a0b77={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0x5ed2('0x33')][_0x5ed2('0x9')]=_0x1a0b77;_0x4f8089++;});}_0x1f57dc();_0xc26489();setInterval(function(){_0x1f57dc();_0xc26489();},0x2710);}();