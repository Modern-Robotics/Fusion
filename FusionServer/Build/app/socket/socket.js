const _0x54c6=['Client\x20disconnected:\x20','connectedClients','wifi-fusion_storage_type','fusion_latest_version','SocketId','sockets','pop','socket','status','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','stdout','exports','platform','data','wifi-connection','gamepad-available','child_process','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','fusion_program_running','./scripts/ReadBatt.py','exec','stderr','fusion_battery_level','dirname','global-message','disconnect','update-available','version-number','push','git\x20rev-parse\x20HEAD','internet-available','join','diagnostics_running','verbose','battery-level','KillProgram','Error\x20reading\x20battery\x20:\x20\x0a','internet-access','git\x20describe\x20--tags\x20','../fusionProgram','Build','Client\x20connected:\x20','../utils/logger','stringify','config','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','trim','fusion_current_SHA','emit','fusion_update_available','git\x20fetch','pipe','python','success','error','shelljs','win32','Socket\x20error\x20-\x20','fusion_diagnostics_running','wireless-tools/wpa_cli','splice','fusion_gamepad_available','split','Connected\x20to\x20server','Wifi_NIC','fusion_wifi_access','fusion_current_version','fusion_internet_access','spawn','type','git\x20rev-list\x20--tags\x20--max-count=1','debug','fusion_latest_SHA','process','program-running','indexOf','get','SocketVariables','http://localhost:8080/api/diagnostics/stop','Configuring\x20socket\x20communication'];(function(_0x345b11,_0x54c638){const _0x41954e=function(_0x139723){while(--_0x139723){_0x345b11['push'](_0x345b11['shift']());}};_0x41954e(++_0x54c638);}(_0x54c6,0x140));const _0x4195=function(_0x345b11,_0x54c638){_0x345b11=_0x345b11-0x0;let _0x41954e=_0x54c6[_0x345b11];return _0x41954e;};const config=require(_0x4195('0x2c'));const logger=require(_0x4195('0x2a'));const io=require('.');const FusionSettings=require('../global/fusionSettings');const fusionProgram=require(_0x4195('0x27'));const spawn=require(_0x4195('0x10'))[_0x4195('0x44')];const internetAvailable=require(_0x4195('0x1e'));const wpa_cli=require(_0x4195('0x3b'));const os=require('os');const shell=require(_0x4195('0x37'));const path=require('path');const request=require('request');module[_0x4195('0xb')]=async function(){logger[_0x4195('0x21')](_0x4195('0x4f'));FusionSettings[_0x4195('0x1')]=[];var _0x1ec067=path[_0x4195('0x17')](__dirname)[_0x4195('0x3e')](path['sep'])[_0x4195('0x6')]();var _0x3d8b19=0x0;var _0x745db=0xb;io['on']('connection',function(_0x5b3998){FusionSettings[_0x4195('0x1')][_0x4195('0x1c')](_0x5b3998);logger[_0x4195('0x47')](_0x4195('0x29')+_0x5b3998['id']);_0x22152e();_0x5b3998['on'](_0x4195('0x1f'),function(_0x14d56b){_0x5b3998[_0x4195('0x30')](_0x4195('0x18'),{'message':_0x4195('0x3f'),'type':_0x4195('0x35')});});_0x5b3998['on'](_0x4195('0x19'),function(_0x4b8c7d){logger[_0x4195('0x47')](_0x4195('0x0')+_0x5b3998['id']+'\x20because\x20\x22'+_0x4b8c7d+'\x22');if(FusionSettings['SocketVariables'][_0x4195('0x12')])if(FusionSettings['SocketVariables'][_0x4195('0x12')][_0x4195('0x4')]==_0x5b3998['id'])fusionProgram[_0x4195('0x23')]();if(FusionSettings[_0x4195('0x4d')][_0x4195('0x3a')])if(FusionSettings['SocketVariables'][_0x4195('0x3a')][_0x4195('0x7')]==_0x5b3998['id']){logger['verbose']('Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client');request({'url':_0x4195('0x4e'),'method':'GET'},function(_0x398c31,_0x42df50,_0x2407ad){if(_0x398c31)logger[_0x4195('0x36')](_0x4195('0x9')+_0x398c31);else{if(_0x42df50['statusCode']==0xc8){FusionSettings['SocketVariables'][_0x4195('0x3a')]=null;}}io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x20'),FusionSettings['SocketVariables'][_0x4195('0x3a')]);});}var _0x5338cd=FusionSettings[_0x4195('0x1')][_0x4195('0x4b')](_0x5b3998);FusionSettings[_0x4195('0x1')][_0x4195('0x3c')](_0x5338cd,0x1);});_0x5b3998['on'](_0x4195('0x36'),function(_0x4e5617){logger[_0x4195('0x36')](_0x4195('0x39')+_0x4e5617);});});function _0x2b64a0(){_0x2b3946();_0x5a0f1d();_0x37ddc1();_0x1f0d5d();_0x59508c();_0x1d32ef();_0x1f9336();}function _0x265713(){if(_0x3d8b19>=_0x745db){logger['debug'](JSON[_0x4195('0x2b')](FusionSettings[_0x4195('0x4d')]));io[_0x4195('0x5')][_0x4195('0x30')]('battery-level',FusionSettings['SocketVariables'][_0x4195('0x16')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x25'),FusionSettings[_0x4195('0x4d')][_0x4195('0x43')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x1b'),FusionSettings[_0x4195('0x4d')]['fusion_current_version']);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x1a'),FusionSettings['SocketVariables']['fusion_update_available']);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0xf'),FusionSettings[_0x4195('0x4d')][_0x4195('0x3d')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x20'),FusionSettings[_0x4195('0x4d')][_0x4195('0x3a')]);io['sockets'][_0x4195('0x30')](_0x4195('0xe'),FusionSettings[_0x4195('0x4d')][_0x4195('0x41')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x2'),FusionSettings['Storage'][_0x4195('0x45')]);io[_0x4195('0x5')]['emit']('program-running',FusionSettings['SocketVariables'][_0x4195('0x12')]);_0x3d8b19=0x0;}else{setTimeout(_0x265713,0x7d0);}}function _0x22152e(){io['sockets'][_0x4195('0x30')](_0x4195('0x22'),FusionSettings[_0x4195('0x4d')][_0x4195('0x16')]);io[_0x4195('0x5')][_0x4195('0x30')]('internet-access',FusionSettings[_0x4195('0x4d')][_0x4195('0x43')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x1b'),FusionSettings[_0x4195('0x4d')]['fusion_current_version']);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x1a'),FusionSettings[_0x4195('0x4d')][_0x4195('0x31')]);io['sockets']['emit'](_0x4195('0xf'),FusionSettings[_0x4195('0x4d')][_0x4195('0x3d')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0x20'),FusionSettings['SocketVariables'][_0x4195('0x3a')]);io[_0x4195('0x5')][_0x4195('0x30')](_0x4195('0xe'),FusionSettings[_0x4195('0x4d')][_0x4195('0x41')]);io[_0x4195('0x5')]['emit'](_0x4195('0x4a'),FusionSettings[_0x4195('0x4d')][_0x4195('0x12')]);}function _0x2b3946(){if(os[_0x4195('0xc')]()!=_0x4195('0x38')){var _0x42ee7f=_0x4195('0x13');var _0x5224a0=spawn(_0x4195('0x34'),[_0x42ee7f],{'stdio':_0x4195('0x33')});_0x5224a0[_0x4195('0xa')]['on']('data',function(_0xabb65d){FusionSettings['SocketVariables']['fusion_battery_level']=String(_0xabb65d)[_0x4195('0x2e')]();_0x3d8b19++;});_0x5224a0[_0x4195('0x15')]['on'](_0x4195('0xd'),function(_0x5b9ec6){logger[_0x4195('0x36')](_0x4195('0x24')+String(_0x5b9ec6));});}else{_0x3d8b19++;}}function _0x5a0f1d(){internetAvailable({'timeout':0x2710,'retries':0x5})['then'](function(){FusionSettings[_0x4195('0x4d')]['fusion_internet_access']=!![];_0x3d8b19++;})['catch'](function(){FusionSettings['SocketVariables'][_0x4195('0x43')]=![];_0x3d8b19++;});}function _0x37ddc1(){shell[_0x4195('0x14')](_0x4195('0x1d'),{'silent':!![]},function(_0x4c8005,_0x3099f5,_0x5b0fb5){(function(_0x9f88){FusionSettings['SocketVariables']['fusion_current_SHA']=_0x9f88[_0x4195('0x2e')]();_0x3d8b19++;_0xc4a7e8();}(_0x3099f5['trim']()));});}function _0xc4a7e8(){shell[_0x4195('0x14')](_0x4195('0x26')+FusionSettings[_0x4195('0x4d')][_0x4195('0x2f')],{'silent':!![]},function(_0x1c08bb,_0x32f632,_0x48caba){(function(_0x5a7453){FusionSettings[_0x4195('0x4d')][_0x4195('0x42')]=_0x5a7453[_0x4195('0x2e')]();_0x3d8b19++;_0xe0d6ac();}(_0x32f632[_0x4195('0x2e')]()));});}function _0xe0d6ac(){if(_0x1ec067==_0x4195('0x28')){shell[_0x4195('0x14')](_0x4195('0x32'),{'silent':!![]},function(_0x35cc62,_0x4e61f1,_0x58f5b8){(function(_0x351c50){_0x3d8b19++;_0x4f0db6();}(_0x4e61f1['trim']()));});}else{_0x3d8b19++;_0x4f0db6();}}function _0x4f0db6(){shell[_0x4195('0x14')](_0x4195('0x46'),{'silent':!![]},function(_0x194090,_0x1a6fbd,_0x295d82){(function(_0x5560dd){FusionSettings[_0x4195('0x4d')][_0x4195('0x48')]=_0x5560dd['trim']();_0x3d8b19++;_0x48ee13();}(_0x1a6fbd['trim']()));});}function _0x48ee13(){shell[_0x4195('0x14')]('git\x20describe\x20--tags\x20'+FusionSettings['SocketVariables'][_0x4195('0x48')],{'silent':!![]},function(_0x1a9fe8,_0x7f0807,_0x48d3eb){(function(_0x452e8c){FusionSettings[_0x4195('0x4d')][_0x4195('0x3')]=_0x452e8c['trim']();_0x3d8b19++;}(_0x7f0807[_0x4195('0x2e')]()));});}function _0x1f0d5d(){if(FusionSettings['SocketVariables'][_0x4195('0x2f')]!=FusionSettings[_0x4195('0x4d')]['fusion_latest_SHA']){FusionSettings[_0x4195('0x4d')][_0x4195('0x31')]=!![];}else{FusionSettings['SocketVariables'][_0x4195('0x31')]=![];}_0x3d8b19++;}function _0x59508c(){if(os[_0x4195('0xc')]()!=_0x4195('0x38')){shell[_0x4195('0x14')](_0x4195('0x11'),{'silent':!![]},function(_0x55c7f9,_0x34ca4e,_0x251b2e){(function(_0x34064e){FusionSettings['SocketVariables'][_0x4195('0x3d')]=_0x34064e['trim']();if(!FusionSettings[_0x4195('0x4d')][_0x4195('0x3d')])FusionSettings['SocketVariables'][_0x4195('0x3d')]=![];else FusionSettings[_0x4195('0x4d')][_0x4195('0x3d')]=!![];_0x3d8b19++;}(_0x34ca4e[_0x4195('0x2e')]()));});}else{FusionSettings[_0x4195('0x4d')]['fusion_gamepad_available']=![];_0x3d8b19++;}}function _0x1d32ef(){if(os[_0x4195('0xc')]()!='win32'){shell[_0x4195('0x14')](_0x4195('0x2d'),{'silent':!![]},function(_0x3d8f7c,_0x162151,_0x1ae307){(function(_0x2b3290){var _0x4015db=_0x2b3290[_0x4195('0x2e')]();if(_0x4015db){if(FusionSettings[_0x4195('0x4d')]['fusion_diagnostics_running'])FusionSettings[_0x4195('0x4d')]['fusion_diagnostics_running'][_0x4195('0x49')]=_0x4015db;else{FusionSettings[_0x4195('0x4d')][_0x4195('0x3a')]={'process':_0x4015db,'socket':-0x1};}}else FusionSettings[_0x4195('0x4d')][_0x4195('0x3a')]=null;_0x3d8b19++;}(_0x162151[_0x4195('0x2e')]()));});}else{FusionSettings[_0x4195('0x4d')]['fusion_gamepad_available']=null;_0x3d8b19++;}}function _0x1f9336(){wpa_cli[_0x4195('0x8')](config[_0x4195('0x4c')](_0x4195('0x40')),function(_0xa2f20,_0x4f4cdc){if(_0xa2f20){_0x4f4cdc={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0x4195('0x4d')]['fusion_wifi_access']=_0x4f4cdc;_0x3d8b19++;});}_0x265713();_0x2b64a0();setInterval(function(){_0x265713();_0x2b64a0();},0x2710);}();