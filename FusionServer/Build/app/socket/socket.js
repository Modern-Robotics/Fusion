const _0x4722=['sockets','process','gamepad-available','fusion_current_version','git\x20fetch','../fusionProgram','stderr','diagnostics_running','connectedClients','internet-access','fusion_update_available','socket','exports','global-message','split','battery-level','sep','program-running','fusion_current_SHA','win32','SocketId','python','stringify','stdout','Client\x20disconnected:\x20','wireless-tools/wpa_cli','error','push','emit','status','git\x20describe\x20--tags\x20','statusCode','debug','fusion_battery_level','version-number','Error\x20reading\x20battery\x20:\x20\x0a','git\x20rev-parse\x20HEAD','connection','../global/fusionSettings','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','SocketVariables','wifi-fusion_storage_type','KillProgram','git\x20rev-list\x20--tags\x20--max-count=1','verbose','fusion_diagnostics_running','data','\x20because\x20\x22','fusion_latest_SHA','fusion_internet_access','fusion_wifi_access','./scripts/ReadBatt.py','Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client','wifi-connection','exec','then','config','fusion_program_running','../utils/logger','Wifi_NIC','platform','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','pop','request','fusion_gamepad_available','GET','splice','trim','child_process','fusion_latest_version','join','Connected\x20to\x20server','update-available','get'];(function(_0x5aa385,_0x4722f4){const _0x316fad=function(_0x44c513){while(--_0x44c513){_0x5aa385['push'](_0x5aa385['shift']());}};_0x316fad(++_0x4722f4);}(_0x4722,0x1e1));const _0x316f=function(_0x5aa385,_0x4722f4){_0x5aa385=_0x5aa385-0x0;let _0x316fad=_0x4722[_0x5aa385];return _0x316fad;};const config=require(_0x316f('0x13'));const logger=require(_0x316f('0x15'));const io=require('.');const FusionSettings=require(_0x316f('0x1'));const fusionProgram=require(_0x316f('0x2a'));const spawn=require(_0x316f('0x1f'))['spawn'];const internetAvailable=require('internet-available');const wpa_cli=require(_0x316f('0x3e'));const os=require('os');const shell=require('shelljs');const path=require('path');const request=require(_0x316f('0x1a'));module[_0x316f('0x31')]=async function(){logger[_0x316f('0x7')]('Configuring\x20socket\x20communication');FusionSettings[_0x316f('0x2d')]=[];var _0x2d480f=path['dirname'](__dirname)[_0x316f('0x33')](path[_0x316f('0x35')])[_0x316f('0x19')]();var _0x328b39=0x0;var _0x51adff=0xb;io['on'](_0x316f('0x0'),function(_0x104de9){FusionSettings[_0x316f('0x2d')][_0x316f('0x40')](_0x104de9);logger[_0x316f('0x45')]('Client\x20connected:\x20'+_0x104de9['id']);_0xab8e0c();_0x104de9['on'](_0x316f('0x21'),function(_0x5d190e){_0x104de9[_0x316f('0x41')](_0x316f('0x32'),{'message':_0x316f('0x22'),'type':'success'});});_0x104de9['on']('disconnect',function(_0xb98588){logger[_0x316f('0x45')](_0x316f('0x3d')+_0x104de9['id']+_0x316f('0xa')+_0xb98588+'\x22');if(FusionSettings[_0x316f('0x3')][_0x316f('0x14')])if(FusionSettings[_0x316f('0x3')][_0x316f('0x14')][_0x316f('0x39')]==_0x104de9['id'])fusionProgram[_0x316f('0x5')]();if(FusionSettings[_0x316f('0x3')][_0x316f('0x8')])if(FusionSettings[_0x316f('0x3')]['fusion_diagnostics_running'][_0x316f('0x30')]==_0x104de9['id']){logger[_0x316f('0x7')](_0x316f('0xf'));request({'url':'http://localhost:8080/api/diagnostics/stop','method':_0x316f('0x1c')},function(_0xc4be4a,_0x450044,_0x56517b){if(_0xc4be4a)logger[_0x316f('0x3f')](_0x316f('0x18')+_0xc4be4a);else{if(_0x450044[_0x316f('0x44')]==0xc8){FusionSettings[_0x316f('0x3')]['fusion_diagnostics_running']=null;}}io[_0x316f('0x25')]['emit'](_0x316f('0x2c'),FusionSettings[_0x316f('0x3')][_0x316f('0x8')]);});}var _0x548277=FusionSettings[_0x316f('0x2d')]['indexOf'](_0x104de9);FusionSettings[_0x316f('0x2d')][_0x316f('0x1d')](_0x548277,0x1);});_0x104de9['on'](_0x316f('0x3f'),function(_0x51e73e){logger['error']('Socket\x20error\x20-\x20'+_0x51e73e);});});function _0x1aacf4(){_0x41a439();_0x1fec71();_0x348a26();_0x5e75f0();_0xa89b0();_0x5408ca();_0x180ac2();}function _0x5c491b(){if(_0x328b39>=_0x51adff){logger[_0x316f('0x45')](JSON[_0x316f('0x3b')](FusionSettings[_0x316f('0x3')]));io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x34'),FusionSettings[_0x316f('0x3')][_0x316f('0x46')]);io[_0x316f('0x25')]['emit'](_0x316f('0x2e'),FusionSettings[_0x316f('0x3')][_0x316f('0xc')]);io[_0x316f('0x25')]['emit'](_0x316f('0x47'),FusionSettings[_0x316f('0x3')]['fusion_current_version']);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x23'),FusionSettings['SocketVariables'][_0x316f('0x2f')]);io['sockets'][_0x316f('0x41')]('gamepad-available',FusionSettings[_0x316f('0x3')][_0x316f('0x1b')]);io[_0x316f('0x25')][_0x316f('0x41')]('diagnostics_running',FusionSettings[_0x316f('0x3')]['fusion_diagnostics_running']);io['sockets'][_0x316f('0x41')](_0x316f('0x10'),FusionSettings[_0x316f('0x3')][_0x316f('0xd')]);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x4'),FusionSettings['Storage']['type']);io[_0x316f('0x25')]['emit'](_0x316f('0x36'),FusionSettings[_0x316f('0x3')][_0x316f('0x14')]);_0x328b39=0x0;}else{setTimeout(_0x5c491b,0x7d0);}}function _0xab8e0c(){io['sockets'][_0x316f('0x41')](_0x316f('0x34'),FusionSettings[_0x316f('0x3')][_0x316f('0x46')]);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x2e'),FusionSettings[_0x316f('0x3')]['fusion_internet_access']);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x47'),FusionSettings[_0x316f('0x3')][_0x316f('0x28')]);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x23'),FusionSettings[_0x316f('0x3')]['fusion_update_available']);io[_0x316f('0x25')]['emit'](_0x316f('0x27'),FusionSettings[_0x316f('0x3')][_0x316f('0x1b')]);io[_0x316f('0x25')]['emit']('diagnostics_running',FusionSettings[_0x316f('0x3')]['fusion_diagnostics_running']);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x10'),FusionSettings['SocketVariables'][_0x316f('0xd')]);io[_0x316f('0x25')][_0x316f('0x41')](_0x316f('0x36'),FusionSettings[_0x316f('0x3')][_0x316f('0x14')]);}function _0x41a439(){if(os[_0x316f('0x17')]()!='win32'){var _0xf98e70=_0x316f('0xe');var _0x55ce36=spawn(_0x316f('0x3a'),[_0xf98e70],{'stdio':'pipe'});_0x55ce36[_0x316f('0x3c')]['on']('data',function(_0x2eeea8){FusionSettings[_0x316f('0x3')][_0x316f('0x46')]=String(_0x2eeea8)['trim']();_0x328b39++;});_0x55ce36[_0x316f('0x2b')]['on'](_0x316f('0x9'),function(_0x75de28){logger[_0x316f('0x3f')](_0x316f('0x48')+String(_0x75de28));});}else{_0x328b39++;}}function _0x1fec71(){internetAvailable({'timeout':0x2710,'retries':0x5})[_0x316f('0x12')](function(){FusionSettings[_0x316f('0x3')][_0x316f('0xc')]=!![];_0x328b39++;})['catch'](function(){FusionSettings[_0x316f('0x3')][_0x316f('0xc')]=![];_0x328b39++;});}function _0x348a26(){shell['exec'](_0x316f('0x49'),{'silent':!![]},function(_0x48635b,_0x1a6626,_0x3b429b){(function(_0x28528b){FusionSettings['SocketVariables'][_0x316f('0x37')]=_0x28528b[_0x316f('0x1e')]();_0x328b39++;_0x5acc32();}(_0x1a6626[_0x316f('0x1e')]()));});}function _0x5acc32(){shell[_0x316f('0x11')](_0x316f('0x43')+FusionSettings[_0x316f('0x3')][_0x316f('0x37')],{'silent':!![]},function(_0xf9ada7,_0x39b618,_0x341882){(function(_0x30d8e8){FusionSettings[_0x316f('0x3')][_0x316f('0x28')]=_0x30d8e8[_0x316f('0x1e')]();_0x328b39++;_0x26e191();}(_0x39b618[_0x316f('0x1e')]()));});}function _0x26e191(){if(_0x2d480f=='Build'){shell[_0x316f('0x11')](_0x316f('0x29'),{'silent':!![]},function(_0x3aed5f,_0x59ee5c,_0x9e663f){(function(_0x15db57){_0x328b39++;_0x174628();}(_0x59ee5c['trim']()));});}else{_0x328b39++;_0x174628();}}function _0x174628(){shell[_0x316f('0x11')](_0x316f('0x6'),{'silent':!![]},function(_0x2fb6bd,_0x1908ba,_0x24c7f){(function(_0x1a9045){FusionSettings[_0x316f('0x3')][_0x316f('0xb')]=_0x1a9045['trim']();_0x328b39++;_0x52888e();}(_0x1908ba[_0x316f('0x1e')]()));});}function _0x52888e(){shell[_0x316f('0x11')](_0x316f('0x43')+FusionSettings[_0x316f('0x3')]['fusion_latest_SHA'],{'silent':!![]},function(_0x151ba9,_0x4db84d,_0x131c21){(function(_0x1695a0){FusionSettings['SocketVariables'][_0x316f('0x20')]=_0x1695a0['trim']();_0x328b39++;}(_0x4db84d[_0x316f('0x1e')]()));});}function _0x5e75f0(){if(FusionSettings[_0x316f('0x3')][_0x316f('0x37')]!=FusionSettings[_0x316f('0x3')][_0x316f('0xb')]){FusionSettings[_0x316f('0x3')][_0x316f('0x2f')]=!![];}else{FusionSettings[_0x316f('0x3')][_0x316f('0x2f')]=![];}_0x328b39++;}function _0xa89b0(){if(os[_0x316f('0x17')]()!=_0x316f('0x38')){shell[_0x316f('0x11')]('sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN',{'silent':!![]},function(_0x100a6f,_0x3bdb22,_0x40f01c){(function(_0xd01732){FusionSettings[_0x316f('0x3')]['fusion_gamepad_available']=_0xd01732[_0x316f('0x1e')]();if(!FusionSettings[_0x316f('0x3')][_0x316f('0x1b')])FusionSettings[_0x316f('0x3')][_0x316f('0x1b')]=![];else FusionSettings['SocketVariables'][_0x316f('0x1b')]=!![];_0x328b39++;}(_0x3bdb22[_0x316f('0x1e')]()));});}else{FusionSettings[_0x316f('0x3')][_0x316f('0x1b')]=![];_0x328b39++;}}function _0x5408ca(){if(os[_0x316f('0x17')]()!=_0x316f('0x38')){shell[_0x316f('0x11')](_0x316f('0x2'),{'silent':!![]},function(_0x201d14,_0x5c26e4,_0x1e2cb5){(function(_0x328973){var _0x4cf58c=_0x328973['trim']();if(_0x4cf58c){if(FusionSettings[_0x316f('0x3')][_0x316f('0x8')])FusionSettings['SocketVariables']['fusion_diagnostics_running'][_0x316f('0x26')]=_0x4cf58c;else{FusionSettings['SocketVariables'][_0x316f('0x8')]={'process':_0x4cf58c,'socket':-0x1};}}else FusionSettings[_0x316f('0x3')][_0x316f('0x8')]=null;_0x328b39++;}(_0x5c26e4[_0x316f('0x1e')]()));});}else{FusionSettings[_0x316f('0x3')]['fusion_gamepad_available']=null;_0x328b39++;}}function _0x180ac2(){wpa_cli[_0x316f('0x42')](config[_0x316f('0x24')](_0x316f('0x16')),function(_0x5ebcbd,_0x54a6a7){if(_0x5ebcbd){_0x54a6a7={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings['SocketVariables'][_0x316f('0xd')]=_0x54a6a7;_0x328b39++;});}_0x5c491b();_0x1aacf4();setInterval(function(){_0x5c491b();_0x1aacf4();},0x2710);}();