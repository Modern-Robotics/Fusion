const _0x42a9=['255875piIfJg','fusion_update_available','Build','split','wifi-connection','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','39181ODWLeo','win32','python','debug','../utils/logger','SocketVariables','spawn','request','fusion_battery_level','diagnostics_running','22sFREJM','964882SENClY','http://localhost:8080/api/diagnostics/stop','fusion_latest_version','gamepad-available','457213NcjJxq','fusion_internet_access','git\x20rev-parse\x20HEAD','1JcPyJl','KillProgram','success','stderr','fusion_current_SHA','Error\x20reading\x20battery\x20:\x20\x0a','disconnect','355646vMDGka','client-connected','config','path','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','Socket\x20error\x20-\x20','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','git\x20rev-list\x20--tags\x20--max-count=1','./../events','728879gdUMLo','fusion_diagnostics_running','fusion_current_version','fusion_wifi_access','get','\x20because\x20\x22','wifi-fusion_storage_type','version-number','2661683BiebXk','Client\x20disconnected:\x20','splice','indexOf','catch','2PYcDRq','platform','stringify','fusion_latest_SHA','fusion_gamepad_available','error','emit','2qJnFhe','exec','fusion_program_running','pipe','data','internet-available','Wifi_NIC','socket','git\x20describe\x20--tags\x20','connectedClients','verbose','./scripts/ReadBatt.py','trim','program-running','internet-access','GET','1pyAXSG','then','battery-level','update-available','dirname','sockets','sep','process','global-message'];const _0x1493=function(_0x30609d,_0x264322){_0x30609d=_0x30609d-0x9a;let _0x42a976=_0x42a9[_0x30609d];return _0x42a976;};const _0x3878cf=_0x1493;(function(_0x47d65d,_0xc5fcdc){const _0x5327c2=_0x1493;while(!![]){try{const _0x5413af=parseInt(_0x5327c2(0xe0))+parseInt(_0x5327c2(0x9e))*-parseInt(_0x5327c2(0xb2))+parseInt(_0x5327c2(0xea))*parseInt(_0x5327c2(0xab))+-parseInt(_0x5327c2(0xdc))*parseInt(_0x5327c2(0xe3))+parseInt(_0x5327c2(0xcb))+parseInt(_0x5327c2(0xd1))*-parseInt(_0x5327c2(0xdb))+parseInt(_0x5327c2(0xc2))*parseInt(_0x5327c2(0xa6));if(_0x5413af===_0xc5fcdc)break;else _0x47d65d['push'](_0x47d65d['shift']());}catch(_0x269e0d){_0x47d65d['push'](_0x47d65d['shift']());}}}(_0x42a9,0xc3aa1));const config=require(_0x3878cf(0xec)),logger=require(_0x3878cf(0xd5)),io=require('.'),FusionSettings=require('../global/fusionSettings'),fusionProgram=require('../fusionProgram'),spawn=require('child_process')[_0x3878cf(0xd7)],internetAvailable=require(_0x3878cf(0xb7)),wpa_cli=require('wireless-tools/wpa_cli'),os=require('os'),shell=require('shelljs'),path=require(_0x3878cf(0xed)),request=require(_0x3878cf(0xd8)),eventEmitter=require(_0x3878cf(0x9d));module['exports']=async function(){const _0x55cf1d=_0x3878cf;logger[_0x55cf1d(0xbc)]('Configuring\x20socket\x20communication'),FusionSettings[_0x55cf1d(0xbb)]=[];var _0x2facd8=path[_0x55cf1d(0xc6)](__dirname)[_0x55cf1d(0xce)](path[_0x55cf1d(0xc8)])['pop'](),_0x5cfe3f=0x0,_0x3b3ad5=0xb;io['on']('connection',function(_0xd7ba95){const _0x32ddb7=_0x55cf1d;FusionSettings[_0x32ddb7(0xbb)]['push'](_0xd7ba95),logger['debug']('Client\x20connected:\x20'+_0xd7ba95['id']),_0x3ec731(),_0xd7ba95['on']('join',function(_0xa0f305){const _0x5e9d62=_0x32ddb7;_0xd7ba95[_0x5e9d62(0xb1)](_0x5e9d62(0xca),{'message':'Connected\x20to\x20server','type':_0x5e9d62(0xe5)}),eventEmitter['emit'](_0x5e9d62(0xeb));}),_0xd7ba95['on'](_0x32ddb7(0xe9),function(_0x184f76){const _0x26a5bc=_0x32ddb7;logger['debug'](_0x26a5bc(0xa7)+_0xd7ba95['id']+_0x26a5bc(0xa3)+_0x184f76+'\x22');if(FusionSettings[_0x26a5bc(0xd6)][_0x26a5bc(0xb4)]){if(FusionSettings[_0x26a5bc(0xd6)][_0x26a5bc(0xb4)]['SocketId']==_0xd7ba95['id'])fusionProgram[_0x26a5bc(0xe4)]();}if(FusionSettings[_0x26a5bc(0xd6)]['fusion_diagnostics_running'])FusionSettings[_0x26a5bc(0xd6)][_0x26a5bc(0x9f)][_0x26a5bc(0xb9)]==_0xd7ba95['id']&&(logger[_0x26a5bc(0xbc)]('Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client'),request({'url':_0x26a5bc(0xdd),'method':_0x26a5bc(0xc1)},function(_0x25daaa,_0x568290,_0x4a436d){const _0x39d8d0=_0x26a5bc;if(_0x25daaa)logger[_0x39d8d0(0xb0)](_0x39d8d0(0xee)+_0x25daaa);else _0x568290['statusCode']==0xc8&&(FusionSettings[_0x39d8d0(0xd6)][_0x39d8d0(0x9f)]=null);io[_0x39d8d0(0xc7)][_0x39d8d0(0xb1)](_0x39d8d0(0xda),FusionSettings[_0x39d8d0(0xd6)][_0x39d8d0(0x9f)]);}));var _0x224af6=FusionSettings['connectedClients'][_0x26a5bc(0xa9)](_0xd7ba95);FusionSettings['connectedClients'][_0x26a5bc(0xa8)](_0x224af6,0x1),eventEmitter[_0x26a5bc(0xb1)]('client-disconnected');}),_0xd7ba95['on'](_0x32ddb7(0xb0),function(_0x2673c0){const _0x732ed9=_0x32ddb7;logger[_0x732ed9(0xb0)](_0x732ed9(0x9a)+_0x2673c0);});});function _0x15a7eb(){_0x1d0f16(),_0x2110c7(),_0xea0d17(),_0x385284(),_0x231596(),_0x28107a(),_0xb5e006();}function _0x29454a(){const _0x3a1cb8=_0x55cf1d;_0x5cfe3f>=_0x3b3ad5?(logger[_0x3a1cb8(0xd4)](JSON[_0x3a1cb8(0xad)](FusionSettings[_0x3a1cb8(0xd6)])),io['sockets'][_0x3a1cb8(0xb1)](_0x3a1cb8(0xc4),FusionSettings['SocketVariables'][_0x3a1cb8(0xd9)]),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xc0),FusionSettings['SocketVariables'][_0x3a1cb8(0xe1)]),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xa5),FusionSettings[_0x3a1cb8(0xd6)]['fusion_current_version']),io[_0x3a1cb8(0xc7)]['emit'](_0x3a1cb8(0xc5),FusionSettings[_0x3a1cb8(0xd6)][_0x3a1cb8(0xcc)]),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xdf),FusionSettings[_0x3a1cb8(0xd6)][_0x3a1cb8(0xaf)]),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xda),FusionSettings['SocketVariables'][_0x3a1cb8(0x9f)]),io[_0x3a1cb8(0xc7)]['emit']('wifi-connection',FusionSettings[_0x3a1cb8(0xd6)]['fusion_wifi_access']),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xa4),FusionSettings['Storage']['type']),io[_0x3a1cb8(0xc7)][_0x3a1cb8(0xb1)](_0x3a1cb8(0xbf),FusionSettings['SocketVariables'][_0x3a1cb8(0xb4)]),_0x5cfe3f=0x0):setTimeout(_0x29454a,0x7d0);}function _0x3ec731(){const _0x2e0e48=_0x55cf1d;io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)]('battery-level',FusionSettings['SocketVariables'][_0x2e0e48(0xd9)]),io[_0x2e0e48(0xc7)]['emit'](_0x2e0e48(0xc0),FusionSettings[_0x2e0e48(0xd6)][_0x2e0e48(0xe1)]),io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)]('version-number',FusionSettings['SocketVariables'][_0x2e0e48(0xa0)]),io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)](_0x2e0e48(0xc5),FusionSettings[_0x2e0e48(0xd6)][_0x2e0e48(0xcc)]),io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)](_0x2e0e48(0xdf),FusionSettings[_0x2e0e48(0xd6)][_0x2e0e48(0xaf)]),io['sockets'][_0x2e0e48(0xb1)]('diagnostics_running',FusionSettings[_0x2e0e48(0xd6)][_0x2e0e48(0x9f)]),io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)](_0x2e0e48(0xcf),FusionSettings[_0x2e0e48(0xd6)]['fusion_wifi_access']),io[_0x2e0e48(0xc7)][_0x2e0e48(0xb1)](_0x2e0e48(0xbf),FusionSettings[_0x2e0e48(0xd6)]['fusion_program_running']);}function _0x1d0f16(){const _0x4b0700=_0x55cf1d;if(os['platform']()!='win32'){var _0x64532d=_0x4b0700(0xbd),_0x5f0a2a=spawn(_0x4b0700(0xd3),[_0x64532d],{'stdio':_0x4b0700(0xb5)});_0x5f0a2a['stdout']['on']('data',function(_0x3323cd){const _0x3218e8=_0x4b0700;FusionSettings[_0x3218e8(0xd6)][_0x3218e8(0xd9)]=String(_0x3323cd)[_0x3218e8(0xbe)](),_0x5cfe3f++;}),_0x5f0a2a[_0x4b0700(0xe6)]['on'](_0x4b0700(0xb6),function(_0x1f50ce){const _0x354069=_0x4b0700;logger[_0x354069(0xb0)](_0x354069(0xe8)+String(_0x1f50ce));});}else _0x5cfe3f++;}function _0x2110c7(){const _0x3dba48=_0x55cf1d;internetAvailable({'timeout':0x2710,'retries':0x5})[_0x3dba48(0xc3)](function(){const _0xe7cf06=_0x3dba48;FusionSettings['SocketVariables'][_0xe7cf06(0xe1)]=!![],_0x5cfe3f++;})[_0x3dba48(0xaa)](function(){const _0x34a5eb=_0x3dba48;FusionSettings[_0x34a5eb(0xd6)]['fusion_internet_access']=![],_0x5cfe3f++;});}function _0xea0d17(){const _0x3c5436=_0x55cf1d;shell[_0x3c5436(0xb3)](_0x3c5436(0xe2),{'silent':!![]},function(_0x1daef3,_0x523f9a,_0x29239b){const _0x1e3f3a=_0x3c5436;(function(_0x4cac91){const _0x54f795=_0x1493;FusionSettings[_0x54f795(0xd6)]['fusion_current_SHA']=_0x4cac91[_0x54f795(0xbe)](),_0x5cfe3f++,_0x1f7041();}(_0x523f9a[_0x1e3f3a(0xbe)]()));});}function _0x1f7041(){const _0x14f238=_0x55cf1d;shell[_0x14f238(0xb3)](_0x14f238(0xba)+FusionSettings[_0x14f238(0xd6)][_0x14f238(0xe7)],{'silent':!![]},function(_0x47effb,_0x37b597,_0x2f78ce){const _0x450688=_0x14f238;(function(_0x115012){const _0x2e4478=_0x1493;FusionSettings[_0x2e4478(0xd6)]['fusion_current_version']=_0x115012[_0x2e4478(0xbe)](),_0x5cfe3f++,_0x2029ed();}(_0x37b597[_0x450688(0xbe)]()));});}function _0x2029ed(){const _0x27d42e=_0x55cf1d;_0x2facd8==_0x27d42e(0xcd)?shell[_0x27d42e(0xb3)]('git\x20fetch',{'silent':!![]},function(_0x1c71b0,_0x14387f,_0x495c53){const _0x351de6=_0x27d42e;(function(_0x503559){_0x5cfe3f++,_0xa4eafb();}(_0x14387f[_0x351de6(0xbe)]()));}):(_0x5cfe3f++,_0xa4eafb());}function _0xa4eafb(){const _0x394834=_0x55cf1d;shell[_0x394834(0xb3)](_0x394834(0x9c),{'silent':!![]},function(_0x3ac835,_0x1aae0a,_0x3aa658){(function(_0x2dfa9f){const _0xe47d95=_0x1493;FusionSettings[_0xe47d95(0xd6)][_0xe47d95(0xae)]=_0x2dfa9f[_0xe47d95(0xbe)](),_0x5cfe3f++,_0x38e6b1();}(_0x1aae0a['trim']()));});}function _0x38e6b1(){const _0x575881=_0x55cf1d;shell[_0x575881(0xb3)](_0x575881(0xba)+FusionSettings[_0x575881(0xd6)][_0x575881(0xae)],{'silent':!![]},function(_0x203e73,_0xa523f5,_0x17e6e8){const _0x423da0=_0x575881;(function(_0x1b228e){const _0xeb0f3c=_0x1493;FusionSettings[_0xeb0f3c(0xd6)][_0xeb0f3c(0xde)]=_0x1b228e[_0xeb0f3c(0xbe)](),_0x5cfe3f++;}(_0xa523f5[_0x423da0(0xbe)]()));});}function _0x385284(){const _0x410690=_0x55cf1d;FusionSettings[_0x410690(0xd6)][_0x410690(0xe7)]!=FusionSettings[_0x410690(0xd6)][_0x410690(0xae)]?FusionSettings[_0x410690(0xd6)][_0x410690(0xcc)]=!![]:FusionSettings['SocketVariables'][_0x410690(0xcc)]=![],_0x5cfe3f++;}function _0x231596(){const _0x4ae855=_0x55cf1d;os['platform']()!=_0x4ae855(0xd2)?shell[_0x4ae855(0xb3)](_0x4ae855(0xd0),{'silent':!![]},function(_0x3e97a7,_0x3023a4,_0x439bb5){const _0x3e30e5=_0x4ae855;(function(_0x11755a){const _0x454c8d=_0x1493;FusionSettings[_0x454c8d(0xd6)][_0x454c8d(0xaf)]=_0x11755a[_0x454c8d(0xbe)]();if(!FusionSettings[_0x454c8d(0xd6)][_0x454c8d(0xaf)])FusionSettings[_0x454c8d(0xd6)][_0x454c8d(0xaf)]=![];else FusionSettings[_0x454c8d(0xd6)]['fusion_gamepad_available']=!![];_0x5cfe3f++;}(_0x3023a4[_0x3e30e5(0xbe)]()));}):(FusionSettings[_0x4ae855(0xd6)][_0x4ae855(0xaf)]=![],_0x5cfe3f++);}function _0x28107a(){const _0x383500=_0x55cf1d;os[_0x383500(0xac)]()!=_0x383500(0xd2)?shell[_0x383500(0xb3)](_0x383500(0x9b),{'silent':!![]},function(_0x1f460a,_0x41172b,_0x18f76f){const _0x4a6f68=_0x383500;(function(_0x314818){const _0x1bb479=_0x1493;var _0x1e0fae=_0x314818[_0x1bb479(0xbe)]();if(_0x1e0fae){if(FusionSettings[_0x1bb479(0xd6)][_0x1bb479(0x9f)])FusionSettings[_0x1bb479(0xd6)][_0x1bb479(0x9f)][_0x1bb479(0xc9)]=_0x1e0fae;else FusionSettings['SocketVariables'][_0x1bb479(0x9f)]={'process':_0x1e0fae,'socket':-0x1};}else FusionSettings[_0x1bb479(0xd6)]['fusion_diagnostics_running']=null;_0x5cfe3f++;}(_0x41172b[_0x4a6f68(0xbe)]()));}):(FusionSettings[_0x383500(0xd6)][_0x383500(0xaf)]=null,_0x5cfe3f++);}function _0xb5e006(){const _0x59e5db=_0x55cf1d;wpa_cli['status'](config[_0x59e5db(0xa2)](_0x59e5db(0xb8)),function(_0x394ddf,_0x1594f3){const _0x5e33f8=_0x59e5db;_0x394ddf&&(_0x1594f3={'ssid':undefined,'ip':undefined,'mac':undefined}),FusionSettings[_0x5e33f8(0xd6)][_0x5e33f8(0xa1)]=_0x1594f3,_0x5cfe3f++;});}_0x29454a(),_0x15a7eb(),setInterval(function(){_0x29454a(),_0x15a7eb();},0x2710);}();