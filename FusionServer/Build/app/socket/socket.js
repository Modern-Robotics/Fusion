const _0x4afc=['fusion_latest_version','connection','Client\x20connected:\x20','fusion_current_version','git\x20rev-parse\x20HEAD','win32','indexOf','Client\x20disconnected:\x20','join','python','Wifi_NIC','battery-level','KillProgram','Error\x20reading\x20battery\x20:\x20\x0a','exports','exec','SocketVariables','fusion_program_running','verbose','platform','program-running','fusion_internet_access','splice','wifi-connection','fusion_current_SHA','statusCode','stringify','fusion_diagnostics_running','../global/fusionSettings','stdout','../fusionProgram','../utils/logger','fusion_wifi_access','sockets','config','Connected\x20to\x20server','internet-access','SocketId','diagnostics_running','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','version-number','trim','spawn','git\x20rev-list\x20--tags\x20--max-count=1','http://localhost:8080/api/diagnostics/stop','fusion_battery_level','fusion_gamepad_available','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','then','sep','status','git\x20describe\x20--tags\x20','Storage','Configuring\x20socket\x20communication','./scripts/ReadBatt.py','Build','debug','dirname','connectedClients','internet-available','child_process','GET','error','fusion_update_available','type','get','update-available','disconnect','split','socket','wireless-tools/wpa_cli','wifi-fusion_storage_type','gamepad-available','emit','data'];(function(_0xf175fe,_0x4afcfb){const _0xc15377=function(_0x157271){while(--_0x157271){_0xf175fe['push'](_0xf175fe['shift']());}};_0xc15377(++_0x4afcfb);}(_0x4afc,0xa3));const _0xc153=function(_0xf175fe,_0x4afcfb){_0xf175fe=_0xf175fe-0x0;let _0xc15377=_0x4afc[_0xf175fe];return _0xc15377;};const config=require(_0xc153('0x15'));const logger=require(_0xc153('0x12'));const io=require('.');const FusionSettings=require(_0xc153('0xf'));const fusionProgram=require(_0xc153('0x11'));const spawn=require(_0xc153('0x2f'))[_0xc153('0x1d')];const internetAvailable=require(_0xc153('0x2e'));const wpa_cli=require(_0xc153('0x39'));const os=require('os');const shell=require('shelljs');const path=require('path');const request=require('request');module[_0xc153('0x1')]=async function(){logger[_0xc153('0x5')](_0xc153('0x28'));FusionSettings[_0xc153('0x2d')]=[];var _0x180672=path[_0xc153('0x2c')](__dirname)[_0xc153('0x37')](path[_0xc153('0x24')])['pop']();var _0x4634c7=0x0;var _0x3bcd07=0xb;io['on'](_0xc153('0x3f'),function(_0x7f2971){FusionSettings[_0xc153('0x2d')]['push'](_0x7f2971);logger[_0xc153('0x2b')](_0xc153('0x40')+_0x7f2971['id']);_0x54b386();_0x7f2971['on'](_0xc153('0x46'),function(_0x52bf2c){_0x7f2971[_0xc153('0x3c')]('global-message',{'message':_0xc153('0x16'),'type':'success'});});_0x7f2971['on'](_0xc153('0x36'),function(_0x1108f3){logger['debug'](_0xc153('0x45')+_0x7f2971['id']+'\x20because\x20\x22'+_0x1108f3+'\x22');if(FusionSettings['SocketVariables'][_0xc153('0x4')])if(FusionSettings[_0xc153('0x3')][_0xc153('0x4')][_0xc153('0x18')]==_0x7f2971['id'])fusionProgram[_0xc153('0x4a')]();if(FusionSettings[_0xc153('0x3')][_0xc153('0xe')])if(FusionSettings['SocketVariables'][_0xc153('0xe')][_0xc153('0x38')]==_0x7f2971['id']){logger[_0xc153('0x5')]('Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client');request({'url':_0xc153('0x1f'),'method':_0xc153('0x30')},function(_0x2adc4f,_0x9d175c,_0x5bb03d){if(_0x2adc4f)logger[_0xc153('0x31')]('Error\x20terminating\x20diagnostic\x20tools\x20:\x20'+_0x2adc4f);else{if(_0x9d175c[_0xc153('0xc')]==0xc8){FusionSettings['SocketVariables'][_0xc153('0xe')]=null;}}io[_0xc153('0x14')][_0xc153('0x3c')]('diagnostics_running',FusionSettings['SocketVariables'][_0xc153('0xe')]);});}var _0x4c3a11=FusionSettings['connectedClients'][_0xc153('0x44')](_0x7f2971);FusionSettings[_0xc153('0x2d')][_0xc153('0x9')](_0x4c3a11,0x1);});_0x7f2971['on'](_0xc153('0x31'),function(_0x38c4a6){logger['error']('Socket\x20error\x20-\x20'+_0x38c4a6);});});function _0x15f566(){_0x4e70aa();_0x3dd5a6();_0x2bebc5();_0x4f5faa();_0x23bc92();_0x291567();_0x2c609b();}function _0x14d5e5(){if(_0x4634c7>=_0x3bcd07){logger['debug'](JSON[_0xc153('0xd')](FusionSettings[_0xc153('0x3')]));io[_0xc153('0x14')][_0xc153('0x3c')]('battery-level',FusionSettings[_0xc153('0x3')][_0xc153('0x20')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x17'),FusionSettings[_0xc153('0x3')][_0xc153('0x8')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x1b'),FusionSettings['SocketVariables'][_0xc153('0x41')]);io['sockets'][_0xc153('0x3c')](_0xc153('0x35'),FusionSettings[_0xc153('0x3')][_0xc153('0x32')]);io[_0xc153('0x14')][_0xc153('0x3c')]('gamepad-available',FusionSettings['SocketVariables'][_0xc153('0x21')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x19'),FusionSettings[_0xc153('0x3')]['fusion_diagnostics_running']);io[_0xc153('0x14')]['emit'](_0xc153('0xa'),FusionSettings['SocketVariables'][_0xc153('0x13')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x3a'),FusionSettings[_0xc153('0x27')][_0xc153('0x33')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x7'),FusionSettings[_0xc153('0x3')][_0xc153('0x4')]);_0x4634c7=0x0;}else{setTimeout(_0x14d5e5,0x7d0);}}function _0x54b386(){io['sockets']['emit'](_0xc153('0x49'),FusionSettings[_0xc153('0x3')][_0xc153('0x20')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x17'),FusionSettings[_0xc153('0x3')]['fusion_internet_access']);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x1b'),FusionSettings[_0xc153('0x3')][_0xc153('0x41')]);io['sockets'][_0xc153('0x3c')]('update-available',FusionSettings['SocketVariables'][_0xc153('0x32')]);io['sockets'][_0xc153('0x3c')](_0xc153('0x3b'),FusionSettings[_0xc153('0x3')]['fusion_gamepad_available']);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x19'),FusionSettings['SocketVariables'][_0xc153('0xe')]);io[_0xc153('0x14')][_0xc153('0x3c')]('wifi-connection',FusionSettings[_0xc153('0x3')][_0xc153('0x13')]);io[_0xc153('0x14')][_0xc153('0x3c')](_0xc153('0x7'),FusionSettings['SocketVariables']['fusion_program_running']);}function _0x4e70aa(){if(os[_0xc153('0x6')]()!=_0xc153('0x43')){var _0x13ff08=_0xc153('0x29');var _0x5720c1=spawn(_0xc153('0x47'),[_0x13ff08],{'stdio':'pipe'});_0x5720c1[_0xc153('0x10')]['on'](_0xc153('0x3d'),function(_0x6bc32b){FusionSettings[_0xc153('0x3')][_0xc153('0x20')]=String(_0x6bc32b)['trim']();_0x4634c7++;});_0x5720c1['stderr']['on'](_0xc153('0x3d'),function(_0x2be982){logger[_0xc153('0x31')](_0xc153('0x0')+String(_0x2be982));});}else{_0x4634c7++;}}function _0x3dd5a6(){internetAvailable({'timeout':0x2710,'retries':0x5})[_0xc153('0x23')](function(){FusionSettings['SocketVariables'][_0xc153('0x8')]=!![];_0x4634c7++;})['catch'](function(){FusionSettings[_0xc153('0x3')][_0xc153('0x8')]=![];_0x4634c7++;});}function _0x2bebc5(){shell[_0xc153('0x2')](_0xc153('0x42'),{'silent':!![]},function(_0x448c1b,_0x3fd2aa,_0x652ccf){(function(_0x366348){FusionSettings['SocketVariables'][_0xc153('0xb')]=_0x366348[_0xc153('0x1c')]();_0x4634c7++;_0x1945b8();}(_0x3fd2aa['trim']()));});}function _0x1945b8(){shell[_0xc153('0x2')](_0xc153('0x26')+FusionSettings[_0xc153('0x3')][_0xc153('0xb')],{'silent':!![]},function(_0x287528,_0x463546,_0x81e2be){(function(_0x48b730){FusionSettings['SocketVariables'][_0xc153('0x41')]=_0x48b730['trim']();_0x4634c7++;_0x1053a8();}(_0x463546[_0xc153('0x1c')]()));});}function _0x1053a8(){if(_0x180672==_0xc153('0x2a')){shell[_0xc153('0x2')]('git\x20fetch',{'silent':!![]},function(_0x1363b4,_0x35c7c3,_0x5942e2){(function(_0x3b8afe){_0x4634c7++;_0x88d3e4();}(_0x35c7c3[_0xc153('0x1c')]()));});}else{_0x4634c7++;_0x88d3e4();}}function _0x88d3e4(){shell['exec'](_0xc153('0x1e'),{'silent':!![]},function(_0x2e15f3,_0x5e3d74,_0x2ed583){(function(_0x485853){FusionSettings[_0xc153('0x3')]['fusion_latest_SHA']=_0x485853[_0xc153('0x1c')]();_0x4634c7++;_0x584063();}(_0x5e3d74[_0xc153('0x1c')]()));});}function _0x584063(){shell[_0xc153('0x2')](_0xc153('0x26')+FusionSettings[_0xc153('0x3')]['fusion_latest_SHA'],{'silent':!![]},function(_0x4596d6,_0x4b7950,_0x21c71b){(function(_0x274ac6){FusionSettings['SocketVariables'][_0xc153('0x3e')]=_0x274ac6['trim']();_0x4634c7++;}(_0x4b7950[_0xc153('0x1c')]()));});}function _0x4f5faa(){if(FusionSettings[_0xc153('0x3')][_0xc153('0xb')]!=FusionSettings[_0xc153('0x3')]['fusion_latest_SHA']){FusionSettings[_0xc153('0x3')][_0xc153('0x32')]=!![];}else{FusionSettings['SocketVariables'][_0xc153('0x32')]=![];}_0x4634c7++;}function _0x23bc92(){if(os['platform']()!=_0xc153('0x43')){shell['exec'](_0xc153('0x1a'),{'silent':!![]},function(_0x4fce5c,_0x5c31cd,_0x2cce4e){(function(_0x1c6e65){FusionSettings[_0xc153('0x3')][_0xc153('0x21')]=_0x1c6e65[_0xc153('0x1c')]();if(!FusionSettings['SocketVariables']['fusion_gamepad_available'])FusionSettings[_0xc153('0x3')][_0xc153('0x21')]=![];else FusionSettings['SocketVariables'][_0xc153('0x21')]=!![];_0x4634c7++;}(_0x5c31cd[_0xc153('0x1c')]()));});}else{FusionSettings['SocketVariables'][_0xc153('0x21')]=![];_0x4634c7++;}}function _0x291567(){if(os[_0xc153('0x6')]()!='win32'){shell[_0xc153('0x2')](_0xc153('0x22'),{'silent':!![]},function(_0x121bc1,_0x2ab91a,_0x1349fb){(function(_0x36f40a){var _0x1907a0=_0x36f40a[_0xc153('0x1c')]();if(_0x1907a0){if(FusionSettings[_0xc153('0x3')][_0xc153('0xe')])FusionSettings[_0xc153('0x3')][_0xc153('0xe')]['process']=_0x1907a0;else{FusionSettings[_0xc153('0x3')]['fusion_diagnostics_running']={'process':_0x1907a0,'socket':-0x1};}}else FusionSettings[_0xc153('0x3')][_0xc153('0xe')]=null;_0x4634c7++;}(_0x2ab91a[_0xc153('0x1c')]()));});}else{FusionSettings[_0xc153('0x3')][_0xc153('0x21')]=null;_0x4634c7++;}}function _0x2c609b(){wpa_cli[_0xc153('0x25')](config[_0xc153('0x34')](_0xc153('0x48')),function(_0x342fe8,_0x56983a){if(_0x342fe8){_0x56983a={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0xc153('0x3')]['fusion_wifi_access']=_0x56983a;_0x4634c7++;});}_0x14d5e5();_0x15f566();setInterval(function(){_0x14d5e5();_0x15f566();},0x2710);}();