const _0x3ae0=['indexOf','fusion_current_SHA','diagnostics_running','Client\x20connected:\x20','Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client','stringify','fusion_battery_level','gamepad-available','debug','success','./scripts/ReadBatt.py','fusion_program_running','splice','exports','Configuring\x20socket\x20communication','Client\x20disconnected:\x20','GET','win32','verbose','shelljs','type','Storage','trim','update-available','spawn','internet-access','wifi-fusion_storage_type','../fusionProgram','sep','get','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','connection','join','statusCode','stderr','fusion_latest_SHA','pop','emit','../utils/logger','connectedClients','Error\x20reading\x20battery\x20:\x20\x0a','Wifi_NIC','data','SocketId','KillProgram','push','SocketVariables','child_process','fusion_diagnostics_running','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','socket','config','global-message','error','exec','process','platform','catch','git\x20rev-list\x20--tags\x20--max-count=1','fusion_gamepad_available','wireless-tools/wpa_cli','Build','wifi-connection','fusion_wifi_access','pipe','disconnect','battery-level','git\x20fetch','fusion_update_available','path','version-number','fusion_current_version','program-running','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','request','sockets','dirname','Socket\x20error\x20-\x20','fusion_internet_access','stdout'];(function(_0x10eda4,_0x3ae064){const _0x3816b0=function(_0x15b7fa){while(--_0x15b7fa){_0x10eda4['push'](_0x10eda4['shift']());}};_0x3816b0(++_0x3ae064);}(_0x3ae0,0xab));const _0x3816=function(_0x10eda4,_0x3ae064){_0x10eda4=_0x10eda4-0x0;let _0x3816b0=_0x3ae0[_0x10eda4];return _0x3816b0;};const config=require(_0x3816('0x28'));const logger=require(_0x3816('0x1b'));const io=require('.');const FusionSettings=require('../global/fusionSettings');const fusionProgram=require(_0x3816('0x10'));const spawn=require(_0x3816('0x24'))[_0x3816('0xd')];const internetAvailable=require('internet-available');const wpa_cli=require(_0x3816('0x31'));const os=require('os');const shell=require(_0x3816('0x8'));const path=require(_0x3816('0x3a'));const request=require(_0x3816('0x3f'));module[_0x3816('0x2')]=async function(){logger[_0x3816('0x7')](_0x3816('0x3'));FusionSettings[_0x3816('0x1c')]=[];var _0x43d637=path[_0x3816('0x41')](__dirname)['split'](path[_0x3816('0x11')])[_0x3816('0x19')]();var _0x5eef0b=0x0;var _0x519f34=0xb;io['on'](_0x3816('0x14'),function(_0x33a3df){FusionSettings['connectedClients'][_0x3816('0x22')](_0x33a3df);logger['debug'](_0x3816('0x48')+_0x33a3df['id']);_0x49edaf();_0x33a3df['on'](_0x3816('0x15'),function(_0xd20ac4){_0x33a3df[_0x3816('0x1a')](_0x3816('0x29'),{'message':'Connected\x20to\x20server','type':_0x3816('0x4e')});});_0x33a3df['on'](_0x3816('0x36'),function(_0x45fb39){logger[_0x3816('0x4d')](_0x3816('0x4')+_0x33a3df['id']+'\x20because\x20\x22'+_0x45fb39+'\x22');if(FusionSettings['SocketVariables'][_0x3816('0x0')])if(FusionSettings[_0x3816('0x23')]['fusion_program_running'][_0x3816('0x20')]==_0x33a3df['id'])fusionProgram[_0x3816('0x21')]();if(FusionSettings['SocketVariables'][_0x3816('0x25')])if(FusionSettings[_0x3816('0x23')][_0x3816('0x25')][_0x3816('0x27')]==_0x33a3df['id']){logger[_0x3816('0x7')](_0x3816('0x49'));request({'url':'http://localhost:8080/api/diagnostics/stop','method':_0x3816('0x5')},function(_0x43b4e7,_0x9c688f,_0x38eb5b){if(_0x43b4e7)logger['error'](_0x3816('0x3e')+_0x43b4e7);else{if(_0x9c688f[_0x3816('0x16')]==0xc8){FusionSettings['SocketVariables'][_0x3816('0x25')]=null;}}io[_0x3816('0x40')]['emit']('diagnostics_running',FusionSettings['SocketVariables'][_0x3816('0x25')]);});}var _0x32fd7e=FusionSettings['connectedClients'][_0x3816('0x45')](_0x33a3df);FusionSettings[_0x3816('0x1c')][_0x3816('0x1')](_0x32fd7e,0x1);});_0x33a3df['on']('error',function(_0x3c7e38){logger[_0x3816('0x2a')](_0x3816('0x42')+_0x3c7e38);});});function _0x50f183(){_0x3d7765();_0x4afb59();_0x446dd1();_0x3b9a9c();_0x1b1a6e();_0x22c276();_0x20c957();}function _0x1a8e60(){if(_0x5eef0b>=_0x519f34){logger['debug'](JSON[_0x3816('0x4a')](FusionSettings[_0x3816('0x23')]));io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x37'),FusionSettings[_0x3816('0x23')][_0x3816('0x4b')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0xe'),FusionSettings[_0x3816('0x23')][_0x3816('0x43')]);io[_0x3816('0x40')][_0x3816('0x1a')]('version-number',FusionSettings[_0x3816('0x23')][_0x3816('0x3c')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0xc'),FusionSettings[_0x3816('0x23')][_0x3816('0x39')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x4c'),FusionSettings[_0x3816('0x23')]['fusion_gamepad_available']);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x47'),FusionSettings['SocketVariables']['fusion_diagnostics_running']);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x33'),FusionSettings[_0x3816('0x23')][_0x3816('0x34')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0xf'),FusionSettings[_0x3816('0xa')][_0x3816('0x9')]);io[_0x3816('0x40')][_0x3816('0x1a')]('program-running',FusionSettings[_0x3816('0x23')]['fusion_program_running']);_0x5eef0b=0x0;}else{setTimeout(_0x1a8e60,0x7d0);}}function _0x49edaf(){io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x37'),FusionSettings['SocketVariables'][_0x3816('0x4b')]);io[_0x3816('0x40')]['emit']('internet-access',FusionSettings['SocketVariables'][_0x3816('0x43')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x3b'),FusionSettings[_0x3816('0x23')][_0x3816('0x3c')]);io[_0x3816('0x40')]['emit'](_0x3816('0xc'),FusionSettings[_0x3816('0x23')][_0x3816('0x39')]);io[_0x3816('0x40')]['emit']('gamepad-available',FusionSettings['SocketVariables'][_0x3816('0x30')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x47'),FusionSettings[_0x3816('0x23')][_0x3816('0x25')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x33'),FusionSettings[_0x3816('0x23')][_0x3816('0x34')]);io[_0x3816('0x40')][_0x3816('0x1a')](_0x3816('0x3d'),FusionSettings[_0x3816('0x23')][_0x3816('0x0')]);}function _0x3d7765(){if(os[_0x3816('0x2d')]()!=_0x3816('0x6')){var _0x1bd59f=_0x3816('0x4f');var _0x5c2210=spawn('python',[_0x1bd59f],{'stdio':_0x3816('0x35')});_0x5c2210[_0x3816('0x44')]['on'](_0x3816('0x1f'),function(_0x1d543a){FusionSettings[_0x3816('0x23')][_0x3816('0x4b')]=String(_0x1d543a)[_0x3816('0xb')]();_0x5eef0b++;});_0x5c2210[_0x3816('0x17')]['on'](_0x3816('0x1f'),function(_0x5b1170){logger[_0x3816('0x2a')](_0x3816('0x1d')+String(_0x5b1170));});}else{_0x5eef0b++;}}function _0x4afb59(){internetAvailable({'timeout':0x2710,'retries':0x5})['then'](function(){FusionSettings['SocketVariables']['fusion_internet_access']=!![];_0x5eef0b++;})[_0x3816('0x2e')](function(){FusionSettings[_0x3816('0x23')][_0x3816('0x43')]=![];_0x5eef0b++;});}function _0x446dd1(){shell[_0x3816('0x2b')]('git\x20rev-parse\x20HEAD',{'silent':!![]},function(_0x1c6c51,_0x19b2fe,_0x4bff55){(function(_0x36cbcc){FusionSettings['SocketVariables'][_0x3816('0x46')]=_0x36cbcc[_0x3816('0xb')]();_0x5eef0b++;_0xc88224();}(_0x19b2fe['trim']()));});}function _0xc88224(){shell[_0x3816('0x2b')]('git\x20describe\x20--tags\x20'+FusionSettings[_0x3816('0x23')]['fusion_current_SHA'],{'silent':!![]},function(_0x43348e,_0x29bf20,_0x5a0d87){(function(_0x35f493){FusionSettings[_0x3816('0x23')][_0x3816('0x3c')]=_0x35f493['trim']();_0x5eef0b++;_0x2708bc();}(_0x29bf20[_0x3816('0xb')]()));});}function _0x2708bc(){if(_0x43d637==_0x3816('0x32')){shell['exec'](_0x3816('0x38'),{'silent':!![]},function(_0x4900fb,_0x5bd730,_0x18ba94){(function(_0x2f1460){_0x5eef0b++;_0x2540d1();}(_0x5bd730[_0x3816('0xb')]()));});}else{_0x5eef0b++;_0x2540d1();}}function _0x2540d1(){shell['exec'](_0x3816('0x2f'),{'silent':!![]},function(_0x1eb0b4,_0x319332,_0x11512f){(function(_0x2fb18e){FusionSettings['SocketVariables'][_0x3816('0x18')]=_0x2fb18e[_0x3816('0xb')]();_0x5eef0b++;_0x31d4ed();}(_0x319332[_0x3816('0xb')]()));});}function _0x31d4ed(){shell[_0x3816('0x2b')]('git\x20describe\x20--tags\x20'+FusionSettings[_0x3816('0x23')]['fusion_latest_SHA'],{'silent':!![]},function(_0x1a9682,_0x384d57,_0x89a8f9){(function(_0x2da827){FusionSettings['SocketVariables']['fusion_latest_version']=_0x2da827[_0x3816('0xb')]();_0x5eef0b++;}(_0x384d57['trim']()));});}function _0x3b9a9c(){if(FusionSettings[_0x3816('0x23')][_0x3816('0x46')]!=FusionSettings[_0x3816('0x23')]['fusion_latest_SHA']){FusionSettings['SocketVariables'][_0x3816('0x39')]=!![];}else{FusionSettings['SocketVariables'][_0x3816('0x39')]=![];}_0x5eef0b++;}function _0x1b1a6e(){if(os[_0x3816('0x2d')]()!=_0x3816('0x6')){shell[_0x3816('0x2b')](_0x3816('0x13'),{'silent':!![]},function(_0x15dd34,_0xabe7f5,_0x5ec309){(function(_0x828a32){FusionSettings[_0x3816('0x23')][_0x3816('0x30')]=_0x828a32[_0x3816('0xb')]();if(!FusionSettings[_0x3816('0x23')][_0x3816('0x30')])FusionSettings[_0x3816('0x23')][_0x3816('0x30')]=![];else FusionSettings[_0x3816('0x23')][_0x3816('0x30')]=!![];_0x5eef0b++;}(_0xabe7f5['trim']()));});}else{FusionSettings['SocketVariables']['fusion_gamepad_available']=![];_0x5eef0b++;}}function _0x22c276(){if(os[_0x3816('0x2d')]()!=_0x3816('0x6')){shell['exec'](_0x3816('0x26'),{'silent':!![]},function(_0x3d5bb4,_0xa608c8,_0x52f8e9){(function(_0x160889){var _0x1dd74f=_0x160889[_0x3816('0xb')]();if(_0x1dd74f){if(FusionSettings[_0x3816('0x23')][_0x3816('0x25')])FusionSettings[_0x3816('0x23')][_0x3816('0x25')][_0x3816('0x2c')]=_0x1dd74f;else{FusionSettings['SocketVariables']['fusion_diagnostics_running']={'process':_0x1dd74f,'socket':-0x1};}}else FusionSettings[_0x3816('0x23')][_0x3816('0x25')]=null;_0x5eef0b++;}(_0xa608c8[_0x3816('0xb')]()));});}else{FusionSettings[_0x3816('0x23')][_0x3816('0x30')]=null;_0x5eef0b++;}}function _0x20c957(){wpa_cli['status'](config[_0x3816('0x12')](_0x3816('0x1e')),function(_0x3b1758,_0x3dd89e){if(_0x3b1758){_0x3dd89e={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0x3816('0x23')]['fusion_wifi_access']=_0x3dd89e;_0x5eef0b++;});}_0x1a8e60();_0x50f183();setInterval(function(){_0x1a8e60();_0x50f183();},0x2710);}();