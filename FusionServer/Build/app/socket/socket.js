const _0x43ff=['fusion_gamepad_available','verbose','type','wireless-tools/wpa_cli','fusion_current_SHA','stringify','stdout','Client\x20connected:\x20','gamepad-available','stderr','SocketVariables','git\x20describe\x20--tags\x20','fusion_wifi_access','../global/fusionSettings','Socket\x20error\x20-\x20','disconnect','exports','pipe','SocketId','push','Error\x20reading\x20battery\x20:\x20\x0a','error','fusion_battery_level','spawn','debug','battery-level','request','http://localhost:8080/api/diagnostics/stop','Storage','platform','statusCode','connectedClients','exec','fusion_latest_version','Client\x20disconnected:\x20','\x20because\x20\x22','win32','../utils/logger','version-number','sockets','ps\x20aux\x20|\x20grep\x20\x27[s]udo\x20python\x20../../diagnostics/diagnosticGUI.py\x27\x20|\x20awk\x20\x27{print\x20$2}\x27','child_process','dirname','python','GET','success','emit','sep','indexOf','data','get','splice','pop','global-message','diagnostics_running','git\x20rev-parse\x20HEAD','fusion_current_version','config','program-running','Build','fusion_update_available','fusion_diagnostics_running','../fusionProgram','git\x20fetch','catch','Error\x20terminating\x20diagnostic\x20tools\x20:\x20','wifi-connection','connection','fusion_internet_access','sudo\x20netstat\x20-panp\x20|\x20grep\x205000\x20|\x20grep\x20LISTEN','Connected\x20to\x20server','socket','split','fusion_program_running','./scripts/ReadBatt.py','fusion_latest_SHA','internet-access','trim'];(function(_0x86cf2a,_0x43ff65){const _0x5ddabc=function(_0x2a2d58){while(--_0x2a2d58){_0x86cf2a['push'](_0x86cf2a['shift']());}};_0x5ddabc(++_0x43ff65);}(_0x43ff,0x87));const _0x5dda=function(_0x86cf2a,_0x43ff65){_0x86cf2a=_0x86cf2a-0x0;let _0x5ddabc=_0x43ff[_0x86cf2a];return _0x5ddabc;};const config=require(_0x5dda('0x0'));const logger=require(_0x5dda('0x3a'));const io=require('.');const FusionSettings=require(_0x5dda('0x22'));const fusionProgram=require(_0x5dda('0x5'));const spawn=require(_0x5dda('0x3e'))[_0x5dda('0x2c')];const internetAvailable=require('internet-available');const wpa_cli=require(_0x5dda('0x18'));const os=require('os');const shell=require('shelljs');const path=require('path');const request=require(_0x5dda('0x2f'));module[_0x5dda('0x25')]=async function(){logger[_0x5dda('0x16')]('Configuring\x20socket\x20communication');FusionSettings[_0x5dda('0x34')]=[];var _0x30e8d8=path[_0x5dda('0x3f')](__dirname)[_0x5dda('0xf')](path[_0x5dda('0x44')])[_0x5dda('0x49')]();var _0x136911=0x0;var _0x2b8217=0xb;io['on'](_0x5dda('0xa'),function(_0x3478f1){FusionSettings[_0x5dda('0x34')][_0x5dda('0x28')](_0x3478f1);logger['debug'](_0x5dda('0x1c')+_0x3478f1['id']);_0x4f2d86();_0x3478f1['on']('join',function(_0x3f2f52){_0x3478f1[_0x5dda('0x43')](_0x5dda('0x4a'),{'message':_0x5dda('0xd'),'type':_0x5dda('0x42')});});_0x3478f1['on'](_0x5dda('0x24'),function(_0x1c34d2){logger[_0x5dda('0x2d')](_0x5dda('0x37')+_0x3478f1['id']+_0x5dda('0x38')+_0x1c34d2+'\x22');if(FusionSettings[_0x5dda('0x1f')][_0x5dda('0x10')])if(FusionSettings[_0x5dda('0x1f')][_0x5dda('0x10')][_0x5dda('0x27')]==_0x3478f1['id'])fusionProgram['KillProgram']();if(FusionSettings[_0x5dda('0x1f')]['fusion_diagnostics_running'])if(FusionSettings['SocketVariables'][_0x5dda('0x4')][_0x5dda('0xe')]==_0x3478f1['id']){logger[_0x5dda('0x16')]('Terminating\x20diagnostic\x20tools\x20due\x20to\x20absent\x20client');request({'url':_0x5dda('0x30'),'method':_0x5dda('0x41')},function(_0x1d9946,_0x28dc52,_0xc03e0a){if(_0x1d9946)logger[_0x5dda('0x2a')](_0x5dda('0x8')+_0x1d9946);else{if(_0x28dc52[_0x5dda('0x33')]==0xc8){FusionSettings['SocketVariables'][_0x5dda('0x4')]=null;}}io['sockets'][_0x5dda('0x43')](_0x5dda('0x4b'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4')]);});}var _0x2a1eb3=FusionSettings['connectedClients'][_0x5dda('0x45')](_0x3478f1);FusionSettings[_0x5dda('0x34')][_0x5dda('0x48')](_0x2a1eb3,0x1);});_0x3478f1['on'](_0x5dda('0x2a'),function(_0x184bed){logger[_0x5dda('0x2a')](_0x5dda('0x23')+_0x184bed);});});function _0x213beb(){_0x1a0a49();_0xbaef7c();_0x10b9fb();_0x33c24e();_0x40cba4();_0x19976e();_0x28709a();}function _0xb00d65(){if(_0x136911>=_0x2b8217){logger[_0x5dda('0x2d')](JSON[_0x5dda('0x1a')](FusionSettings[_0x5dda('0x1f')]));io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x2e'),FusionSettings['SocketVariables']['fusion_battery_level']);io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x13'),FusionSettings[_0x5dda('0x1f')]['fusion_internet_access']);io[_0x5dda('0x3c')]['emit'](_0x5dda('0x3b'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4d')]);io[_0x5dda('0x3c')][_0x5dda('0x43')]('update-available',FusionSettings[_0x5dda('0x1f')][_0x5dda('0x3')]);io[_0x5dda('0x3c')][_0x5dda('0x43')]('gamepad-available',FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')]);io[_0x5dda('0x3c')][_0x5dda('0x43')]('diagnostics_running',FusionSettings['SocketVariables'][_0x5dda('0x4')]);io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x9'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x21')]);io['sockets'][_0x5dda('0x43')]('wifi-fusion_storage_type',FusionSettings[_0x5dda('0x31')][_0x5dda('0x17')]);io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x1'),FusionSettings['SocketVariables']['fusion_program_running']);_0x136911=0x0;}else{setTimeout(_0xb00d65,0x7d0);}}function _0x4f2d86(){io[_0x5dda('0x3c')][_0x5dda('0x43')]('battery-level',FusionSettings['SocketVariables'][_0x5dda('0x2b')]);io[_0x5dda('0x3c')]['emit'](_0x5dda('0x13'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0xb')]);io['sockets'][_0x5dda('0x43')](_0x5dda('0x3b'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4d')]);io[_0x5dda('0x3c')][_0x5dda('0x43')]('update-available',FusionSettings[_0x5dda('0x1f')]['fusion_update_available']);io['sockets'][_0x5dda('0x43')](_0x5dda('0x1d'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')]);io[_0x5dda('0x3c')]['emit']('diagnostics_running',FusionSettings[_0x5dda('0x1f')]['fusion_diagnostics_running']);io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x9'),FusionSettings['SocketVariables'][_0x5dda('0x21')]);io[_0x5dda('0x3c')][_0x5dda('0x43')](_0x5dda('0x1'),FusionSettings[_0x5dda('0x1f')][_0x5dda('0x10')]);}function _0x1a0a49(){if(os[_0x5dda('0x32')]()!=_0x5dda('0x39')){var _0x2b1c2b=_0x5dda('0x11');var _0x1cb7f6=spawn(_0x5dda('0x40'),[_0x2b1c2b],{'stdio':_0x5dda('0x26')});_0x1cb7f6[_0x5dda('0x1b')]['on'](_0x5dda('0x46'),function(_0x5bfb45){FusionSettings['SocketVariables'][_0x5dda('0x2b')]=String(_0x5bfb45)[_0x5dda('0x14')]();_0x136911++;});_0x1cb7f6[_0x5dda('0x1e')]['on']('data',function(_0x3de5f7){logger[_0x5dda('0x2a')](_0x5dda('0x29')+String(_0x3de5f7));});}else{_0x136911++;}}function _0xbaef7c(){internetAvailable({'timeout':0x2710,'retries':0x5})['then'](function(){FusionSettings[_0x5dda('0x1f')]['fusion_internet_access']=!![];_0x136911++;})[_0x5dda('0x7')](function(){FusionSettings[_0x5dda('0x1f')]['fusion_internet_access']=![];_0x136911++;});}function _0x10b9fb(){shell[_0x5dda('0x35')](_0x5dda('0x4c'),{'silent':!![]},function(_0x2c59f5,_0x2be01b,_0x33ccdb){(function(_0x160ccc){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x19')]=_0x160ccc[_0x5dda('0x14')]();_0x136911++;_0x4c6f59();}(_0x2be01b['trim']()));});}function _0x4c6f59(){shell['exec'](_0x5dda('0x20')+FusionSettings[_0x5dda('0x1f')][_0x5dda('0x19')],{'silent':!![]},function(_0x933acc,_0x30fbf4,_0x4e162f){(function(_0x54e692){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4d')]=_0x54e692[_0x5dda('0x14')]();_0x136911++;_0x58812d();}(_0x30fbf4[_0x5dda('0x14')]()));});}function _0x58812d(){if(_0x30e8d8==_0x5dda('0x2')){shell[_0x5dda('0x35')](_0x5dda('0x6'),{'silent':!![]},function(_0x44f4bb,_0x189b31,_0x4211f4){(function(_0x2fd7b7){_0x136911++;_0x535f2();}(_0x189b31['trim']()));});}else{_0x136911++;_0x535f2();}}function _0x535f2(){shell[_0x5dda('0x35')]('git\x20rev-list\x20--tags\x20--max-count=1',{'silent':!![]},function(_0x4ef8b5,_0x25bd2b,_0x36d9e4){(function(_0x57557e){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x12')]=_0x57557e[_0x5dda('0x14')]();_0x136911++;_0x3b56a2();}(_0x25bd2b['trim']()));});}function _0x3b56a2(){shell[_0x5dda('0x35')]('git\x20describe\x20--tags\x20'+FusionSettings['SocketVariables'][_0x5dda('0x12')],{'silent':!![]},function(_0x10f721,_0x21d38a,_0x8c8acb){(function(_0x254ff4){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x36')]=_0x254ff4[_0x5dda('0x14')]();_0x136911++;}(_0x21d38a['trim']()));});}function _0x33c24e(){if(FusionSettings[_0x5dda('0x1f')][_0x5dda('0x19')]!=FusionSettings[_0x5dda('0x1f')]['fusion_latest_SHA']){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x3')]=!![];}else{FusionSettings[_0x5dda('0x1f')]['fusion_update_available']=![];}_0x136911++;}function _0x40cba4(){if(os[_0x5dda('0x32')]()!=_0x5dda('0x39')){shell[_0x5dda('0x35')](_0x5dda('0xc'),{'silent':!![]},function(_0xab2a65,_0x108386,_0xa537ed){(function(_0x388f94){FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')]=_0x388f94[_0x5dda('0x14')]();if(!FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')])FusionSettings['SocketVariables'][_0x5dda('0x15')]=![];else FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')]=!![];_0x136911++;}(_0x108386[_0x5dda('0x14')]()));});}else{FusionSettings[_0x5dda('0x1f')][_0x5dda('0x15')]=![];_0x136911++;}}function _0x19976e(){if(os[_0x5dda('0x32')]()!=_0x5dda('0x39')){shell[_0x5dda('0x35')](_0x5dda('0x3d'),{'silent':!![]},function(_0x20eb2b,_0x5a0147,_0x124128){(function(_0x528450){var _0xe564df=_0x528450[_0x5dda('0x14')]();if(_0xe564df){if(FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4')])FusionSettings['SocketVariables']['fusion_diagnostics_running']['process']=_0xe564df;else{FusionSettings['SocketVariables']['fusion_diagnostics_running']={'process':_0xe564df,'socket':-0x1};}}else FusionSettings[_0x5dda('0x1f')][_0x5dda('0x4')]=null;_0x136911++;}(_0x5a0147[_0x5dda('0x14')]()));});}else{FusionSettings[_0x5dda('0x1f')]['fusion_gamepad_available']=null;_0x136911++;}}function _0x28709a(){wpa_cli['status'](config[_0x5dda('0x47')]('Wifi_NIC'),function(_0x1858da,_0x3a1045){if(_0x1858da){_0x3a1045={'ssid':undefined,'ip':undefined,'mac':undefined};}FusionSettings[_0x5dda('0x1f')]['fusion_wifi_access']=_0x3a1045;_0x136911++;});}_0xb00d65();_0x213beb();setInterval(function(){_0xb00d65();_0x213beb();},0x2710);}();