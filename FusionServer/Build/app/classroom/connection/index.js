const _0x5960=['wifiStatus','MyBot_Gatekeeper_WiFi','get','split','substr','Unable\x20to\x20reach\x20classroom\x20community:\x20','wifi','Connecting\x20to\x20hidden\x20classroom:\x20','Connecting\x20to\x20classroom:\x20','exec','status','Not\x20connected\x20to\x20classroom\x20network','wireless-tools/wpa_cli','stringify','../../utils/logger','warn','ssid','No\x20fallback\x20network\x20found','serial','exports','hiddenPassword','community_access','Storing\x20fallback\x20network','hiddenSSID','\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27','stdout','Wifi_NIC','wifiInterface','https://',':8443/api/v1/connect/','debug','networks','config','Not\x20part\x20of\x20the\x20classroom\x20community','Fallback\x20network\x20found:\x20','request-promise','Gateway\x20found\x20at:\x20','./../../utils/wireless','getmac','currentNetwork','fallbackNetwork','fallBackNetwork','Checking\x20for\x20fallback\x20network','On\x20hidden\x20network,\x20rechecking\x20community\x20access','join','connected','data','Connecting\x20classroom\x20socket\x20communication','length','eth0','passphrase'];(function(_0x29cc36,_0x5960f0){const _0x24e230=function(_0x3930c6){while(--_0x3930c6){_0x29cc36['push'](_0x29cc36['shift']());}};_0x24e230(++_0x5960f0);}(_0x5960,0x113));const _0x24e2=function(_0x29cc36,_0x5960f0){_0x29cc36=_0x29cc36-0x0;let _0x24e230=_0x5960[_0x29cc36];return _0x24e230;};const config=require(_0x24e2('0xc'));const logger=require(_0x24e2('0x2d'));const rp=require(_0x24e2('0xf'));const wpa_cli=require(_0x24e2('0x2b'));const mac=require(_0x24e2('0x12'));const shell=require('shelljs');const wireless=require(_0x24e2('0x11'));let classroomConnection={'wifiInterface':config[_0x24e2('0x21')](_0x24e2('0x6')),'currentNetwork':0x0,'networks':[{'hiddenSSID':_0x24e2('0x20'),'hiddenPassword':'CMMthgilxoBsecure'}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection[_0x24e2('0x15')]=await getFallBackNetwork();classroomConnection[_0x24e2('0x31')]=await getSerial();classroomConnection[_0x24e2('0x1f')]=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x116355,_0x1b2bef)=>{mac['getMac']({'iface':_0x24e2('0x1d')},function(_0x4a0a7c,_0x126b28){if(_0x4a0a7c){return _0x1b2bef(_0x4a0a7c['message']);}else{let _0x23604f=_0x126b28[_0x24e2('0x22')](':')[_0x24e2('0x18')]('')[_0x24e2('0x23')](-0x6);logger[_0x24e2('0xa')]('Fusion\x20serial\x20number:\x20'+_0x23604f);return _0x116355(_0x23604f);}});});};function getWifiStatus(){return new Promise((_0x165235,_0x4ed66b)=>{wpa_cli[_0x24e2('0x29')](classroomConnection[_0x24e2('0x7')],function(_0x2ffe52,_0x31e956){if(_0x2ffe52){return _0x4ed66b('Error\x20accessing\x20network\x20interface:\x20'+_0x2ffe52);}logger[_0x24e2('0xa')]('Wifi\x20interface\x20status:\x20'+JSON[_0x24e2('0x2c')](_0x31e956));return _0x165235(_0x31e956);});});};async function checkCommunityAccess(){const _0xa0821a='ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27'+classroomConnection[_0x24e2('0x7')]+_0x24e2('0x4');const _0x58d4b6=await shell[_0x24e2('0x28')](_0xa0821a,{'silent':!![]})[_0x24e2('0x5')]['trim']();logger[_0x24e2('0xa')](_0x24e2('0x10')+_0x58d4b6);let _0x3b3b7a={'uri':_0x24e2('0x8')+_0x58d4b6+_0x24e2('0x9')+classroomConnection[_0x24e2('0x31')],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x54f321=await rp(_0x3b3b7a);logger['debug'](JSON[_0x24e2('0x2c')](_0x54f321));let _0x280795=![];if(_0x54f321[_0x24e2('0x1a')]){_0x280795=_0x54f321[_0x24e2('0x1a')][_0x24e2('0x1')];}if(_0x280795){let _0x2eb079={'ssid':_0x54f321[_0x24e2('0x25')][_0x24e2('0x2f')],'passphrase':_0x54f321[_0x24e2('0x25')]['passphrase']};await checkIfOnClassroomNetwork(_0x2eb079);}else{logger['debug'](_0x24e2('0xd'));await tryNextClassroomNetork();}}catch(_0x517d69){logger[_0x24e2('0x2e')](_0x24e2('0x24')+_0x517d69);await tryNextClassroomNetork();}};async function checkIfOnClassroomNetwork(_0x27e830){if(classroomConnection[_0x24e2('0x1f')][_0x24e2('0x2f')]==_0x27e830['ssid']){logger['debug']('Already\x20connected\x20to\x20classroom\x20network');await connectSockets();}else{logger['debug'](_0x24e2('0x2a'));await connectToClassroomNetwork(_0x27e830);}};async function connectSockets(){logger['debug'](_0x24e2('0x1b'));await require('../sockets');connection[_0x24e2('0x19')]=!![];};async function connectToClassroomNetwork(_0x5cf4cc){try{logger[_0x24e2('0xa')](_0x24e2('0x27')+_0x5cf4cc[_0x24e2('0x2f')]);let _0xec7958={'ssid':_0x5cf4cc['ssid'],'password':_0x5cf4cc[_0x24e2('0x1e')],'hidden':![]};await wireless['connectToNetwork'](_0xec7958);await connectSockets();}catch(_0x48c44b){logger[_0x24e2('0x2e')]('Error\x20connecting\x20to\x20classroom\x20network:\x20'+_0x48c44b);}};async function getFallBackNetwork(){return new Promise((_0x545982,_0x4b0b7b)=>{let _0x3bff49=null;if(_0x3bff49){logger[_0x24e2('0xa')](_0x24e2('0x2'));}else{logger[_0x24e2('0xa')](_0x24e2('0x30'));}return _0x545982(null);});};async function restoreFallBackNetwork(){logger[_0x24e2('0xa')](_0x24e2('0x16'));if(classroomConnection['fallbackNetwork']){logger['debug'](_0x24e2('0xe')+classroomConnection[_0x24e2('0x14')]);}else{logger[_0x24e2('0xa')](_0x24e2('0x30'));}};async function connectToHiddenClassroomNetwork(_0x2245ae){try{logger[_0x24e2('0xa')](_0x24e2('0x26')+_0x2245ae['hiddenSSID']);let _0x55f601={'ssid':_0x2245ae[_0x24e2('0x3')],'password':_0x2245ae[_0x24e2('0x0')],'hidden':!![]};await wireless['connectToNetwork'](_0x55f601);logger[_0x24e2('0xa')](_0x24e2('0x17'));await checkCommunityAccess();}catch(_0x193666){logger[_0x24e2('0x2e')](_0x193666);await tryNextClassroomNetork();}};async function tryNextClassroomNetork(){logger['debug']('Trying\x20next\x20hidden\x20classroom\x20network');let _0x44709d=await getNextNetwork();if(_0x44709d){logger[_0x24e2('0xa')]('Next\x20network\x20is:\x20'+_0x44709d[_0x24e2('0x3')]);await connectToHiddenClassroomNetwork(_0x44709d);}else{logger[_0x24e2('0xa')]('No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network');await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x480357=null;if(classroomConnection[_0x24e2('0x13')]<classroomConnection[_0x24e2('0xb')][_0x24e2('0x1c')])_0x480357=classroomConnection[_0x24e2('0xb')][classroomConnection[_0x24e2('0x13')]++];return _0x480357;};module[_0x24e2('0x32')]=connection;