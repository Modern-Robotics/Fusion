const _0x39a1=['stdout','15387CVxLgn','Trying\x20next\x20hidden\x20classroom\x20network','config','709986iPrytg','691350AOCvPf','Wifi_NIC','wifiStatus','getMac','48443jvLWCb','exec','24NFFIao','networks','../sockets','./../../utils/wireless','debug','1167223GlbtoF','serial','Connecting\x20classroom\x20socket\x20communication','wifiInterface','Gateway\x20found\x20at:\x20','Error\x20connecting\x20to\x20classroom\x20network:\x20','status','warn','Checking\x20for\x20fallback\x20network','passphrase','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','hiddenPassword','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','Already\x20connected\x20to\x20classroom\x20network','substr','wireless-tools/wpa_cli','Next\x20network\x20is:\x20','https://','Not\x20connected\x20to\x20classroom\x20network','hiddenSSID','118xuwbcr','trim','data','getmac','connected','27FftGCo','Connecting\x20to\x20classroom:\x20','eth0','21iOjVVx','wifi','connectToNetwork','Connecting\x20to\x20hidden\x20classroom:\x20','fallbackNetwork','stringify','15097fXRITK','join','fallBackNetwork','Fusion\x20serial\x20number:\x20','currentNetwork','length','CMMthgilxoBsecure','ssid','Storing\x20fallback\x20network','No\x20fallback\x20network\x20found','Error\x20accessing\x20network\x20interface:\x20',':8443/api/v1/connect/','Fallback\x20network\x20found:\x20','get','10935OSFHoN','Wifi\x20interface\x20status:\x20','split'];const _0x423e63=_0x62bc;(function(_0xf758f5,_0x4ce4ce){const _0x1783d2=_0x62bc;while(!![]){try{const _0x53251a=-parseInt(_0x1783d2(0x207))*-parseInt(_0x1783d2(0x1f9))+-parseInt(_0x1783d2(0x21c))+-parseInt(_0x1783d2(0x1e0))*parseInt(_0x1783d2(0x215))+parseInt(_0x1783d2(0x21d))+-parseInt(_0x1783d2(0x1e5))+-parseInt(_0x1783d2(0x201))*-parseInt(_0x1783d2(0x1de))+-parseInt(_0x1783d2(0x219))*parseInt(_0x1783d2(0x1fe));if(_0x53251a===_0x4ce4ce)break;else _0xf758f5['push'](_0xf758f5['shift']());}catch(_0x548a4f){_0xf758f5['push'](_0xf758f5['shift']());}}}(_0x39a1,0xe4459));const config=require(_0x423e63(0x21b)),logger=require('../../utils/logger'),rp=require('request-promise'),wpa_cli=require(_0x423e63(0x1f4)),mac=require(_0x423e63(0x1fc)),shell=require('shelljs'),wireless=require(_0x423e63(0x1e3));let classroomConnection={'wifiInterface':config[_0x423e63(0x214)](_0x423e63(0x21e)),'currentNetwork':0x0,'networks':[{'hiddenSSID':'MyBot_Gatekeeper_WiFi','hiddenPassword':_0x423e63(0x20d)}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){const _0x2826ee=_0x423e63;classroomConnection[_0x2826ee(0x209)]=await getFallBackNetwork(),classroomConnection[_0x2826ee(0x1e6)]=await getSerial(),classroomConnection[_0x2826ee(0x21f)]=await getWifiStatus(),await checkCommunityAccess();}};function getSerial(){return new Promise((_0x18f307,_0x492812)=>{const _0x1f7206=_0x62bc;mac[_0x1f7206(0x1dd)]({'iface':_0x1f7206(0x200)},function(_0x53b2ba,_0x5bfec5){const _0x2f192=_0x1f7206;if(_0x53b2ba)return _0x492812(_0x53b2ba['message']);else{let _0x16c0e0=_0x5bfec5[_0x2f192(0x217)](':')[_0x2f192(0x208)]('')[_0x2f192(0x1f3)](-0x6);return logger[_0x2f192(0x1e4)](_0x2f192(0x20a)+_0x16c0e0),_0x18f307(_0x16c0e0);}});});};function getWifiStatus(){return new Promise((_0x128a17,_0x3cf424)=>{const _0x2e66e6=_0x62bc;wpa_cli[_0x2e66e6(0x1eb)](classroomConnection[_0x2e66e6(0x1e8)],function(_0x149b4a,_0x29b963){const _0x55aed3=_0x2e66e6;if(_0x149b4a)return _0x3cf424(_0x55aed3(0x211)+_0x149b4a);return logger[_0x55aed3(0x1e4)](_0x55aed3(0x216)+JSON[_0x55aed3(0x206)](_0x29b963)),_0x128a17(_0x29b963);});});};async function checkCommunityAccess(){const _0x1797f7=_0x423e63,_0x386ad0=_0x1797f7(0x1ef)+classroomConnection[_0x1797f7(0x1e8)]+'\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27',_0x1d900c=await shell[_0x1797f7(0x1df)](_0x386ad0,{'silent':!![]})[_0x1797f7(0x218)][_0x1797f7(0x1fa)]();logger[_0x1797f7(0x1e4)](_0x1797f7(0x1e9)+_0x1d900c);let _0x4645ce={'uri':_0x1797f7(0x1f6)+_0x1d900c+_0x1797f7(0x212)+classroomConnection[_0x1797f7(0x1e6)],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x54978e=await rp(_0x4645ce);logger[_0x1797f7(0x1e4)](JSON[_0x1797f7(0x206)](_0x54978e));let _0x1fbe18=![];_0x54978e['data']&&(_0x1fbe18=_0x54978e[_0x1797f7(0x1fb)]['community_access']);if(_0x1fbe18){let _0x54a679={'ssid':_0x54978e[_0x1797f7(0x202)][_0x1797f7(0x20e)],'passphrase':_0x54978e['wifi'][_0x1797f7(0x1ee)]};await checkIfOnClassroomNetwork(_0x54a679);}else logger['debug']('Not\x20part\x20of\x20the\x20classroom\x20community'),await tryNextClassroomNetwork();}catch(_0x4885e2){logger[_0x1797f7(0x1ec)]('Unable\x20to\x20reach\x20classroom\x20community:\x20'+_0x4885e2),await tryNextClassroomNetwork();}};async function checkIfOnClassroomNetwork(_0x134ad5){const _0x374677=_0x423e63;classroomConnection['wifiStatus'][_0x374677(0x20e)]==_0x134ad5[_0x374677(0x20e)]?(logger[_0x374677(0x1e4)](_0x374677(0x1f2)),await connectSockets()):(logger[_0x374677(0x1e4)](_0x374677(0x1f7)),await connectToClassroomNetwork(_0x134ad5));};async function connectSockets(){const _0x3f73a8=_0x423e63;logger[_0x3f73a8(0x1e4)](_0x3f73a8(0x1e7)),await require(_0x3f73a8(0x1e2)),connection[_0x3f73a8(0x1fd)]=!![];};async function connectToClassroomNetwork(_0x3178fc){const _0x3e43d2=_0x423e63;try{logger[_0x3e43d2(0x1e4)](_0x3e43d2(0x1ff)+_0x3178fc[_0x3e43d2(0x20e)]);let _0x4a4853={'ssid':_0x3178fc[_0x3e43d2(0x20e)],'password':_0x3178fc[_0x3e43d2(0x1ee)],'hidden':![]};await wireless[_0x3e43d2(0x203)](_0x4a4853),await connectSockets();}catch(_0x49a0fd){logger[_0x3e43d2(0x1ec)](_0x3e43d2(0x1ea)+_0x49a0fd);}};function _0x62bc(_0x30956e,_0x4ac000){return _0x62bc=function(_0x39a1e6,_0x62bcaf){_0x39a1e6=_0x39a1e6-0x1dd;let _0x46831f=_0x39a1[_0x39a1e6];return _0x46831f;},_0x62bc(_0x30956e,_0x4ac000);}async function getFallBackNetwork(){return new Promise((_0x217ce3,_0x3e51fa)=>{const _0x93a65c=_0x62bc;let _0x351128=null;return _0x351128?logger[_0x93a65c(0x1e4)](_0x93a65c(0x20f)):logger[_0x93a65c(0x1e4)](_0x93a65c(0x210)),_0x217ce3(null);});};async function restoreFallBackNetwork(){const _0x2b5683=_0x423e63;logger[_0x2b5683(0x1e4)](_0x2b5683(0x1ed)),classroomConnection[_0x2b5683(0x205)]?logger['debug'](_0x2b5683(0x213)+classroomConnection[_0x2b5683(0x205)]):logger[_0x2b5683(0x1e4)](_0x2b5683(0x210));};async function connectToHiddenClassroomNetwork(_0x3a4bde){const _0x2099e1=_0x423e63;try{logger['debug'](_0x2099e1(0x204)+_0x3a4bde[_0x2099e1(0x1f8)]);let _0x41f6bc={'ssid':_0x3a4bde[_0x2099e1(0x1f8)],'password':_0x3a4bde[_0x2099e1(0x1f0)],'hidden':!![]};await wireless[_0x2099e1(0x203)](_0x41f6bc),logger[_0x2099e1(0x1e4)]('On\x20hidden\x20network,\x20rechecking\x20community\x20access'),await checkCommunityAccess();}catch(_0x44713d){logger[_0x2099e1(0x1ec)](_0x44713d),await tryNextClassroomNetwork();}};async function tryNextClassroomNetwork(){const _0xc2e618=_0x423e63;logger[_0xc2e618(0x1e4)](_0xc2e618(0x21a));let _0x5d2d88=await getNextNetwork();_0x5d2d88?(logger[_0xc2e618(0x1e4)](_0xc2e618(0x1f5)+_0x5d2d88[_0xc2e618(0x1f8)]),await connectToHiddenClassroomNetwork(_0x5d2d88)):(logger[_0xc2e618(0x1e4)](_0xc2e618(0x1f1)),await restoreFallBackNetwork());};async function getNextNetwork(){const _0x5250a7=_0x423e63;let _0x435616=null;if(classroomConnection[_0x5250a7(0x20b)]<classroomConnection[_0x5250a7(0x1e1)][_0x5250a7(0x20c)])_0x435616=classroomConnection[_0x5250a7(0x1e1)][classroomConnection[_0x5250a7(0x20b)]++];return _0x435616;};module['exports']=connection;