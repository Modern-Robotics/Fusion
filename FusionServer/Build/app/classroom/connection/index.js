const _0x4286=['currentNetwork','networks','Storing\x20fallback\x20network','CMMthgilxoBsecure','serial','request-promise','../sockets','Not\x20part\x20of\x20the\x20classroom\x20community','hiddenSSID','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','exec','passphrase','On\x20hidden\x20network,\x20rechecking\x20community\x20access','Fusion\x20serial\x20number:\x20','split','status','Already\x20connected\x20to\x20classroom\x20network','shelljs','Not\x20connected\x20to\x20classroom\x20network','getMac','Error\x20connecting\x20to\x20classroom\x20network:\x20','fallbackNetwork','stdout','Connecting\x20to\x20hidden\x20classroom:\x20','Connecting\x20to\x20classroom:\x20','Wifi\x20interface\x20status:\x20','Checking\x20for\x20fallback\x20network','exports','debug','Next\x20network\x20is:\x20','stringify','community_access','join','wifiStatus','\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27','wifi','Trying\x20next\x20hidden\x20classroom\x20network','Error\x20accessing\x20network\x20interface:\x20','Unable\x20to\x20reach\x20classroom\x20community:\x20','https://','warn','data','Gateway\x20found\x20at:\x20','connectToNetwork','getmac','No\x20fallback\x20network\x20found','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','eth0','get','./../../utils/wireless','wifiInterface','Wifi_NIC',':8443/api/v1/connect/','ssid'];(function(_0x155f7b,_0x4286d7){const _0x1db95f=function(_0x4882a6){while(--_0x4882a6){_0x155f7b['push'](_0x155f7b['shift']());}};_0x1db95f(++_0x4286d7);}(_0x4286,0xbd));const _0x1db9=function(_0x155f7b,_0x4286d7){_0x155f7b=_0x155f7b-0x0;let _0x1db95f=_0x4286[_0x155f7b];return _0x1db95f;};const config=require('config');const logger=require('../../utils/logger');const rp=require(_0x1db9('0x20'));const wpa_cli=require('wireless-tools/wpa_cli');const mac=require(_0x1db9('0x11'));const shell=require(_0x1db9('0x2c'));const wireless=require(_0x1db9('0x16'));let classroomConnection={'wifiInterface':config[_0x1db9('0x15')](_0x1db9('0x18')),'currentNetwork':0x0,'networks':[{'hiddenSSID':'MyBot_Gatekeeper_WiFi','hiddenPassword':_0x1db9('0x1e')}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection['fallBackNetwork']=await getFallBackNetwork();classroomConnection['serial']=await getSerial();classroomConnection['wifiStatus']=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x1178fb,_0x27b2a4)=>{mac[_0x1db9('0x2e')]({'iface':_0x1db9('0x14')},function(_0x1e6094,_0x5958f8){if(_0x1e6094){return _0x27b2a4(_0x1e6094['message']);}else{let _0x3c1156=_0x5958f8[_0x1db9('0x29')](':')[_0x1db9('0x5')]('')['substr'](-0x6);logger['debug'](_0x1db9('0x28')+_0x3c1156);return _0x1178fb(_0x3c1156);}});});};function getWifiStatus(){return new Promise((_0x1f8982,_0x107e9c)=>{wpa_cli[_0x1db9('0x2a')](classroomConnection['wifiInterface'],function(_0x1b602c,_0x1a2109){if(_0x1b602c){return _0x107e9c(_0x1db9('0xa')+_0x1b602c);}logger[_0x1db9('0x1')](_0x1db9('0x34')+JSON[_0x1db9('0x3')](_0x1a2109));return _0x1f8982(_0x1a2109);});});};async function checkCommunityAccess(){const _0x52f5a3=_0x1db9('0x24')+classroomConnection[_0x1db9('0x17')]+_0x1db9('0x7');const _0x32fd4a=await shell[_0x1db9('0x25')](_0x52f5a3,{'silent':!![]})[_0x1db9('0x31')]['trim']();logger['debug'](_0x1db9('0xf')+_0x32fd4a);let _0x1a63a1={'uri':_0x1db9('0xc')+_0x32fd4a+_0x1db9('0x19')+classroomConnection[_0x1db9('0x1f')],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x374b08=await rp(_0x1a63a1);logger[_0x1db9('0x1')](JSON[_0x1db9('0x3')](_0x374b08));let _0x2b93b4=![];if(_0x374b08[_0x1db9('0xe')]){_0x2b93b4=_0x374b08[_0x1db9('0xe')][_0x1db9('0x4')];}if(_0x2b93b4){let _0x29b7bf={'ssid':_0x374b08[_0x1db9('0x8')]['ssid'],'passphrase':_0x374b08[_0x1db9('0x8')]['passphrase']};await checkIfOnClassroomNetwork(_0x29b7bf);}else{logger[_0x1db9('0x1')](_0x1db9('0x22'));await tryNextClassroomNetork();}}catch(_0x14b60e){logger[_0x1db9('0xd')](_0x1db9('0xb')+_0x14b60e);await tryNextClassroomNetork();}};async function checkIfOnClassroomNetwork(_0x1b243b){if(classroomConnection[_0x1db9('0x6')][_0x1db9('0x1a')]==_0x1b243b[_0x1db9('0x1a')]){logger[_0x1db9('0x1')](_0x1db9('0x2b'));await connectSockets();}else{logger[_0x1db9('0x1')](_0x1db9('0x2d'));await connectToClassroomNetwork(_0x1b243b);}};async function connectSockets(){logger['debug']('Connecting\x20classroom\x20socket\x20communication');await require(_0x1db9('0x21'));connection['connected']=!![];};async function connectToClassroomNetwork(_0x288eee){try{logger[_0x1db9('0x1')](_0x1db9('0x33')+_0x288eee[_0x1db9('0x1a')]);let _0x1fee32={'ssid':_0x288eee[_0x1db9('0x1a')],'password':_0x288eee[_0x1db9('0x26')],'hidden':![]};await wireless[_0x1db9('0x10')](_0x1fee32);await connectSockets();}catch(_0x11542b){logger['warn'](_0x1db9('0x2f')+_0x11542b);}};async function getFallBackNetwork(){return new Promise((_0x5d51ce,_0x1bdb61)=>{let _0x3f75eb=null;if(_0x3f75eb){logger['debug'](_0x1db9('0x1d'));}else{logger[_0x1db9('0x1')]('No\x20fallback\x20network\x20found');}return _0x5d51ce(null);});};async function restoreFallBackNetwork(){logger[_0x1db9('0x1')](_0x1db9('0x35'));if(classroomConnection['fallbackNetwork']){logger[_0x1db9('0x1')]('Fallback\x20network\x20found:\x20'+classroomConnection[_0x1db9('0x30')]);}else{logger['debug'](_0x1db9('0x12'));}};async function connectToHiddenClassroomNetwork(_0x2d1601){try{logger[_0x1db9('0x1')](_0x1db9('0x32')+_0x2d1601['hiddenSSID']);let _0x413af0={'ssid':_0x2d1601[_0x1db9('0x23')],'password':_0x2d1601['hiddenPassword'],'hidden':!![]};await wireless[_0x1db9('0x10')](_0x413af0);logger[_0x1db9('0x1')](_0x1db9('0x27'));await checkCommunityAccess();}catch(_0x4fbd19){logger[_0x1db9('0xd')](_0x4fbd19);await tryNextClassroomNetork();}};async function tryNextClassroomNetork(){logger[_0x1db9('0x1')](_0x1db9('0x9'));let _0x1c5ff1=await getNextNetwork();if(_0x1c5ff1){logger[_0x1db9('0x1')](_0x1db9('0x2')+_0x1c5ff1[_0x1db9('0x23')]);await connectToHiddenClassroomNetwork(_0x1c5ff1);}else{logger[_0x1db9('0x1')](_0x1db9('0x13'));await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x524042=null;if(classroomConnection[_0x1db9('0x1b')]<classroomConnection['networks']['length'])_0x524042=classroomConnection[_0x1db9('0x1c')][classroomConnection[_0x1db9('0x1b')]++];return _0x524042;};module[_0x1db9('0x0')]=connection;