const _0x10c5=['Gateway\x20found\x20at:\x20','length','MyBot_Gatekeeper_WiFi','passphrase',':8443/api/v1/connect/','Next\x20network\x20is:\x20','config','debug','split','Fusion\x20serial\x20number:\x20','ssid','./../../utils/wireless','Connecting\x20to\x20hidden\x20classroom:\x20','wireless-tools/wpa_cli','fallbackNetwork','On\x20hidden\x20network,\x20rechecking\x20community\x20access','message','exports','serial','shelljs','substr','networks','connectToNetwork','currentNetwork','hiddenSSID','Fallback\x20network\x20found:\x20','Trying\x20next\x20hidden\x20classroom\x20network','https://','trim','warn','exec','Unable\x20to\x20reach\x20classroom\x20community:\x20','Already\x20connected\x20to\x20classroom\x20network','stringify','No\x20fallback\x20network\x20found','hiddenPassword','getmac','Not\x20part\x20of\x20the\x20classroom\x20community','getMac','Connecting\x20classroom\x20socket\x20communication','data','Wifi_NIC','request-promise','community_access','wifiStatus','\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27','Connecting\x20to\x20classroom:\x20','fallBackNetwork','get','CMMthgilxoBsecure','wifi','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','join','Checking\x20for\x20fallback\x20network'];(function(_0x545f15,_0x10c5a4){const _0xd9cd90=function(_0x86ddd8){while(--_0x86ddd8){_0x545f15['push'](_0x545f15['shift']());}};_0xd9cd90(++_0x10c5a4);}(_0x10c5,0x1c6));const _0xd9cd=function(_0x545f15,_0x10c5a4){_0x545f15=_0x545f15-0x0;let _0xd9cd90=_0x10c5[_0x545f15];return _0xd9cd90;};const config=require(_0xd9cd('0x26'));const logger=require('../../utils/logger');const rp=require(_0xd9cd('0x14'));const wpa_cli=require(_0xd9cd('0x2d'));const mac=require(_0xd9cd('0xe'));const shell=require(_0xd9cd('0x33'));const wireless=require(_0xd9cd('0x2b'));let classroomConnection={'wifiInterface':config[_0xd9cd('0x1a')](_0xd9cd('0x13')),'currentNetwork':0x0,'networks':[{'hiddenSSID':_0xd9cd('0x22'),'hiddenPassword':_0xd9cd('0x1b')}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection[_0xd9cd('0x19')]=await getFallBackNetwork();classroomConnection[_0xd9cd('0x32')]=await getSerial();classroomConnection[_0xd9cd('0x16')]=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x2c7c0a,_0x5a72ce)=>{mac[_0xd9cd('0x10')]({'iface':'eth0'},function(_0x3cf83b,_0x3213be){if(_0x3cf83b){return _0x5a72ce(_0x3cf83b[_0xd9cd('0x30')]);}else{let _0x467729=_0x3213be[_0xd9cd('0x28')](':')[_0xd9cd('0x1e')]('')[_0xd9cd('0x34')](-0x6);logger[_0xd9cd('0x27')](_0xd9cd('0x29')+_0x467729);return _0x2c7c0a(_0x467729);}});});};function getWifiStatus(){return new Promise((_0xe04d4b,_0x3f6a57)=>{wpa_cli['status'](classroomConnection['wifiInterface'],function(_0x3030ba,_0x11cd0b){if(_0x3030ba){return _0x3f6a57('Error\x20accessing\x20network\x20interface:\x20'+_0x3030ba);}logger['debug']('Wifi\x20interface\x20status:\x20'+JSON[_0xd9cd('0xb')](_0x11cd0b));return _0xe04d4b(_0x11cd0b);});});};async function checkCommunityAccess(){const _0x4fa229='ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27'+classroomConnection['wifiInterface']+_0xd9cd('0x17');const _0x93f857=await shell[_0xd9cd('0x8')](_0x4fa229,{'silent':!![]})['stdout'][_0xd9cd('0x6')]();logger['debug'](_0xd9cd('0x20')+_0x93f857);let _0x1e3d08={'uri':_0xd9cd('0x5')+_0x93f857+_0xd9cd('0x24')+classroomConnection[_0xd9cd('0x32')],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x1a23fb=await rp(_0x1e3d08);logger[_0xd9cd('0x27')](JSON['stringify'](_0x1a23fb));let _0x274036=![];if(_0x1a23fb[_0xd9cd('0x12')]){_0x274036=_0x1a23fb[_0xd9cd('0x12')][_0xd9cd('0x15')];}if(_0x274036){let _0xa131b8={'ssid':_0x1a23fb[_0xd9cd('0x1c')][_0xd9cd('0x2a')],'passphrase':_0x1a23fb['wifi'][_0xd9cd('0x23')]};await checkIfOnClassroomNetwork(_0xa131b8);}else{logger[_0xd9cd('0x27')](_0xd9cd('0xf'));await tryNextClassroomNetwork();}}catch(_0x5ea63e){logger['warn'](_0xd9cd('0x9')+_0x5ea63e);await tryNextClassroomNetwork();}};async function checkIfOnClassroomNetwork(_0x58ef3d){if(classroomConnection[_0xd9cd('0x16')][_0xd9cd('0x2a')]==_0x58ef3d[_0xd9cd('0x2a')]){logger[_0xd9cd('0x27')](_0xd9cd('0xa'));await connectSockets();}else{logger[_0xd9cd('0x27')]('Not\x20connected\x20to\x20classroom\x20network');await connectToClassroomNetwork(_0x58ef3d);}};async function connectSockets(){logger['debug'](_0xd9cd('0x11'));await require('../sockets');connection['connected']=!![];};async function connectToClassroomNetwork(_0x2dd036){try{logger['debug'](_0xd9cd('0x18')+_0x2dd036[_0xd9cd('0x2a')]);let _0xa987ea={'ssid':_0x2dd036['ssid'],'password':_0x2dd036['passphrase'],'hidden':![]};await wireless[_0xd9cd('0x0')](_0xa987ea);await connectSockets();}catch(_0x1cb28d){logger['warn']('Error\x20connecting\x20to\x20classroom\x20network:\x20'+_0x1cb28d);}};async function getFallBackNetwork(){return new Promise((_0x3a3a72,_0x410a3c)=>{let _0x451cd1=null;if(_0x451cd1){logger[_0xd9cd('0x27')]('Storing\x20fallback\x20network');}else{logger[_0xd9cd('0x27')](_0xd9cd('0xc'));}return _0x3a3a72(null);});};async function restoreFallBackNetwork(){logger[_0xd9cd('0x27')](_0xd9cd('0x1f'));if(classroomConnection[_0xd9cd('0x2e')]){logger['debug'](_0xd9cd('0x3')+classroomConnection['fallbackNetwork']);}else{logger['debug'](_0xd9cd('0xc'));}};async function connectToHiddenClassroomNetwork(_0x3f264e){try{logger[_0xd9cd('0x27')](_0xd9cd('0x2c')+_0x3f264e[_0xd9cd('0x2')]);let _0x2706a0={'ssid':_0x3f264e[_0xd9cd('0x2')],'password':_0x3f264e[_0xd9cd('0xd')],'hidden':!![]};await wireless[_0xd9cd('0x0')](_0x2706a0);logger[_0xd9cd('0x27')](_0xd9cd('0x2f'));await checkCommunityAccess();}catch(_0x255b08){logger[_0xd9cd('0x7')](_0x255b08);await tryNextClassroomNetwork();}};async function tryNextClassroomNetwork(){logger[_0xd9cd('0x27')](_0xd9cd('0x4'));let _0x54e750=await getNextNetwork();if(_0x54e750){logger[_0xd9cd('0x27')](_0xd9cd('0x25')+_0x54e750[_0xd9cd('0x2')]);await connectToHiddenClassroomNetwork(_0x54e750);}else{logger[_0xd9cd('0x27')](_0xd9cd('0x1d'));await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x54b88b=null;if(classroomConnection[_0xd9cd('0x1')]<classroomConnection[_0xd9cd('0x35')][_0xd9cd('0x21')])_0x54b88b=classroomConnection['networks'][classroomConnection[_0xd9cd('0x1')]++];return _0x54b88b;};module[_0xd9cd('0x31')]=connection;