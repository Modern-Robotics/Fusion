const _0x1e92=['exports','stdout','connected','passphrase','status','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','fallbackNetwork','Next\x20network\x20is:\x20','Wifi_NIC','eth0','Unable\x20to\x20reach\x20classroom\x20community:\x20','hiddenSSID','length','Error\x20connecting\x20to\x20classroom\x20network:\x20','Gateway\x20found\x20at:\x20','Fallback\x20network\x20found:\x20','On\x20hidden\x20network,\x20rechecking\x20community\x20access',':8443/api/v1/connect/','wifiInterface','getmac','message','community_access','getMac','fallBackNetwork','currentNetwork','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','data','wireless-tools/wpa_cli','No\x20fallback\x20network\x20found','wifi','warn','hiddenPassword','get','./../../utils/wireless','debug','config','Checking\x20for\x20fallback\x20network','stringify','Connecting\x20to\x20classroom:\x20','shelljs','ssid','serial','networks','connectToNetwork','Wifi\x20interface\x20status:\x20','Error\x20accessing\x20network\x20interface:\x20','substr','trim','Connecting\x20to\x20hidden\x20classroom:\x20','Not\x20part\x20of\x20the\x20classroom\x20community','Connecting\x20classroom\x20socket\x20communication','exec','wifiStatus','Not\x20connected\x20to\x20classroom\x20network','../sockets'];(function(_0x22c3d8,_0x1e9206){const _0x420bf8=function(_0x14e601){while(--_0x14e601){_0x22c3d8['push'](_0x22c3d8['shift']());}};_0x420bf8(++_0x1e9206);}(_0x1e92,0xf6));const _0x420b=function(_0x22c3d8,_0x1e9206){_0x22c3d8=_0x22c3d8-0x0;let _0x420bf8=_0x1e92[_0x22c3d8];return _0x420bf8;};const config=require(_0x420b('0x9'));const logger=require('../../utils/logger');const rp=require('request-promise');const wpa_cli=require(_0x420b('0x1'));const mac=require(_0x420b('0x30'));const shell=require(_0x420b('0xd'));const wireless=require(_0x420b('0x7'));let classroomConnection={'wifiInterface':config[_0x420b('0x6')](_0x420b('0x25')),'currentNetwork':0x0,'networks':[{'hiddenSSID':'MyBot_Gatekeeper_WiFi','hiddenPassword':'CMMthgilxoBsecure'}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection[_0x420b('0x34')]=await getFallBackNetwork();classroomConnection[_0x420b('0xf')]=await getSerial();classroomConnection[_0x420b('0x1a')]=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x2986f3,_0x3c9703)=>{mac[_0x420b('0x33')]({'iface':_0x420b('0x26')},function(_0x84a5c3,_0x313305){if(_0x84a5c3){return _0x3c9703(_0x84a5c3[_0x420b('0x31')]);}else{let _0x14825d=_0x313305['split'](':')['join']('')[_0x420b('0x14')](-0x6);logger['debug']('Fusion\x20serial\x20number:\x20'+_0x14825d);return _0x2986f3(_0x14825d);}});});};function getWifiStatus(){return new Promise((_0x1c3ba3,_0x5ce311)=>{wpa_cli[_0x420b('0x21')](classroomConnection[_0x420b('0x2f')],function(_0x3f8c28,_0x2ab890){if(_0x3f8c28){return _0x5ce311(_0x420b('0x13')+_0x3f8c28);}logger[_0x420b('0x8')](_0x420b('0x12')+JSON[_0x420b('0xb')](_0x2ab890));return _0x1c3ba3(_0x2ab890);});});};async function checkCommunityAccess(){const _0x393d98=_0x420b('0x36')+classroomConnection[_0x420b('0x2f')]+'\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27';const _0x1b9b79=await shell[_0x420b('0x19')](_0x393d98,{'silent':!![]})[_0x420b('0x1e')][_0x420b('0x15')]();logger[_0x420b('0x8')](_0x420b('0x2b')+_0x1b9b79);let _0x94a07c={'uri':'https://'+_0x1b9b79+_0x420b('0x2e')+classroomConnection['serial'],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x2a624f=await rp(_0x94a07c);logger[_0x420b('0x8')](JSON['stringify'](_0x2a624f));let _0x10cc0e=![];if(_0x2a624f[_0x420b('0x0')]){_0x10cc0e=_0x2a624f[_0x420b('0x0')][_0x420b('0x32')];}if(_0x10cc0e){let _0x1b729d={'ssid':_0x2a624f[_0x420b('0x3')][_0x420b('0xe')],'passphrase':_0x2a624f[_0x420b('0x3')][_0x420b('0x20')]};await checkIfOnClassroomNetwork(_0x1b729d);}else{logger[_0x420b('0x8')](_0x420b('0x17'));await tryNextClassroomNetork();}}catch(_0x14f93b){logger[_0x420b('0x4')](_0x420b('0x27')+_0x14f93b);await tryNextClassroomNetork();}};async function checkIfOnClassroomNetwork(_0x59ffbc){if(classroomConnection[_0x420b('0x1a')][_0x420b('0xe')]==_0x59ffbc['ssid']){logger[_0x420b('0x8')]('Already\x20connected\x20to\x20classroom\x20network');await connectSockets();}else{logger[_0x420b('0x8')](_0x420b('0x1b'));await connectToClassroomNetwork(_0x59ffbc);}};async function connectSockets(){logger['debug'](_0x420b('0x18'));await require(_0x420b('0x1c'));connection[_0x420b('0x1f')]=!![];};async function connectToClassroomNetwork(_0x2073e1){try{logger['debug'](_0x420b('0xc')+_0x2073e1['ssid']);let _0x51c0ad={'ssid':_0x2073e1[_0x420b('0xe')],'password':_0x2073e1[_0x420b('0x20')],'hidden':![]};await wireless[_0x420b('0x11')](_0x51c0ad);await connectSockets();}catch(_0x1ad837){logger[_0x420b('0x4')](_0x420b('0x2a')+_0x1ad837);}};async function getFallBackNetwork(){return new Promise((_0x46dc8d,_0x4f1eda)=>{let _0x5026e0=null;if(_0x5026e0){logger[_0x420b('0x8')]('Storing\x20fallback\x20network');}else{logger['debug'](_0x420b('0x2'));}return _0x46dc8d(null);});};async function restoreFallBackNetwork(){logger['debug'](_0x420b('0xa'));if(classroomConnection[_0x420b('0x23')]){logger[_0x420b('0x8')](_0x420b('0x2c')+classroomConnection['fallbackNetwork']);}else{logger[_0x420b('0x8')](_0x420b('0x2'));}};async function connectToHiddenClassroomNetwork(_0x2f91d9){try{logger[_0x420b('0x8')](_0x420b('0x16')+_0x2f91d9[_0x420b('0x28')]);let _0x147b6a={'ssid':_0x2f91d9[_0x420b('0x28')],'password':_0x2f91d9[_0x420b('0x5')],'hidden':!![]};await wireless['connectToNetwork'](_0x147b6a);logger[_0x420b('0x8')](_0x420b('0x2d'));await checkCommunityAccess();}catch(_0x463042){logger[_0x420b('0x4')](_0x463042);await tryNextClassroomNetork();}};async function tryNextClassroomNetork(){logger[_0x420b('0x8')]('Trying\x20next\x20hidden\x20classroom\x20network');let _0x365355=await getNextNetwork();if(_0x365355){logger[_0x420b('0x8')](_0x420b('0x24')+_0x365355[_0x420b('0x28')]);await connectToHiddenClassroomNetwork(_0x365355);}else{logger[_0x420b('0x8')](_0x420b('0x22'));await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x396f15=null;if(classroomConnection[_0x420b('0x35')]<classroomConnection[_0x420b('0x10')][_0x420b('0x29')])_0x396f15=classroomConnection[_0x420b('0x10')][classroomConnection['currentNetwork']++];return _0x396f15;};module[_0x420b('0x1d')]=connection;