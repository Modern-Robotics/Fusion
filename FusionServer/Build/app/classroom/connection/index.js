var _0x3899=['connectToNetwork','Error\x20connecting\x20to\x20classroom\x20network:\x20','Storing\x20fallback\x20network','No\x20fallback\x20network\x20found','fallbackNetwork','Fallback\x20network\x20found:\x20','hiddenSSID','hiddenPassword','On\x20hidden\x20network,\x20rechecking\x20community\x20access','warn','Trying\x20next\x20hidden\x20classroom\x20network','Next\x20network\x20is:\x20','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','currentNetwork','networks','length','exports','config','../../utils/logger','shelljs','./../../utils/wireless','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','fallBackNetwork','serial','wifiStatus','getMac','message','split','debug','Fusion\x20serial\x20number:\x20','Error\x20accessing\x20network\x20interface:\x20','Wifi\x20interface\x20status:\x20','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','wifiInterface','\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27','exec','stdout','trim','Gateway\x20found\x20at:\x20',':8443/api/v1/connect/','stringify','data','community_access','wifi','ssid','passphrase','Not\x20part\x20of\x20the\x20classroom\x20community','Unable\x20to\x20reach\x20classroom\x20community:\x20','Already\x20connected\x20to\x20classroom\x20network','Not\x20connected\x20to\x20classroom\x20network','Connecting\x20to\x20classroom:\x20'];(function(_0x29eed8,_0x4bb4aa){var _0x47e29c=function(_0x2d3fd2){while(--_0x2d3fd2){_0x29eed8['push'](_0x29eed8['shift']());}};_0x47e29c(++_0x4bb4aa);}(_0x3899,0x149));var _0x38ac=function(_0xd8adaa,_0x115267){_0xd8adaa=_0xd8adaa-0x0;var _0x244c78=_0x3899[_0xd8adaa];return _0x244c78;};const config=require(_0x38ac('0x0'));const logger=require(_0x38ac('0x1'));const rp=require('request-promise');const wpa_cli=require('wireless-tools/wpa_cli');const mac=require('getmac');const shell=require(_0x38ac('0x2'));const wireless=require(_0x38ac('0x3'));let classroomConnection={'wifiInterface':config['get']('Wifi_NIC'),'currentNetwork':0x0,'networks':[{'hiddenSSID':_0x38ac('0x4'),'hiddenPassword':_0x38ac('0x5')}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection[_0x38ac('0x6')]=await getFallBackNetwork();classroomConnection[_0x38ac('0x7')]=await getSerial();classroomConnection[_0x38ac('0x8')]=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x293f6d,_0x5a9fa0)=>{mac[_0x38ac('0x9')]({'iface':'eth0'},function(_0x4aef04,_0x2d7b02){if(_0x4aef04){return _0x5a9fa0(_0x4aef04[_0x38ac('0xa')]);}else{let _0x3614ed=_0x2d7b02[_0x38ac('0xb')](':')['join']('')['substr'](-0x6);logger[_0x38ac('0xc')](_0x38ac('0xd')+_0x3614ed);return _0x293f6d(_0x3614ed);}});});};function getWifiStatus(){return new Promise((_0x2df284,_0x42e060)=>{wpa_cli['status'](classroomConnection['wifiInterface'],function(_0x5bbb9e,_0x385127){if(_0x5bbb9e){return _0x42e060(_0x38ac('0xe')+_0x5bbb9e);}logger['debug'](_0x38ac('0xf')+JSON['stringify'](_0x385127));return _0x2df284(_0x385127);});});};async function checkCommunityAccess(){const _0x1c5682=_0x38ac('0x10')+classroomConnection[_0x38ac('0x11')]+_0x38ac('0x12');const _0x599195=await shell[_0x38ac('0x13')](_0x1c5682,{'silent':!![]})[_0x38ac('0x14')][_0x38ac('0x15')]();logger[_0x38ac('0xc')](_0x38ac('0x16')+_0x599195);let _0x5c06ee={'uri':'https://'+_0x599195+_0x38ac('0x17')+classroomConnection['serial'],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x4e0d78=await rp(_0x5c06ee);logger[_0x38ac('0xc')](JSON[_0x38ac('0x18')](_0x4e0d78));let _0x12c6f7=![];if(_0x4e0d78[_0x38ac('0x19')]){_0x12c6f7=_0x4e0d78['data'][_0x38ac('0x1a')];}if(_0x12c6f7){let _0x8e23={'ssid':_0x4e0d78[_0x38ac('0x1b')][_0x38ac('0x1c')],'passphrase':_0x4e0d78[_0x38ac('0x1b')][_0x38ac('0x1d')]};await checkIfOnClassroomNetwork(_0x8e23);}else{logger['debug'](_0x38ac('0x1e'));await tryNextClassroomNetwork();}}catch(_0x29790d){logger['warn'](_0x38ac('0x1f')+_0x29790d);await tryNextClassroomNetwork();}};async function checkIfOnClassroomNetwork(_0x38b7e3){if(classroomConnection['wifiStatus'][_0x38ac('0x1c')]==_0x38b7e3['ssid']){logger[_0x38ac('0xc')](_0x38ac('0x20'));await connectSockets();}else{logger['debug'](_0x38ac('0x21'));await connectToClassroomNetwork(_0x38b7e3);}};async function connectSockets(){logger[_0x38ac('0xc')]('Connecting\x20classroom\x20socket\x20communication');await require('../sockets');connection['connected']=!![];};async function connectToClassroomNetwork(_0x1070f7){try{logger[_0x38ac('0xc')](_0x38ac('0x22')+_0x1070f7[_0x38ac('0x1c')]);let _0x1b3674={'ssid':_0x1070f7[_0x38ac('0x1c')],'password':_0x1070f7[_0x38ac('0x1d')],'hidden':![]};await wireless[_0x38ac('0x23')](_0x1b3674);await connectSockets();}catch(_0x507e5b){logger['warn'](_0x38ac('0x24')+_0x507e5b);}};async function getFallBackNetwork(){return new Promise((_0xbce78e,_0xadaa26)=>{let _0x6d347d=null;if(_0x6d347d){logger[_0x38ac('0xc')](_0x38ac('0x25'));}else{logger[_0x38ac('0xc')](_0x38ac('0x26'));}return _0xbce78e(null);});};async function restoreFallBackNetwork(){logger[_0x38ac('0xc')]('Checking\x20for\x20fallback\x20network');if(classroomConnection[_0x38ac('0x27')]){logger[_0x38ac('0xc')](_0x38ac('0x28')+classroomConnection[_0x38ac('0x27')]);}else{logger['debug'](_0x38ac('0x26'));}};async function connectToHiddenClassroomNetwork(_0x4afd42){try{logger[_0x38ac('0xc')]('Connecting\x20to\x20hidden\x20classroom:\x20'+_0x4afd42[_0x38ac('0x29')]);let _0x1f959a={'ssid':_0x4afd42[_0x38ac('0x29')],'password':_0x4afd42[_0x38ac('0x2a')],'hidden':!![]};await wireless[_0x38ac('0x23')](_0x1f959a);logger[_0x38ac('0xc')](_0x38ac('0x2b'));await checkCommunityAccess();}catch(_0x4602ef){logger[_0x38ac('0x2c')](_0x4602ef);await tryNextClassroomNetwork();}};async function tryNextClassroomNetwork(){logger['debug'](_0x38ac('0x2d'));let _0x43ec65=await getNextNetwork();if(_0x43ec65){logger[_0x38ac('0xc')](_0x38ac('0x2e')+_0x43ec65[_0x38ac('0x29')]);await connectToHiddenClassroomNetwork(_0x43ec65);}else{logger[_0x38ac('0xc')](_0x38ac('0x2f'));await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x58dfec=null;if(classroomConnection[_0x38ac('0x30')]<classroomConnection[_0x38ac('0x31')][_0x38ac('0x32')])_0x58dfec=classroomConnection[_0x38ac('0x31')][classroomConnection[_0x38ac('0x30')]++];return _0x58dfec;};module[_0x38ac('0x33')]=connection;