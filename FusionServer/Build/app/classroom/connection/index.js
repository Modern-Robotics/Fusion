const _0x4980=['Checking\x20for\x20fallback\x20network','community_access','serial','Error\x20accessing\x20network\x20interface:\x20','522117KBfhcw','join','networks','358kThHoH','Fusion\x20serial\x20number:\x20','../../utils/logger','Connecting\x20to\x20hidden\x20classroom:\x20','get','1394216SiScvY','CMMthgilxoBsecure','request-promise','3dAJqfj','Gateway\x20found\x20at:\x20','9421BqqGlR','trim','hiddenPassword','passphrase','wifi','139DgDoSw','Not\x20part\x20of\x20the\x20classroom\x20community','exports','wifiStatus','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','Storing\x20fallback\x20network','ssid','wifiInterface','Connecting\x20to\x20classroom:\x20','No\x20fallback\x20network\x20found','stringify','status','hiddenSSID','stdout','message','Trying\x20next\x20hidden\x20classroom\x20network','Not\x20connected\x20to\x20classroom\x20network','Wifi\x20interface\x20status:\x20','currentNetwork','24033EMvVQk','substr','./../../utils/wireless','connectToNetwork','debug','fallBackNetwork','Wifi_NIC','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network','Connecting\x20classroom\x20socket\x20communication','Unable\x20to\x20reach\x20classroom\x20community:\x20','Fallback\x20network\x20found:\x20','fallbackNetwork','warn','On\x20hidden\x20network,\x20rechecking\x20community\x20access','131CyxGcU','length','data','947tGCNaU','Error\x20connecting\x20to\x20classroom\x20network:\x20','eth0','11779NBWTOD','https://','942069CReNYz','split'];const _0x402f=function(_0x4a94ba,_0x5b0480){_0x4a94ba=_0x4a94ba-0xee;let _0x4980f9=_0x4980[_0x4a94ba];return _0x4980f9;};const _0x3a6d93=_0x402f;(function(_0x2b7fbf,_0x8759f8){const _0xca8d38=_0x402f;while(!![]){try{const _0xc33183=parseInt(_0xca8d38(0x11a))+parseInt(_0xca8d38(0x12d))*-parseInt(_0xca8d38(0x12b))+parseInt(_0xca8d38(0x123))*parseInt(_0xca8d38(0x115))+parseInt(_0xca8d38(0x118))*-parseInt(_0xca8d38(0xf1))+-parseInt(_0xca8d38(0x128))+-parseInt(_0xca8d38(0x120))+-parseInt(_0xca8d38(0x112))*-parseInt(_0xca8d38(0x104));if(_0xc33183===_0x8759f8)break;else _0x2b7fbf['push'](_0x2b7fbf['shift']());}catch(_0x136062){_0x2b7fbf['push'](_0x2b7fbf['shift']());}}}(_0x4980,0xceeb5));const config=require('config'),logger=require(_0x3a6d93(0x125)),rp=require(_0x3a6d93(0x12a)),wpa_cli=require('wireless-tools/wpa_cli'),mac=require('getmac'),shell=require('shelljs'),wireless=require(_0x3a6d93(0x106));let classroomConnection={'wifiInterface':config[_0x3a6d93(0x127)](_0x3a6d93(0x10a)),'currentNetwork':0x0,'networks':[{'hiddenSSID':'MyBot_Gatekeeper_WiFi','hiddenPassword':_0x3a6d93(0x129)}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){const _0x11bfeb=_0x3a6d93;classroomConnection[_0x11bfeb(0x109)]=await getFallBackNetwork(),classroomConnection['serial']=await getSerial(),classroomConnection[_0x11bfeb(0xf4)]=await getWifiStatus(),await checkCommunityAccess();}};function getSerial(){return new Promise((_0x1afe71,_0x304f46)=>{const _0x159dc3=_0x402f;mac['getMac']({'iface':_0x159dc3(0x117)},function(_0x527061,_0x534ff8){const _0x498310=_0x159dc3;if(_0x527061)return _0x304f46(_0x527061[_0x498310(0xff)]);else{let _0x25be63=_0x534ff8[_0x498310(0x11b)](':')[_0x498310(0x121)]('')[_0x498310(0x105)](-0x6);return logger[_0x498310(0x108)](_0x498310(0x124)+_0x25be63),_0x1afe71(_0x25be63);}});});};function getWifiStatus(){return new Promise((_0x378732,_0x5e39be)=>{const _0x29c63d=_0x402f;wpa_cli[_0x29c63d(0xfc)](classroomConnection[_0x29c63d(0xf8)],function(_0xd03e44,_0x7dd347){const _0x3d3360=_0x29c63d;if(_0xd03e44)return _0x5e39be(_0x3d3360(0x11f)+_0xd03e44);return logger[_0x3d3360(0x108)](_0x3d3360(0x102)+JSON[_0x3d3360(0xfb)](_0x7dd347)),_0x378732(_0x7dd347);});});};async function checkCommunityAccess(){const _0x520516=_0x3a6d93,_0x50451d=_0x520516(0xf5)+classroomConnection[_0x520516(0xf8)]+'\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27',_0x55eb28=await shell['exec'](_0x50451d,{'silent':!![]})[_0x520516(0xfe)][_0x520516(0x12e)]();logger[_0x520516(0x108)](_0x520516(0x12c)+_0x55eb28);let _0x3ed867={'uri':_0x520516(0x119)+_0x55eb28+':8443/api/v1/connect/'+classroomConnection[_0x520516(0x11e)],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x55a984=await rp(_0x3ed867);logger[_0x520516(0x108)](JSON['stringify'](_0x55a984));let _0x2270eb=![];_0x55a984['data']&&(_0x2270eb=_0x55a984[_0x520516(0x114)][_0x520516(0x11d)]);if(_0x2270eb){let _0x5abe43={'ssid':_0x55a984[_0x520516(0xf0)][_0x520516(0xf7)],'passphrase':_0x55a984[_0x520516(0xf0)]['passphrase']};await checkIfOnClassroomNetwork(_0x5abe43);}else logger[_0x520516(0x108)](_0x520516(0xf2)),await tryNextClassroomNetwork();}catch(_0x4ddf3c){logger[_0x520516(0x110)](_0x520516(0x10d)+_0x4ddf3c),await tryNextClassroomNetwork();}};async function checkIfOnClassroomNetwork(_0x4ec843){const _0x2ec9f1=_0x3a6d93;classroomConnection[_0x2ec9f1(0xf4)]['ssid']==_0x4ec843[_0x2ec9f1(0xf7)]?(logger[_0x2ec9f1(0x108)]('Already\x20connected\x20to\x20classroom\x20network'),await connectSockets()):(logger[_0x2ec9f1(0x108)](_0x2ec9f1(0x101)),await connectToClassroomNetwork(_0x4ec843));};async function connectSockets(){const _0x51fefd=_0x3a6d93;logger[_0x51fefd(0x108)](_0x51fefd(0x10c)),await require('../sockets'),connection['connected']=!![];};async function connectToClassroomNetwork(_0x3da917){const _0x163b85=_0x3a6d93;try{logger['debug'](_0x163b85(0xf9)+_0x3da917[_0x163b85(0xf7)]);let _0x4ab6b4={'ssid':_0x3da917[_0x163b85(0xf7)],'password':_0x3da917[_0x163b85(0xef)],'hidden':![]};await wireless['connectToNetwork'](_0x4ab6b4),await connectSockets();}catch(_0x4e4906){logger[_0x163b85(0x110)](_0x163b85(0x116)+_0x4e4906);}};async function getFallBackNetwork(){return new Promise((_0x378d68,_0x5538aa)=>{const _0x4d863d=_0x402f;let _0x5aa58b=null;return _0x5aa58b?logger[_0x4d863d(0x108)](_0x4d863d(0xf6)):logger['debug'](_0x4d863d(0xfa)),_0x378d68(null);});};async function restoreFallBackNetwork(){const _0x37119e=_0x3a6d93;logger[_0x37119e(0x108)](_0x37119e(0x11c)),classroomConnection['fallbackNetwork']?logger[_0x37119e(0x108)](_0x37119e(0x10e)+classroomConnection[_0x37119e(0x10f)]):logger[_0x37119e(0x108)](_0x37119e(0xfa));};async function connectToHiddenClassroomNetwork(_0x5a7a07){const _0x2a7317=_0x3a6d93;try{logger[_0x2a7317(0x108)](_0x2a7317(0x126)+_0x5a7a07[_0x2a7317(0xfd)]);let _0x3e8902={'ssid':_0x5a7a07[_0x2a7317(0xfd)],'password':_0x5a7a07[_0x2a7317(0xee)],'hidden':!![]};await wireless[_0x2a7317(0x107)](_0x3e8902),logger[_0x2a7317(0x108)](_0x2a7317(0x111)),await checkCommunityAccess();}catch(_0x18bc4b){logger[_0x2a7317(0x110)](_0x18bc4b),await tryNextClassroomNetwork();}};async function tryNextClassroomNetwork(){const _0x48d1eb=_0x3a6d93;logger[_0x48d1eb(0x108)](_0x48d1eb(0x100));let _0x1c46a2=await getNextNetwork();_0x1c46a2?(logger[_0x48d1eb(0x108)]('Next\x20network\x20is:\x20'+_0x1c46a2[_0x48d1eb(0xfd)]),await connectToHiddenClassroomNetwork(_0x1c46a2)):(logger[_0x48d1eb(0x108)](_0x48d1eb(0x10b)),await restoreFallBackNetwork());};async function getNextNetwork(){const _0x5037a0=_0x3a6d93;let _0x4fa906=null;if(classroomConnection[_0x5037a0(0x103)]<classroomConnection[_0x5037a0(0x122)][_0x5037a0(0x113)])_0x4fa906=classroomConnection['networks'][classroomConnection['currentNetwork']++];return _0x4fa906;};module[_0x3a6d93(0xf3)]=connection;