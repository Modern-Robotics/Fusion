const _0x3818=['Checking\x20for\x20fallback\x20network','length','Error\x20accessing\x20network\x20interface:\x20','../sockets','passphrase','./../../utils/wireless','connected','../../utils/logger','ssid','get','serial',':8443/api/v1/connect/','Not\x20part\x20of\x20the\x20classroom\x20community','ip\x20route\x20show\x20|\x20grep\x20-i\x20\x27','community_access','fallBackNetwork','status','stdout','exec','split','shelljs','Not\x20connected\x20to\x20classroom\x20network','Storing\x20fallback\x20network','No\x20fallback\x20network\x20found','connectToNetwork','join','warn','stringify','fallbackNetwork','wifiStatus','data','debug','Error\x20connecting\x20to\x20classroom\x20network:\x20','currentNetwork','Already\x20connected\x20to\x20classroom\x20network','Fusion\x20serial\x20number:\x20','wireless-tools/wpa_cli','exports','getMac','Wifi_NIC','request-promise','Next\x20network\x20is:\x20','hiddenSSID','networks','Connecting\x20to\x20hidden\x20classroom:\x20','Wifi\x20interface\x20status:\x20','message','https://','config','trim','No\x20more\x20networks\x20to\x20try.\x20Restoring\x20fallback\x20network'];(function(_0x2f09b4,_0x381881){const _0x2e4935=function(_0x2e833a){while(--_0x2e833a){_0x2f09b4['push'](_0x2f09b4['shift']());}};_0x2e4935(++_0x381881);}(_0x3818,0x129));const _0x2e49=function(_0x2f09b4,_0x381881){_0x2f09b4=_0x2f09b4-0x0;let _0x2e4935=_0x3818[_0x2f09b4];return _0x2e4935;};const config=require(_0x2e49('0x6'));const logger=require(_0x2e49('0x10'));const rp=require(_0x2e49('0x31'));const wpa_cli=require(_0x2e49('0x2d'));const mac=require('getmac');const shell=require(_0x2e49('0x1d'));const wireless=require(_0x2e49('0xe'));let classroomConnection={'wifiInterface':config[_0x2e49('0x12')](_0x2e49('0x30')),'currentNetwork':0x0,'networks':[{'hiddenSSID':'MyBot_Gatekeeper_WiFi','hiddenPassword':'CMMthgilxoBsecure'}],'serial':null,'wifiStatus':null,'fallbackNetwork':null};const connection={'connected':![],'connect':async function(){classroomConnection[_0x2e49('0x18')]=await getFallBackNetwork();classroomConnection[_0x2e49('0x13')]=await getSerial();classroomConnection[_0x2e49('0x26')]=await getWifiStatus();await checkCommunityAccess();}};function getSerial(){return new Promise((_0x38d953,_0x2b196b)=>{mac[_0x2e49('0x2f')]({'iface':'eth0'},function(_0x5439e5,_0x2bfc72){if(_0x5439e5){return _0x2b196b(_0x5439e5[_0x2e49('0x4')]);}else{let _0x138e61=_0x2bfc72[_0x2e49('0x1c')](':')[_0x2e49('0x22')]('')['substr'](-0x6);logger[_0x2e49('0x28')](_0x2e49('0x2c')+_0x138e61);return _0x38d953(_0x138e61);}});});};function getWifiStatus(){return new Promise((_0x3508d7,_0x1cb9cc)=>{wpa_cli[_0x2e49('0x19')](classroomConnection['wifiInterface'],function(_0x32a227,_0x402527){if(_0x32a227){return _0x1cb9cc(_0x2e49('0xb')+_0x32a227);}logger['debug'](_0x2e49('0x3')+JSON[_0x2e49('0x24')](_0x402527));return _0x3508d7(_0x402527);});});};async function checkCommunityAccess(){const _0x194ebb=_0x2e49('0x16')+classroomConnection['wifiInterface']+'\x20\x20metric\x27\x20|\x20awk\x20\x27{print\x20$3}\x27';const _0x2b43c7=await shell[_0x2e49('0x1b')](_0x194ebb,{'silent':!![]})[_0x2e49('0x1a')][_0x2e49('0x7')]();logger[_0x2e49('0x28')]('Gateway\x20found\x20at:\x20'+_0x2b43c7);let _0x57825e={'uri':_0x2e49('0x5')+_0x2b43c7+_0x2e49('0x14')+classroomConnection[_0x2e49('0x13')],'rejectUnauthorized':![],'json':!![],'timeout':0x1388};try{let _0x427b19=await rp(_0x57825e);logger[_0x2e49('0x28')](JSON['stringify'](_0x427b19));let _0x5ba525=![];if(_0x427b19['data']){_0x5ba525=_0x427b19[_0x2e49('0x27')][_0x2e49('0x17')];}if(_0x5ba525){let _0x2e1800={'ssid':_0x427b19['wifi'][_0x2e49('0x11')],'passphrase':_0x427b19['wifi'][_0x2e49('0xd')]};await checkIfOnClassroomNetwork(_0x2e1800);}else{logger[_0x2e49('0x28')](_0x2e49('0x15'));await tryNextClassroomNetwork();}}catch(_0x19b2c5){logger[_0x2e49('0x23')]('Unable\x20to\x20reach\x20classroom\x20community:\x20'+_0x19b2c5);await tryNextClassroomNetwork();}};async function checkIfOnClassroomNetwork(_0x403322){if(classroomConnection[_0x2e49('0x26')]['ssid']==_0x403322[_0x2e49('0x11')]){logger['debug'](_0x2e49('0x2b'));await connectSockets();}else{logger['debug'](_0x2e49('0x1e'));await connectToClassroomNetwork(_0x403322);}};async function connectSockets(){logger[_0x2e49('0x28')]('Connecting\x20classroom\x20socket\x20communication');await require(_0x2e49('0xc'));connection[_0x2e49('0xf')]=!![];};async function connectToClassroomNetwork(_0x55a552){try{logger[_0x2e49('0x28')]('Connecting\x20to\x20classroom:\x20'+_0x55a552[_0x2e49('0x11')]);let _0x4755ea={'ssid':_0x55a552[_0x2e49('0x11')],'password':_0x55a552[_0x2e49('0xd')],'hidden':![]};await wireless[_0x2e49('0x21')](_0x4755ea);await connectSockets();}catch(_0x356942){logger['warn'](_0x2e49('0x29')+_0x356942);}};async function getFallBackNetwork(){return new Promise((_0x5515b3,_0x39455d)=>{let _0x160f7=null;if(_0x160f7){logger[_0x2e49('0x28')](_0x2e49('0x1f'));}else{logger['debug'](_0x2e49('0x20'));}return _0x5515b3(null);});};async function restoreFallBackNetwork(){logger['debug'](_0x2e49('0x9'));if(classroomConnection[_0x2e49('0x25')]){logger[_0x2e49('0x28')]('Fallback\x20network\x20found:\x20'+classroomConnection[_0x2e49('0x25')]);}else{logger[_0x2e49('0x28')](_0x2e49('0x20'));}};async function connectToHiddenClassroomNetwork(_0x5a754b){try{logger[_0x2e49('0x28')](_0x2e49('0x2')+_0x5a754b[_0x2e49('0x0')]);let _0x10b308={'ssid':_0x5a754b[_0x2e49('0x0')],'password':_0x5a754b['hiddenPassword'],'hidden':!![]};await wireless[_0x2e49('0x21')](_0x10b308);logger['debug']('On\x20hidden\x20network,\x20rechecking\x20community\x20access');await checkCommunityAccess();}catch(_0x256bac){logger['warn'](_0x256bac);await tryNextClassroomNetwork();}};async function tryNextClassroomNetwork(){logger['debug']('Trying\x20next\x20hidden\x20classroom\x20network');let _0x534cde=await getNextNetwork();if(_0x534cde){logger[_0x2e49('0x28')](_0x2e49('0x32')+_0x534cde['hiddenSSID']);await connectToHiddenClassroomNetwork(_0x534cde);}else{logger['debug'](_0x2e49('0x8'));await restoreFallBackNetwork();}};async function getNextNetwork(){let _0x3bc8c8=null;if(classroomConnection['currentNetwork']<classroomConnection[_0x2e49('0x1')][_0x2e49('0xa')])_0x3bc8c8=classroomConnection['networks'][classroomConnection[_0x2e49('0x2a')]++];return _0x3bc8c8;};module[_0x2e49('0x2e')]=connection;