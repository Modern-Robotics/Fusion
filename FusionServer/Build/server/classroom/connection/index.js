const _0x2ed7=['Could\x20not\x20access\x20classroom\x20environment','Wifi_NIC','POST','wifiInterface','Fusion\x20is\x20part\x20of\x20community','connected','attemptConnection','passphrase','Connecting\x20to\x20hidden\x20network',':8443/api/v1/connect/','https://10.200.200.1','message','Error\x20connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20hidden\x20network','Current\x20network:\x20','./../sockets/','status','wireless-tools/wpa_cli','request-promise','Failed\x20to\x20update\x20ip\x20address','serverMessage','ssid','c3online.edu:8443','CMMthgilxoBsecure','hiddenSSID','Can\x20reach\x20community','info','c3online.edu','MyBot_Gatekeeper_WiFi','Wifi\x20dongle\x20found','partOfCommunity','globalUrl','wifi','hiddenPassword','./../../../config/serial','exports','Fusion\x20not\x20part\x20of\x20this\x20community'];(function(_0x9df1a7,_0x2ed755){const _0x2ab1b3=function(_0x5db2ad){while(--_0x5db2ad){_0x9df1a7['push'](_0x9df1a7['shift']());}};_0x2ab1b3(++_0x2ed755);}(_0x2ed7,0x8d));const _0x2ab1=function(_0x9df1a7,_0x2ed755){_0x9df1a7=_0x9df1a7-0x0;let _0x2ab1b3=_0x2ed7[_0x9df1a7];return _0x2ab1b3;};const winston=require('winston');const rp=require(_0x2ab1('0x19'));const wpa_cli=require(_0x2ab1('0x18'));const config=require('config');const settings={'wifiInterface':config['get'](_0x2ab1('0x8'))};const classroomConnection={'url':_0x2ab1('0x22'),'classroomBackend':'c3online.edu/backend','classroomAPI':_0x2ab1('0x1d'),'globalUrl':_0x2ab1('0x11'),'connected':![],'hiddenSSID':_0x2ab1('0x23'),'hiddenPassword':_0x2ab1('0x1e')};classroomConnection[_0x2ab1('0xd')]=function(){return new Promise(async function(_0x4c6214,_0x2ec2e3){try{const _0x40447f=await require(_0x2ab1('0x4'));const _0x423f3d=_0x40447f['serialId'];await checkHasWirelessDongle();let _0x1199d5=await communityReachable();if(!_0x1199d5)await connectToHiddenClassroomNetwork();let _0x40a799=await determineCommunityAccess(_0x423f3d);if(_0x40a799[_0x2ab1('0x0')]){let _0x2680b6=await getConnectedNetworkName();winston['info'](_0x2ab1('0x15')+_0x2680b6);if(_0x2680b6!=_0x40a799['wifi'][_0x2ab1('0x1c')])await connectToClassroomNetwork(_0x40a799['wifi'][_0x2ab1('0x1c')],_0x40a799[_0x2ab1('0x2')][_0x2ab1('0xe')]);await updateIPAddress(_0x423f3d);await require(_0x2ab1('0x16'));classroomConnection[_0x2ab1('0xc')]=!![];}return _0x4c6214();}catch(_0x19640c){winston[_0x2ab1('0x21')](_0x19640c);return _0x4c6214();}});};function checkHasWirelessDongle(){return new Promise(function(_0x352687,_0x45b1f2){wpa_cli[_0x2ab1('0x17')](settings[_0x2ab1('0xa')],function(_0x2fda32,_0x15df8a){if(_0x2fda32){return _0x45b1f2('Error\x20accessing\x20wifi\x20dongle');}winston[_0x2ab1('0x21')]('Wireless\x20dongle\x20detected');return _0x352687(_0x2ab1('0x24'));});});};function determineCommunityAccess(_0x2c2adc){return new Promise(async function(_0x79b215,_0x526415){let _0x3b5d4c={'uri':classroomConnection['globalUrl']+_0x2ab1('0x10')+_0x2c2adc,'rejectUnauthorized':![],'json':!![],'timeout':0x2710};try{let _0x37456a=await rp(_0x3b5d4c);if(_0x37456a[_0x2ab1('0x12')]!='Fusion\x20not\x20part\x20of\x20community'){_0x37456a[_0x2ab1('0x0')]=!![];winston['info'](_0x2ab1('0xb'));}else{_0x37456a[_0x2ab1('0x0')]=![];winston[_0x2ab1('0x21')](_0x2ab1('0x6'));}return _0x79b215(_0x37456a);}catch(_0x20a92f){return _0x526415(_0x2ab1('0x7'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x5ae063,_0x1f4df6){try{winston[_0x2ab1('0x21')](_0x2ab1('0xf'));let _0xb90735={'method':_0x2ab1('0x9'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x2ab1('0x1f')],'password':classroomConnection[_0x2ab1('0x3')],'hiddenNetwork':!![]},'json':!![]};let _0x10df28=await rp(_0xb90735);winston[_0x2ab1('0x21')](_0x10df28[_0x2ab1('0x1b')]);return _0x5ae063(_0x10df28);}catch(_0x559ccc){winston['info'](_0x2ab1('0x14'));winston[_0x2ab1('0x21')](_0x559ccc);return _0x1f4df6(_0x559ccc);}});};function connectToClassroomNetwork(_0x8754c0,_0x45c53d){return new Promise(async function(_0x5d51ea,_0x2cc9a6){try{winston[_0x2ab1('0x21')]('Connecting\x20to\x20classroom\x20network');let _0x46277f={'method':_0x2ab1('0x9'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':_0x8754c0,'password':_0x45c53d},'json':!![]};let _0x582cce=await rp(_0x46277f);winston[_0x2ab1('0x21')](_0x582cce[_0x2ab1('0x1b')]);return _0x5d51ea(_0x582cce);}catch(_0x434783){winston['info'](_0x2ab1('0x13'));winston['info'](_0x434783);return _0x2cc9a6(_0x434783);}});};function getConnectedNetworkName(){return new Promise(function(_0x55c64e,_0xa3495e){wpa_cli[_0x2ab1('0x17')](settings[_0x2ab1('0xa')],function(_0x583c0e,_0x2ec761){if(_0x583c0e)return _0xa3495e(_0x583c0e);return _0x55c64e(_0x2ec761[_0x2ab1('0x1c')]);});});};function updateIPAddress(_0x44baca){return new Promise(async function(_0x295fc6,_0x2c09b3){let _0x220e6f={'uri':classroomConnection[_0x2ab1('0x1')]+_0x2ab1('0x10')+_0x44baca,'rejectUnauthorized':![],'json':!![],'resolveWithFullResponse':!![],'timeout':0x2710};try{let _0x2e52ed=await rp(_0x220e6f);winston['info']('Updated\x20ip\x20address!');return _0x295fc6(_0x2e52ed);}catch(_0x382d9f){winston[_0x2ab1('0x21')](_0x2ab1('0x1a'));return _0x2c09b3(_0x382d9f);}});};function communityReachable(){return new Promise(async function(_0x536380,_0x65d29e){try{let _0x344726={'uri':classroomConnection['globalUrl'],'rejectUnauthorized':![],'json':!![],'timeout':0x2710};await rp(_0x344726);winston[_0x2ab1('0x21')](_0x2ab1('0x20'));return _0x536380(!![]);}catch(_0x5cb453){winston[_0x2ab1('0x21')]('Community\x20unreachable');return _0x536380(![]);}});};module[_0x2ab1('0x5')]=classroomConnection;