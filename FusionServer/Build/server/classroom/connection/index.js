var _0x1746=['c3online.edu:8443','https://10.200.200.1','otherdemokey','attemptConnection','./../../../config/serial','partOfCommunity','info','Current\x20network:\x20','wifi','ssid','passphrase','./../sockets/','connected','status','wifiInterface','Wireless\x20dongle\x20detected','Wifi\x20dongle\x20found','globalUrl','message','Fusion\x20not\x20part\x20of\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','POST','http://localhost:8080/api/admin/wirelessConnections','hiddenSSID','hiddenPassword','serverMessage','Connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20classroom\x20network',':8443/api/v1/connect/','Can\x20reach\x20community','Community\x20unreachable','request-promise','c3online.edu/backend'];(function(_0xffcf02,_0x8434c6){var _0x47513c=function(_0x4dc76b){while(--_0x4dc76b){_0xffcf02['push'](_0xffcf02['shift']());}};_0x47513c(++_0x8434c6);}(_0x1746,0x130));var _0xeaaa=function(_0x498a6c,_0x39307d){_0x498a6c=_0x498a6c-0x0;var _0x26a603=_0x1746[_0x498a6c];return _0x26a603;};const winston=require('winston');const rp=require(_0xeaaa('0x0'));const wpa_cli=require('wireless-tools/wpa_cli');const settings={'wifiInterface':'wlan1'};const classroomConnection={'url':'c3online.edu','classroomBackend':_0xeaaa('0x1'),'classroomAPI':_0xeaaa('0x2'),'globalUrl':_0xeaaa('0x3'),'connected':![],'hiddenSSID':'virtual.c3edu.online','hiddenPassword':_0xeaaa('0x4')};classroomConnection[_0xeaaa('0x5')]=function(){return new Promise(async function(_0x789469,_0x5e3719){try{const _0x54bbb2=await require(_0xeaaa('0x6'));const _0x256ecb=_0x54bbb2['serialId'];await checkHasWirelessDongle();let _0x584174=await communityReachable();if(!_0x584174)await connectToHiddenClassroomNetwork();let _0x222439=await determineCommunityAccess(_0x256ecb);if(_0x222439[_0xeaaa('0x7')]){let _0x4ed9ad=await getConnectedNetworkName();winston[_0xeaaa('0x8')](_0xeaaa('0x9')+_0x4ed9ad);if(_0x4ed9ad!=_0x222439[_0xeaaa('0xa')][_0xeaaa('0xb')])await connectToClassroomNetwork(_0x222439[_0xeaaa('0xa')][_0xeaaa('0xb')],_0x222439[_0xeaaa('0xa')][_0xeaaa('0xc')]);await updateIPAddress(_0x256ecb);await require(_0xeaaa('0xd'));classroomConnection[_0xeaaa('0xe')]=!![];}return _0x789469();}catch(_0x49b522){winston[_0xeaaa('0x8')](_0x49b522);return _0x789469();}});};function checkHasWirelessDongle(){return new Promise(function(_0x15dbf2,_0x378227){wpa_cli[_0xeaaa('0xf')](settings[_0xeaaa('0x10')],function(_0x4481a4,_0x1c6085){if(_0x4481a4){return _0x378227('Error\x20accessing\x20wifi\x20dongle');}winston[_0xeaaa('0x8')](_0xeaaa('0x11'));return _0x15dbf2(_0xeaaa('0x12'));});});};function determineCommunityAccess(_0xfd7abb){return new Promise(async function(_0x5246f2,_0x3c033a){let _0x32d38c={'uri':classroomConnection[_0xeaaa('0x13')]+':8443/api/v1/connect/'+_0xfd7abb,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x18adb1=await rp(_0x32d38c);if(_0x18adb1[_0xeaaa('0x14')]!=_0xeaaa('0x15')){_0x18adb1[_0xeaaa('0x7')]=!![];winston['info']('Fusion\x20is\x20part\x20of\x20community');}else{_0x18adb1[_0xeaaa('0x7')]=![];winston[_0xeaaa('0x8')]('Fusion\x20not\x20part\x20of\x20this\x20community');}return _0x5246f2(_0x18adb1);}catch(_0x185f58){return _0x3c033a(_0xeaaa('0x16'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x3bad3f,_0x32acba){try{winston[_0xeaaa('0x8')](_0xeaaa('0x17'));let _0x2d7a2a={'method':_0xeaaa('0x18'),'uri':_0xeaaa('0x19'),'body':{'ssid':classroomConnection[_0xeaaa('0x1a')],'password':classroomConnection[_0xeaaa('0x1b')],'hiddenNetwork':!![]},'json':!![]};let _0x2e76db=await rp(_0x2d7a2a);winston['info'](_0x2e76db[_0xeaaa('0x1c')]);return _0x3bad3f(_0x2e76db);}catch(_0x33fdc6){winston['info']('Error\x20connecting\x20to\x20hidden\x20network');winston[_0xeaaa('0x8')](_0x33fdc6);return _0x32acba(_0x33fdc6);}});};function connectToClassroomNetwork(_0x5c5724,_0xb4bf80){return new Promise(async function(_0x2e9dc4,_0x3d29fa){try{winston[_0xeaaa('0x8')](_0xeaaa('0x1d'));let _0xe234e3={'method':_0xeaaa('0x18'),'uri':_0xeaaa('0x19'),'body':{'ssid':_0x5c5724,'password':_0xb4bf80},'json':!![]};let _0xd5f6f6=await rp(_0xe234e3);winston[_0xeaaa('0x8')](_0xd5f6f6[_0xeaaa('0x1c')]);return _0x2e9dc4(_0xd5f6f6);}catch(_0x23b8ec){winston[_0xeaaa('0x8')](_0xeaaa('0x1e'));winston['info'](_0x23b8ec);return _0x3d29fa(_0x23b8ec);}});};function getConnectedNetworkName(){return new Promise(function(_0x19b198,_0x3c07f4){wpa_cli[_0xeaaa('0xf')](settings[_0xeaaa('0x10')],function(_0x2c2ad3,_0x45a58b){if(_0x2c2ad3)return _0x3c07f4(_0x2c2ad3);return _0x19b198(_0x45a58b[_0xeaaa('0xb')]);});});};function updateIPAddress(_0x2b0b9f){return new Promise(async function(_0x4e43cd,_0x228cae){try{let _0x2291a5={'uri':classroomConnection[_0xeaaa('0x13')]+_0xeaaa('0x1f')+_0x2b0b9f,'rejectUnauthorized':![],'json':!![]};await rp(_0x2291a5);return _0x4e43cd();}catch(_0x41cfb0){return _0x228cae(_0x41cfb0);}});};function communityReachable(){return new Promise(async function(_0x38a2ba,_0xba0b73){try{let _0x356f43={'uri':classroomConnection[_0xeaaa('0x13')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x356f43);winston[_0xeaaa('0x8')](_0xeaaa('0x20'));return _0x38a2ba(!![]);}catch(_0x450930){winston[_0xeaaa('0x8')](_0xeaaa('0x21'));return _0x38a2ba(![]);}});};module['exports']=classroomConnection;