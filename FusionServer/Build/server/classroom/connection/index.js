var _0x4fcb=['wifi','ssid','passphrase','connected','status','Wireless\x20dongle\x20detected','Wifi\x20dongle\x20found',':8443/api/v1/connect/','message','Fusion\x20is\x20part\x20of\x20community','partOfCommunity','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','hiddenSSID','serverMessage','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network','POST','http://localhost:8080/api/admin/wirelessConnections','wifiInterface','globalUrl','Can\x20reach\x20community','Community\x20unreachable','winston','request-promise','wireless-tools/wpa_cli','wlan1','c3online.edu','c3online.edu/backend','https://10.200.200.1','virtual.c3edu.online','otherdemokey','attemptConnection','./../../../config/serial','serialId','info'];(function(_0x45e533,_0x54bd8b){var _0x49c50a=function(_0x39bb32){while(--_0x39bb32){_0x45e533['push'](_0x45e533['shift']());}};_0x49c50a(++_0x54bd8b);}(_0x4fcb,0xac));var _0x387b=function(_0x5b4ed4,_0x3ff53c){_0x5b4ed4=_0x5b4ed4-0x0;var _0x9c5964=_0x4fcb[_0x5b4ed4];return _0x9c5964;};const winston=require(_0x387b('0x0'));const rp=require(_0x387b('0x1'));const wpa_cli=require(_0x387b('0x2'));const settings={'wifiInterface':_0x387b('0x3')};const classroomConnection={'url':_0x387b('0x4'),'classroomBackend':_0x387b('0x5'),'classroomAPI':'c3online.edu:8443','globalUrl':_0x387b('0x6'),'connected':![],'hiddenSSID':_0x387b('0x7'),'hiddenPassword':_0x387b('0x8')};classroomConnection[_0x387b('0x9')]=function(){return new Promise(async function(_0x7d3cd5,_0x30d1c3){try{const _0x542b26=await require(_0x387b('0xa'));const _0x5c516a=_0x542b26[_0x387b('0xb')];await checkHasWirelessDongle();let _0x596375=await communityReachable();if(!_0x596375)await connectToHiddenClassroomNetwork();let _0x1469f8=await determineCommunityAccess(_0x5c516a);if(_0x1469f8['partOfCommunity']){let _0x77c773=await getConnectedNetworkName();winston[_0x387b('0xc')]('Current\x20network:\x20'+_0x77c773);if(_0x77c773!=_0x1469f8[_0x387b('0xd')][_0x387b('0xe')])await connectToClassroomNetwork(_0x1469f8[_0x387b('0xd')]['ssid'],_0x1469f8['wifi'][_0x387b('0xf')]);await updateIPAddress(_0x5c516a);await require('./../sockets/');classroomConnection[_0x387b('0x10')]=!![];}return _0x7d3cd5();}catch(_0x5de12f){winston[_0x387b('0xc')](_0x5de12f);return _0x7d3cd5();}});};function checkHasWirelessDongle(){return new Promise(function(_0x3c7c99,_0x3fac28){wpa_cli[_0x387b('0x11')](settings['wifiInterface'],function(_0x3ba0dc,_0x24872f){if(_0x3ba0dc){return _0x3fac28('Error\x20accessing\x20wifi\x20dongle');}winston[_0x387b('0xc')](_0x387b('0x12'));return _0x3c7c99(_0x387b('0x13'));});});};function determineCommunityAccess(_0x430df1){return new Promise(async function(_0x3d8730,_0x6067e5){let _0x319464={'uri':classroomConnection['globalUrl']+_0x387b('0x14')+_0x430df1,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0xc5e0ae=await rp(_0x319464);if(_0xc5e0ae[_0x387b('0x15')]!='Fusion\x20not\x20part\x20of\x20community'){_0xc5e0ae['partOfCommunity']=!![];winston['info'](_0x387b('0x16'));}else{_0xc5e0ae[_0x387b('0x17')]=![];winston[_0x387b('0xc')](_0x387b('0x18'));}return _0x3d8730(_0xc5e0ae);}catch(_0x2915f5){return _0x6067e5(_0x387b('0x19'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x3e201b,_0x4a02f8){try{winston[_0x387b('0xc')](_0x387b('0x1a'));let _0x1babcf={'method':'POST','uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x387b('0x1b')],'password':classroomConnection['hiddenPassword'],'hiddenNetwork':!![]},'json':!![]};let _0x2de0e7=await rp(_0x1babcf);winston[_0x387b('0xc')](_0x2de0e7[_0x387b('0x1c')]);return _0x3e201b(_0x2de0e7);}catch(_0x38b876){winston[_0x387b('0xc')](_0x387b('0x1d'));winston['info'](_0x38b876);return _0x4a02f8(_0x38b876);}});};function connectToClassroomNetwork(_0xeef03f,_0x13365f){return new Promise(async function(_0xf82602,_0x1234de){try{winston[_0x387b('0xc')](_0x387b('0x1e'));let _0x5bed9e={'method':_0x387b('0x1f'),'uri':_0x387b('0x20'),'body':{'ssid':_0xeef03f,'password':_0x13365f},'json':!![]};let _0x34a894=await rp(_0x5bed9e);winston[_0x387b('0xc')](_0x34a894[_0x387b('0x1c')]);return _0xf82602(_0x34a894);}catch(_0x3dbc0a){winston[_0x387b('0xc')]('Error\x20connecting\x20to\x20classroom\x20network');winston[_0x387b('0xc')](_0x3dbc0a);return _0x1234de(_0x3dbc0a);}});};function getConnectedNetworkName(){return new Promise(function(_0x1d37a7,_0x23e8cc){wpa_cli[_0x387b('0x11')](settings[_0x387b('0x21')],function(_0x30a141,_0x398e4b){if(_0x30a141)return _0x23e8cc(_0x30a141);return _0x1d37a7(_0x398e4b[_0x387b('0xe')]);});});};function updateIPAddress(_0x14a138){return new Promise(async function(_0x3629bf,_0x20ed75){try{let _0xeef540={'uri':classroomConnection[_0x387b('0x22')]+':8443/api/v1/connect/'+_0x14a138,'rejectUnauthorized':![],'json':!![]};await rp(_0xeef540);return _0x3629bf();}catch(_0x1bb432){return _0x20ed75(_0x1bb432);}});};function communityReachable(){return new Promise(async function(_0x425467,_0x2bf889){try{let _0x1d9803={'uri':classroomConnection[_0x387b('0x22')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x1d9803);winston['info'](_0x387b('0x23'));return _0x425467(!![]);}catch(_0x475612){winston[_0x387b('0xc')](_0x387b('0x24'));return _0x425467(![]);}});};module['exports']=classroomConnection;