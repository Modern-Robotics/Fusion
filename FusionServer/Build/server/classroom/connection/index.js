var _0x35da=['Connecting\x20to\x20classroom\x20network','POST','http://localhost:8080/api/admin/wirelessConnections','Error\x20connecting\x20to\x20classroom\x20network','Can\x20reach\x20community','Community\x20unreachable','exports','request-promise','wireless-tools/wpa_cli','config','get','c3online.edu','c3online.edu:8443','otherdemokey','attemptConnection','./../../../config/serial','serialId','partOfCommunity','info','Current\x20network:\x20','wifi','ssid','status','wifiInterface','Wifi\x20dongle\x20found','globalUrl',':8443/api/v1/connect/','Fusion\x20not\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','Connecting\x20to\x20hidden\x20network','hiddenPassword','serverMessage'];(function(_0x598b32,_0x2dc051){var _0x342ea2=function(_0x11a52c){while(--_0x11a52c){_0x598b32['push'](_0x598b32['shift']());}};_0x342ea2(++_0x2dc051);}(_0x35da,0xc7));var _0x5033=function(_0x4cad85,_0x4acccb){_0x4cad85=_0x4cad85-0x0;var _0x72cb5e=_0x35da[_0x4cad85];return _0x72cb5e;};const winston=require('winston');const rp=require(_0x5033('0x0'));const wpa_cli=require(_0x5033('0x1'));const config=require(_0x5033('0x2'));const settings={'wifiInterface':config[_0x5033('0x3')]('Wifi_NIC')};const classroomConnection={'url':_0x5033('0x4'),'classroomBackend':'c3online.edu/backend','classroomAPI':_0x5033('0x5'),'globalUrl':'https://10.200.200.1','connected':![],'hiddenSSID':'virtual.c3edu.online','hiddenPassword':_0x5033('0x6')};classroomConnection[_0x5033('0x7')]=function(){return new Promise(async function(_0x17b61b,_0x4fb50a){try{const _0x49dc75=await require(_0x5033('0x8'));const _0x269055=_0x49dc75[_0x5033('0x9')];await checkHasWirelessDongle();let _0x29ce5b=await communityReachable();if(!_0x29ce5b)await connectToHiddenClassroomNetwork();let _0x41eb3d=await determineCommunityAccess(_0x269055);if(_0x41eb3d[_0x5033('0xa')]){let _0x167ce2=await getConnectedNetworkName();winston[_0x5033('0xb')](_0x5033('0xc')+_0x167ce2);if(_0x167ce2!=_0x41eb3d[_0x5033('0xd')][_0x5033('0xe')])await connectToClassroomNetwork(_0x41eb3d[_0x5033('0xd')][_0x5033('0xe')],_0x41eb3d[_0x5033('0xd')]['passphrase']);await updateIPAddress(_0x269055);await require('./../sockets/');classroomConnection['connected']=!![];}return _0x17b61b();}catch(_0x5063c9){winston['info'](_0x5063c9);return _0x17b61b();}});};function checkHasWirelessDongle(){return new Promise(function(_0x20d83f,_0x2156d0){wpa_cli[_0x5033('0xf')](settings[_0x5033('0x10')],function(_0x26978b,_0x4a6b58){if(_0x26978b){return _0x2156d0('Error\x20accessing\x20wifi\x20dongle');}winston[_0x5033('0xb')]('Wireless\x20dongle\x20detected');return _0x20d83f(_0x5033('0x11'));});});};function determineCommunityAccess(_0x10b34a){return new Promise(async function(_0x4f2715,_0x25c9e7){let _0x2d7607={'uri':classroomConnection[_0x5033('0x12')]+_0x5033('0x13')+_0x10b34a,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x3b706e=await rp(_0x2d7607);if(_0x3b706e['message']!=_0x5033('0x14')){_0x3b706e[_0x5033('0xa')]=!![];winston['info']('Fusion\x20is\x20part\x20of\x20community');}else{_0x3b706e[_0x5033('0xa')]=![];winston['info'](_0x5033('0x15'));}return _0x4f2715(_0x3b706e);}catch(_0x5d5356){return _0x25c9e7('Could\x20not\x20access\x20classroom\x20environment');}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x37a7a9,_0x13aaf5){try{winston[_0x5033('0xb')](_0x5033('0x16'));let _0x2030a1={'method':'POST','uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection['hiddenSSID'],'password':classroomConnection[_0x5033('0x17')],'hiddenNetwork':!![]},'json':!![]};let _0x434aa3=await rp(_0x2030a1);winston[_0x5033('0xb')](_0x434aa3[_0x5033('0x18')]);return _0x37a7a9(_0x434aa3);}catch(_0x3370ea){winston[_0x5033('0xb')]('Error\x20connecting\x20to\x20hidden\x20network');winston[_0x5033('0xb')](_0x3370ea);return _0x13aaf5(_0x3370ea);}});};function connectToClassroomNetwork(_0x3eba35,_0x2aaf92){return new Promise(async function(_0x9fa52c,_0x22c8a6){try{winston[_0x5033('0xb')](_0x5033('0x19'));let _0x52c4f5={'method':_0x5033('0x1a'),'uri':_0x5033('0x1b'),'body':{'ssid':_0x3eba35,'password':_0x2aaf92},'json':!![]};let _0x2015cb=await rp(_0x52c4f5);winston[_0x5033('0xb')](_0x2015cb[_0x5033('0x18')]);return _0x9fa52c(_0x2015cb);}catch(_0x126f56){winston[_0x5033('0xb')](_0x5033('0x1c'));winston[_0x5033('0xb')](_0x126f56);return _0x22c8a6(_0x126f56);}});};function getConnectedNetworkName(){return new Promise(function(_0x3eb8d2,_0x36b9b7){wpa_cli[_0x5033('0xf')](settings['wifiInterface'],function(_0x16dd3d,_0x4d5f8b){if(_0x16dd3d)return _0x36b9b7(_0x16dd3d);return _0x3eb8d2(_0x4d5f8b['ssid']);});});};function updateIPAddress(_0xa91e30){return new Promise(async function(_0x49622a,_0x5c36ae){try{let _0x509b00={'uri':classroomConnection['globalUrl']+_0x5033('0x13')+_0xa91e30,'rejectUnauthorized':![],'json':!![]};await rp(_0x509b00);return _0x49622a();}catch(_0x230329){return _0x5c36ae(_0x230329);}});};function communityReachable(){return new Promise(async function(_0x28402a,_0x15ae44){try{let _0x4d493e={'uri':classroomConnection[_0x5033('0x12')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x4d493e);winston[_0x5033('0xb')](_0x5033('0x1d'));return _0x28402a(!![]);}catch(_0x5c1f6c){winston[_0x5033('0xb')](_0x5033('0x1e'));return _0x28402a(![]);}});};module[_0x5033('0x1f')]=classroomConnection;