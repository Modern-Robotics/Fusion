var _0x47c0=['connected','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','Wireless\x20dongle\x20detected','Wifi\x20dongle\x20found','globalUrl',':8443/api/v1/connect/','message','Fusion\x20not\x20part\x20of\x20community','Fusion\x20is\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','POST','hiddenSSID','hiddenPassword','serverMessage','Connecting\x20to\x20classroom\x20network','winston','request-promise','wireless-tools/wpa_cli','config','Wifi_NIC','c3online.edu','c3online.edu:8443','virtual.c3edu.online','otherdemokey','attemptConnection','./../../../config/serial','serialId','partOfCommunity','info','Current\x20network:\x20','ssid','wifi','passphrase'];(function(_0x34066f,_0x559c80){var _0x116c8f=function(_0x549d71){while(--_0x549d71){_0x34066f['push'](_0x34066f['shift']());}};_0x116c8f(++_0x559c80);}(_0x47c0,0x7e));var _0x495f=function(_0x163fa8,_0x11bd46){_0x163fa8=_0x163fa8-0x0;var _0x2bcf5d=_0x47c0[_0x163fa8];return _0x2bcf5d;};const winston=require(_0x495f('0x0'));const rp=require(_0x495f('0x1'));const wpa_cli=require(_0x495f('0x2'));const config=require(_0x495f('0x3'));const settings={'wifiInterface':config['get'](_0x495f('0x4'))};const classroomConnection={'url':_0x495f('0x5'),'classroomBackend':'c3online.edu/backend','classroomAPI':_0x495f('0x6'),'globalUrl':'https://10.200.200.1','connected':![],'hiddenSSID':_0x495f('0x7'),'hiddenPassword':_0x495f('0x8')};classroomConnection[_0x495f('0x9')]=function(){return new Promise(async function(_0x7dd6cb,_0x1d42f2){try{const _0x308a24=await require(_0x495f('0xa'));const _0x2333e0=_0x308a24[_0x495f('0xb')];await checkHasWirelessDongle();let _0x2c0ade=await communityReachable();if(!_0x2c0ade)await connectToHiddenClassroomNetwork();let _0x535110=await determineCommunityAccess(_0x2333e0);if(_0x535110[_0x495f('0xc')]){let _0x42c7c9=await getConnectedNetworkName();winston[_0x495f('0xd')](_0x495f('0xe')+_0x42c7c9);if(_0x42c7c9!=_0x535110['wifi'][_0x495f('0xf')])await connectToClassroomNetwork(_0x535110['wifi'][_0x495f('0xf')],_0x535110[_0x495f('0x10')][_0x495f('0x11')]);await updateIPAddress(_0x2333e0);await require('./../sockets/');classroomConnection[_0x495f('0x12')]=!![];}return _0x7dd6cb();}catch(_0x3945ee){winston[_0x495f('0xd')](_0x3945ee);return _0x7dd6cb();}});};function checkHasWirelessDongle(){return new Promise(function(_0x32a117,_0x3fc06c){wpa_cli[_0x495f('0x13')](settings[_0x495f('0x14')],function(_0x16f2de,_0x495b94){if(_0x16f2de){return _0x3fc06c(_0x495f('0x15'));}winston[_0x495f('0xd')](_0x495f('0x16'));return _0x32a117(_0x495f('0x17'));});});};function determineCommunityAccess(_0x4270f4){return new Promise(async function(_0x29ba29,_0x544bcc){let _0x50cc63={'uri':classroomConnection[_0x495f('0x18')]+_0x495f('0x19')+_0x4270f4,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x2e5f33=await rp(_0x50cc63);if(_0x2e5f33[_0x495f('0x1a')]!=_0x495f('0x1b')){_0x2e5f33[_0x495f('0xc')]=!![];winston[_0x495f('0xd')](_0x495f('0x1c'));}else{_0x2e5f33[_0x495f('0xc')]=![];winston[_0x495f('0xd')](_0x495f('0x1d'));}return _0x29ba29(_0x2e5f33);}catch(_0x2187db){return _0x544bcc(_0x495f('0x1e'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x2a6123,_0x11f03a){try{winston['info']('Connecting\x20to\x20hidden\x20network');let _0x1b71de={'method':_0x495f('0x1f'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x495f('0x20')],'password':classroomConnection[_0x495f('0x21')],'hiddenNetwork':!![]},'json':!![]};let _0xf56051=await rp(_0x1b71de);winston['info'](_0xf56051[_0x495f('0x22')]);return _0x2a6123(_0xf56051);}catch(_0x342190){winston[_0x495f('0xd')]('Error\x20connecting\x20to\x20hidden\x20network');winston[_0x495f('0xd')](_0x342190);return _0x11f03a(_0x342190);}});};function connectToClassroomNetwork(_0x125b97,_0x3fe30c){return new Promise(async function(_0x5c6924,_0x46ea69){try{winston['info'](_0x495f('0x23'));let _0x281750={'method':_0x495f('0x1f'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':_0x125b97,'password':_0x3fe30c},'json':!![]};let _0x98c94f=await rp(_0x281750);winston['info'](_0x98c94f[_0x495f('0x22')]);return _0x5c6924(_0x98c94f);}catch(_0x319bf8){winston[_0x495f('0xd')]('Error\x20connecting\x20to\x20classroom\x20network');winston['info'](_0x319bf8);return _0x46ea69(_0x319bf8);}});};function getConnectedNetworkName(){return new Promise(function(_0x4dbc8a,_0x128a6e){wpa_cli['status'](settings[_0x495f('0x14')],function(_0x53fa27,_0x1b6014){if(_0x53fa27)return _0x128a6e(_0x53fa27);return _0x4dbc8a(_0x1b6014[_0x495f('0xf')]);});});};function updateIPAddress(_0x16e300){return new Promise(async function(_0xab0351,_0x511092){try{let _0x82ebb3={'uri':classroomConnection[_0x495f('0x18')]+':8443/api/v1/connect/'+_0x16e300,'rejectUnauthorized':![],'json':!![]};await rp(_0x82ebb3);return _0xab0351();}catch(_0x373f85){return _0x511092(_0x373f85);}});};function communityReachable(){return new Promise(async function(_0x4e8456,_0x2b2f6d){try{let _0x40eeb3={'uri':classroomConnection[_0x495f('0x18')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x40eeb3);winston[_0x495f('0xd')]('Can\x20reach\x20community');return _0x4e8456(!![]);}catch(_0x3fd014){winston['info']('Community\x20unreachable');return _0x4e8456(![]);}});};module['exports']=classroomConnection;