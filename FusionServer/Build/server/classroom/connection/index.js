var _0x394e=['Can\x20reach\x20community','Community\x20unreachable','exports','winston','config','get','Wifi_NIC','c3online.edu/backend','c3online.edu:8443','https://10.200.200.1','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','attemptConnection','./../../../config/serial','serialId','info','wifi','ssid','passphrase','./../sockets/','connected','status','Error\x20accessing\x20wifi\x20dongle','Wireless\x20dongle\x20detected',':8443/api/v1/connect/','partOfCommunity','Fusion\x20not\x20part\x20of\x20this\x20community','http://localhost:8080/api/admin/wirelessConnections','hiddenSSID','hiddenPassword','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network','POST','Error\x20connecting\x20to\x20classroom\x20network','wifiInterface','globalUrl','Updated\x20ip\x20address!','Failed\x20to\x20update\x20ip\x20address'];(function(_0x319c53,_0x1510b0){var _0x1954c8=function(_0x225829){while(--_0x225829){_0x319c53['push'](_0x319c53['shift']());}};_0x1954c8(++_0x1510b0);}(_0x394e,0xe7));var _0x4704=function(_0x12e56a,_0x1ab389){_0x12e56a=_0x12e56a-0x0;var _0x2a51a6=_0x394e[_0x12e56a];return _0x2a51a6;};const winston=require(_0x4704('0x0'));const rp=require('request-promise');const wpa_cli=require('wireless-tools/wpa_cli');const config=require(_0x4704('0x1'));const settings={'wifiInterface':config[_0x4704('0x2')](_0x4704('0x3'))};const classroomConnection={'url':'c3online.edu','classroomBackend':_0x4704('0x4'),'classroomAPI':_0x4704('0x5'),'globalUrl':_0x4704('0x6'),'connected':![],'hiddenSSID':_0x4704('0x7'),'hiddenPassword':_0x4704('0x8')};classroomConnection[_0x4704('0x9')]=function(){return new Promise(async function(_0x5969aa,_0x317f59){try{const _0x4157db=await require(_0x4704('0xa'));const _0x5f116a=_0x4157db[_0x4704('0xb')];await checkHasWirelessDongle();let _0xcf61f9=await communityReachable();if(!_0xcf61f9)await connectToHiddenClassroomNetwork();let _0x2fa207=await determineCommunityAccess(_0x5f116a);if(_0x2fa207['partOfCommunity']){let _0x330535=await getConnectedNetworkName();winston[_0x4704('0xc')]('Current\x20network:\x20'+_0x330535);if(_0x330535!=_0x2fa207[_0x4704('0xd')]['ssid'])await connectToClassroomNetwork(_0x2fa207['wifi'][_0x4704('0xe')],_0x2fa207['wifi'][_0x4704('0xf')]);await updateIPAddress(_0x5f116a);await require(_0x4704('0x10'));classroomConnection[_0x4704('0x11')]=!![];}return _0x5969aa();}catch(_0x23ebbd){winston[_0x4704('0xc')](_0x23ebbd);return _0x5969aa();}});};function checkHasWirelessDongle(){return new Promise(function(_0x42cef1,_0x304a29){wpa_cli[_0x4704('0x12')](settings['wifiInterface'],function(_0x15e138,_0x4f4e07){if(_0x15e138){return _0x304a29(_0x4704('0x13'));}winston['info'](_0x4704('0x14'));return _0x42cef1('Wifi\x20dongle\x20found');});});};function determineCommunityAccess(_0xf8bb6a){return new Promise(async function(_0x406d65,_0x1cee68){let _0x111e4f={'uri':classroomConnection['globalUrl']+_0x4704('0x15')+_0xf8bb6a,'rejectUnauthorized':![],'json':!![],'timeout':0x2710};try{let _0x2688f2=await rp(_0x111e4f);if(_0x2688f2['message']!='Fusion\x20not\x20part\x20of\x20community'){_0x2688f2[_0x4704('0x16')]=!![];winston[_0x4704('0xc')]('Fusion\x20is\x20part\x20of\x20community');}else{_0x2688f2[_0x4704('0x16')]=![];winston[_0x4704('0xc')](_0x4704('0x17'));}return _0x406d65(_0x2688f2);}catch(_0x259b0a){return _0x1cee68('Could\x20not\x20access\x20classroom\x20environment');}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x490f3f,_0x18a039){try{winston['info']('Connecting\x20to\x20hidden\x20network');let _0xbe4e2e={'method':'POST','uri':_0x4704('0x18'),'body':{'ssid':classroomConnection[_0x4704('0x19')],'password':classroomConnection[_0x4704('0x1a')],'hiddenNetwork':!![]},'json':!![]};let _0x4907c1=await rp(_0xbe4e2e);winston[_0x4704('0xc')](_0x4907c1['serverMessage']);return _0x490f3f(_0x4907c1);}catch(_0x37576f){winston['info'](_0x4704('0x1b'));winston['info'](_0x37576f);return _0x18a039(_0x37576f);}});};function connectToClassroomNetwork(_0x1dee6a,_0x4c4b4e){return new Promise(async function(_0x539090,_0x5a3a97){try{winston['info'](_0x4704('0x1c'));let _0xd84934={'method':_0x4704('0x1d'),'uri':_0x4704('0x18'),'body':{'ssid':_0x1dee6a,'password':_0x4c4b4e},'json':!![]};let _0x82dd50=await rp(_0xd84934);winston[_0x4704('0xc')](_0x82dd50['serverMessage']);return _0x539090(_0x82dd50);}catch(_0x1ace7b){winston[_0x4704('0xc')](_0x4704('0x1e'));winston[_0x4704('0xc')](_0x1ace7b);return _0x5a3a97(_0x1ace7b);}});};function getConnectedNetworkName(){return new Promise(function(_0x2d8c6a,_0x1e02cf){wpa_cli[_0x4704('0x12')](settings[_0x4704('0x1f')],function(_0x392f3d,_0x321554){if(_0x392f3d)return _0x1e02cf(_0x392f3d);return _0x2d8c6a(_0x321554[_0x4704('0xe')]);});});};function updateIPAddress(_0x59294e){return new Promise(async function(_0x489572,_0x2f1946){let _0x5e6f35={'uri':classroomConnection[_0x4704('0x20')]+_0x4704('0x15')+_0x59294e,'rejectUnauthorized':![],'json':!![],'resolveWithFullResponse':!![],'timeout':0x2710};try{let _0x58d759=await rp(_0x5e6f35);winston['info'](_0x4704('0x21'));return _0x489572(_0x58d759);}catch(_0x5003ed){winston[_0x4704('0xc')](_0x4704('0x22'));return _0x2f1946(_0x5003ed);}});};function communityReachable(){return new Promise(async function(_0x34595b,_0x339972){try{let _0x1789c3={'uri':classroomConnection[_0x4704('0x20')],'rejectUnauthorized':![],'json':!![],'timeout':0x2710};await rp(_0x1789c3);winston[_0x4704('0xc')](_0x4704('0x23'));return _0x34595b(!![]);}catch(_0x463e71){winston[_0x4704('0xc')](_0x4704('0x24'));return _0x34595b(![]);}});};module[_0x4704('0x25')]=classroomConnection;