var _0x4e70=['exports','winston','request-promise','wireless-tools/wpa_cli','get','Wifi_NIC','c3online.edu','c3online.edu/backend','c3online.edu:8443','https://10.200.200.1','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','attemptConnection','./../../../config/serial','serialId','partOfCommunity','info','Current\x20network:\x20','wifi','ssid','passphrase','./../sockets/','connected','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','Wifi\x20dongle\x20found','message','Fusion\x20is\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','POST','http://localhost:8080/api/admin/wirelessConnections','hiddenSSID','hiddenPassword','serverMessage','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20classroom\x20network','globalUrl','Can\x20reach\x20community'];(function(_0x4a17d7,_0x1e396f){var _0x19ed73=function(_0x4dc770){while(--_0x4dc770){_0x4a17d7['push'](_0x4a17d7['shift']());}};_0x19ed73(++_0x1e396f);}(_0x4e70,0x119));var _0x44be=function(_0x12814e,_0x5a65ce){_0x12814e=_0x12814e-0x0;var _0x3569fc=_0x4e70[_0x12814e];return _0x3569fc;};const winston=require(_0x44be('0x0'));const rp=require(_0x44be('0x1'));const wpa_cli=require(_0x44be('0x2'));const config=require('config');const settings={'wifiInterface':config[_0x44be('0x3')](_0x44be('0x4'))};const classroomConnection={'url':_0x44be('0x5'),'classroomBackend':_0x44be('0x6'),'classroomAPI':_0x44be('0x7'),'globalUrl':_0x44be('0x8'),'connected':![],'hiddenSSID':_0x44be('0x9'),'hiddenPassword':_0x44be('0xa')};classroomConnection[_0x44be('0xb')]=function(){return new Promise(async function(_0x30bf86,_0x31f0b7){try{const _0x25b6b4=await require(_0x44be('0xc'));const _0x329583=_0x25b6b4[_0x44be('0xd')];await checkHasWirelessDongle();let _0x2b0129=await communityReachable();if(!_0x2b0129)await connectToHiddenClassroomNetwork();let _0x3b578e=await determineCommunityAccess(_0x329583);if(_0x3b578e[_0x44be('0xe')]){let _0x45db03=await getConnectedNetworkName();winston[_0x44be('0xf')](_0x44be('0x10')+_0x45db03);if(_0x45db03!=_0x3b578e[_0x44be('0x11')][_0x44be('0x12')])await connectToClassroomNetwork(_0x3b578e[_0x44be('0x11')][_0x44be('0x12')],_0x3b578e[_0x44be('0x11')][_0x44be('0x13')]);await updateIPAddress(_0x329583);await require(_0x44be('0x14'));classroomConnection[_0x44be('0x15')]=!![];}return _0x30bf86();}catch(_0x26246e){winston['info'](_0x26246e);return _0x30bf86();}});};function checkHasWirelessDongle(){return new Promise(function(_0x520106,_0x4353b4){wpa_cli[_0x44be('0x16')](settings[_0x44be('0x17')],function(_0x21bcb6,_0x3e09ea){if(_0x21bcb6){return _0x4353b4(_0x44be('0x18'));}winston[_0x44be('0xf')]('Wireless\x20dongle\x20detected');return _0x520106(_0x44be('0x19'));});});};function determineCommunityAccess(_0x162e9b){return new Promise(async function(_0x3d43c1,_0x27d4e4){let _0x578768={'uri':classroomConnection['globalUrl']+':8443/api/v1/connect/'+_0x162e9b,'rejectUnauthorized':![],'json':!![],'timeout':0x2710};try{let _0x497275=await rp(_0x578768);if(_0x497275[_0x44be('0x1a')]!='Fusion\x20not\x20part\x20of\x20community'){_0x497275[_0x44be('0xe')]=!![];winston[_0x44be('0xf')](_0x44be('0x1b'));}else{_0x497275[_0x44be('0xe')]=![];winston[_0x44be('0xf')](_0x44be('0x1c'));}return _0x3d43c1(_0x497275);}catch(_0x207ee5){return _0x27d4e4('Could\x20not\x20access\x20classroom\x20environment');}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x16a2d1,_0x1a4405){try{winston[_0x44be('0xf')]('Connecting\x20to\x20hidden\x20network');let _0x371614={'method':_0x44be('0x1d'),'uri':_0x44be('0x1e'),'body':{'ssid':classroomConnection[_0x44be('0x1f')],'password':classroomConnection[_0x44be('0x20')],'hiddenNetwork':!![]},'json':!![]};let _0x155b54=await rp(_0x371614);winston[_0x44be('0xf')](_0x155b54[_0x44be('0x21')]);return _0x16a2d1(_0x155b54);}catch(_0x5398f8){winston[_0x44be('0xf')](_0x44be('0x22'));winston[_0x44be('0xf')](_0x5398f8);return _0x1a4405(_0x5398f8);}});};function connectToClassroomNetwork(_0x2a38fd,_0x2918aa){return new Promise(async function(_0x183fb5,_0x4c3516){try{winston['info'](_0x44be('0x23'));let _0x2f587f={'method':_0x44be('0x1d'),'uri':_0x44be('0x1e'),'body':{'ssid':_0x2a38fd,'password':_0x2918aa},'json':!![]};let _0x253fc5=await rp(_0x2f587f);winston[_0x44be('0xf')](_0x253fc5['serverMessage']);return _0x183fb5(_0x253fc5);}catch(_0x11f99f){winston[_0x44be('0xf')](_0x44be('0x24'));winston[_0x44be('0xf')](_0x11f99f);return _0x4c3516(_0x11f99f);}});};function getConnectedNetworkName(){return new Promise(function(_0x13f3fa,_0x46a446){wpa_cli['status'](settings['wifiInterface'],function(_0x32486f,_0x2e4269){if(_0x32486f)return _0x46a446(_0x32486f);return _0x13f3fa(_0x2e4269[_0x44be('0x12')]);});});};function updateIPAddress(_0x38113a){return new Promise(async function(_0x392ab5,_0x1679f2){let _0x317329={'uri':classroomConnection[_0x44be('0x25')]+':8443/api/v1/connect/'+_0x38113a,'rejectUnauthorized':![],'json':!![],'resolveWithFullResponse':!![],'timeout':0x2710};try{let _0x3c8cc8=await rp(_0x317329);winston['info']('Updated\x20ip\x20address!');return _0x392ab5(_0x3c8cc8);}catch(_0x2b939f){winston[_0x44be('0xf')]('Failed\x20to\x20update\x20ip\x20address');return _0x1679f2(_0x2b939f);}});};function communityReachable(){return new Promise(async function(_0x4972d1,_0x4cb966){try{let _0x3af063={'uri':classroomConnection[_0x44be('0x25')],'rejectUnauthorized':![],'json':!![],'timeout':0x2710};await rp(_0x3af063);winston[_0x44be('0xf')](_0x44be('0x26'));return _0x4972d1(!![]);}catch(_0x1fb8d5){winston[_0x44be('0xf')]('Community\x20unreachable');return _0x4972d1(![]);}});};module[_0x44be('0x27')]=classroomConnection;