var _0x4af0=['get','c3online.edu','c3online.edu:8443','https://10.200.200.1','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','attemptConnection','partOfCommunity','info','Current\x20network:\x20','wifi','ssid','passphrase','./../sockets/','connected','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','globalUrl',':8443/api/v1/connect/','message','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','POST','http://localhost:8080/api/admin/wirelessConnections','hiddenPassword','serverMessage','Error\x20connecting\x20to\x20classroom\x20network','Can\x20reach\x20community','Community\x20unreachable','exports','winston','request-promise','wireless-tools/wpa_cli','config'];(function(_0x323e47,_0x10aea3){var _0x55f925=function(_0x16c8f4){while(--_0x16c8f4){_0x323e47['push'](_0x323e47['shift']());}};_0x55f925(++_0x10aea3);}(_0x4af0,0x1d0));var _0x2af7=function(_0x502aaa,_0x43a97d){_0x502aaa=_0x502aaa-0x0;var _0x5c3a92=_0x4af0[_0x502aaa];return _0x5c3a92;};const winston=require(_0x2af7('0x0'));const rp=require(_0x2af7('0x1'));const wpa_cli=require(_0x2af7('0x2'));const config=require(_0x2af7('0x3'));const settings={'wifiInterface':config[_0x2af7('0x4')]('Wifi_NIC')};const classroomConnection={'url':_0x2af7('0x5'),'classroomBackend':'c3online.edu/backend','classroomAPI':_0x2af7('0x6'),'globalUrl':_0x2af7('0x7'),'connected':![],'hiddenSSID':_0x2af7('0x8'),'hiddenPassword':_0x2af7('0x9')};classroomConnection[_0x2af7('0xa')]=function(){return new Promise(async function(_0x2a04a5,_0x3689d9){try{const _0x4654b9=await require('./../../../config/serial');const _0xa2eb14=_0x4654b9['serialId'];await checkHasWirelessDongle();let _0x141339=await communityReachable();if(!_0x141339)await connectToHiddenClassroomNetwork();let _0x442ae4=await determineCommunityAccess(_0xa2eb14);if(_0x442ae4[_0x2af7('0xb')]){let _0x11ab7f=await getConnectedNetworkName();winston[_0x2af7('0xc')](_0x2af7('0xd')+_0x11ab7f);if(_0x11ab7f!=_0x442ae4[_0x2af7('0xe')][_0x2af7('0xf')])await connectToClassroomNetwork(_0x442ae4[_0x2af7('0xe')]['ssid'],_0x442ae4['wifi'][_0x2af7('0x10')]);await updateIPAddress(_0xa2eb14);await require(_0x2af7('0x11'));classroomConnection[_0x2af7('0x12')]=!![];}return _0x2a04a5();}catch(_0x45590c){winston[_0x2af7('0xc')](_0x45590c);return _0x2a04a5();}});};function checkHasWirelessDongle(){return new Promise(function(_0xd0623f,_0x3467e4){wpa_cli[_0x2af7('0x13')](settings[_0x2af7('0x14')],function(_0x343246,_0x17718a){if(_0x343246){return _0x3467e4(_0x2af7('0x15'));}winston[_0x2af7('0xc')]('Wireless\x20dongle\x20detected');return _0xd0623f('Wifi\x20dongle\x20found');});});};function determineCommunityAccess(_0x159bd4){return new Promise(async function(_0x3c7e54,_0x432ad3){let _0x792c7d={'uri':classroomConnection[_0x2af7('0x16')]+_0x2af7('0x17')+_0x159bd4,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x39a150=await rp(_0x792c7d);if(_0x39a150[_0x2af7('0x18')]!='Fusion\x20not\x20part\x20of\x20community'){_0x39a150[_0x2af7('0xb')]=!![];winston[_0x2af7('0xc')]('Fusion\x20is\x20part\x20of\x20community');}else{_0x39a150[_0x2af7('0xb')]=![];winston[_0x2af7('0xc')](_0x2af7('0x19'));}return _0x3c7e54(_0x39a150);}catch(_0x328925){return _0x432ad3(_0x2af7('0x1a'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x595b66,_0x189ee3){try{winston[_0x2af7('0xc')](_0x2af7('0x1b'));let _0x309fa3={'method':_0x2af7('0x1c'),'uri':_0x2af7('0x1d'),'body':{'ssid':classroomConnection['hiddenSSID'],'password':classroomConnection[_0x2af7('0x1e')],'hiddenNetwork':!![]},'json':!![]};let _0x1d2cb1=await rp(_0x309fa3);winston[_0x2af7('0xc')](_0x1d2cb1['serverMessage']);return _0x595b66(_0x1d2cb1);}catch(_0x532cc3){winston['info']('Error\x20connecting\x20to\x20hidden\x20network');winston['info'](_0x532cc3);return _0x189ee3(_0x532cc3);}});};function connectToClassroomNetwork(_0x668ca2,_0x482bdd){return new Promise(async function(_0x1dde3c,_0x5b4b93){try{winston[_0x2af7('0xc')]('Connecting\x20to\x20classroom\x20network');let _0x4437cd={'method':_0x2af7('0x1c'),'uri':_0x2af7('0x1d'),'body':{'ssid':_0x668ca2,'password':_0x482bdd},'json':!![]};let _0x2b116f=await rp(_0x4437cd);winston['info'](_0x2b116f[_0x2af7('0x1f')]);return _0x1dde3c(_0x2b116f);}catch(_0x3ab12f){winston[_0x2af7('0xc')](_0x2af7('0x20'));winston[_0x2af7('0xc')](_0x3ab12f);return _0x5b4b93(_0x3ab12f);}});};function getConnectedNetworkName(){return new Promise(function(_0x6d3db,_0x1524e8){wpa_cli['status'](settings['wifiInterface'],function(_0x3fbc00,_0x566ae1){if(_0x3fbc00)return _0x1524e8(_0x3fbc00);return _0x6d3db(_0x566ae1[_0x2af7('0xf')]);});});};function updateIPAddress(_0x1fa1a0){return new Promise(async function(_0x29d7c9,_0x3dcc52){try{let _0x1c1862={'uri':classroomConnection['globalUrl']+_0x2af7('0x17')+_0x1fa1a0,'rejectUnauthorized':![],'json':!![]};await rp(_0x1c1862);return _0x29d7c9();}catch(_0x54eac6){return _0x3dcc52(_0x54eac6);}});};function communityReachable(){return new Promise(async function(_0x1e5a03,_0x3288e){try{let _0x4861c0={'uri':classroomConnection[_0x2af7('0x16')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x4861c0);winston['info'](_0x2af7('0x21'));return _0x1e5a03(!![]);}catch(_0x51851a){winston[_0x2af7('0xc')](_0x2af7('0x22'));return _0x1e5a03(![]);}});};module[_0x2af7('0x23')]=classroomConnection;