var _0x2318=['serverMessage','Error\x20connecting\x20to\x20classroom\x20network',':8443/api/v1/connect/','Updated\x20ip\x20address!','Failed\x20to\x20update\x20ip\x20address','Can\x20reach\x20community','Community\x20unreachable','winston','wireless-tools/wpa_cli','get','c3online.edu/backend','https://10.200.200.1','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','attemptConnection','./../../../config/serial','serialId','partOfCommunity','info','wifi','ssid','passphrase','connected','status','wifiInterface','Wireless\x20dongle\x20detected','Wifi\x20dongle\x20found','globalUrl','message','Fusion\x20not\x20part\x20of\x20community','Fusion\x20is\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','POST','hiddenSSID','hiddenPassword','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network'];(function(_0x481c68,_0xfce27a){var _0x2344f9=function(_0x46c62f){while(--_0x46c62f){_0x481c68['push'](_0x481c68['shift']());}};_0x2344f9(++_0xfce27a);}(_0x2318,0xf1));var _0x2a68=function(_0x47bb53,_0x5cec48){_0x47bb53=_0x47bb53-0x0;var _0x4067dd=_0x2318[_0x47bb53];return _0x4067dd;};const winston=require(_0x2a68('0x0'));const rp=require('request-promise');const wpa_cli=require(_0x2a68('0x1'));const config=require('config');const settings={'wifiInterface':config[_0x2a68('0x2')]('Wifi_NIC')};const classroomConnection={'url':'c3online.edu','classroomBackend':_0x2a68('0x3'),'classroomAPI':'c3online.edu:8443','globalUrl':_0x2a68('0x4'),'connected':![],'hiddenSSID':_0x2a68('0x5'),'hiddenPassword':_0x2a68('0x6')};classroomConnection[_0x2a68('0x7')]=function(){return new Promise(async function(_0x328d56,_0x4da15b){try{const _0x181b43=await require(_0x2a68('0x8'));const _0x13618f=_0x181b43[_0x2a68('0x9')];await checkHasWirelessDongle();let _0x44777f=await communityReachable();if(!_0x44777f)await connectToHiddenClassroomNetwork();let _0xd5bec6=await determineCommunityAccess(_0x13618f);if(_0xd5bec6[_0x2a68('0xa')]){let _0x3d93b6=await getConnectedNetworkName();winston[_0x2a68('0xb')]('Current\x20network:\x20'+_0x3d93b6);if(_0x3d93b6!=_0xd5bec6['wifi']['ssid'])await connectToClassroomNetwork(_0xd5bec6[_0x2a68('0xc')][_0x2a68('0xd')],_0xd5bec6[_0x2a68('0xc')][_0x2a68('0xe')]);await updateIPAddress(_0x13618f);await require('./../sockets/');classroomConnection[_0x2a68('0xf')]=!![];}return _0x328d56();}catch(_0x40b99b){winston[_0x2a68('0xb')](_0x40b99b);return _0x328d56();}});};function checkHasWirelessDongle(){return new Promise(function(_0x5e67f0,_0x5d9fdb){wpa_cli[_0x2a68('0x10')](settings[_0x2a68('0x11')],function(_0x4b6c54,_0xd53ac6){if(_0x4b6c54){return _0x5d9fdb('Error\x20accessing\x20wifi\x20dongle');}winston[_0x2a68('0xb')](_0x2a68('0x12'));return _0x5e67f0(_0x2a68('0x13'));});});};function determineCommunityAccess(_0x5cf5c9){return new Promise(async function(_0x296532,_0x366205){let _0x44a2a5={'uri':classroomConnection[_0x2a68('0x14')]+':8443/api/v1/connect/'+_0x5cf5c9,'rejectUnauthorized':![],'json':!![],'timeout':0x2710};try{let _0xd99eb=await rp(_0x44a2a5);if(_0xd99eb[_0x2a68('0x15')]!=_0x2a68('0x16')){_0xd99eb[_0x2a68('0xa')]=!![];winston[_0x2a68('0xb')](_0x2a68('0x17'));}else{_0xd99eb[_0x2a68('0xa')]=![];winston[_0x2a68('0xb')](_0x2a68('0x18'));}return _0x296532(_0xd99eb);}catch(_0x51fa45){return _0x366205(_0x2a68('0x19'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x36d81b,_0x45aed3){try{winston['info'](_0x2a68('0x1a'));let _0x4fbacb={'method':_0x2a68('0x1b'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x2a68('0x1c')],'password':classroomConnection[_0x2a68('0x1d')],'hiddenNetwork':!![]},'json':!![]};let _0x44283b=await rp(_0x4fbacb);winston['info'](_0x44283b['serverMessage']);return _0x36d81b(_0x44283b);}catch(_0x5957e8){winston['info'](_0x2a68('0x1e'));winston[_0x2a68('0xb')](_0x5957e8);return _0x45aed3(_0x5957e8);}});};function connectToClassroomNetwork(_0xfe760e,_0x501a15){return new Promise(async function(_0x5ddea2,_0x3647b5){try{winston[_0x2a68('0xb')](_0x2a68('0x1f'));let _0x3e714c={'method':_0x2a68('0x1b'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':_0xfe760e,'password':_0x501a15},'json':!![]};let _0xd0cc70=await rp(_0x3e714c);winston[_0x2a68('0xb')](_0xd0cc70[_0x2a68('0x20')]);return _0x5ddea2(_0xd0cc70);}catch(_0x480efc){winston[_0x2a68('0xb')](_0x2a68('0x21'));winston[_0x2a68('0xb')](_0x480efc);return _0x3647b5(_0x480efc);}});};function getConnectedNetworkName(){return new Promise(function(_0x1b0b2c,_0x4c4a53){wpa_cli['status'](settings['wifiInterface'],function(_0x83b46b,_0x228e73){if(_0x83b46b)return _0x4c4a53(_0x83b46b);return _0x1b0b2c(_0x228e73[_0x2a68('0xd')]);});});};function updateIPAddress(_0x4e7eb9){return new Promise(async function(_0x4cea89,_0x195afb){let _0x53add6={'uri':classroomConnection[_0x2a68('0x14')]+_0x2a68('0x22')+_0x4e7eb9,'rejectUnauthorized':![],'json':!![],'resolveWithFullResponse':!![],'timeout':0x2710};try{let _0x493312=await rp(_0x53add6);winston[_0x2a68('0xb')](_0x2a68('0x23'));return _0x4cea89(_0x493312);}catch(_0x4a1dd5){winston['info'](_0x2a68('0x24'));return _0x195afb(_0x4a1dd5);}});};function communityReachable(){return new Promise(async function(_0x5a2b0f,_0x15d2ba){try{let _0x53674e={'uri':classroomConnection[_0x2a68('0x14')],'rejectUnauthorized':![],'json':!![],'timeout':0x2710};await rp(_0x53674e);winston[_0x2a68('0xb')](_0x2a68('0x25'));return _0x5a2b0f(!![]);}catch(_0x3feb61){winston[_0x2a68('0xb')](_0x2a68('0x26'));return _0x5a2b0f(![]);}});};module['exports']=classroomConnection;