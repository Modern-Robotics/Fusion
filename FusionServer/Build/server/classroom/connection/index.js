var _0x4022=['wireless-tools/wpa_cli','config','get','c3online.edu/backend','c3online.edu:8443','https://10.200.200.1','MyBot_Gatekeeper_WiFi','CMMthgilxoBsecure','attemptConnection','./../../../config/serial','serialId','info','wifi','ssid','passphrase','connected','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','Wireless\x20dongle\x20detected','Wifi\x20dongle\x20found','globalUrl',':8443/api/v1/connect/','Fusion\x20not\x20part\x20of\x20community','Fusion\x20is\x20part\x20of\x20community','partOfCommunity','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','POST','http://localhost:8080/api/admin/wirelessConnections','hiddenSSID','hiddenPassword','serverMessage','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20classroom\x20network','Can\x20reach\x20community','Community\x20unreachable','exports','winston'];(function(_0x1c3c5f,_0x50280b){var _0x3ae64c=function(_0x4beffd){while(--_0x4beffd){_0x1c3c5f['push'](_0x1c3c5f['shift']());}};_0x3ae64c(++_0x50280b);}(_0x4022,0x1df));var _0x4ac1=function(_0xab25fa,_0x1a44dc){_0xab25fa=_0xab25fa-0x0;var _0x38390e=_0x4022[_0xab25fa];return _0x38390e;};const winston=require(_0x4ac1('0x0'));const rp=require('request-promise');const wpa_cli=require(_0x4ac1('0x1'));const config=require(_0x4ac1('0x2'));const settings={'wifiInterface':config[_0x4ac1('0x3')]('Wifi_NIC')};const classroomConnection={'url':'c3online.edu','classroomBackend':_0x4ac1('0x4'),'classroomAPI':_0x4ac1('0x5'),'globalUrl':_0x4ac1('0x6'),'connected':![],'hiddenSSID':_0x4ac1('0x7'),'hiddenPassword':_0x4ac1('0x8')};classroomConnection[_0x4ac1('0x9')]=function(){return new Promise(async function(_0x59856a,_0x1a43a4){try{const _0x2baa5d=await require(_0x4ac1('0xa'));const _0x96a869=_0x2baa5d[_0x4ac1('0xb')];await checkHasWirelessDongle();let _0x588cf6=await communityReachable();if(!_0x588cf6)await connectToHiddenClassroomNetwork();let _0x20ccb5=await determineCommunityAccess(_0x96a869);if(_0x20ccb5['partOfCommunity']){let _0x580d75=await getConnectedNetworkName();winston[_0x4ac1('0xc')]('Current\x20network:\x20'+_0x580d75);if(_0x580d75!=_0x20ccb5[_0x4ac1('0xd')][_0x4ac1('0xe')])await connectToClassroomNetwork(_0x20ccb5['wifi'][_0x4ac1('0xe')],_0x20ccb5[_0x4ac1('0xd')][_0x4ac1('0xf')]);await updateIPAddress(_0x96a869);await require('./../sockets/');classroomConnection[_0x4ac1('0x10')]=!![];}return _0x59856a();}catch(_0x2ab4b2){winston[_0x4ac1('0xc')](_0x2ab4b2);return _0x59856a();}});};function checkHasWirelessDongle(){return new Promise(function(_0x3383ec,_0x3b8a05){wpa_cli[_0x4ac1('0x11')](settings[_0x4ac1('0x12')],function(_0x517ce7,_0x4f4f8d){if(_0x517ce7){return _0x3b8a05(_0x4ac1('0x13'));}winston[_0x4ac1('0xc')](_0x4ac1('0x14'));return _0x3383ec(_0x4ac1('0x15'));});});};function determineCommunityAccess(_0x2b5d92){return new Promise(async function(_0x5c9241,_0x31dcc3){let _0x4c644b={'uri':classroomConnection[_0x4ac1('0x16')]+_0x4ac1('0x17')+_0x2b5d92,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x52a7a6=await rp(_0x4c644b);if(_0x52a7a6['message']!=_0x4ac1('0x18')){_0x52a7a6['partOfCommunity']=!![];winston['info'](_0x4ac1('0x19'));}else{_0x52a7a6[_0x4ac1('0x1a')]=![];winston['info'](_0x4ac1('0x1b'));}return _0x5c9241(_0x52a7a6);}catch(_0x60afa){return _0x31dcc3(_0x4ac1('0x1c'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x5806ec,_0x52700d){try{winston[_0x4ac1('0xc')]('Connecting\x20to\x20hidden\x20network');let _0x331fca={'method':_0x4ac1('0x1d'),'uri':_0x4ac1('0x1e'),'body':{'ssid':classroomConnection[_0x4ac1('0x1f')],'password':classroomConnection[_0x4ac1('0x20')],'hiddenNetwork':!![]},'json':!![]};let _0x59b5e8=await rp(_0x331fca);winston[_0x4ac1('0xc')](_0x59b5e8[_0x4ac1('0x21')]);return _0x5806ec(_0x59b5e8);}catch(_0x2c0d90){winston['info'](_0x4ac1('0x22'));winston[_0x4ac1('0xc')](_0x2c0d90);return _0x52700d(_0x2c0d90);}});};function connectToClassroomNetwork(_0xca109c,_0x72fc3a){return new Promise(async function(_0x158935,_0x10dae8){try{winston['info'](_0x4ac1('0x23'));let _0xbec7e5={'method':_0x4ac1('0x1d'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':_0xca109c,'password':_0x72fc3a},'json':!![]};let _0x21b24f=await rp(_0xbec7e5);winston[_0x4ac1('0xc')](_0x21b24f[_0x4ac1('0x21')]);return _0x158935(_0x21b24f);}catch(_0x536f38){winston[_0x4ac1('0xc')](_0x4ac1('0x24'));winston['info'](_0x536f38);return _0x10dae8(_0x536f38);}});};function getConnectedNetworkName(){return new Promise(function(_0x1a0da7,_0x3229e6){wpa_cli[_0x4ac1('0x11')](settings['wifiInterface'],function(_0x17fa69,_0x2d0628){if(_0x17fa69)return _0x3229e6(_0x17fa69);return _0x1a0da7(_0x2d0628[_0x4ac1('0xe')]);});});};function updateIPAddress(_0x54b703){return new Promise(async function(_0x1f28e9,_0x5b9395){try{let _0x156d0a={'uri':classroomConnection[_0x4ac1('0x16')]+':8443/api/v1/connect/'+_0x54b703,'rejectUnauthorized':![],'json':!![]};await rp(_0x156d0a);return _0x1f28e9();}catch(_0x466324){return _0x5b9395(_0x466324);}});};function communityReachable(){return new Promise(async function(_0x4183e8,_0x5de83d){try{let _0xdedbbf={'uri':classroomConnection[_0x4ac1('0x16')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0xdedbbf);winston['info'](_0x4ac1('0x25'));return _0x4183e8(!![]);}catch(_0xf460ff){winston[_0x4ac1('0xc')](_0x4ac1('0x26'));return _0x4183e8(![]);}});};module[_0x4ac1('0x27')]=classroomConnection;