var _0x4007=['wlan1','c3online.edu','c3online.edu/backend','c3online.edu:8443','https://10.200.200.1','otherdemokey','attemptConnection','serialId','info','ssid','passphrase','./../sockets/','connected','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','Wifi\x20dongle\x20found','globalUrl',':8443/api/v1/connect/','message','Fusion\x20not\x20part\x20of\x20community','partOfCommunity','Fusion\x20is\x20part\x20of\x20community','Connecting\x20to\x20hidden\x20network','POST','http://localhost:8080/api/admin/wirelessConnections','hiddenSSID','serverMessage','Connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20classroom\x20network','Can\x20reach\x20community','Community\x20unreachable','exports','winston'];(function(_0x1672d5,_0x33a64a){var _0x3871ad=function(_0x45fc27){while(--_0x45fc27){_0x1672d5['push'](_0x1672d5['shift']());}};_0x3871ad(++_0x33a64a);}(_0x4007,0x1db));var _0x49dc=function(_0x1bc4c1,_0x56f9bf){_0x1bc4c1=_0x1bc4c1-0x0;var _0x2d411a=_0x4007[_0x1bc4c1];return _0x2d411a;};const winston=require(_0x49dc('0x0'));const rp=require('request-promise');const wpa_cli=require('wireless-tools/wpa_cli');const settings={'wifiInterface':_0x49dc('0x1')};const classroomConnection={'url':_0x49dc('0x2'),'classroomBackend':_0x49dc('0x3'),'classroomAPI':_0x49dc('0x4'),'globalUrl':_0x49dc('0x5'),'connected':![],'hiddenSSID':'virtual.c3edu.online','hiddenPassword':_0x49dc('0x6')};classroomConnection[_0x49dc('0x7')]=function(){return new Promise(async function(_0x4f2824,_0x4ac0b9){try{const _0x5631ef=await require('./../../../config/serial');const _0xb328c9=_0x5631ef[_0x49dc('0x8')];await checkHasWirelessDongle();let _0x1499bc=await communityReachable();if(!_0x1499bc)await connectToHiddenClassroomNetwork();let _0x4084d2=await determineCommunityAccess(_0xb328c9);if(_0x4084d2['partOfCommunity']){let _0x4c439d=await getConnectedNetworkName();winston[_0x49dc('0x9')]('Current\x20network:\x20'+_0x4c439d);if(_0x4c439d!=_0x4084d2['wifi'][_0x49dc('0xa')])await connectToClassroomNetwork(_0x4084d2['wifi'][_0x49dc('0xa')],_0x4084d2['wifi'][_0x49dc('0xb')]);await updateIPAddress(_0xb328c9);await require(_0x49dc('0xc'));classroomConnection[_0x49dc('0xd')]=!![];}return _0x4f2824();}catch(_0x466b13){winston[_0x49dc('0x9')](_0x466b13);return _0x4f2824();}});};function checkHasWirelessDongle(){return new Promise(function(_0x45b182,_0x40e9be){wpa_cli[_0x49dc('0xe')](settings[_0x49dc('0xf')],function(_0x3b1248,_0x599fbe){if(_0x3b1248){return _0x40e9be(_0x49dc('0x10'));}winston[_0x49dc('0x9')]('Wireless\x20dongle\x20detected');return _0x45b182(_0x49dc('0x11'));});});};function determineCommunityAccess(_0x332f80){return new Promise(async function(_0x3f147a,_0x3a5206){let _0x206557={'uri':classroomConnection[_0x49dc('0x12')]+_0x49dc('0x13')+_0x332f80,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x55ae07=await rp(_0x206557);if(_0x55ae07[_0x49dc('0x14')]!=_0x49dc('0x15')){_0x55ae07[_0x49dc('0x16')]=!![];winston[_0x49dc('0x9')](_0x49dc('0x17'));}else{_0x55ae07[_0x49dc('0x16')]=![];winston[_0x49dc('0x9')]('Fusion\x20not\x20part\x20of\x20this\x20community');}return _0x3f147a(_0x55ae07);}catch(_0x160b66){return _0x3a5206('Could\x20not\x20access\x20classroom\x20environment');}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x2c2d40,_0x4b0511){try{winston[_0x49dc('0x9')](_0x49dc('0x18'));let _0x31b776={'method':_0x49dc('0x19'),'uri':_0x49dc('0x1a'),'body':{'ssid':classroomConnection[_0x49dc('0x1b')],'password':classroomConnection['hiddenPassword'],'hiddenNetwork':!![]},'json':!![]};let _0x347df0=await rp(_0x31b776);winston[_0x49dc('0x9')](_0x347df0[_0x49dc('0x1c')]);return _0x2c2d40(_0x347df0);}catch(_0x2aaf33){winston[_0x49dc('0x9')]('Error\x20connecting\x20to\x20hidden\x20network');winston['info'](_0x2aaf33);return _0x4b0511(_0x2aaf33);}});};function connectToClassroomNetwork(_0x4ab21d,_0x2268fb){return new Promise(async function(_0x22c66f,_0x4b0185){try{winston[_0x49dc('0x9')](_0x49dc('0x1d'));let _0x5746c9={'method':_0x49dc('0x19'),'uri':_0x49dc('0x1a'),'body':{'ssid':_0x4ab21d,'password':_0x2268fb},'json':!![]};let _0x3c6fc7=await rp(_0x5746c9);winston[_0x49dc('0x9')](_0x3c6fc7['serverMessage']);return _0x22c66f(_0x3c6fc7);}catch(_0x38e912){winston[_0x49dc('0x9')](_0x49dc('0x1e'));winston[_0x49dc('0x9')](_0x38e912);return _0x4b0185(_0x38e912);}});};function getConnectedNetworkName(){return new Promise(function(_0x26ece4,_0x2c00e0){wpa_cli['status'](settings[_0x49dc('0xf')],function(_0x2537c8,_0xf9425c){if(_0x2537c8)return _0x2c00e0(_0x2537c8);return _0x26ece4(_0xf9425c['ssid']);});});};function updateIPAddress(_0x323209){return new Promise(async function(_0x38acc2,_0x54002a){try{let _0x561138={'uri':classroomConnection[_0x49dc('0x12')]+_0x49dc('0x13')+_0x323209,'rejectUnauthorized':![],'json':!![]};await rp(_0x561138);return _0x38acc2();}catch(_0xc3303){return _0x54002a(_0xc3303);}});};function communityReachable(){return new Promise(async function(_0x228302,_0x1a759c){try{let _0x358981={'uri':classroomConnection['globalUrl'],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x358981);winston[_0x49dc('0x9')](_0x49dc('0x1f'));return _0x228302(!![]);}catch(_0x326429){winston[_0x49dc('0x9')](_0x49dc('0x20'));return _0x228302(![]);}});};module[_0x49dc('0x21')]=classroomConnection;