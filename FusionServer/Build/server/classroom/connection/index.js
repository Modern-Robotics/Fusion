var _0x54af=['serialId','partOfCommunity','info','Current\x20network:\x20','wifi','ssid','passphrase','./../sockets/','status','wifiInterface','Error\x20accessing\x20wifi\x20dongle','Wireless\x20dongle\x20detected','globalUrl','Fusion\x20not\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','POST','hiddenSSID','hiddenPassword','serverMessage','Error\x20connecting\x20to\x20hidden\x20network','Connecting\x20to\x20classroom\x20network','http://localhost:8080/api/admin/wirelessConnections','Error\x20connecting\x20to\x20classroom\x20network',':8443/api/v1/connect/','Can\x20reach\x20community','Community\x20unreachable','exports','winston','wireless-tools/wpa_cli','wlan1','c3online.edu','c3online.edu/backend','c3online.edu:8443','virtual.c3edu.online','attemptConnection','./../../../config/serial'];(function(_0xaf781a,_0x3478e9){var _0x3b9cb4=function(_0x3d2fd9){while(--_0x3d2fd9){_0xaf781a['push'](_0xaf781a['shift']());}};_0x3b9cb4(++_0x3478e9);}(_0x54af,0x1bf));var _0x357b=function(_0x1da36e,_0x199bec){_0x1da36e=_0x1da36e-0x0;var _0x3f3943=_0x54af[_0x1da36e];return _0x3f3943;};const winston=require(_0x357b('0x0'));const rp=require('request-promise');const wpa_cli=require(_0x357b('0x1'));const settings={'wifiInterface':_0x357b('0x2')};const classroomConnection={'url':_0x357b('0x3'),'classroomBackend':_0x357b('0x4'),'classroomAPI':_0x357b('0x5'),'globalUrl':'https://10.200.200.1','connected':![],'hiddenSSID':_0x357b('0x6'),'hiddenPassword':'otherdemokey'};classroomConnection[_0x357b('0x7')]=function(){return new Promise(async function(_0x2c4761,_0xcc49b6){try{const _0x54652b=await require(_0x357b('0x8'));const _0x5b0a56=_0x54652b[_0x357b('0x9')];await checkHasWirelessDongle();let _0x58bf3c=await communityReachable();if(!_0x58bf3c)await connectToHiddenClassroomNetwork();let _0x442e5a=await determineCommunityAccess(_0x5b0a56);if(_0x442e5a[_0x357b('0xa')]){let _0x51e2b4=await getConnectedNetworkName();winston[_0x357b('0xb')](_0x357b('0xc')+_0x51e2b4);if(_0x51e2b4!=_0x442e5a[_0x357b('0xd')][_0x357b('0xe')])await connectToClassroomNetwork(_0x442e5a[_0x357b('0xd')][_0x357b('0xe')],_0x442e5a[_0x357b('0xd')][_0x357b('0xf')]);await updateIPAddress(_0x5b0a56);await require(_0x357b('0x10'));classroomConnection['connected']=!![];}return _0x2c4761();}catch(_0x48c306){winston[_0x357b('0xb')](_0x48c306);return _0x2c4761();}});};function checkHasWirelessDongle(){return new Promise(function(_0x3ae36,_0xe700ed){wpa_cli[_0x357b('0x11')](settings[_0x357b('0x12')],function(_0x369631,_0x27b438){if(_0x369631){return _0xe700ed(_0x357b('0x13'));}winston[_0x357b('0xb')](_0x357b('0x14'));return _0x3ae36('Wifi\x20dongle\x20found');});});};function determineCommunityAccess(_0x1be615){return new Promise(async function(_0x47f84d,_0x3a525d){let _0x53e9f5={'uri':classroomConnection[_0x357b('0x15')]+':8443/api/v1/connect/'+_0x1be615,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x55386d=await rp(_0x53e9f5);if(_0x55386d['message']!=_0x357b('0x16')){_0x55386d['partOfCommunity']=!![];winston['info']('Fusion\x20is\x20part\x20of\x20community');}else{_0x55386d['partOfCommunity']=![];winston['info'](_0x357b('0x17'));}return _0x47f84d(_0x55386d);}catch(_0x561767){return _0x3a525d(_0x357b('0x18'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x501cf8,_0xf5ead6){try{winston[_0x357b('0xb')](_0x357b('0x19'));let _0xe78fe9={'method':_0x357b('0x1a'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x357b('0x1b')],'password':classroomConnection[_0x357b('0x1c')],'hiddenNetwork':!![]},'json':!![]};let _0x392dc5=await rp(_0xe78fe9);winston['info'](_0x392dc5[_0x357b('0x1d')]);return _0x501cf8(_0x392dc5);}catch(_0x23028e){winston[_0x357b('0xb')](_0x357b('0x1e'));winston[_0x357b('0xb')](_0x23028e);return _0xf5ead6(_0x23028e);}});};function connectToClassroomNetwork(_0x1af21,_0x54c644){return new Promise(async function(_0x3a3071,_0x27d304){try{winston[_0x357b('0xb')](_0x357b('0x1f'));let _0xdf203e={'method':'POST','uri':_0x357b('0x20'),'body':{'ssid':_0x1af21,'password':_0x54c644},'json':!![]};let _0x280b48=await rp(_0xdf203e);winston[_0x357b('0xb')](_0x280b48[_0x357b('0x1d')]);return _0x3a3071(_0x280b48);}catch(_0x2bea33){winston[_0x357b('0xb')](_0x357b('0x21'));winston['info'](_0x2bea33);return _0x27d304(_0x2bea33);}});};function getConnectedNetworkName(){return new Promise(function(_0x7726d8,_0x54b17c){wpa_cli[_0x357b('0x11')](settings[_0x357b('0x12')],function(_0x10334b,_0x2e3e3f){if(_0x10334b)return _0x54b17c(_0x10334b);return _0x7726d8(_0x2e3e3f[_0x357b('0xe')]);});});};function updateIPAddress(_0x5179d3){return new Promise(async function(_0x161867,_0x157692){try{let _0x532c68={'uri':classroomConnection[_0x357b('0x15')]+_0x357b('0x22')+_0x5179d3,'rejectUnauthorized':![],'json':!![]};await rp(_0x532c68);return _0x161867();}catch(_0x484278){return _0x157692(_0x484278);}});};function communityReachable(){return new Promise(async function(_0xece1ba,_0x26f1db){try{let _0x3a3b18={'uri':classroomConnection[_0x357b('0x15')],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x3a3b18);winston['info'](_0x357b('0x23'));return _0xece1ba(!![]);}catch(_0x31c1df){winston[_0x357b('0xb')](_0x357b('0x24'));return _0xece1ba(![]);}});};module[_0x357b('0x25')]=classroomConnection;