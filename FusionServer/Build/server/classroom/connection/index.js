var _0x3d96=['Can\x20reach\x20community','Community\x20unreachable','exports','wireless-tools/wpa_cli','wlan1','c3online.edu','c3online.edu:8443','https://10.200.200.1','virtual.c3edu.online','otherdemokey','./../../../config/serial','serialId','info','Current\x20network:\x20','wifi','ssid','passphrase','./../sockets/','status','wifiInterface','globalUrl',':8443/api/v1/connect/','message','Fusion\x20not\x20part\x20of\x20community','partOfCommunity','Fusion\x20is\x20part\x20of\x20community','Fusion\x20not\x20part\x20of\x20this\x20community','Could\x20not\x20access\x20classroom\x20environment','Connecting\x20to\x20hidden\x20network','POST','hiddenSSID','hiddenPassword','serverMessage','Connecting\x20to\x20classroom\x20network','Error\x20connecting\x20to\x20classroom\x20network'];(function(_0x24563f,_0x5ae96c){var _0x25f39d=function(_0x499704){while(--_0x499704){_0x24563f['push'](_0x24563f['shift']());}};_0x25f39d(++_0x5ae96c);}(_0x3d96,0x1a7));var _0x5892=function(_0x348624,_0x5c9e79){_0x348624=_0x348624-0x0;var _0x34542d=_0x3d96[_0x348624];return _0x34542d;};const winston=require('winston');const rp=require('request-promise');const wpa_cli=require(_0x5892('0x0'));const settings={'wifiInterface':_0x5892('0x1')};const classroomConnection={'url':_0x5892('0x2'),'classroomBackend':'c3online.edu/backend','classroomAPI':_0x5892('0x3'),'globalUrl':_0x5892('0x4'),'connected':![],'hiddenSSID':_0x5892('0x5'),'hiddenPassword':_0x5892('0x6')};classroomConnection['attemptConnection']=function(){return new Promise(async function(_0x5cda03,_0x1be348){try{const _0x5c76b2=await require(_0x5892('0x7'));const _0x3dfdbe=_0x5c76b2[_0x5892('0x8')];await checkHasWirelessDongle();let _0x496a16=await communityReachable();if(!_0x496a16)await connectToHiddenClassroomNetwork();let _0x1cc082=await determineCommunityAccess(_0x3dfdbe);if(_0x1cc082['partOfCommunity']){let _0x46b9f8=await getConnectedNetworkName();winston[_0x5892('0x9')](_0x5892('0xa')+_0x46b9f8);if(_0x46b9f8!=_0x1cc082[_0x5892('0xb')][_0x5892('0xc')])await connectToClassroomNetwork(_0x1cc082['wifi'][_0x5892('0xc')],_0x1cc082[_0x5892('0xb')][_0x5892('0xd')]);await updateIPAddress(_0x3dfdbe);await require(_0x5892('0xe'));classroomConnection['connected']=!![];}return _0x5cda03();}catch(_0x4fcbb8){winston[_0x5892('0x9')](_0x4fcbb8);return _0x5cda03();}});};function checkHasWirelessDongle(){return new Promise(function(_0x4e72a7,_0xc31584){wpa_cli[_0x5892('0xf')](settings[_0x5892('0x10')],function(_0xd45ce4,_0x211841){if(_0xd45ce4){return _0xc31584('Error\x20accessing\x20wifi\x20dongle');}winston[_0x5892('0x9')]('Wireless\x20dongle\x20detected');return _0x4e72a7('Wifi\x20dongle\x20found');});});};function determineCommunityAccess(_0x5334ec){return new Promise(async function(_0xfa2763,_0x2bf0a7){let _0x4f5d4e={'uri':classroomConnection[_0x5892('0x11')]+_0x5892('0x12')+_0x5334ec,'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};try{let _0x25e317=await rp(_0x4f5d4e);if(_0x25e317[_0x5892('0x13')]!=_0x5892('0x14')){_0x25e317[_0x5892('0x15')]=!![];winston['info'](_0x5892('0x16'));}else{_0x25e317[_0x5892('0x15')]=![];winston[_0x5892('0x9')](_0x5892('0x17'));}return _0xfa2763(_0x25e317);}catch(_0x5b8646){return _0x2bf0a7(_0x5892('0x18'));}});};function connectToHiddenClassroomNetwork(){return new Promise(async function(_0x58d57e,_0x145eef){try{winston[_0x5892('0x9')](_0x5892('0x19'));let _0x2e45d4={'method':_0x5892('0x1a'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':classroomConnection[_0x5892('0x1b')],'password':classroomConnection[_0x5892('0x1c')],'hiddenNetwork':!![]},'json':!![]};let _0x26dc29=await rp(_0x2e45d4);winston[_0x5892('0x9')](_0x26dc29[_0x5892('0x1d')]);return _0x58d57e(_0x26dc29);}catch(_0x5435ff){winston['info']('Error\x20connecting\x20to\x20hidden\x20network');winston[_0x5892('0x9')](_0x5435ff);return _0x145eef(_0x5435ff);}});};function connectToClassroomNetwork(_0x51dd73,_0x519d2b){return new Promise(async function(_0x5ea8bc,_0x3a4c39){try{winston['info'](_0x5892('0x1e'));let _0x8fa9b4={'method':_0x5892('0x1a'),'uri':'http://localhost:8080/api/admin/wirelessConnections','body':{'ssid':_0x51dd73,'password':_0x519d2b},'json':!![]};let _0x877086=await rp(_0x8fa9b4);winston['info'](_0x877086[_0x5892('0x1d')]);return _0x5ea8bc(_0x877086);}catch(_0x2b1ebb){winston[_0x5892('0x9')](_0x5892('0x1f'));winston['info'](_0x2b1ebb);return _0x3a4c39(_0x2b1ebb);}});};function getConnectedNetworkName(){return new Promise(function(_0x6c2d84,_0x236e42){wpa_cli[_0x5892('0xf')](settings[_0x5892('0x10')],function(_0x4c4ab2,_0x4a9767){if(_0x4c4ab2)return _0x236e42(_0x4c4ab2);return _0x6c2d84(_0x4a9767[_0x5892('0xc')]);});});};function updateIPAddress(_0x3485f5){return new Promise(async function(_0x289261,_0x201b43){try{let _0x3f6774={'uri':classroomConnection[_0x5892('0x11')]+_0x5892('0x12')+_0x3485f5,'rejectUnauthorized':![],'json':!![]};await rp(_0x3f6774);return _0x289261();}catch(_0x7c4fb7){return _0x201b43(_0x7c4fb7);}});};function communityReachable(){return new Promise(async function(_0x1f3f81,_0x5bdee8){try{let _0x32630a={'uri':classroomConnection['globalUrl'],'rejectUnauthorized':![],'json':!![],'timeout':0x7d0};await rp(_0x32630a);winston[_0x5892('0x9')](_0x5892('0x20'));return _0x1f3f81(!![]);}catch(_0x3fdc86){winston[_0x5892('0x9')](_0x5892('0x21'));return _0x1f3f81(![]);}});};module[_0x5892('0x22')]=classroomConnection;